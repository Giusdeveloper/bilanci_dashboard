var wI=Object.defineProperty;var gy=e=>{throw TypeError(e)};var bI=(e,t,r)=>t in e?wI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Pe=(e,t,r)=>bI(e,typeof t!="symbol"?t+"":t,r),lp=(e,t,r)=>t.has(e)||gy("Cannot "+r);var W=(e,t,r)=>(lp(e,t,"read from private field"),r?r.call(e):t.get(e)),Te=(e,t,r)=>t.has(e)?gy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ve=(e,t,r,n)=>(lp(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Me=(e,t,r)=>(lp(e,t,"access private method"),r);var Od=(e,t,r,n)=>({set _(i){ve(e,t,i,r)},get _(){return W(e,t,n)}});function TS(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function kS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function _I(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var CS={exports:{}},d0={},AS={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ud=Symbol.for("react.element"),SI=Symbol.for("react.portal"),EI=Symbol.for("react.fragment"),TI=Symbol.for("react.strict_mode"),kI=Symbol.for("react.profiler"),CI=Symbol.for("react.provider"),AI=Symbol.for("react.context"),RI=Symbol.for("react.forward_ref"),PI=Symbol.for("react.suspense"),OI=Symbol.for("react.memo"),II=Symbol.for("react.lazy"),vy=Symbol.iterator;function DI(e){return e===null||typeof e!="object"?null:(e=vy&&e[vy]||e["@@iterator"],typeof e=="function"?e:null)}var RS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PS=Object.assign,OS={};function ec(e,t,r){this.props=e,this.context=t,this.refs=OS,this.updater=r||RS}ec.prototype.isReactComponent={};ec.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ec.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function IS(){}IS.prototype=ec.prototype;function Lv(e,t,r){this.props=e,this.context=t,this.refs=OS,this.updater=r||RS}var zv=Lv.prototype=new IS;zv.constructor=Lv;PS(zv,ec.prototype);zv.isPureReactComponent=!0;var xy=Array.isArray,DS=Object.prototype.hasOwnProperty,jv={current:null},NS={key:!0,ref:!0,__self:!0,__source:!0};function FS(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)DS.call(t,n)&&!NS.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:ud,type:e,key:s,ref:a,props:i,_owner:jv.current}}function NI(e,t){return{$$typeof:ud,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bv(e){return typeof e=="object"&&e!==null&&e.$$typeof===ud}function FI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var yy=/\/+/g;function cp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?FI(""+e.key):t.toString(36)}function zf(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ud:case SI:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+cp(a,0):n,xy(i)?(r="",e!=null&&(r=e.replace(yy,"$&/")+"/"),zf(i,t,r,"",function(c){return c})):i!=null&&(Bv(i)&&(i=NI(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(yy,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",xy(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+cp(s,o);a+=zf(s,t,r,l,i)}else if(l=DI(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+cp(s,o++),a+=zf(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Id(e,t,r){if(e==null)return e;var n=[],i=0;return zf(e,n,"","",function(s){return t.call(r,s,i++)}),n}function MI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Lr={current:null},jf={transition:null},LI={ReactCurrentDispatcher:Lr,ReactCurrentBatchConfig:jf,ReactCurrentOwner:jv};function MS(){throw Error("act(...) is not supported in production builds of React.")}Be.Children={map:Id,forEach:function(e,t,r){Id(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Id(e,function(){t++}),t},toArray:function(e){return Id(e,function(t){return t})||[]},only:function(e){if(!Bv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Be.Component=ec;Be.Fragment=EI;Be.Profiler=kI;Be.PureComponent=Lv;Be.StrictMode=TI;Be.Suspense=PI;Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LI;Be.act=MS;Be.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=PS({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=jv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)DS.call(t,l)&&!NS.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ud,type:e.type,key:i,ref:s,props:n,_owner:a}};Be.createContext=function(e){return e={$$typeof:AI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:CI,_context:e},e.Consumer=e};Be.createElement=FS;Be.createFactory=function(e){var t=FS.bind(null,e);return t.type=e,t};Be.createRef=function(){return{current:null}};Be.forwardRef=function(e){return{$$typeof:RI,render:e}};Be.isValidElement=Bv;Be.lazy=function(e){return{$$typeof:II,_payload:{_status:-1,_result:e},_init:MI}};Be.memo=function(e,t){return{$$typeof:OI,type:e,compare:t===void 0?null:t}};Be.startTransition=function(e){var t=jf.transition;jf.transition={};try{e()}finally{jf.transition=t}};Be.unstable_act=MS;Be.useCallback=function(e,t){return Lr.current.useCallback(e,t)};Be.useContext=function(e){return Lr.current.useContext(e)};Be.useDebugValue=function(){};Be.useDeferredValue=function(e){return Lr.current.useDeferredValue(e)};Be.useEffect=function(e,t){return Lr.current.useEffect(e,t)};Be.useId=function(){return Lr.current.useId()};Be.useImperativeHandle=function(e,t,r){return Lr.current.useImperativeHandle(e,t,r)};Be.useInsertionEffect=function(e,t){return Lr.current.useInsertionEffect(e,t)};Be.useLayoutEffect=function(e,t){return Lr.current.useLayoutEffect(e,t)};Be.useMemo=function(e,t){return Lr.current.useMemo(e,t)};Be.useReducer=function(e,t,r){return Lr.current.useReducer(e,t,r)};Be.useRef=function(e){return Lr.current.useRef(e)};Be.useState=function(e){return Lr.current.useState(e)};Be.useSyncExternalStore=function(e,t,r){return Lr.current.useSyncExternalStore(e,t,r)};Be.useTransition=function(){return Lr.current.useTransition()};Be.version="18.3.1";AS.exports=Be;var _=AS.exports;const mi=kS(_),LS=TS({__proto__:null,default:mi},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zI=_,jI=Symbol.for("react.element"),BI=Symbol.for("react.fragment"),UI=Object.prototype.hasOwnProperty,$I=zI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VI={key:!0,ref:!0,__self:!0,__source:!0};function zS(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)UI.call(t,n)&&!VI.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:jI,type:e,key:s,ref:a,props:i,_owner:$I.current}}d0.Fragment=BI;d0.jsx=zS;d0.jsxs=zS;CS.exports=d0;var x=CS.exports,jS={exports:{}},dn={},BS={exports:{}},US={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(G,z){var ie=G.length;G.push(z);e:for(;0<ie;){var ae=ie-1>>>1,D=G[ae];if(0<i(D,z))G[ae]=z,G[ie]=D,ie=ae;else break e}}function r(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var z=G[0],ie=G.pop();if(ie!==z){G[0]=ie;e:for(var ae=0,D=G.length,V=D>>>1;ae<V;){var B=2*(ae+1)-1,U=G[B],Y=B+1,te=G[Y];if(0>i(U,ie))Y<D&&0>i(te,U)?(G[ae]=te,G[Y]=ie,ae=Y):(G[ae]=U,G[B]=ie,ae=B);else if(Y<D&&0>i(te,ie))G[ae]=te,G[Y]=ie,ae=Y;else break e}}return z}function i(G,z){var ie=G.sortIndex-z.sortIndex;return ie!==0?ie:G.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,f=3,p=!1,m=!1,h=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(G){for(var z=r(c);z!==null;){if(z.callback===null)n(c);else if(z.startTime<=G)n(c),z.sortIndex=z.expirationTime,t(l,z);else break;z=r(c)}}function b(G){if(h=!1,y(G),!m)if(r(l)!==null)m=!0,K(E);else{var z=r(c);z!==null&&Q(b,z.startTime-G)}}function E(G,z){m=!1,h&&(h=!1,v(C),C=-1),p=!0;var ie=f;try{for(y(z),d=r(l);d!==null&&(!(d.expirationTime>z)||G&&!I());){var ae=d.callback;if(typeof ae=="function"){d.callback=null,f=d.priorityLevel;var D=ae(d.expirationTime<=z);z=e.unstable_now(),typeof D=="function"?d.callback=D:d===r(l)&&n(l),y(z)}else n(l);d=r(l)}if(d!==null)var V=!0;else{var B=r(c);B!==null&&Q(b,B.startTime-z),V=!1}return V}finally{d=null,f=ie,p=!1}}var k=!1,S=null,C=-1,T=5,P=-1;function I(){return!(e.unstable_now()-P<T)}function R(){if(S!==null){var G=e.unstable_now();P=G;var z=!0;try{z=S(!0,G)}finally{z?H():(k=!1,S=null)}}else k=!1}var H;if(typeof w=="function")H=function(){w(R)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,X=q.port2;q.port1.onmessage=R,H=function(){X.postMessage(null)}}else H=function(){g(R,0)};function K(G){S=G,k||(k=!0,H())}function Q(G,z){C=g(function(){G(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,K(E))},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(G){switch(f){case 1:case 2:case 3:var z=3;break;default:z=f}var ie=f;f=z;try{return G()}finally{f=ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ie=f;f=G;try{return z()}finally{f=ie}},e.unstable_scheduleCallback=function(G,z,ie){var ae=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?ae+ie:ae):ie=ae,G){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=ie+D,G={id:u++,callback:z,priorityLevel:G,startTime:ie,expirationTime:D,sortIndex:-1},ie>ae?(G.sortIndex=ie,t(c,G),r(l)===null&&G===r(c)&&(h?(v(C),C=-1):h=!0,Q(b,ie-ae))):(G.sortIndex=D,t(l,G),m||p||(m=!0,K(E))),G},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(G){var z=f;return function(){var ie=f;f=z;try{return G.apply(this,arguments)}finally{f=ie}}}})(US);BS.exports=US;var HI=BS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WI=_,ln=HI;function ue(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $S=new Set,wu={};function wo(e,t){Fl(e,t),Fl(e+"Capture",t)}function Fl(e,t){for(wu[e]=t,e=0;e<t.length;e++)$S.add(t[e])}var Ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dm=Object.prototype.hasOwnProperty,GI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wy={},by={};function KI(e){return Dm.call(by,e)?!0:Dm.call(wy,e)?!1:GI.test(e)?by[e]=!0:(wy[e]=!0,!1)}function qI(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XI(e,t,r,n){if(t===null||typeof t>"u"||qI(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zr(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var lr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){lr[e]=new zr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];lr[t]=new zr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){lr[e]=new zr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){lr[e]=new zr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){lr[e]=new zr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){lr[e]=new zr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){lr[e]=new zr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){lr[e]=new zr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){lr[e]=new zr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Uv=/[\-:]([a-z])/g;function $v(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Uv,$v);lr[t]=new zr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Uv,$v);lr[t]=new zr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Uv,$v);lr[t]=new zr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){lr[e]=new zr(e,1,!1,e.toLowerCase(),null,!1,!1)});lr.xlinkHref=new zr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){lr[e]=new zr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vv(e,t,r,n){var i=lr.hasOwnProperty(t)?lr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(XI(t,r,i,n)&&(r=null),n||i===null?KI(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ss=WI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dd=Symbol.for("react.element"),Go=Symbol.for("react.portal"),Ko=Symbol.for("react.fragment"),Hv=Symbol.for("react.strict_mode"),Nm=Symbol.for("react.profiler"),VS=Symbol.for("react.provider"),HS=Symbol.for("react.context"),Wv=Symbol.for("react.forward_ref"),Fm=Symbol.for("react.suspense"),Mm=Symbol.for("react.suspense_list"),Gv=Symbol.for("react.memo"),vs=Symbol.for("react.lazy"),WS=Symbol.for("react.offscreen"),_y=Symbol.iterator;function yc(e){return e===null||typeof e!="object"?null:(e=_y&&e[_y]||e["@@iterator"],typeof e=="function"?e:null)}var vt=Object.assign,up;function Nc(e){if(up===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);up=t&&t[1]||""}return`
`+up+e}var dp=!1;function fp(e,t){if(!e||dp)return"";dp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{dp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Nc(e):""}function YI(e){switch(e.tag){case 5:return Nc(e.type);case 16:return Nc("Lazy");case 13:return Nc("Suspense");case 19:return Nc("SuspenseList");case 0:case 2:case 15:return e=fp(e.type,!1),e;case 11:return e=fp(e.type.render,!1),e;case 1:return e=fp(e.type,!0),e;default:return""}}function Lm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ko:return"Fragment";case Go:return"Portal";case Nm:return"Profiler";case Hv:return"StrictMode";case Fm:return"Suspense";case Mm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case HS:return(e.displayName||"Context")+".Consumer";case VS:return(e._context.displayName||"Context")+".Provider";case Wv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Gv:return t=e.displayName||null,t!==null?t:Lm(e.type)||"Memo";case vs:t=e._payload,e=e._init;try{return Lm(e(t))}catch{}}return null}function QI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lm(t);case 8:return t===Hv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Zs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function GS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function JI(e){var t=GS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Nd(e){e._valueTracker||(e._valueTracker=JI(e))}function KS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=GS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function lh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zm(e,t){var r=t.checked;return vt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Sy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Zs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function qS(e,t){t=t.checked,t!=null&&Vv(e,"checked",t,!1)}function jm(e,t){qS(e,t);var r=Zs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Bm(e,t.type,r):t.hasOwnProperty("defaultValue")&&Bm(e,t.type,Zs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ey(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Bm(e,t,r){(t!=="number"||lh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Fc=Array.isArray;function sl(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Zs(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Um(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ue(91));return vt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ty(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ue(92));if(Fc(r)){if(1<r.length)throw Error(ue(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Zs(r)}}function XS(e,t){var r=Zs(t.value),n=Zs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ky(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function YS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $m(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?YS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Fd,QS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Fd=Fd||document.createElement("div"),Fd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Fd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function bu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Xc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ZI=["Webkit","ms","Moz","O"];Object.keys(Xc).forEach(function(e){ZI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xc[t]=Xc[e]})});function JS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Xc.hasOwnProperty(e)&&Xc[e]?(""+t).trim():t+"px"}function ZS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=JS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var e3=vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vm(e,t){if(t){if(e3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ue(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ue(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ue(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ue(62))}}function Hm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wm=null;function Kv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gm=null,al=null,ol=null;function Cy(e){if(e=hd(e)){if(typeof Gm!="function")throw Error(ue(280));var t=e.stateNode;t&&(t=g0(t),Gm(e.stateNode,e.type,t))}}function eE(e){al?ol?ol.push(e):ol=[e]:al=e}function tE(){if(al){var e=al,t=ol;if(ol=al=null,Cy(e),t)for(e=0;e<t.length;e++)Cy(t[e])}}function rE(e,t){return e(t)}function nE(){}var hp=!1;function iE(e,t,r){if(hp)return e(t,r);hp=!0;try{return rE(e,t,r)}finally{hp=!1,(al!==null||ol!==null)&&(nE(),tE())}}function _u(e,t){var r=e.stateNode;if(r===null)return null;var n=g0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ue(231,t,typeof r));return r}var Km=!1;if(Ji)try{var wc={};Object.defineProperty(wc,"passive",{get:function(){Km=!0}}),window.addEventListener("test",wc,wc),window.removeEventListener("test",wc,wc)}catch{Km=!1}function t3(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Yc=!1,ch=null,uh=!1,qm=null,r3={onError:function(e){Yc=!0,ch=e}};function n3(e,t,r,n,i,s,a,o,l){Yc=!1,ch=null,t3.apply(r3,arguments)}function i3(e,t,r,n,i,s,a,o,l){if(n3.apply(this,arguments),Yc){if(Yc){var c=ch;Yc=!1,ch=null}else throw Error(ue(198));uh||(uh=!0,qm=c)}}function bo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function sE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ay(e){if(bo(e)!==e)throw Error(ue(188))}function s3(e){var t=e.alternate;if(!t){if(t=bo(e),t===null)throw Error(ue(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ay(i),e;if(s===n)return Ay(i),t;s=s.sibling}throw Error(ue(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(ue(189))}}if(r.alternate!==n)throw Error(ue(190))}if(r.tag!==3)throw Error(ue(188));return r.stateNode.current===r?e:t}function aE(e){return e=s3(e),e!==null?oE(e):null}function oE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=oE(e);if(t!==null)return t;e=e.sibling}return null}var lE=ln.unstable_scheduleCallback,Ry=ln.unstable_cancelCallback,a3=ln.unstable_shouldYield,o3=ln.unstable_requestPaint,Ct=ln.unstable_now,l3=ln.unstable_getCurrentPriorityLevel,qv=ln.unstable_ImmediatePriority,cE=ln.unstable_UserBlockingPriority,dh=ln.unstable_NormalPriority,c3=ln.unstable_LowPriority,uE=ln.unstable_IdlePriority,f0=null,bi=null;function u3(e){if(bi&&typeof bi.onCommitFiberRoot=="function")try{bi.onCommitFiberRoot(f0,e,void 0,(e.current.flags&128)===128)}catch{}}var ti=Math.clz32?Math.clz32:h3,d3=Math.log,f3=Math.LN2;function h3(e){return e>>>=0,e===0?32:31-(d3(e)/f3|0)|0}var Md=64,Ld=4194304;function Mc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function fh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Mc(o):(s&=a,s!==0&&(n=Mc(s)))}else a=r&~i,a!==0?n=Mc(a):s!==0&&(n=Mc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ti(t),i=1<<r,n|=e[r],t&=~i;return n}function p3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function m3(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-ti(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=p3(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function Xm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dE(){var e=Md;return Md<<=1,!(Md&4194240)&&(Md=64),e}function pp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function dd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ti(t),e[t]=r}function g3(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-ti(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Xv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ti(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Qe=0;function fE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hE,Yv,pE,mE,gE,Ym=!1,zd=[],Us=null,$s=null,Vs=null,Su=new Map,Eu=new Map,ys=[],v3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Py(e,t){switch(e){case"focusin":case"focusout":Us=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Vs=null;break;case"pointerover":case"pointerout":Su.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eu.delete(t.pointerId)}}function bc(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=hd(t),t!==null&&Yv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function x3(e,t,r,n,i){switch(t){case"focusin":return Us=bc(Us,e,t,r,n,i),!0;case"dragenter":return $s=bc($s,e,t,r,n,i),!0;case"mouseover":return Vs=bc(Vs,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Su.set(s,bc(Su.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Eu.set(s,bc(Eu.get(s)||null,e,t,r,n,i)),!0}return!1}function vE(e){var t=Fa(e.target);if(t!==null){var r=bo(t);if(r!==null){if(t=r.tag,t===13){if(t=sE(r),t!==null){e.blockedOn=t,gE(e.priority,function(){pE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Qm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Wm=n,r.target.dispatchEvent(n),Wm=null}else return t=hd(r),t!==null&&Yv(t),e.blockedOn=r,!1;t.shift()}return!0}function Oy(e,t,r){Bf(e)&&r.delete(t)}function y3(){Ym=!1,Us!==null&&Bf(Us)&&(Us=null),$s!==null&&Bf($s)&&($s=null),Vs!==null&&Bf(Vs)&&(Vs=null),Su.forEach(Oy),Eu.forEach(Oy)}function _c(e,t){e.blockedOn===t&&(e.blockedOn=null,Ym||(Ym=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,y3)))}function Tu(e){function t(i){return _c(i,e)}if(0<zd.length){_c(zd[0],e);for(var r=1;r<zd.length;r++){var n=zd[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Us!==null&&_c(Us,e),$s!==null&&_c($s,e),Vs!==null&&_c(Vs,e),Su.forEach(t),Eu.forEach(t),r=0;r<ys.length;r++)n=ys[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ys.length&&(r=ys[0],r.blockedOn===null);)vE(r),r.blockedOn===null&&ys.shift()}var ll=ss.ReactCurrentBatchConfig,hh=!0;function w3(e,t,r,n){var i=Qe,s=ll.transition;ll.transition=null;try{Qe=1,Qv(e,t,r,n)}finally{Qe=i,ll.transition=s}}function b3(e,t,r,n){var i=Qe,s=ll.transition;ll.transition=null;try{Qe=4,Qv(e,t,r,n)}finally{Qe=i,ll.transition=s}}function Qv(e,t,r,n){if(hh){var i=Qm(e,t,r,n);if(i===null)Ep(e,t,n,ph,r),Py(e,n);else if(x3(i,e,t,r,n))n.stopPropagation();else if(Py(e,n),t&4&&-1<v3.indexOf(e)){for(;i!==null;){var s=hd(i);if(s!==null&&hE(s),s=Qm(e,t,r,n),s===null&&Ep(e,t,n,ph,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ep(e,t,n,null,r)}}var ph=null;function Qm(e,t,r,n){if(ph=null,e=Kv(n),e=Fa(e),e!==null)if(t=bo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=sE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ph=e,null}function xE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(l3()){case qv:return 1;case cE:return 4;case dh:case c3:return 16;case uE:return 536870912;default:return 16}default:return 16}}var Ns=null,Jv=null,Uf=null;function yE(){if(Uf)return Uf;var e,t=Jv,r=t.length,n,i="value"in Ns?Ns.value:Ns.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Uf=i.slice(e,1<n?1-n:void 0)}function $f(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jd(){return!0}function Iy(){return!1}function fn(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?jd:Iy,this.isPropagationStopped=Iy,this}return vt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=jd)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=jd)},persist:function(){},isPersistent:jd}),t}var tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zv=fn(tc),fd=vt({},tc,{view:0,detail:0}),_3=fn(fd),mp,gp,Sc,h0=vt({},fd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:e1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sc&&(Sc&&e.type==="mousemove"?(mp=e.screenX-Sc.screenX,gp=e.screenY-Sc.screenY):gp=mp=0,Sc=e),mp)},movementY:function(e){return"movementY"in e?e.movementY:gp}}),Dy=fn(h0),S3=vt({},h0,{dataTransfer:0}),E3=fn(S3),T3=vt({},fd,{relatedTarget:0}),vp=fn(T3),k3=vt({},tc,{animationName:0,elapsedTime:0,pseudoElement:0}),C3=fn(k3),A3=vt({},tc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),R3=fn(A3),P3=vt({},tc,{data:0}),Ny=fn(P3),O3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},D3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function N3(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=D3[e])?!!t[e]:!1}function e1(){return N3}var F3=vt({},fd,{key:function(e){if(e.key){var t=O3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=$f(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?I3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:e1,charCode:function(e){return e.type==="keypress"?$f(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?$f(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),M3=fn(F3),L3=vt({},h0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fy=fn(L3),z3=vt({},fd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:e1}),j3=fn(z3),B3=vt({},tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),U3=fn(B3),$3=vt({},h0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),V3=fn($3),H3=[9,13,27,32],t1=Ji&&"CompositionEvent"in window,Qc=null;Ji&&"documentMode"in document&&(Qc=document.documentMode);var W3=Ji&&"TextEvent"in window&&!Qc,wE=Ji&&(!t1||Qc&&8<Qc&&11>=Qc),My=" ",Ly=!1;function bE(e,t){switch(e){case"keyup":return H3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _E(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qo=!1;function G3(e,t){switch(e){case"compositionend":return _E(t);case"keypress":return t.which!==32?null:(Ly=!0,My);case"textInput":return e=t.data,e===My&&Ly?null:e;default:return null}}function K3(e,t){if(qo)return e==="compositionend"||!t1&&bE(e,t)?(e=yE(),Uf=Jv=Ns=null,qo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wE&&t.locale!=="ko"?null:t.data;default:return null}}var q3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!q3[e.type]:t==="textarea"}function SE(e,t,r,n){eE(n),t=mh(t,"onChange"),0<t.length&&(r=new Zv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Jc=null,ku=null;function X3(e){NE(e,0)}function p0(e){var t=Qo(e);if(KS(t))return e}function Y3(e,t){if(e==="change")return t}var EE=!1;if(Ji){var xp;if(Ji){var yp="oninput"in document;if(!yp){var jy=document.createElement("div");jy.setAttribute("oninput","return;"),yp=typeof jy.oninput=="function"}xp=yp}else xp=!1;EE=xp&&(!document.documentMode||9<document.documentMode)}function By(){Jc&&(Jc.detachEvent("onpropertychange",TE),ku=Jc=null)}function TE(e){if(e.propertyName==="value"&&p0(ku)){var t=[];SE(t,ku,e,Kv(e)),iE(X3,t)}}function Q3(e,t,r){e==="focusin"?(By(),Jc=t,ku=r,Jc.attachEvent("onpropertychange",TE)):e==="focusout"&&By()}function J3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return p0(ku)}function Z3(e,t){if(e==="click")return p0(t)}function eD(e,t){if(e==="input"||e==="change")return p0(t)}function tD(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ii=typeof Object.is=="function"?Object.is:tD;function Cu(e,t){if(ii(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Dm.call(t,i)||!ii(e[i],t[i]))return!1}return!0}function Uy(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $y(e,t){var r=Uy(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Uy(r)}}function kE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?kE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function CE(){for(var e=window,t=lh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=lh(e.document)}return t}function r1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function rD(e){var t=CE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&kE(r.ownerDocument.documentElement,r)){if(n!==null&&r1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=$y(r,s);var a=$y(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nD=Ji&&"documentMode"in document&&11>=document.documentMode,Xo=null,Jm=null,Zc=null,Zm=!1;function Vy(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Zm||Xo==null||Xo!==lh(n)||(n=Xo,"selectionStart"in n&&r1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Zc&&Cu(Zc,n)||(Zc=n,n=mh(Jm,"onSelect"),0<n.length&&(t=new Zv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Xo)))}function Bd(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Yo={animationend:Bd("Animation","AnimationEnd"),animationiteration:Bd("Animation","AnimationIteration"),animationstart:Bd("Animation","AnimationStart"),transitionend:Bd("Transition","TransitionEnd")},wp={},AE={};Ji&&(AE=document.createElement("div").style,"AnimationEvent"in window||(delete Yo.animationend.animation,delete Yo.animationiteration.animation,delete Yo.animationstart.animation),"TransitionEvent"in window||delete Yo.transitionend.transition);function m0(e){if(wp[e])return wp[e];if(!Yo[e])return e;var t=Yo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in AE)return wp[e]=t[r];return e}var RE=m0("animationend"),PE=m0("animationiteration"),OE=m0("animationstart"),IE=m0("transitionend"),DE=new Map,Hy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oa(e,t){DE.set(e,t),wo(t,[e])}for(var bp=0;bp<Hy.length;bp++){var _p=Hy[bp],iD=_p.toLowerCase(),sD=_p[0].toUpperCase()+_p.slice(1);oa(iD,"on"+sD)}oa(RE,"onAnimationEnd");oa(PE,"onAnimationIteration");oa(OE,"onAnimationStart");oa("dblclick","onDoubleClick");oa("focusin","onFocus");oa("focusout","onBlur");oa(IE,"onTransitionEnd");Fl("onMouseEnter",["mouseout","mouseover"]);Fl("onMouseLeave",["mouseout","mouseover"]);Fl("onPointerEnter",["pointerout","pointerover"]);Fl("onPointerLeave",["pointerout","pointerover"]);wo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wo("onBeforeInput",["compositionend","keypress","textInput","paste"]);wo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aD=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lc));function Wy(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,i3(n,t,void 0,e),e.currentTarget=null}function NE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Wy(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Wy(i,o,c),s=l}}}if(uh)throw e=qm,uh=!1,qm=null,e}function at(e,t){var r=t[ig];r===void 0&&(r=t[ig]=new Set);var n=e+"__bubble";r.has(n)||(FE(t,e,2,!1),r.add(n))}function Sp(e,t,r){var n=0;t&&(n|=4),FE(r,e,n,t)}var Ud="_reactListening"+Math.random().toString(36).slice(2);function Au(e){if(!e[Ud]){e[Ud]=!0,$S.forEach(function(r){r!=="selectionchange"&&(aD.has(r)||Sp(r,!1,e),Sp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ud]||(t[Ud]=!0,Sp("selectionchange",!1,t))}}function FE(e,t,r,n){switch(xE(t)){case 1:var i=w3;break;case 4:i=b3;break;default:i=Qv}r=i.bind(null,t,r,e),i=void 0,!Km||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Ep(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Fa(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}iE(function(){var c=s,u=Kv(r),d=[];e:{var f=DE.get(e);if(f!==void 0){var p=Zv,m=e;switch(e){case"keypress":if($f(r)===0)break e;case"keydown":case"keyup":p=M3;break;case"focusin":m="focus",p=vp;break;case"focusout":m="blur",p=vp;break;case"beforeblur":case"afterblur":p=vp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Dy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=E3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=j3;break;case RE:case PE:case OE:p=C3;break;case IE:p=U3;break;case"scroll":p=_3;break;case"wheel":p=V3;break;case"copy":case"cut":case"paste":p=R3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Fy}var h=(t&4)!==0,g=!h&&e==="scroll",v=h?f!==null?f+"Capture":null:f;h=[];for(var w=c,y;w!==null;){y=w;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,v!==null&&(b=_u(w,v),b!=null&&h.push(Ru(w,b,y)))),g)break;w=w.return}0<h.length&&(f=new p(f,m,null,r,u),d.push({event:f,listeners:h}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==Wm&&(m=r.relatedTarget||r.fromElement)&&(Fa(m)||m[Zi]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=c,m=m?Fa(m):null,m!==null&&(g=bo(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(h=Dy,b="onMouseLeave",v="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(h=Fy,b="onPointerLeave",v="onPointerEnter",w="pointer"),g=p==null?f:Qo(p),y=m==null?f:Qo(m),f=new h(b,w+"leave",p,r,u),f.target=g,f.relatedTarget=y,b=null,Fa(u)===c&&(h=new h(v,w+"enter",m,r,u),h.target=y,h.relatedTarget=g,b=h),g=b,p&&m)t:{for(h=p,v=m,w=0,y=h;y;y=Oo(y))w++;for(y=0,b=v;b;b=Oo(b))y++;for(;0<w-y;)h=Oo(h),w--;for(;0<y-w;)v=Oo(v),y--;for(;w--;){if(h===v||v!==null&&h===v.alternate)break t;h=Oo(h),v=Oo(v)}h=null}else h=null;p!==null&&Gy(d,f,p,h,!1),m!==null&&g!==null&&Gy(d,g,m,h,!0)}}e:{if(f=c?Qo(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var E=Y3;else if(zy(f))if(EE)E=eD;else{E=J3;var k=Q3}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=Z3);if(E&&(E=E(e,c))){SE(d,E,r,u);break e}k&&k(e,f,c),e==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&Bm(f,"number",f.value)}switch(k=c?Qo(c):window,e){case"focusin":(zy(k)||k.contentEditable==="true")&&(Xo=k,Jm=c,Zc=null);break;case"focusout":Zc=Jm=Xo=null;break;case"mousedown":Zm=!0;break;case"contextmenu":case"mouseup":case"dragend":Zm=!1,Vy(d,r,u);break;case"selectionchange":if(nD)break;case"keydown":case"keyup":Vy(d,r,u)}var S;if(t1)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else qo?bE(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(wE&&r.locale!=="ko"&&(qo||C!=="onCompositionStart"?C==="onCompositionEnd"&&qo&&(S=yE()):(Ns=u,Jv="value"in Ns?Ns.value:Ns.textContent,qo=!0)),k=mh(c,C),0<k.length&&(C=new Ny(C,e,null,r,u),d.push({event:C,listeners:k}),S?C.data=S:(S=_E(r),S!==null&&(C.data=S)))),(S=W3?G3(e,r):K3(e,r))&&(c=mh(c,"onBeforeInput"),0<c.length&&(u=new Ny("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=S))}NE(d,t)})}function Ru(e,t,r){return{instance:e,listener:t,currentTarget:r}}function mh(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=_u(e,r),s!=null&&n.unshift(Ru(e,s,i)),s=_u(e,t),s!=null&&n.push(Ru(e,s,i))),e=e.return}return n}function Oo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gy(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=_u(r,s),l!=null&&a.unshift(Ru(r,l,o))):i||(l=_u(r,s),l!=null&&a.push(Ru(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var oD=/\r\n?/g,lD=/\u0000|\uFFFD/g;function Ky(e){return(typeof e=="string"?e:""+e).replace(oD,`
`).replace(lD,"")}function $d(e,t,r){if(t=Ky(t),Ky(e)!==t&&r)throw Error(ue(425))}function gh(){}var eg=null,tg=null;function rg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ng=typeof setTimeout=="function"?setTimeout:void 0,cD=typeof clearTimeout=="function"?clearTimeout:void 0,qy=typeof Promise=="function"?Promise:void 0,uD=typeof queueMicrotask=="function"?queueMicrotask:typeof qy<"u"?function(e){return qy.resolve(null).then(e).catch(dD)}:ng;function dD(e){setTimeout(function(){throw e})}function Tp(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Tu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Tu(t)}function Hs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Xy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var rc=Math.random().toString(36).slice(2),wi="__reactFiber$"+rc,Pu="__reactProps$"+rc,Zi="__reactContainer$"+rc,ig="__reactEvents$"+rc,fD="__reactListeners$"+rc,hD="__reactHandles$"+rc;function Fa(e){var t=e[wi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Zi]||r[wi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Xy(e);e!==null;){if(r=e[wi])return r;e=Xy(e)}return t}e=r,r=e.parentNode}return null}function hd(e){return e=e[wi]||e[Zi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ue(33))}function g0(e){return e[Pu]||null}var sg=[],Jo=-1;function la(e){return{current:e}}function lt(e){0>Jo||(e.current=sg[Jo],sg[Jo]=null,Jo--)}function nt(e,t){Jo++,sg[Jo]=e.current,e.current=t}var ea={},_r=la(ea),Gr=la(!1),no=ea;function Ml(e,t){var r=e.type.contextTypes;if(!r)return ea;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Kr(e){return e=e.childContextTypes,e!=null}function vh(){lt(Gr),lt(_r)}function Yy(e,t,r){if(_r.current!==ea)throw Error(ue(168));nt(_r,t),nt(Gr,r)}function ME(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ue(108,QI(e)||"Unknown",i));return vt({},r,n)}function xh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ea,no=_r.current,nt(_r,e),nt(Gr,Gr.current),!0}function Qy(e,t,r){var n=e.stateNode;if(!n)throw Error(ue(169));r?(e=ME(e,t,no),n.__reactInternalMemoizedMergedChildContext=e,lt(Gr),lt(_r),nt(_r,e)):lt(Gr),nt(Gr,r)}var Ui=null,v0=!1,kp=!1;function LE(e){Ui===null?Ui=[e]:Ui.push(e)}function pD(e){v0=!0,LE(e)}function ca(){if(!kp&&Ui!==null){kp=!0;var e=0,t=Qe;try{var r=Ui;for(Qe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ui=null,v0=!1}catch(i){throw Ui!==null&&(Ui=Ui.slice(e+1)),lE(qv,ca),i}finally{Qe=t,kp=!1}}return null}var Zo=[],el=0,yh=null,wh=0,_n=[],Sn=0,io=null,Hi=1,Wi="";function ka(e,t){Zo[el++]=wh,Zo[el++]=yh,yh=e,wh=t}function zE(e,t,r){_n[Sn++]=Hi,_n[Sn++]=Wi,_n[Sn++]=io,io=e;var n=Hi;e=Wi;var i=32-ti(n)-1;n&=~(1<<i),r+=1;var s=32-ti(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Hi=1<<32-ti(t)+i|r<<i|n,Wi=s+e}else Hi=1<<s|r<<i|n,Wi=e}function n1(e){e.return!==null&&(ka(e,1),zE(e,1,0))}function i1(e){for(;e===yh;)yh=Zo[--el],Zo[el]=null,wh=Zo[--el],Zo[el]=null;for(;e===io;)io=_n[--Sn],_n[Sn]=null,Wi=_n[--Sn],_n[Sn]=null,Hi=_n[--Sn],_n[Sn]=null}var an=null,nn=null,dt=!1,qn=null;function jE(e,t){var r=kn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Jy(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,an=e,nn=Hs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,an=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=io!==null?{id:Hi,overflow:Wi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=kn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,an=e,nn=null,!0):!1;default:return!1}}function ag(e){return(e.mode&1)!==0&&(e.flags&128)===0}function og(e){if(dt){var t=nn;if(t){var r=t;if(!Jy(e,t)){if(ag(e))throw Error(ue(418));t=Hs(r.nextSibling);var n=an;t&&Jy(e,t)?jE(n,r):(e.flags=e.flags&-4097|2,dt=!1,an=e)}}else{if(ag(e))throw Error(ue(418));e.flags=e.flags&-4097|2,dt=!1,an=e}}}function Zy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;an=e}function Vd(e){if(e!==an)return!1;if(!dt)return Zy(e),dt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!rg(e.type,e.memoizedProps)),t&&(t=nn)){if(ag(e))throw BE(),Error(ue(418));for(;t;)jE(e,t),t=Hs(t.nextSibling)}if(Zy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ue(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){nn=Hs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=an?Hs(e.stateNode.nextSibling):null;return!0}function BE(){for(var e=nn;e;)e=Hs(e.nextSibling)}function Ll(){nn=an=null,dt=!1}function s1(e){qn===null?qn=[e]:qn.push(e)}var mD=ss.ReactCurrentBatchConfig;function Ec(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ue(309));var n=r.stateNode}if(!n)throw Error(ue(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(ue(284));if(!r._owner)throw Error(ue(290,e))}return e}function Hd(e,t){throw e=Object.prototype.toString.call(t),Error(ue(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ew(e){var t=e._init;return t(e._payload)}function UE(e){function t(v,w){if(e){var y=v.deletions;y===null?(v.deletions=[w],v.flags|=16):y.push(w)}}function r(v,w){if(!e)return null;for(;w!==null;)t(v,w),w=w.sibling;return null}function n(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function i(v,w){return v=qs(v,w),v.index=0,v.sibling=null,v}function s(v,w,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<w?(v.flags|=2,w):y):(v.flags|=2,w)):(v.flags|=1048576,w)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,w,y,b){return w===null||w.tag!==6?(w=Dp(y,v.mode,b),w.return=v,w):(w=i(w,y),w.return=v,w)}function l(v,w,y,b){var E=y.type;return E===Ko?u(v,w,y.props.children,b,y.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===vs&&ew(E)===w.type)?(b=i(w,y.props),b.ref=Ec(v,w,y),b.return=v,b):(b=Xf(y.type,y.key,y.props,null,v.mode,b),b.ref=Ec(v,w,y),b.return=v,b)}function c(v,w,y,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=Np(y,v.mode,b),w.return=v,w):(w=i(w,y.children||[]),w.return=v,w)}function u(v,w,y,b,E){return w===null||w.tag!==7?(w=Qa(y,v.mode,b,E),w.return=v,w):(w=i(w,y),w.return=v,w)}function d(v,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Dp(""+w,v.mode,y),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Dd:return y=Xf(w.type,w.key,w.props,null,v.mode,y),y.ref=Ec(v,null,w),y.return=v,y;case Go:return w=Np(w,v.mode,y),w.return=v,w;case vs:var b=w._init;return d(v,b(w._payload),y)}if(Fc(w)||yc(w))return w=Qa(w,v.mode,y,null),w.return=v,w;Hd(v,w)}return null}function f(v,w,y,b){var E=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return E!==null?null:o(v,w,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Dd:return y.key===E?l(v,w,y,b):null;case Go:return y.key===E?c(v,w,y,b):null;case vs:return E=y._init,f(v,w,E(y._payload),b)}if(Fc(y)||yc(y))return E!==null?null:u(v,w,y,b,null);Hd(v,y)}return null}function p(v,w,y,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(y)||null,o(w,v,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Dd:return v=v.get(b.key===null?y:b.key)||null,l(w,v,b,E);case Go:return v=v.get(b.key===null?y:b.key)||null,c(w,v,b,E);case vs:var k=b._init;return p(v,w,y,k(b._payload),E)}if(Fc(b)||yc(b))return v=v.get(y)||null,u(w,v,b,E,null);Hd(w,b)}return null}function m(v,w,y,b){for(var E=null,k=null,S=w,C=w=0,T=null;S!==null&&C<y.length;C++){S.index>C?(T=S,S=null):T=S.sibling;var P=f(v,S,y[C],b);if(P===null){S===null&&(S=T);break}e&&S&&P.alternate===null&&t(v,S),w=s(P,w,C),k===null?E=P:k.sibling=P,k=P,S=T}if(C===y.length)return r(v,S),dt&&ka(v,C),E;if(S===null){for(;C<y.length;C++)S=d(v,y[C],b),S!==null&&(w=s(S,w,C),k===null?E=S:k.sibling=S,k=S);return dt&&ka(v,C),E}for(S=n(v,S);C<y.length;C++)T=p(S,v,C,y[C],b),T!==null&&(e&&T.alternate!==null&&S.delete(T.key===null?C:T.key),w=s(T,w,C),k===null?E=T:k.sibling=T,k=T);return e&&S.forEach(function(I){return t(v,I)}),dt&&ka(v,C),E}function h(v,w,y,b){var E=yc(y);if(typeof E!="function")throw Error(ue(150));if(y=E.call(y),y==null)throw Error(ue(151));for(var k=E=null,S=w,C=w=0,T=null,P=y.next();S!==null&&!P.done;C++,P=y.next()){S.index>C?(T=S,S=null):T=S.sibling;var I=f(v,S,P.value,b);if(I===null){S===null&&(S=T);break}e&&S&&I.alternate===null&&t(v,S),w=s(I,w,C),k===null?E=I:k.sibling=I,k=I,S=T}if(P.done)return r(v,S),dt&&ka(v,C),E;if(S===null){for(;!P.done;C++,P=y.next())P=d(v,P.value,b),P!==null&&(w=s(P,w,C),k===null?E=P:k.sibling=P,k=P);return dt&&ka(v,C),E}for(S=n(v,S);!P.done;C++,P=y.next())P=p(S,v,C,P.value,b),P!==null&&(e&&P.alternate!==null&&S.delete(P.key===null?C:P.key),w=s(P,w,C),k===null?E=P:k.sibling=P,k=P);return e&&S.forEach(function(R){return t(v,R)}),dt&&ka(v,C),E}function g(v,w,y,b){if(typeof y=="object"&&y!==null&&y.type===Ko&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Dd:e:{for(var E=y.key,k=w;k!==null;){if(k.key===E){if(E=y.type,E===Ko){if(k.tag===7){r(v,k.sibling),w=i(k,y.props.children),w.return=v,v=w;break e}}else if(k.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===vs&&ew(E)===k.type){r(v,k.sibling),w=i(k,y.props),w.ref=Ec(v,k,y),w.return=v,v=w;break e}r(v,k);break}else t(v,k);k=k.sibling}y.type===Ko?(w=Qa(y.props.children,v.mode,b,y.key),w.return=v,v=w):(b=Xf(y.type,y.key,y.props,null,v.mode,b),b.ref=Ec(v,w,y),b.return=v,v=b)}return a(v);case Go:e:{for(k=y.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(v,w.sibling),w=i(w,y.children||[]),w.return=v,v=w;break e}else{r(v,w);break}else t(v,w);w=w.sibling}w=Np(y,v.mode,b),w.return=v,v=w}return a(v);case vs:return k=y._init,g(v,w,k(y._payload),b)}if(Fc(y))return m(v,w,y,b);if(yc(y))return h(v,w,y,b);Hd(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(v,w.sibling),w=i(w,y),w.return=v,v=w):(r(v,w),w=Dp(y,v.mode,b),w.return=v,v=w),a(v)):r(v,w)}return g}var zl=UE(!0),$E=UE(!1),bh=la(null),_h=null,tl=null,a1=null;function o1(){a1=tl=_h=null}function l1(e){var t=bh.current;lt(bh),e._currentValue=t}function lg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cl(e,t){_h=e,a1=tl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wr=!0),e.firstContext=null)}function Rn(e){var t=e._currentValue;if(a1!==e)if(e={context:e,memoizedValue:t,next:null},tl===null){if(_h===null)throw Error(ue(308));tl=e,_h.dependencies={lanes:0,firstContext:e}}else tl=tl.next=e;return t}var Ma=null;function c1(e){Ma===null?Ma=[e]:Ma.push(e)}function VE(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,c1(t)):(r.next=i.next,i.next=r),t.interleaved=r,es(e,n)}function es(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var xs=!1;function u1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ki(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ws(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,We&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,es(e,r)}return i=n.interleaved,i===null?(t.next=t,c1(n)):(t.next=i.next,i.next=t),n.interleaved=t,es(e,r)}function Vf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Xv(e,r)}}function tw(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Sh(e,t,r,n){var i=e.updateQueue;xs=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,u=c=l=null,o=s;do{var f=o.lane,p=o.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,h=o;switch(f=t,p=r,h.tag){case 1:if(m=h.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=h.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=vt({},d,f);break e;case 2:xs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,a|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ao|=a,e.lanes=a,e.memoizedState=d}}function rw(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ue(191,i));i.call(n)}}}var pd={},_i=la(pd),Ou=la(pd),Iu=la(pd);function La(e){if(e===pd)throw Error(ue(174));return e}function d1(e,t){switch(nt(Iu,t),nt(Ou,e),nt(_i,pd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$m(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$m(t,e)}lt(_i),nt(_i,t)}function jl(){lt(_i),lt(Ou),lt(Iu)}function WE(e){La(Iu.current);var t=La(_i.current),r=$m(t,e.type);t!==r&&(nt(Ou,e),nt(_i,r))}function f1(e){Ou.current===e&&(lt(_i),lt(Ou))}var mt=la(0);function Eh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cp=[];function h1(){for(var e=0;e<Cp.length;e++)Cp[e]._workInProgressVersionPrimary=null;Cp.length=0}var Hf=ss.ReactCurrentDispatcher,Ap=ss.ReactCurrentBatchConfig,so=0,gt=null,Ut=null,Yt=null,Th=!1,eu=!1,Du=0,gD=0;function dr(){throw Error(ue(321))}function p1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ii(e[r],t[r]))return!1;return!0}function m1(e,t,r,n,i,s){if(so=s,gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Hf.current=e===null||e.memoizedState===null?wD:bD,e=r(n,i),eu){s=0;do{if(eu=!1,Du=0,25<=s)throw Error(ue(301));s+=1,Yt=Ut=null,t.updateQueue=null,Hf.current=_D,e=r(n,i)}while(eu)}if(Hf.current=kh,t=Ut!==null&&Ut.next!==null,so=0,Yt=Ut=gt=null,Th=!1,t)throw Error(ue(300));return e}function g1(){var e=Du!==0;return Du=0,e}function hi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?gt.memoizedState=Yt=e:Yt=Yt.next=e,Yt}function Pn(){if(Ut===null){var e=gt.alternate;e=e!==null?e.memoizedState:null}else e=Ut.next;var t=Yt===null?gt.memoizedState:Yt.next;if(t!==null)Yt=t,Ut=e;else{if(e===null)throw Error(ue(310));Ut=e,e={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},Yt===null?gt.memoizedState=Yt=e:Yt=Yt.next=e}return Yt}function Nu(e,t){return typeof t=="function"?t(e):t}function Rp(e){var t=Pn(),r=t.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=e;var n=Ut,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((so&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,gt.lanes|=u,ao|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,ii(n,t.memoizedState)||(Wr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,gt.lanes|=s,ao|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pp(e){var t=Pn(),r=t.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);ii(s,t.memoizedState)||(Wr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function GE(){}function KE(e,t){var r=gt,n=Pn(),i=t(),s=!ii(n.memoizedState,i);if(s&&(n.memoizedState=i,Wr=!0),n=n.queue,v1(YE.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Yt!==null&&Yt.memoizedState.tag&1){if(r.flags|=2048,Fu(9,XE.bind(null,r,n,i,t),void 0,null),Jt===null)throw Error(ue(349));so&30||qE(r,t,i)}return i}function qE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function XE(e,t,r,n){t.value=r,t.getSnapshot=n,QE(t)&&JE(e)}function YE(e,t,r){return r(function(){QE(t)&&JE(e)})}function QE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ii(e,r)}catch{return!0}}function JE(e){var t=es(e,1);t!==null&&ri(t,e,1,-1)}function nw(e){var t=hi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nu,lastRenderedState:e},t.queue=e,e=e.dispatch=yD.bind(null,gt,e),[t.memoizedState,e]}function Fu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ZE(){return Pn().memoizedState}function Wf(e,t,r,n){var i=hi();gt.flags|=e,i.memoizedState=Fu(1|t,r,void 0,n===void 0?null:n)}function x0(e,t,r,n){var i=Pn();n=n===void 0?null:n;var s=void 0;if(Ut!==null){var a=Ut.memoizedState;if(s=a.destroy,n!==null&&p1(n,a.deps)){i.memoizedState=Fu(t,r,s,n);return}}gt.flags|=e,i.memoizedState=Fu(1|t,r,s,n)}function iw(e,t){return Wf(8390656,8,e,t)}function v1(e,t){return x0(2048,8,e,t)}function eT(e,t){return x0(4,2,e,t)}function tT(e,t){return x0(4,4,e,t)}function rT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nT(e,t,r){return r=r!=null?r.concat([e]):null,x0(4,4,rT.bind(null,t,e),r)}function x1(){}function iT(e,t){var r=Pn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&p1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function sT(e,t){var r=Pn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&p1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function aT(e,t,r){return so&21?(ii(r,t)||(r=dE(),gt.lanes|=r,ao|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wr=!0),e.memoizedState=r)}function vD(e,t){var r=Qe;Qe=r!==0&&4>r?r:4,e(!0);var n=Ap.transition;Ap.transition={};try{e(!1),t()}finally{Qe=r,Ap.transition=n}}function oT(){return Pn().memoizedState}function xD(e,t,r){var n=Ks(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},lT(e))cT(t,r);else if(r=VE(e,t,r,n),r!==null){var i=Nr();ri(r,e,n,i),uT(r,t,n)}}function yD(e,t,r){var n=Ks(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(lT(e))cT(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,ii(o,a)){var l=t.interleaved;l===null?(i.next=i,c1(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=VE(e,t,i,n),r!==null&&(i=Nr(),ri(r,e,n,i),uT(r,t,n))}}function lT(e){var t=e.alternate;return e===gt||t!==null&&t===gt}function cT(e,t){eu=Th=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function uT(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Xv(e,r)}}var kh={readContext:Rn,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useInsertionEffect:dr,useLayoutEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useMutableSource:dr,useSyncExternalStore:dr,useId:dr,unstable_isNewReconciler:!1},wD={readContext:Rn,useCallback:function(e,t){return hi().memoizedState=[e,t===void 0?null:t],e},useContext:Rn,useEffect:iw,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Wf(4194308,4,rT.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Wf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wf(4,2,e,t)},useMemo:function(e,t){var r=hi();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=hi();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=xD.bind(null,gt,e),[n.memoizedState,e]},useRef:function(e){var t=hi();return e={current:e},t.memoizedState=e},useState:nw,useDebugValue:x1,useDeferredValue:function(e){return hi().memoizedState=e},useTransition:function(){var e=nw(!1),t=e[0];return e=vD.bind(null,e[1]),hi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gt,i=hi();if(dt){if(r===void 0)throw Error(ue(407));r=r()}else{if(r=t(),Jt===null)throw Error(ue(349));so&30||qE(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,iw(YE.bind(null,n,s,e),[e]),n.flags|=2048,Fu(9,XE.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=hi(),t=Jt.identifierPrefix;if(dt){var r=Wi,n=Hi;r=(n&~(1<<32-ti(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Du++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=gD++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bD={readContext:Rn,useCallback:iT,useContext:Rn,useEffect:v1,useImperativeHandle:nT,useInsertionEffect:eT,useLayoutEffect:tT,useMemo:sT,useReducer:Rp,useRef:ZE,useState:function(){return Rp(Nu)},useDebugValue:x1,useDeferredValue:function(e){var t=Pn();return aT(t,Ut.memoizedState,e)},useTransition:function(){var e=Rp(Nu)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:GE,useSyncExternalStore:KE,useId:oT,unstable_isNewReconciler:!1},_D={readContext:Rn,useCallback:iT,useContext:Rn,useEffect:v1,useImperativeHandle:nT,useInsertionEffect:eT,useLayoutEffect:tT,useMemo:sT,useReducer:Pp,useRef:ZE,useState:function(){return Pp(Nu)},useDebugValue:x1,useDeferredValue:function(e){var t=Pn();return Ut===null?t.memoizedState=e:aT(t,Ut.memoizedState,e)},useTransition:function(){var e=Pp(Nu)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:GE,useSyncExternalStore:KE,useId:oT,unstable_isNewReconciler:!1};function Hn(e,t){if(e&&e.defaultProps){t=vt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function cg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:vt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var y0={isMounted:function(e){return(e=e._reactInternals)?bo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Nr(),i=Ks(e),s=Ki(n,i);s.payload=t,r!=null&&(s.callback=r),t=Ws(e,s,i),t!==null&&(ri(t,e,i,n),Vf(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Nr(),i=Ks(e),s=Ki(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ws(e,s,i),t!==null&&(ri(t,e,i,n),Vf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nr(),n=Ks(e),i=Ki(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ws(e,i,n),t!==null&&(ri(t,e,n,r),Vf(t,e,n))}};function sw(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Cu(r,n)||!Cu(i,s):!0}function dT(e,t,r){var n=!1,i=ea,s=t.contextType;return typeof s=="object"&&s!==null?s=Rn(s):(i=Kr(t)?no:_r.current,n=t.contextTypes,s=(n=n!=null)?Ml(e,i):ea),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=y0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function aw(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&y0.enqueueReplaceState(t,t.state,null)}function ug(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},u1(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Rn(s):(s=Kr(t)?no:_r.current,i.context=Ml(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(cg(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&y0.enqueueReplaceState(i,i.state,null),Sh(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Bl(e,t){try{var r="",n=t;do r+=YI(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Op(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function dg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var SD=typeof WeakMap=="function"?WeakMap:Map;function fT(e,t,r){r=Ki(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ah||(Ah=!0,bg=n),dg(e,t)},r}function hT(e,t,r){r=Ki(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){dg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){dg(e,t),typeof n!="function"&&(Gs===null?Gs=new Set([this]):Gs.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function ow(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new SD;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=LD.bind(null,e,t,r),t.then(e,e))}function lw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function cw(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ki(-1,1),t.tag=2,Ws(r,t,1))),r.lanes|=1),e)}var ED=ss.ReactCurrentOwner,Wr=!1;function Rr(e,t,r,n){t.child=e===null?$E(t,null,r,n):zl(t,e.child,r,n)}function uw(e,t,r,n,i){r=r.render;var s=t.ref;return cl(t,i),n=m1(e,t,r,n,s,i),r=g1(),e!==null&&!Wr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ts(e,t,i)):(dt&&r&&n1(t),t.flags|=1,Rr(e,t,n,i),t.child)}function dw(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!k1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,pT(e,t,s,n,i)):(e=Xf(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Cu,r(a,n)&&e.ref===t.ref)return ts(e,t,i)}return t.flags|=1,e=qs(s,n),e.ref=t.ref,e.return=t,t.child=e}function pT(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Cu(s,n)&&e.ref===t.ref)if(Wr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Wr=!0);else return t.lanes=e.lanes,ts(e,t,i)}return fg(e,t,r,n,i)}function mT(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(nl,Qr),Qr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,nt(nl,Qr),Qr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,nt(nl,Qr),Qr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,nt(nl,Qr),Qr|=n;return Rr(e,t,i,r),t.child}function gT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function fg(e,t,r,n,i){var s=Kr(r)?no:_r.current;return s=Ml(t,s),cl(t,i),r=m1(e,t,r,n,s,i),n=g1(),e!==null&&!Wr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ts(e,t,i)):(dt&&n&&n1(t),t.flags|=1,Rr(e,t,r,i),t.child)}function fw(e,t,r,n,i){if(Kr(r)){var s=!0;xh(t)}else s=!1;if(cl(t,i),t.stateNode===null)Gf(e,t),dT(t,r,n),ug(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Rn(c):(c=Kr(r)?no:_r.current,c=Ml(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&aw(t,a,n,c),xs=!1;var f=t.memoizedState;a.state=f,Sh(t,n,a,i),l=t.memoizedState,o!==n||f!==l||Gr.current||xs?(typeof u=="function"&&(cg(t,r,u,n),l=t.memoizedState),(o=xs||sw(t,r,o,n,f,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,HE(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Hn(t.type,o),a.props=c,d=t.pendingProps,f=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Rn(l):(l=Kr(r)?no:_r.current,l=Ml(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==l)&&aw(t,a,n,l),xs=!1,f=t.memoizedState,a.state=f,Sh(t,n,a,i);var m=t.memoizedState;o!==d||f!==m||Gr.current||xs?(typeof p=="function"&&(cg(t,r,p,n),m=t.memoizedState),(c=xs||sw(t,r,c,n,f,m,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),a.props=n,a.state=m,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return hg(e,t,r,n,s,i)}function hg(e,t,r,n,i,s){gT(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&Qy(t,r,!1),ts(e,t,s);n=t.stateNode,ED.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=zl(t,e.child,null,s),t.child=zl(t,null,o,s)):Rr(e,t,o,s),t.memoizedState=n.state,i&&Qy(t,r,!0),t.child}function vT(e){var t=e.stateNode;t.pendingContext?Yy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Yy(e,t.context,!1),d1(e,t.containerInfo)}function hw(e,t,r,n,i){return Ll(),s1(i),t.flags|=256,Rr(e,t,r,n),t.child}var pg={dehydrated:null,treeContext:null,retryLane:0};function mg(e){return{baseLanes:e,cachePool:null,transitions:null}}function xT(e,t,r){var n=t.pendingProps,i=mt.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),nt(mt,i&1),e===null)return og(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=_0(a,n,0,null),e=Qa(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=mg(r),t.memoizedState=pg,e):y1(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return TD(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=qs(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=qs(o,s):(s=Qa(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?mg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=pg,n}return s=e.child,e=s.sibling,n=qs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function y1(e,t){return t=_0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wd(e,t,r,n){return n!==null&&s1(n),zl(t,e.child,null,r),e=y1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function TD(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Op(Error(ue(422))),Wd(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=_0({mode:"visible",children:n.children},i,0,null),s=Qa(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&zl(t,e.child,null,a),t.child.memoizedState=mg(a),t.memoizedState=pg,s);if(!(t.mode&1))return Wd(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ue(419)),n=Op(s,n,void 0),Wd(e,t,a,n)}if(o=(a&e.childLanes)!==0,Wr||o){if(n=Jt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,es(e,i),ri(n,e,i,-1))}return T1(),n=Op(Error(ue(421))),Wd(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=zD.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,nn=Hs(i.nextSibling),an=t,dt=!0,qn=null,e!==null&&(_n[Sn++]=Hi,_n[Sn++]=Wi,_n[Sn++]=io,Hi=e.id,Wi=e.overflow,io=t),t=y1(t,n.children),t.flags|=4096,t)}function pw(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),lg(e.return,t,r)}function Ip(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function yT(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Rr(e,t,n.children,r),n=mt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&pw(e,r,t);else if(e.tag===19)pw(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(nt(mt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Eh(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Ip(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Eh(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Ip(t,!0,r,null,s);break;case"together":Ip(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ts(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ao|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ue(153));if(t.child!==null){for(e=t.child,r=qs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=qs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function kD(e,t,r){switch(t.tag){case 3:vT(t),Ll();break;case 5:WE(t);break;case 1:Kr(t.type)&&xh(t);break;case 4:d1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;nt(bh,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(nt(mt,mt.current&1),t.flags|=128,null):r&t.child.childLanes?xT(e,t,r):(nt(mt,mt.current&1),e=ts(e,t,r),e!==null?e.sibling:null);nt(mt,mt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return yT(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),nt(mt,mt.current),n)break;return null;case 22:case 23:return t.lanes=0,mT(e,t,r)}return ts(e,t,r)}var wT,gg,bT,_T;wT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};gg=function(){};bT=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,La(_i.current);var s=null;switch(r){case"input":i=zm(e,i),n=zm(e,n),s=[];break;case"select":i=vt({},i,{value:void 0}),n=vt({},n,{value:void 0}),s=[];break;case"textarea":i=Um(e,i),n=Um(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=gh)}Vm(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(wu.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(wu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&at("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};_T=function(e,t,r,n){r!==n&&(t.flags|=4)};function Tc(e,t){if(!dt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function CD(e,t,r){var n=t.pendingProps;switch(i1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(t),null;case 1:return Kr(t.type)&&vh(),fr(t),null;case 3:return n=t.stateNode,jl(),lt(Gr),lt(_r),h1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Vd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,qn!==null&&(Eg(qn),qn=null))),gg(e,t),fr(t),null;case 5:f1(t);var i=La(Iu.current);if(r=t.type,e!==null&&t.stateNode!=null)bT(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ue(166));return fr(t),null}if(e=La(_i.current),Vd(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[wi]=t,n[Pu]=s,e=(t.mode&1)!==0,r){case"dialog":at("cancel",n),at("close",n);break;case"iframe":case"object":case"embed":at("load",n);break;case"video":case"audio":for(i=0;i<Lc.length;i++)at(Lc[i],n);break;case"source":at("error",n);break;case"img":case"image":case"link":at("error",n),at("load",n);break;case"details":at("toggle",n);break;case"input":Sy(n,s),at("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},at("invalid",n);break;case"textarea":Ty(n,s),at("invalid",n)}Vm(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&$d(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&$d(n.textContent,o,e),i=["children",""+o]):wu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&at("scroll",n)}switch(r){case"input":Nd(n),Ey(n,s,!0);break;case"textarea":Nd(n),ky(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=gh)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=YS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[wi]=t,e[Pu]=n,wT(e,t,!1,!1),t.stateNode=e;e:{switch(a=Hm(r,n),r){case"dialog":at("cancel",e),at("close",e),i=n;break;case"iframe":case"object":case"embed":at("load",e),i=n;break;case"video":case"audio":for(i=0;i<Lc.length;i++)at(Lc[i],e);i=n;break;case"source":at("error",e),i=n;break;case"img":case"image":case"link":at("error",e),at("load",e),i=n;break;case"details":at("toggle",e),i=n;break;case"input":Sy(e,n),i=zm(e,n),at("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=vt({},n,{value:void 0}),at("invalid",e);break;case"textarea":Ty(e,n),i=Um(e,n),at("invalid",e);break;default:i=n}Vm(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?ZS(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&QS(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&bu(e,l):typeof l=="number"&&bu(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(wu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&at("scroll",e):l!=null&&Vv(e,s,l,a))}switch(r){case"input":Nd(e),Ey(e,n,!1);break;case"textarea":Nd(e),ky(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Zs(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?sl(e,!!n.multiple,s,!1):n.defaultValue!=null&&sl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=gh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fr(t),null;case 6:if(e&&t.stateNode!=null)_T(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ue(166));if(r=La(Iu.current),La(_i.current),Vd(t)){if(n=t.stateNode,r=t.memoizedProps,n[wi]=t,(s=n.nodeValue!==r)&&(e=an,e!==null))switch(e.tag){case 3:$d(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$d(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[wi]=t,t.stateNode=n}return fr(t),null;case 13:if(lt(mt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(dt&&nn!==null&&t.mode&1&&!(t.flags&128))BE(),Ll(),t.flags|=98560,s=!1;else if(s=Vd(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ue(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ue(317));s[wi]=t}else Ll(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fr(t),s=!1}else qn!==null&&(Eg(qn),qn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||mt.current&1?Ht===0&&(Ht=3):T1())),t.updateQueue!==null&&(t.flags|=4),fr(t),null);case 4:return jl(),gg(e,t),e===null&&Au(t.stateNode.containerInfo),fr(t),null;case 10:return l1(t.type._context),fr(t),null;case 17:return Kr(t.type)&&vh(),fr(t),null;case 19:if(lt(mt),s=t.memoizedState,s===null)return fr(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Tc(s,!1);else{if(Ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Eh(e),a!==null){for(t.flags|=128,Tc(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return nt(mt,mt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ct()>Ul&&(t.flags|=128,n=!0,Tc(s,!1),t.lanes=4194304)}else{if(!n)if(e=Eh(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Tc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!dt)return fr(t),null}else 2*Ct()-s.renderingStartTime>Ul&&r!==1073741824&&(t.flags|=128,n=!0,Tc(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ct(),t.sibling=null,r=mt.current,nt(mt,n?r&1|2:r&1),t):(fr(t),null);case 22:case 23:return E1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Qr&1073741824&&(fr(t),t.subtreeFlags&6&&(t.flags|=8192)):fr(t),null;case 24:return null;case 25:return null}throw Error(ue(156,t.tag))}function AD(e,t){switch(i1(t),t.tag){case 1:return Kr(t.type)&&vh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return jl(),lt(Gr),lt(_r),h1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return f1(t),null;case 13:if(lt(mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ue(340));Ll()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return lt(mt),null;case 4:return jl(),null;case 10:return l1(t.type._context),null;case 22:case 23:return E1(),null;case 24:return null;default:return null}}var Gd=!1,vr=!1,RD=typeof WeakSet=="function"?WeakSet:Set,ye=null;function rl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){wt(e,t,n)}else r.current=null}function vg(e,t,r){try{r()}catch(n){wt(e,t,n)}}var mw=!1;function PD(e,t){if(eg=hh,e=CE(),r1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=e,f=null;t:for(;;){for(var p;d!==r||i!==0&&d.nodeType!==3||(o=a+i),d!==s||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===e)break t;if(f===r&&++c===i&&(o=a),f===s&&++u===n&&(l=a),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(tg={focusedElem:e,selectionRange:r},hh=!1,ye=t;ye!==null;)if(t=ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ye=e;else for(;ye!==null;){t=ye;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var h=m.memoizedProps,g=m.memoizedState,v=t.stateNode,w=v.getSnapshotBeforeUpdate(t.elementType===t.type?h:Hn(t.type,h),g);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(b){wt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ye=e;break}ye=t.return}return m=mw,mw=!1,m}function tu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&vg(t,r,s)}i=i.next}while(i!==n)}}function w0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function xg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ST(e){var t=e.alternate;t!==null&&(e.alternate=null,ST(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[wi],delete t[Pu],delete t[ig],delete t[fD],delete t[hD])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ET(e){return e.tag===5||e.tag===3||e.tag===4}function gw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ET(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=gh));else if(n!==4&&(e=e.child,e!==null))for(yg(e,t,r),e=e.sibling;e!==null;)yg(e,t,r),e=e.sibling}function wg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(wg(e,t,r),e=e.sibling;e!==null;)wg(e,t,r),e=e.sibling}var rr=null,Kn=!1;function ls(e,t,r){for(r=r.child;r!==null;)TT(e,t,r),r=r.sibling}function TT(e,t,r){if(bi&&typeof bi.onCommitFiberUnmount=="function")try{bi.onCommitFiberUnmount(f0,r)}catch{}switch(r.tag){case 5:vr||rl(r,t);case 6:var n=rr,i=Kn;rr=null,ls(e,t,r),rr=n,Kn=i,rr!==null&&(Kn?(e=rr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):rr.removeChild(r.stateNode));break;case 18:rr!==null&&(Kn?(e=rr,r=r.stateNode,e.nodeType===8?Tp(e.parentNode,r):e.nodeType===1&&Tp(e,r),Tu(e)):Tp(rr,r.stateNode));break;case 4:n=rr,i=Kn,rr=r.stateNode.containerInfo,Kn=!0,ls(e,t,r),rr=n,Kn=i;break;case 0:case 11:case 14:case 15:if(!vr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&vg(r,t,a),i=i.next}while(i!==n)}ls(e,t,r);break;case 1:if(!vr&&(rl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){wt(r,t,o)}ls(e,t,r);break;case 21:ls(e,t,r);break;case 22:r.mode&1?(vr=(n=vr)||r.memoizedState!==null,ls(e,t,r),vr=n):ls(e,t,r);break;default:ls(e,t,r)}}function vw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new RD),t.forEach(function(n){var i=jD.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Mn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:rr=o.stateNode,Kn=!1;break e;case 3:rr=o.stateNode.containerInfo,Kn=!0;break e;case 4:rr=o.stateNode.containerInfo,Kn=!0;break e}o=o.return}if(rr===null)throw Error(ue(160));TT(s,a,i),rr=null,Kn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){wt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kT(t,e),t=t.sibling}function kT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Mn(t,e),li(e),n&4){try{tu(3,e,e.return),w0(3,e)}catch(h){wt(e,e.return,h)}try{tu(5,e,e.return)}catch(h){wt(e,e.return,h)}}break;case 1:Mn(t,e),li(e),n&512&&r!==null&&rl(r,r.return);break;case 5:if(Mn(t,e),li(e),n&512&&r!==null&&rl(r,r.return),e.flags&32){var i=e.stateNode;try{bu(i,"")}catch(h){wt(e,e.return,h)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&qS(i,s),Hm(o,a);var c=Hm(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?ZS(i,d):u==="dangerouslySetInnerHTML"?QS(i,d):u==="children"?bu(i,d):Vv(i,u,d,c)}switch(o){case"input":jm(i,s);break;case"textarea":XS(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?sl(i,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?sl(i,!!s.multiple,s.defaultValue,!0):sl(i,!!s.multiple,s.multiple?[]:"",!1))}i[Pu]=s}catch(h){wt(e,e.return,h)}}break;case 6:if(Mn(t,e),li(e),n&4){if(e.stateNode===null)throw Error(ue(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(h){wt(e,e.return,h)}}break;case 3:if(Mn(t,e),li(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Tu(t.containerInfo)}catch(h){wt(e,e.return,h)}break;case 4:Mn(t,e),li(e);break;case 13:Mn(t,e),li(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(_1=Ct())),n&4&&vw(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(vr=(c=vr)||u,Mn(t,e),vr=c):Mn(t,e),li(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ye=e,u=e.child;u!==null;){for(d=ye=u;ye!==null;){switch(f=ye,p=f.child,f.tag){case 0:case 11:case 14:case 15:tu(4,f,f.return);break;case 1:rl(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(h){wt(n,r,h)}}break;case 5:rl(f,f.return);break;case 22:if(f.memoizedState!==null){yw(d);continue}}p!==null?(p.return=f,ye=p):yw(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=JS("display",a))}catch(h){wt(e,e.return,h)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(h){wt(e,e.return,h)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Mn(t,e),li(e),n&4&&vw(e);break;case 21:break;default:Mn(t,e),li(e)}}function li(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ET(r)){var n=r;break e}r=r.return}throw Error(ue(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(bu(i,""),n.flags&=-33);var s=gw(e);wg(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=gw(e);yg(e,o,a);break;default:throw Error(ue(161))}}catch(l){wt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function OD(e,t,r){ye=e,CT(e)}function CT(e,t,r){for(var n=(e.mode&1)!==0;ye!==null;){var i=ye,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Gd;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||vr;o=Gd;var c=vr;if(Gd=a,(vr=l)&&!c)for(ye=i;ye!==null;)a=ye,l=a.child,a.tag===22&&a.memoizedState!==null?ww(i):l!==null?(l.return=a,ye=l):ww(i);for(;s!==null;)ye=s,CT(s),s=s.sibling;ye=i,Gd=o,vr=c}xw(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ye=s):xw(e)}}function xw(e){for(;ye!==null;){var t=ye;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vr||w0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!vr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Hn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&rw(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}rw(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Tu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}vr||t.flags&512&&xg(t)}catch(f){wt(t,t.return,f)}}if(t===e){ye=null;break}if(r=t.sibling,r!==null){r.return=t.return,ye=r;break}ye=t.return}}function yw(e){for(;ye!==null;){var t=ye;if(t===e){ye=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ye=r;break}ye=t.return}}function ww(e){for(;ye!==null;){var t=ye;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{w0(4,t)}catch(l){wt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){wt(t,i,l)}}var s=t.return;try{xg(t)}catch(l){wt(t,s,l)}break;case 5:var a=t.return;try{xg(t)}catch(l){wt(t,a,l)}}}catch(l){wt(t,t.return,l)}if(t===e){ye=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ye=o;break}ye=t.return}}var ID=Math.ceil,Ch=ss.ReactCurrentDispatcher,w1=ss.ReactCurrentOwner,An=ss.ReactCurrentBatchConfig,We=0,Jt=null,Ft=null,sr=0,Qr=0,nl=la(0),Ht=0,Mu=null,ao=0,b0=0,b1=0,ru=null,Vr=null,_1=0,Ul=1/0,ji=null,Ah=!1,bg=null,Gs=null,Kd=!1,Fs=null,Rh=0,nu=0,_g=null,Kf=-1,qf=0;function Nr(){return We&6?Ct():Kf!==-1?Kf:Kf=Ct()}function Ks(e){return e.mode&1?We&2&&sr!==0?sr&-sr:mD.transition!==null?(qf===0&&(qf=dE()),qf):(e=Qe,e!==0||(e=window.event,e=e===void 0?16:xE(e.type)),e):1}function ri(e,t,r,n){if(50<nu)throw nu=0,_g=null,Error(ue(185));dd(e,r,n),(!(We&2)||e!==Jt)&&(e===Jt&&(!(We&2)&&(b0|=r),Ht===4&&ws(e,sr)),qr(e,n),r===1&&We===0&&!(t.mode&1)&&(Ul=Ct()+500,v0&&ca()))}function qr(e,t){var r=e.callbackNode;m3(e,t);var n=fh(e,e===Jt?sr:0);if(n===0)r!==null&&Ry(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ry(r),t===1)e.tag===0?pD(bw.bind(null,e)):LE(bw.bind(null,e)),uD(function(){!(We&6)&&ca()}),r=null;else{switch(fE(n)){case 1:r=qv;break;case 4:r=cE;break;case 16:r=dh;break;case 536870912:r=uE;break;default:r=dh}r=FT(r,AT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function AT(e,t){if(Kf=-1,qf=0,We&6)throw Error(ue(327));var r=e.callbackNode;if(ul()&&e.callbackNode!==r)return null;var n=fh(e,e===Jt?sr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ph(e,n);else{t=n;var i=We;We|=2;var s=PT();(Jt!==e||sr!==t)&&(ji=null,Ul=Ct()+500,Ya(e,t));do try{FD();break}catch(o){RT(e,o)}while(!0);o1(),Ch.current=s,We=i,Ft!==null?t=0:(Jt=null,sr=0,t=Ht)}if(t!==0){if(t===2&&(i=Xm(e),i!==0&&(n=i,t=Sg(e,i))),t===1)throw r=Mu,Ya(e,0),ws(e,n),qr(e,Ct()),r;if(t===6)ws(e,n);else{if(i=e.current.alternate,!(n&30)&&!DD(i)&&(t=Ph(e,n),t===2&&(s=Xm(e),s!==0&&(n=s,t=Sg(e,s))),t===1))throw r=Mu,Ya(e,0),ws(e,n),qr(e,Ct()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ue(345));case 2:Ca(e,Vr,ji);break;case 3:if(ws(e,n),(n&130023424)===n&&(t=_1+500-Ct(),10<t)){if(fh(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Nr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ng(Ca.bind(null,e,Vr,ji),t);break}Ca(e,Vr,ji);break;case 4:if(ws(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-ti(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Ct()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ID(n/1960))-n,10<n){e.timeoutHandle=ng(Ca.bind(null,e,Vr,ji),n);break}Ca(e,Vr,ji);break;case 5:Ca(e,Vr,ji);break;default:throw Error(ue(329))}}}return qr(e,Ct()),e.callbackNode===r?AT.bind(null,e):null}function Sg(e,t){var r=ru;return e.current.memoizedState.isDehydrated&&(Ya(e,t).flags|=256),e=Ph(e,t),e!==2&&(t=Vr,Vr=r,t!==null&&Eg(t)),e}function Eg(e){Vr===null?Vr=e:Vr.push.apply(Vr,e)}function DD(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ii(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ws(e,t){for(t&=~b1,t&=~b0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ti(t),n=1<<r;e[r]=-1,t&=~n}}function bw(e){if(We&6)throw Error(ue(327));ul();var t=fh(e,0);if(!(t&1))return qr(e,Ct()),null;var r=Ph(e,t);if(e.tag!==0&&r===2){var n=Xm(e);n!==0&&(t=n,r=Sg(e,n))}if(r===1)throw r=Mu,Ya(e,0),ws(e,t),qr(e,Ct()),r;if(r===6)throw Error(ue(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ca(e,Vr,ji),qr(e,Ct()),null}function S1(e,t){var r=We;We|=1;try{return e(t)}finally{We=r,We===0&&(Ul=Ct()+500,v0&&ca())}}function oo(e){Fs!==null&&Fs.tag===0&&!(We&6)&&ul();var t=We;We|=1;var r=An.transition,n=Qe;try{if(An.transition=null,Qe=1,e)return e()}finally{Qe=n,An.transition=r,We=t,!(We&6)&&ca()}}function E1(){Qr=nl.current,lt(nl)}function Ya(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,cD(r)),Ft!==null)for(r=Ft.return;r!==null;){var n=r;switch(i1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&vh();break;case 3:jl(),lt(Gr),lt(_r),h1();break;case 5:f1(n);break;case 4:jl();break;case 13:lt(mt);break;case 19:lt(mt);break;case 10:l1(n.type._context);break;case 22:case 23:E1()}r=r.return}if(Jt=e,Ft=e=qs(e.current,null),sr=Qr=t,Ht=0,Mu=null,b1=b0=ao=0,Vr=ru=null,Ma!==null){for(t=0;t<Ma.length;t++)if(r=Ma[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Ma=null}return e}function RT(e,t){do{var r=Ft;try{if(o1(),Hf.current=kh,Th){for(var n=gt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Th=!1}if(so=0,Yt=Ut=gt=null,eu=!1,Du=0,w1.current=null,r===null||r.return===null){Ht=1,Mu=t,Ft=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=sr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=lw(a);if(p!==null){p.flags&=-257,cw(p,a,o,s,t),p.mode&1&&ow(s,c,t),t=p,l=c;var m=t.updateQueue;if(m===null){var h=new Set;h.add(l),t.updateQueue=h}else m.add(l);break e}else{if(!(t&1)){ow(s,c,t),T1();break e}l=Error(ue(426))}}else if(dt&&o.mode&1){var g=lw(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),cw(g,a,o,s,t),s1(Bl(l,o));break e}}s=l=Bl(l,o),Ht!==4&&(Ht=2),ru===null?ru=[s]:ru.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=fT(s,l,t);tw(s,v);break e;case 1:o=l;var w=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Gs===null||!Gs.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=hT(s,o,t);tw(s,b);break e}}s=s.return}while(s!==null)}IT(r)}catch(E){t=E,Ft===r&&r!==null&&(Ft=r=r.return);continue}break}while(!0)}function PT(){var e=Ch.current;return Ch.current=kh,e===null?kh:e}function T1(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Jt===null||!(ao&268435455)&&!(b0&268435455)||ws(Jt,sr)}function Ph(e,t){var r=We;We|=2;var n=PT();(Jt!==e||sr!==t)&&(ji=null,Ya(e,t));do try{ND();break}catch(i){RT(e,i)}while(!0);if(o1(),We=r,Ch.current=n,Ft!==null)throw Error(ue(261));return Jt=null,sr=0,Ht}function ND(){for(;Ft!==null;)OT(Ft)}function FD(){for(;Ft!==null&&!a3();)OT(Ft)}function OT(e){var t=NT(e.alternate,e,Qr);e.memoizedProps=e.pendingProps,t===null?IT(e):Ft=t,w1.current=null}function IT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=AD(r,t),r!==null){r.flags&=32767,Ft=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ht=6,Ft=null;return}}else if(r=CD(r,t,Qr),r!==null){Ft=r;return}if(t=t.sibling,t!==null){Ft=t;return}Ft=t=e}while(t!==null);Ht===0&&(Ht=5)}function Ca(e,t,r){var n=Qe,i=An.transition;try{An.transition=null,Qe=1,MD(e,t,r,n)}finally{An.transition=i,Qe=n}return null}function MD(e,t,r,n){do ul();while(Fs!==null);if(We&6)throw Error(ue(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ue(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(g3(e,s),e===Jt&&(Ft=Jt=null,sr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Kd||(Kd=!0,FT(dh,function(){return ul(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=An.transition,An.transition=null;var a=Qe;Qe=1;var o=We;We|=4,w1.current=null,PD(e,r),kT(r,e),rD(tg),hh=!!eg,tg=eg=null,e.current=r,OD(r),o3(),We=o,Qe=a,An.transition=s}else e.current=r;if(Kd&&(Kd=!1,Fs=e,Rh=i),s=e.pendingLanes,s===0&&(Gs=null),u3(r.stateNode),qr(e,Ct()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ah)throw Ah=!1,e=bg,bg=null,e;return Rh&1&&e.tag!==0&&ul(),s=e.pendingLanes,s&1?e===_g?nu++:(nu=0,_g=e):nu=0,ca(),null}function ul(){if(Fs!==null){var e=fE(Rh),t=An.transition,r=Qe;try{if(An.transition=null,Qe=16>e?16:e,Fs===null)var n=!1;else{if(e=Fs,Fs=null,Rh=0,We&6)throw Error(ue(331));var i=We;for(We|=4,ye=e.current;ye!==null;){var s=ye,a=s.child;if(ye.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ye=c;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:tu(8,u,s)}var d=u.child;if(d!==null)d.return=u,ye=d;else for(;ye!==null;){u=ye;var f=u.sibling,p=u.return;if(ST(u),u===c){ye=null;break}if(f!==null){f.return=p,ye=f;break}ye=p}}}var m=s.alternate;if(m!==null){var h=m.child;if(h!==null){m.child=null;do{var g=h.sibling;h.sibling=null,h=g}while(h!==null)}}ye=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ye=a;else e:for(;ye!==null;){if(s=ye,s.flags&2048)switch(s.tag){case 0:case 11:case 15:tu(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ye=v;break e}ye=s.return}}var w=e.current;for(ye=w;ye!==null;){a=ye;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,ye=y;else e:for(a=w;ye!==null;){if(o=ye,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:w0(9,o)}}catch(E){wt(o,o.return,E)}if(o===a){ye=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,ye=b;break e}ye=o.return}}if(We=i,ca(),bi&&typeof bi.onPostCommitFiberRoot=="function")try{bi.onPostCommitFiberRoot(f0,e)}catch{}n=!0}return n}finally{Qe=r,An.transition=t}}return!1}function _w(e,t,r){t=Bl(r,t),t=fT(e,t,1),e=Ws(e,t,1),t=Nr(),e!==null&&(dd(e,1,t),qr(e,t))}function wt(e,t,r){if(e.tag===3)_w(e,e,r);else for(;t!==null;){if(t.tag===3){_w(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Gs===null||!Gs.has(n))){e=Bl(r,e),e=hT(t,e,1),t=Ws(t,e,1),e=Nr(),t!==null&&(dd(t,1,e),qr(t,e));break}}t=t.return}}function LD(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Nr(),e.pingedLanes|=e.suspendedLanes&r,Jt===e&&(sr&r)===r&&(Ht===4||Ht===3&&(sr&130023424)===sr&&500>Ct()-_1?Ya(e,0):b1|=r),qr(e,t)}function DT(e,t){t===0&&(e.mode&1?(t=Ld,Ld<<=1,!(Ld&130023424)&&(Ld=4194304)):t=1);var r=Nr();e=es(e,t),e!==null&&(dd(e,t,r),qr(e,r))}function zD(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),DT(e,r)}function jD(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ue(314))}n!==null&&n.delete(t),DT(e,r)}var NT;NT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Gr.current)Wr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Wr=!1,kD(e,t,r);Wr=!!(e.flags&131072)}else Wr=!1,dt&&t.flags&1048576&&zE(t,wh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Gf(e,t),e=t.pendingProps;var i=Ml(t,_r.current);cl(t,r),i=m1(null,t,n,e,i,r);var s=g1();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kr(n)?(s=!0,xh(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,u1(t),i.updater=y0,t.stateNode=i,i._reactInternals=t,ug(t,n,e,r),t=hg(null,t,n,!0,s,r)):(t.tag=0,dt&&s&&n1(t),Rr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Gf(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=UD(n),e=Hn(n,e),i){case 0:t=fg(null,t,n,e,r);break e;case 1:t=fw(null,t,n,e,r);break e;case 11:t=uw(null,t,n,e,r);break e;case 14:t=dw(null,t,n,Hn(n.type,e),r);break e}throw Error(ue(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Hn(n,i),fg(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Hn(n,i),fw(e,t,n,i,r);case 3:e:{if(vT(t),e===null)throw Error(ue(387));n=t.pendingProps,s=t.memoizedState,i=s.element,HE(e,t),Sh(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Bl(Error(ue(423)),t),t=hw(e,t,n,r,i);break e}else if(n!==i){i=Bl(Error(ue(424)),t),t=hw(e,t,n,r,i);break e}else for(nn=Hs(t.stateNode.containerInfo.firstChild),an=t,dt=!0,qn=null,r=$E(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ll(),n===i){t=ts(e,t,r);break e}Rr(e,t,n,r)}t=t.child}return t;case 5:return WE(t),e===null&&og(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,rg(n,i)?a=null:s!==null&&rg(n,s)&&(t.flags|=32),gT(e,t),Rr(e,t,a,r),t.child;case 6:return e===null&&og(t),null;case 13:return xT(e,t,r);case 4:return d1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=zl(t,null,n,r):Rr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Hn(n,i),uw(e,t,n,i,r);case 7:return Rr(e,t,t.pendingProps,r),t.child;case 8:return Rr(e,t,t.pendingProps.children,r),t.child;case 12:return Rr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,nt(bh,n._currentValue),n._currentValue=a,s!==null)if(ii(s.value,a)){if(s.children===i.children&&!Gr.current){t=ts(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ki(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),lg(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ue(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),lg(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Rr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,cl(t,r),i=Rn(i),n=n(i),t.flags|=1,Rr(e,t,n,r),t.child;case 14:return n=t.type,i=Hn(n,t.pendingProps),i=Hn(n.type,i),dw(e,t,n,i,r);case 15:return pT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Hn(n,i),Gf(e,t),t.tag=1,Kr(n)?(e=!0,xh(t)):e=!1,cl(t,r),dT(t,n,i),ug(t,n,i,r),hg(null,t,n,!0,e,r);case 19:return yT(e,t,r);case 22:return mT(e,t,r)}throw Error(ue(156,t.tag))};function FT(e,t){return lE(e,t)}function BD(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(e,t,r,n){return new BD(e,t,r,n)}function k1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function UD(e){if(typeof e=="function")return k1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wv)return 11;if(e===Gv)return 14}return 2}function qs(e,t){var r=e.alternate;return r===null?(r=kn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Xf(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")k1(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Ko:return Qa(r.children,i,s,t);case Hv:a=8,i|=8;break;case Nm:return e=kn(12,r,t,i|2),e.elementType=Nm,e.lanes=s,e;case Fm:return e=kn(13,r,t,i),e.elementType=Fm,e.lanes=s,e;case Mm:return e=kn(19,r,t,i),e.elementType=Mm,e.lanes=s,e;case WS:return _0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case VS:a=10;break e;case HS:a=9;break e;case Wv:a=11;break e;case Gv:a=14;break e;case vs:a=16,n=null;break e}throw Error(ue(130,e==null?e:typeof e,""))}return t=kn(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Qa(e,t,r,n){return e=kn(7,e,n,t),e.lanes=r,e}function _0(e,t,r,n){return e=kn(22,e,n,t),e.elementType=WS,e.lanes=r,e.stateNode={isHidden:!1},e}function Dp(e,t,r){return e=kn(6,e,null,t),e.lanes=r,e}function Np(e,t,r){return t=kn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $D(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pp(0),this.expirationTimes=pp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function C1(e,t,r,n,i,s,a,o,l){return e=new $D(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=kn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},u1(s),e}function VD(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Go,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function MT(e){if(!e)return ea;e=e._reactInternals;e:{if(bo(e)!==e||e.tag!==1)throw Error(ue(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ue(171))}if(e.tag===1){var r=e.type;if(Kr(r))return ME(e,r,t)}return t}function LT(e,t,r,n,i,s,a,o,l){return e=C1(r,n,!0,e,i,s,a,o,l),e.context=MT(null),r=e.current,n=Nr(),i=Ks(r),s=Ki(n,i),s.callback=t??null,Ws(r,s,i),e.current.lanes=i,dd(e,i,n),qr(e,n),e}function S0(e,t,r,n){var i=t.current,s=Nr(),a=Ks(i);return r=MT(r),t.context===null?t.context=r:t.pendingContext=r,t=Ki(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ws(i,t,a),e!==null&&(ri(e,i,a,s),Vf(e,i,a)),a}function Oh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Sw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function A1(e,t){Sw(e,t),(e=e.alternate)&&Sw(e,t)}function HD(){return null}var zT=typeof reportError=="function"?reportError:function(e){console.error(e)};function R1(e){this._internalRoot=e}E0.prototype.render=R1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ue(409));S0(e,t,null,null)};E0.prototype.unmount=R1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;oo(function(){S0(null,e,null,null)}),t[Zi]=null}};function E0(e){this._internalRoot=e}E0.prototype.unstable_scheduleHydration=function(e){if(e){var t=mE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ys.length&&t!==0&&t<ys[r].priority;r++);ys.splice(r,0,e),r===0&&vE(e)}};function P1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function T0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ew(){}function WD(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Oh(a);s.call(c)}}var a=LT(t,n,e,0,null,!1,!1,"",Ew);return e._reactRootContainer=a,e[Zi]=a.current,Au(e.nodeType===8?e.parentNode:e),oo(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Oh(l);o.call(c)}}var l=C1(e,0,!1,null,null,!1,!1,"",Ew);return e._reactRootContainer=l,e[Zi]=l.current,Au(e.nodeType===8?e.parentNode:e),oo(function(){S0(t,l,r,n)}),l}function k0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Oh(a);o.call(l)}}S0(t,a,e,i)}else a=WD(r,t,e,i,n);return Oh(a)}hE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Mc(t.pendingLanes);r!==0&&(Xv(t,r|1),qr(t,Ct()),!(We&6)&&(Ul=Ct()+500,ca()))}break;case 13:oo(function(){var n=es(e,1);if(n!==null){var i=Nr();ri(n,e,1,i)}}),A1(e,1)}};Yv=function(e){if(e.tag===13){var t=es(e,134217728);if(t!==null){var r=Nr();ri(t,e,134217728,r)}A1(e,134217728)}};pE=function(e){if(e.tag===13){var t=Ks(e),r=es(e,t);if(r!==null){var n=Nr();ri(r,e,t,n)}A1(e,t)}};mE=function(){return Qe};gE=function(e,t){var r=Qe;try{return Qe=e,t()}finally{Qe=r}};Gm=function(e,t,r){switch(t){case"input":if(jm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=g0(n);if(!i)throw Error(ue(90));KS(n),jm(n,i)}}}break;case"textarea":XS(e,r);break;case"select":t=r.value,t!=null&&sl(e,!!r.multiple,t,!1)}};rE=S1;nE=oo;var GD={usingClientEntryPoint:!1,Events:[hd,Qo,g0,eE,tE,S1]},kc={findFiberByHostInstance:Fa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KD={bundleType:kc.bundleType,version:kc.version,rendererPackageName:kc.rendererPackageName,rendererConfig:kc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=aE(e),e===null?null:e.stateNode},findFiberByHostInstance:kc.findFiberByHostInstance||HD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qd.isDisabled&&qd.supportsFiber)try{f0=qd.inject(KD),bi=qd}catch{}}dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GD;dn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!P1(t))throw Error(ue(200));return VD(e,t,null,r)};dn.createRoot=function(e,t){if(!P1(e))throw Error(ue(299));var r=!1,n="",i=zT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=C1(e,1,!1,null,null,r,!1,n,i),e[Zi]=t.current,Au(e.nodeType===8?e.parentNode:e),new R1(t)};dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ue(188)):(e=Object.keys(e).join(","),Error(ue(268,e)));return e=aE(t),e=e===null?null:e.stateNode,e};dn.flushSync=function(e){return oo(e)};dn.hydrate=function(e,t,r){if(!T0(t))throw Error(ue(200));return k0(null,e,t,!0,r)};dn.hydrateRoot=function(e,t,r){if(!P1(e))throw Error(ue(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=zT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=LT(t,null,e,1,r??null,i,!1,s,a),e[Zi]=t.current,Au(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new E0(t)};dn.render=function(e,t,r){if(!T0(t))throw Error(ue(200));return k0(null,e,t,!1,r)};dn.unmountComponentAtNode=function(e){if(!T0(e))throw Error(ue(40));return e._reactRootContainer?(oo(function(){k0(null,null,e,!1,function(){e._reactRootContainer=null,e[Zi]=null})}),!0):!1};dn.unstable_batchedUpdates=S1;dn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!T0(r))throw Error(ue(200));if(e==null||e._reactInternals===void 0)throw Error(ue(38));return k0(e,t,r,!1,n)};dn.version="18.3.1-next-f1338f8080-20240426";function jT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jT)}catch(e){console.error(e)}}jT(),jS.exports=dn;var _o=jS.exports;const qD=kS(_o);var BT,Tw=_o;BT=Tw.createRoot,Tw.hydrateRoot;function XD(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,i,s,a=[],o="",l=e.split("/");for(l[0]||l.shift();i=l.shift();)r=i[0],r==="*"?(a.push(r),o+=i[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(n=i.indexOf("?",1),s=i.indexOf(".",1),a.push(i.substring(1,~n?n:~s?s:i.length)),o+=~n&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(o+=(~n?"?":"")+"\\"+i.substring(s))):o+="/"+i;return{keys:a,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}var UT={exports:{}},$T={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $l=_;function YD(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var QD=typeof Object.is=="function"?Object.is:YD,JD=$l.useState,ZD=$l.useEffect,eN=$l.useLayoutEffect,tN=$l.useDebugValue;function rN(e,t){var r=t(),n=JD({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return eN(function(){i.value=r,i.getSnapshot=t,Fp(i)&&s({inst:i})},[e,r,t]),ZD(function(){return Fp(i)&&s({inst:i}),e(function(){Fp(i)&&s({inst:i})})},[e]),tN(r),r}function Fp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!QD(e,r)}catch{return!0}}function nN(e,t){return t()}var iN=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?nN:rN;$T.useSyncExternalStore=$l.useSyncExternalStore!==void 0?$l.useSyncExternalStore:iN;UT.exports=$T;var sN=UT.exports;const aN=LS.useInsertionEffect,oN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lN=oN?_.useLayoutEffect:_.useEffect,cN=aN||lN,VT=e=>{const t=_.useRef([e,(...r)=>t[0](...r)]).current;return cN(()=>{t[0]=e}),t[1]},uN="popstate",O1="pushState",I1="replaceState",dN="hashchange",kw=[uN,O1,I1,dN],fN=e=>{for(const t of kw)addEventListener(t,e);return()=>{for(const t of kw)removeEventListener(t,e)}},HT=(e,t)=>sN.useSyncExternalStore(fN,e,t),hN=()=>location.search,pN=({ssrSearch:e=""}={})=>HT(hN,()=>e),Cw=()=>location.pathname,mN=({ssrPath:e}={})=>HT(Cw,e?()=>e:Cw),gN=(e,{replace:t=!1,state:r=null}={})=>history[t?I1:O1](r,"",e),vN=(e={})=>[mN(e),gN],Aw=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Aw]>"u"){for(const e of[O1,I1]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,Aw,{value:!0})}const xN=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",WT=(e="")=>e==="/"?"":e,yN=(e,t)=>e[0]==="~"?e.slice(1):WT(t)+e,wN=(e="",t)=>xN(Rw(WT(e)),Rw(t)),Rw=e=>{try{return decodeURI(e)}catch{return e}},GT={hook:vN,searchHook:pN,parser:XD,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:e=>e},KT=_.createContext(GT),md=()=>_.useContext(KT),qT={},XT=_.createContext(qT),YT=()=>_.useContext(XT),C0=e=>{const[t,r]=e.hook(e);return[wN(e.base,t),VT((n,i)=>r(yN(n,e.base),i))]},QT=()=>C0(md()),JT=(e,t,r,n)=>{const{pattern:i,keys:s}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",n),a=i.exec(r)||[],[o,...l]=a;return o!==void 0?[!0,(()=>{const c=s!==!1?Object.fromEntries(s.map((d,f)=>[d,l[f]])):a.groups;let u={...l};return c&&Object.assign(u,c),u})(),...n?[o]:[]]:[!1,null]},ZT=({children:e,...t})=>{var u,d;const r=md(),n=t.hook?GT:r;let i=n;const[s,a]=((u=t.ssrPath)==null?void 0:u.split("?"))??[];a&&(t.ssrSearch=a,t.ssrPath=s),t.hrefs=t.hrefs??((d=t.hook)==null?void 0:d.hrefs);let o=_.useRef({}),l=o.current,c=l;for(let f in n){const p=f==="base"?n[f]+(t[f]||""):t[f]||n[f];l===c&&p!==c[f]&&(o.current=c={...c}),c[f]=p,p!==n[f]&&(i=c)}return _.createElement(KT.Provider,{value:i,children:e})},Pw=({children:e,component:t},r)=>t?_.createElement(t,{params:r}):typeof e=="function"?e(r):e,bN=e=>{let t=_.useRef(qT),r=t.current;for(const n in e)e[n]!==r[n]&&(r=e);return Object.keys(e).length===0&&(r=e),t.current=r},Ln=({path:e,nest:t,match:r,...n})=>{const i=md(),[s]=C0(i),[a,o,l]=r??JT(i.parser,e,s,t),c=bN({...YT(),...o});if(!a)return null;const u=l?_.createElement(ZT,{base:l},Pw(n,c)):Pw(n,c);return _.createElement(XT.Provider,{value:c,children:u})},Ih=_.forwardRef((e,t)=>{const r=md(),[n,i]=C0(r),{to:s="",href:a=s,onClick:o,asChild:l,children:c,className:u,replace:d,state:f,...p}=e,m=VT(g=>{g.ctrlKey||g.metaKey||g.altKey||g.shiftKey||g.button!==0||(o==null||o(g),g.defaultPrevented||(g.preventDefault(),i(a,e)))}),h=r.hrefs(a[0]==="~"?a.slice(1):r.base+a,r);return l&&_.isValidElement(c)?_.cloneElement(c,{onClick:m,href:h}):_.createElement("a",{...p,onClick:m,href:h,className:u!=null&&u.call?u(n===a):u,children:c,ref:t})}),ek=e=>Array.isArray(e)?e.flatMap(t=>ek(t&&t.type===_.Fragment?t.props.children:t)):[e],_N=({children:e,location:t})=>{const r=md(),[n]=C0(r);for(const i of ek(e)){let s=0;if(_.isValidElement(i)&&(s=JT(r.parser,i.props.path,t||n,i.props.nest))[0])return _.cloneElement(i,{match:s})}return null};var nc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},lo=typeof window>"u"||"Deno"in globalThis;function wn(){}function SN(e,t){return typeof e=="function"?e(t):e}function Tg(e){return typeof e=="number"&&e>=0&&e!==1/0}function tk(e,t){return Math.max(e+(t||0)-Date.now(),0)}function dl(e,t){return typeof e=="function"?e(t):e}function Xn(e,t){return typeof e=="function"?e(t):e}function Ow(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:s,queryKey:a,stale:o}=e;if(a){if(n){if(t.queryHash!==D1(a,t.options))return!1}else if(!Lu(t.queryKey,a))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||i&&i!==t.state.fetchStatus||s&&!s(t))}function Iw(e,t){const{exact:r,status:n,predicate:i,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(co(t.options.mutationKey)!==co(s))return!1}else if(!Lu(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function D1(e,t){return((t==null?void 0:t.queryKeyHashFn)||co)(e)}function co(e){return JSON.stringify(e,(t,r)=>kg(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Lu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!Lu(e[r],t[r])):!1}function rk(e,t){if(e===t)return e;const r=Dw(e)&&Dw(t);if(r||kg(e)&&kg(t)){const n=r?e:Object.keys(e),i=n.length,s=r?t:Object.keys(t),a=s.length,o=r?[]:{};let l=0;for(let c=0;c<a;c++){const u=r?c:s[c];(!r&&n.includes(u)||r)&&e[u]===void 0&&t[u]===void 0?(o[u]=void 0,l++):(o[u]=rk(e[u],t[u]),o[u]===e[u]&&e[u]!==void 0&&l++)}return i===a&&l===i?e:o}return t}function Dh(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Dw(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function kg(e){if(!Nw(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Nw(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Nw(e){return Object.prototype.toString.call(e)==="[object Object]"}function EN(e){return new Promise(t=>{setTimeout(t,e)})}function Cg(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?rk(e,t):t}function TN(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function kN(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var N1=Symbol();function nk(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===N1?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Va,Ts,_l,mS,CN=(mS=class extends nc{constructor(){super();Te(this,Va);Te(this,Ts);Te(this,_l);ve(this,_l,t=>{if(!lo&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){W(this,Ts)||this.setEventListener(W(this,_l))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,Ts))==null||t.call(this),ve(this,Ts,void 0))}setEventListener(t){var r;ve(this,_l,t),(r=W(this,Ts))==null||r.call(this),ve(this,Ts,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){W(this,Va)!==t&&(ve(this,Va,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof W(this,Va)=="boolean"?W(this,Va):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Va=new WeakMap,Ts=new WeakMap,_l=new WeakMap,mS),F1=new CN,Sl,ks,El,gS,AN=(gS=class extends nc{constructor(){super();Te(this,Sl,!0);Te(this,ks);Te(this,El);ve(this,El,t=>{if(!lo&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){W(this,ks)||this.setEventListener(W(this,El))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,ks))==null||t.call(this),ve(this,ks,void 0))}setEventListener(t){var r;ve(this,El,t),(r=W(this,ks))==null||r.call(this),ve(this,ks,t(this.setOnline.bind(this)))}setOnline(t){W(this,Sl)!==t&&(ve(this,Sl,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return W(this,Sl)}},Sl=new WeakMap,ks=new WeakMap,El=new WeakMap,gS),Nh=new AN;function Ag(){let e,t;const r=new Promise((i,s)=>{e=i,t=s});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}function RN(e){return Math.min(1e3*2**e,3e4)}function ik(e){return(e??"online")==="online"?Nh.isOnline():!0}var sk=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Mp(e){return e instanceof sk}function ak(e){let t=!1,r=0,n=!1,i;const s=Ag(),a=h=>{var g;n||(f(new sk(h)),(g=e.abort)==null||g.call(e))},o=()=>{t=!0},l=()=>{t=!1},c=()=>F1.isFocused()&&(e.networkMode==="always"||Nh.isOnline())&&e.canRun(),u=()=>ik(e.networkMode)&&e.canRun(),d=h=>{var g;n||(n=!0,(g=e.onSuccess)==null||g.call(e,h),i==null||i(),s.resolve(h))},f=h=>{var g;n||(n=!0,(g=e.onError)==null||g.call(e,h),i==null||i(),s.reject(h))},p=()=>new Promise(h=>{var g;i=v=>{(n||c())&&h(v)},(g=e.onPause)==null||g.call(e)}).then(()=>{var h;i=void 0,n||(h=e.onContinue)==null||h.call(e)}),m=()=>{if(n)return;let h;const g=r===0?e.initialPromise:void 0;try{h=g??e.fn()}catch(v){h=Promise.reject(v)}Promise.resolve(h).then(d).catch(v=>{var k;if(n)return;const w=e.retry??(lo?0:3),y=e.retryDelay??RN,b=typeof y=="function"?y(r,v):y,E=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,v);if(t||!E){f(v);return}r++,(k=e.onFail)==null||k.call(e,r,v),EN(b).then(()=>c()?void 0:p()).then(()=>{t?f(v):m()})})};return{promise:s,cancel:a,continue:()=>(i==null||i(),s),cancelRetry:o,continueRetry:l,canStart:u,start:()=>(u()?m():p().then(m),s)}}function PN(){let e=[],t=0,r=o=>{o()},n=o=>{o()},i=o=>setTimeout(o,0);const s=o=>{t?e.push(o):i(()=>{r(o)})},a=()=>{const o=e;e=[],o.length&&i(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{i=o}}}var $t=PN(),Ha,vS,ok=(vS=class{constructor(){Te(this,Ha)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Tg(this.gcTime)&&ve(this,Ha,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(lo?1/0:5*60*1e3))}clearGcTimeout(){W(this,Ha)&&(clearTimeout(W(this,Ha)),ve(this,Ha,void 0))}},Ha=new WeakMap,vS),Tl,kl,yn,pr,ad,Wa,Gn,Mi,xS,ON=(xS=class extends ok{constructor(t){super();Te(this,Gn);Te(this,Tl);Te(this,kl);Te(this,yn);Te(this,pr);Te(this,ad);Te(this,Wa);ve(this,Wa,!1),ve(this,ad,t.defaultOptions),this.setOptions(t.options),this.observers=[],ve(this,yn,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ve(this,Tl,IN(this.options)),this.state=t.state??W(this,Tl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=W(this,pr))==null?void 0:t.promise}setOptions(t){this.options={...W(this,ad),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&W(this,yn).remove(this)}setData(t,r){const n=Cg(this.state.data,t,this.options);return Me(this,Gn,Mi).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Me(this,Gn,Mi).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,i;const r=(n=W(this,pr))==null?void 0:n.promise;return(i=W(this,pr))==null||i.cancel(t),r?r.then(wn).catch(wn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(W(this,Tl))}isActive(){return this.observers.some(t=>Xn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===N1||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!tk(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=W(this,pr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=W(this,pr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),W(this,yn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(W(this,pr)&&(W(this,Wa)?W(this,pr).cancel({revert:!0}):W(this,pr).cancelRetry()),this.scheduleGc()),W(this,yn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Me(this,Gn,Mi).call(this,{type:"invalidate"})}fetch(t,r){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(W(this,pr))return W(this,pr).continueRetry(),W(this,pr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const d=this.observers.find(f=>f.options.queryFn);d&&this.setOptions(d.options)}const n=new AbortController,i=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(ve(this,Wa,!0),n.signal)})},s=()=>{const d=nk(this.options,r),f={queryKey:this.queryKey,meta:this.meta};return i(f),ve(this,Wa,!1),this.options.persister?this.options.persister(d,f,this):d(f)},a={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:s};i(a),(l=this.options.behavior)==null||l.onFetch(a,this),ve(this,kl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=a.fetchOptions)==null?void 0:c.meta))&&Me(this,Gn,Mi).call(this,{type:"fetch",meta:(u=a.fetchOptions)==null?void 0:u.meta});const o=d=>{var f,p,m,h;Mp(d)&&d.silent||Me(this,Gn,Mi).call(this,{type:"error",error:d}),Mp(d)||((p=(f=W(this,yn).config).onError)==null||p.call(f,d,this),(h=(m=W(this,yn).config).onSettled)==null||h.call(m,this.state.data,d,this)),this.scheduleGc()};return ve(this,pr,ak({initialPromise:r==null?void 0:r.initialPromise,fn:a.fetchFn,abort:n.abort.bind(n),onSuccess:d=>{var f,p,m,h;if(d===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(g){o(g);return}(p=(f=W(this,yn).config).onSuccess)==null||p.call(f,d,this),(h=(m=W(this,yn).config).onSettled)==null||h.call(m,d,this.state.error,this),this.scheduleGc()},onError:o,onFail:(d,f)=>{Me(this,Gn,Mi).call(this,{type:"failed",failureCount:d,error:f})},onPause:()=>{Me(this,Gn,Mi).call(this,{type:"pause"})},onContinue:()=>{Me(this,Gn,Mi).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),W(this,pr).start()}},Tl=new WeakMap,kl=new WeakMap,yn=new WeakMap,pr=new WeakMap,ad=new WeakMap,Wa=new WeakMap,Gn=new WeakSet,Mi=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...lk(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=t.error;return Mp(i)&&i.revert&&W(this,kl)?{...W(this,kl),fetchStatus:"idle"}:{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),$t.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),W(this,yn).notify({query:this,type:"updated",action:t})})},xS);function lk(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ik(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function IN(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var gi,yS,DN=(yS=class extends nc{constructor(t={}){super();Te(this,gi);this.config=t,ve(this,gi,new Map)}build(t,r,n){const i=r.queryKey,s=r.queryHash??D1(i,r);let a=this.get(s);return a||(a=new ON({cache:this,queryKey:i,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(a)),a}add(t){W(this,gi).has(t.queryHash)||(W(this,gi).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=W(this,gi).get(t.queryHash);r&&(t.destroy(),r===t&&W(this,gi).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){$t.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return W(this,gi).get(t)}getAll(){return[...W(this,gi).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Ow(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>Ow(t,n)):r}notify(t){$t.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){$t.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){$t.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},gi=new WeakMap,yS),vi,Cr,Ga,xi,ps,wS,NN=(wS=class extends ok{constructor(t){super();Te(this,xi);Te(this,vi);Te(this,Cr);Te(this,Ga);this.mutationId=t.mutationId,ve(this,Cr,t.mutationCache),ve(this,vi,[]),this.state=t.state||ck(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){W(this,vi).includes(t)||(W(this,vi).push(t),this.clearGcTimeout(),W(this,Cr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ve(this,vi,W(this,vi).filter(r=>r!==t)),this.scheduleGc(),W(this,Cr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){W(this,vi).length||(this.state.status==="pending"?this.scheduleGc():W(this,Cr).remove(this))}continue(){var t;return((t=W(this,Ga))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,s,a,o,l,c,u,d,f,p,m,h,g,v,w,y,b,E,k,S;ve(this,Ga,ak({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(C,T)=>{Me(this,xi,ps).call(this,{type:"failed",failureCount:C,error:T})},onPause:()=>{Me(this,xi,ps).call(this,{type:"pause"})},onContinue:()=>{Me(this,xi,ps).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>W(this,Cr).canRun(this)}));const r=this.state.status==="pending",n=!W(this,Ga).canStart();try{if(!r){Me(this,xi,ps).call(this,{type:"pending",variables:t,isPaused:n}),await((s=(i=W(this,Cr).config).onMutate)==null?void 0:s.call(i,t,this));const T=await((o=(a=this.options).onMutate)==null?void 0:o.call(a,t));T!==this.state.context&&Me(this,xi,ps).call(this,{type:"pending",context:T,variables:t,isPaused:n})}const C=await W(this,Ga).start();return await((c=(l=W(this,Cr).config).onSuccess)==null?void 0:c.call(l,C,t,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,C,t,this.state.context)),await((p=(f=W(this,Cr).config).onSettled)==null?void 0:p.call(f,C,null,this.state.variables,this.state.context,this)),await((h=(m=this.options).onSettled)==null?void 0:h.call(m,C,null,t,this.state.context)),Me(this,xi,ps).call(this,{type:"success",data:C}),C}catch(C){try{throw await((v=(g=W(this,Cr).config).onError)==null?void 0:v.call(g,C,t,this.state.context,this)),await((y=(w=this.options).onError)==null?void 0:y.call(w,C,t,this.state.context)),await((E=(b=W(this,Cr).config).onSettled)==null?void 0:E.call(b,void 0,C,this.state.variables,this.state.context,this)),await((S=(k=this.options).onSettled)==null?void 0:S.call(k,void 0,C,t,this.state.context)),C}finally{Me(this,xi,ps).call(this,{type:"error",error:C})}}finally{W(this,Cr).runNext(this)}}},vi=new WeakMap,Cr=new WeakMap,Ga=new WeakMap,xi=new WeakSet,ps=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),$t.batch(()=>{W(this,vi).forEach(n=>{n.onMutationUpdate(t)}),W(this,Cr).notify({mutation:this,type:"updated",action:t})})},wS);function ck(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Yr,od,bS,FN=(bS=class extends nc{constructor(t={}){super();Te(this,Yr);Te(this,od);this.config=t,ve(this,Yr,new Map),ve(this,od,Date.now())}build(t,r,n){const i=new NN({mutationCache:this,mutationId:++Od(this,od)._,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){const r=Xd(t),n=W(this,Yr).get(r)??[];n.push(t),W(this,Yr).set(r,n),this.notify({type:"added",mutation:t})}remove(t){var n;const r=Xd(t);if(W(this,Yr).has(r)){const i=(n=W(this,Yr).get(r))==null?void 0:n.filter(s=>s!==t);i&&(i.length===0?W(this,Yr).delete(r):W(this,Yr).set(r,i))}this.notify({type:"removed",mutation:t})}canRun(t){var n;const r=(n=W(this,Yr).get(Xd(t)))==null?void 0:n.find(i=>i.state.status==="pending");return!r||r===t}runNext(t){var n;const r=(n=W(this,Yr).get(Xd(t)))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){$t.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...W(this,Yr).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Iw(r,n))}findAll(t={}){return this.getAll().filter(r=>Iw(t,r))}notify(t){$t.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return $t.batch(()=>Promise.all(t.map(r=>r.continue().catch(wn))))}},Yr=new WeakMap,od=new WeakMap,bS);function Xd(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function Fw(e){return{onFetch:(t,r)=>{var u,d,f,p,m;const n=t.options,i=(f=(d=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,s=((p=t.state.data)==null?void 0:p.pages)||[],a=((m=t.state.data)==null?void 0:m.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let h=!1;const g=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(t.signal.aborted?h=!0:t.signal.addEventListener("abort",()=>{h=!0}),t.signal)})},v=nk(t.options,t.fetchOptions),w=async(y,b,E)=>{if(h)return Promise.reject();if(b==null&&y.pages.length)return Promise.resolve(y);const k={queryKey:t.queryKey,pageParam:b,direction:E?"backward":"forward",meta:t.options.meta};g(k);const S=await v(k),{maxPages:C}=t.options,T=E?kN:TN;return{pages:T(y.pages,S,C),pageParams:T(y.pageParams,b,C)}};if(i&&s.length){const y=i==="backward",b=y?MN:Mw,E={pages:s,pageParams:a},k=b(n,E);o=await w(E,k,y)}else{const y=e??s.length;do{const b=l===0?a[0]??n.initialPageParam:Mw(n,o);if(l>0&&b==null)break;o=await w(o,b),l++}while(l<y)}return o};t.options.persister?t.fetchFn=()=>{var h,g;return(g=(h=t.options).persister)==null?void 0:g.call(h,c,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function Mw(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function MN(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var yt,Cs,As,Cl,Al,Rs,Rl,Pl,_S,LN=(_S=class{constructor(e={}){Te(this,yt);Te(this,Cs);Te(this,As);Te(this,Cl);Te(this,Al);Te(this,Rs);Te(this,Rl);Te(this,Pl);ve(this,yt,e.queryCache||new DN),ve(this,Cs,e.mutationCache||new FN),ve(this,As,e.defaultOptions||{}),ve(this,Cl,new Map),ve(this,Al,new Map),ve(this,Rs,0)}mount(){Od(this,Rs)._++,W(this,Rs)===1&&(ve(this,Rl,F1.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,yt).onFocus())})),ve(this,Pl,Nh.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,yt).onOnline())})))}unmount(){var e,t;Od(this,Rs)._--,W(this,Rs)===0&&((e=W(this,Rl))==null||e.call(this),ve(this,Rl,void 0),(t=W(this,Pl))==null||t.call(this),ve(this,Pl,void 0))}isFetching(e){return W(this,yt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return W(this,Cs).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=W(this,yt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=W(this,yt).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(dl(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return W(this,yt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),i=W(this,yt).get(n.queryHash),s=i==null?void 0:i.state.data,a=SN(t,s);if(a!==void 0)return W(this,yt).build(this,n).setData(a,{...r,manual:!0})}setQueriesData(e,t,r){return $t.batch(()=>W(this,yt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=W(this,yt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=W(this,yt);$t.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=W(this,yt),n={type:"active",...e};return $t.batch(()=>(r.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=$t.batch(()=>W(this,yt).findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(wn).catch(wn)}invalidateQueries(e={},t={}){return $t.batch(()=>{if(W(this,yt).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=$t.batch(()=>W(this,yt).findAll(e).filter(i=>!i.isDisabled()).map(i=>{let s=i.fetch(void 0,r);return r.throwOnError||(s=s.catch(wn)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(wn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=W(this,yt).build(this,t);return r.isStaleByTime(dl(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(wn).catch(wn)}fetchInfiniteQuery(e){return e.behavior=Fw(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(wn).catch(wn)}ensureInfiniteQueryData(e){return e.behavior=Fw(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Nh.isOnline()?W(this,Cs).resumePausedMutations():Promise.resolve()}getQueryCache(){return W(this,yt)}getMutationCache(){return W(this,Cs)}getDefaultOptions(){return W(this,As)}setDefaultOptions(e){ve(this,As,e)}setQueryDefaults(e,t){W(this,Cl).set(co(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...W(this,Cl).values()];let r={};return t.forEach(n=>{Lu(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){W(this,Al).set(co(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...W(this,Al).values()];let r={};return t.forEach(n=>{Lu(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...W(this,As).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=D1(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===N1&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...W(this,As).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){W(this,yt).clear(),W(this,Cs).clear()}},yt=new WeakMap,Cs=new WeakMap,As=new WeakMap,Cl=new WeakMap,Al=new WeakMap,Rs=new WeakMap,Rl=new WeakMap,Pl=new WeakMap,_S),Br,Ue,ld,Ar,Ka,Ol,Ps,yi,cd,Il,Dl,qa,Xa,Os,Nl,Xe,zc,Rg,Pg,Og,Ig,Dg,Ng,Fg,uk,SS,zN=(SS=class extends nc{constructor(t,r){super();Te(this,Xe);Te(this,Br);Te(this,Ue);Te(this,ld);Te(this,Ar);Te(this,Ka);Te(this,Ol);Te(this,Ps);Te(this,yi);Te(this,cd);Te(this,Il);Te(this,Dl);Te(this,qa);Te(this,Xa);Te(this,Os);Te(this,Nl,new Set);this.options=r,ve(this,Br,t),ve(this,yi,null),ve(this,Ps,Ag()),this.options.experimental_prefetchInRender||W(this,Ps).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(W(this,Ue).addObserver(this),Lw(W(this,Ue),this.options)?Me(this,Xe,zc).call(this):this.updateResult(),Me(this,Xe,Ig).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Mg(W(this,Ue),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Mg(W(this,Ue),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Me(this,Xe,Dg).call(this),Me(this,Xe,Ng).call(this),W(this,Ue).removeObserver(this)}setOptions(t,r){const n=this.options,i=W(this,Ue);if(this.options=W(this,Br).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Xn(this.options.enabled,W(this,Ue))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Me(this,Xe,Fg).call(this),W(this,Ue).setOptions(this.options),n._defaulted&&!Dh(this.options,n)&&W(this,Br).getQueryCache().notify({type:"observerOptionsUpdated",query:W(this,Ue),observer:this});const s=this.hasListeners();s&&zw(W(this,Ue),i,this.options,n)&&Me(this,Xe,zc).call(this),this.updateResult(r),s&&(W(this,Ue)!==i||Xn(this.options.enabled,W(this,Ue))!==Xn(n.enabled,W(this,Ue))||dl(this.options.staleTime,W(this,Ue))!==dl(n.staleTime,W(this,Ue)))&&Me(this,Xe,Rg).call(this);const a=Me(this,Xe,Pg).call(this);s&&(W(this,Ue)!==i||Xn(this.options.enabled,W(this,Ue))!==Xn(n.enabled,W(this,Ue))||a!==W(this,Os))&&Me(this,Xe,Og).call(this,a)}getOptimisticResult(t){const r=W(this,Br).getQueryCache().build(W(this,Br),t),n=this.createResult(r,t);return BN(this,n)&&(ve(this,Ar,n),ve(this,Ol,this.options),ve(this,Ka,W(this,Ue).state)),n}getCurrentResult(){return W(this,Ar)}trackResult(t,r){const n={};return Object.keys(t).forEach(i=>{Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),r==null||r(i),t[i])})}),n}trackProp(t){W(this,Nl).add(t)}getCurrentQuery(){return W(this,Ue)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=W(this,Br).defaultQueryOptions(t),n=W(this,Br).getQueryCache().build(W(this,Br),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Me(this,Xe,zc).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),W(this,Ar)))}createResult(t,r){var C;const n=W(this,Ue),i=this.options,s=W(this,Ar),a=W(this,Ka),o=W(this,Ol),c=t!==n?t.state:W(this,ld),{state:u}=t;let d={...u},f=!1,p;if(r._optimisticResults){const T=this.hasListeners(),P=!T&&Lw(t,r),I=T&&zw(t,n,r,i);(P||I)&&(d={...d,...lk(u.data,t.options)}),r._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:m,errorUpdatedAt:h,status:g}=d;if(r.select&&d.data!==void 0)if(s&&d.data===(a==null?void 0:a.data)&&r.select===W(this,cd))p=W(this,Il);else try{ve(this,cd,r.select),p=r.select(d.data),p=Cg(s==null?void 0:s.data,p,r),ve(this,Il,p),ve(this,yi,null)}catch(T){ve(this,yi,T)}else p=d.data;if(r.placeholderData!==void 0&&p===void 0&&g==="pending"){let T;if(s!=null&&s.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData))T=s.data;else if(T=typeof r.placeholderData=="function"?r.placeholderData((C=W(this,Dl))==null?void 0:C.state.data,W(this,Dl)):r.placeholderData,r.select&&T!==void 0)try{T=r.select(T),ve(this,yi,null)}catch(P){ve(this,yi,P)}T!==void 0&&(g="success",p=Cg(s==null?void 0:s.data,T,r),f=!0)}W(this,yi)&&(m=W(this,yi),p=W(this,Il),h=Date.now(),g="error");const v=d.fetchStatus==="fetching",w=g==="pending",y=g==="error",b=w&&v,E=p!==void 0,S={status:g,fetchStatus:d.fetchStatus,isPending:w,isSuccess:g==="success",isError:y,isInitialLoading:b,isLoading:b,data:p,dataUpdatedAt:d.dataUpdatedAt,error:m,errorUpdatedAt:h,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:v,isRefetching:v&&!w,isLoadingError:y&&!E,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:y&&E,isStale:M1(t,r),refetch:this.refetch,promise:W(this,Ps)};if(this.options.experimental_prefetchInRender){const T=R=>{S.status==="error"?R.reject(S.error):S.data!==void 0&&R.resolve(S.data)},P=()=>{const R=ve(this,Ps,S.promise=Ag());T(R)},I=W(this,Ps);switch(I.status){case"pending":t.queryHash===n.queryHash&&T(I);break;case"fulfilled":(S.status==="error"||S.data!==I.value)&&P();break;case"rejected":(S.status!=="error"||S.error!==I.reason)&&P();break}}return S}updateResult(t){const r=W(this,Ar),n=this.createResult(W(this,Ue),this.options);if(ve(this,Ka,W(this,Ue).state),ve(this,Ol,this.options),W(this,Ka).data!==void 0&&ve(this,Dl,W(this,Ue)),Dh(n,r))return;ve(this,Ar,n);const i={},s=()=>{if(!r)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!W(this,Nl).size)return!0;const l=new Set(o??W(this,Nl));return this.options.throwOnError&&l.add("error"),Object.keys(W(this,Ar)).some(c=>{const u=c;return W(this,Ar)[u]!==r[u]&&l.has(u)})};(t==null?void 0:t.listeners)!==!1&&s()&&(i.listeners=!0),Me(this,Xe,uk).call(this,{...i,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Me(this,Xe,Ig).call(this)}},Br=new WeakMap,Ue=new WeakMap,ld=new WeakMap,Ar=new WeakMap,Ka=new WeakMap,Ol=new WeakMap,Ps=new WeakMap,yi=new WeakMap,cd=new WeakMap,Il=new WeakMap,Dl=new WeakMap,qa=new WeakMap,Xa=new WeakMap,Os=new WeakMap,Nl=new WeakMap,Xe=new WeakSet,zc=function(t){Me(this,Xe,Fg).call(this);let r=W(this,Ue).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(wn)),r},Rg=function(){Me(this,Xe,Dg).call(this);const t=dl(this.options.staleTime,W(this,Ue));if(lo||W(this,Ar).isStale||!Tg(t))return;const n=tk(W(this,Ar).dataUpdatedAt,t)+1;ve(this,qa,setTimeout(()=>{W(this,Ar).isStale||this.updateResult()},n))},Pg=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(W(this,Ue)):this.options.refetchInterval)??!1},Og=function(t){Me(this,Xe,Ng).call(this),ve(this,Os,t),!(lo||Xn(this.options.enabled,W(this,Ue))===!1||!Tg(W(this,Os))||W(this,Os)===0)&&ve(this,Xa,setInterval(()=>{(this.options.refetchIntervalInBackground||F1.isFocused())&&Me(this,Xe,zc).call(this)},W(this,Os)))},Ig=function(){Me(this,Xe,Rg).call(this),Me(this,Xe,Og).call(this,Me(this,Xe,Pg).call(this))},Dg=function(){W(this,qa)&&(clearTimeout(W(this,qa)),ve(this,qa,void 0))},Ng=function(){W(this,Xa)&&(clearInterval(W(this,Xa)),ve(this,Xa,void 0))},Fg=function(){const t=W(this,Br).getQueryCache().build(W(this,Br),this.options);if(t===W(this,Ue))return;const r=W(this,Ue);ve(this,Ue,t),ve(this,ld,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},uk=function(t){$t.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(W(this,Ar))}),W(this,Br).getQueryCache().notify({query:W(this,Ue),type:"observerResultsUpdated"})})},SS);function jN(e,t){return Xn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Lw(e,t){return jN(e,t)||e.state.data!==void 0&&Mg(e,t,t.refetchOnMount)}function Mg(e,t,r){if(Xn(t.enabled,e)!==!1){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&M1(e,t)}return!1}function zw(e,t,r,n){return(e!==t||Xn(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&M1(e,r)}function M1(e,t){return Xn(t.enabled,e)!==!1&&e.isStaleByTime(dl(t.staleTime,e))}function BN(e,t){return!Dh(e.getCurrentResult(),t)}var Is,Ds,Ur,Vi,Qi,Yf,Lg,ES,UN=(ES=class extends nc{constructor(r,n){super();Te(this,Qi);Te(this,Is);Te(this,Ds);Te(this,Ur);Te(this,Vi);ve(this,Is,r),this.setOptions(n),this.bindMethods(),Me(this,Qi,Yf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=W(this,Is).defaultMutationOptions(r),Dh(this.options,n)||W(this,Is).getMutationCache().notify({type:"observerOptionsUpdated",mutation:W(this,Ur),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&co(n.mutationKey)!==co(this.options.mutationKey)?this.reset():((i=W(this,Ur))==null?void 0:i.state.status)==="pending"&&W(this,Ur).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=W(this,Ur))==null||r.removeObserver(this)}onMutationUpdate(r){Me(this,Qi,Yf).call(this),Me(this,Qi,Lg).call(this,r)}getCurrentResult(){return W(this,Ds)}reset(){var r;(r=W(this,Ur))==null||r.removeObserver(this),ve(this,Ur,void 0),Me(this,Qi,Yf).call(this),Me(this,Qi,Lg).call(this)}mutate(r,n){var i;return ve(this,Vi,n),(i=W(this,Ur))==null||i.removeObserver(this),ve(this,Ur,W(this,Is).getMutationCache().build(W(this,Is),this.options)),W(this,Ur).addObserver(this),W(this,Ur).execute(r)}},Is=new WeakMap,Ds=new WeakMap,Ur=new WeakMap,Vi=new WeakMap,Qi=new WeakSet,Yf=function(){var n;const r=((n=W(this,Ur))==null?void 0:n.state)??ck();ve(this,Ds,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Lg=function(r){$t.batch(()=>{var n,i,s,a,o,l,c,u;if(W(this,Vi)&&this.hasListeners()){const d=W(this,Ds).variables,f=W(this,Ds).context;(r==null?void 0:r.type)==="success"?((i=(n=W(this,Vi)).onSuccess)==null||i.call(n,r.data,d,f),(a=(s=W(this,Vi)).onSettled)==null||a.call(s,r.data,null,d,f)):(r==null?void 0:r.type)==="error"&&((l=(o=W(this,Vi)).onError)==null||l.call(o,r.error,d,f),(u=(c=W(this,Vi)).onSettled)==null||u.call(c,void 0,r.error,d,f))}this.listeners.forEach(d=>{d(W(this,Ds))})})},ES),dk=_.createContext(void 0),fk=e=>{const t=_.useContext(dk);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},$N=({client:e,children:t})=>(_.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),x.jsx(dk.Provider,{value:e,children:t})),hk=_.createContext(!1),VN=()=>_.useContext(hk);hk.Provider;function HN(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var WN=_.createContext(HN()),GN=()=>_.useContext(WN);function pk(e,t){return typeof e=="function"?e(...t):!!e}function zg(){}var KN=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},qN=e=>{_.useEffect(()=>{e.clearReset()},[e])},XN=({result:e,errorResetBoundary:t,throwOnError:r,query:n})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&pk(r,[e.error,n]),YN=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},QN=(e,t)=>e.isLoading&&e.isFetching&&!t,JN=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,jw=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function ZN(e,t,r){var u,d,f,p,m;const n=fk(),i=VN(),s=GN(),a=n.defaultQueryOptions(e);(d=(u=n.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||d.call(u,a),a._optimisticResults=i?"isRestoring":"optimistic",YN(a),KN(a,s),qN(s);const o=!n.getQueryCache().get(a.queryHash),[l]=_.useState(()=>new t(n,a)),c=l.getOptimisticResult(a);if(_.useSyncExternalStore(_.useCallback(h=>{const g=i?zg:l.subscribe($t.batchCalls(h));return l.updateResult(),g},[l,i]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),_.useEffect(()=>{l.setOptions(a,{listeners:!1})},[a,l]),JN(a,c))throw jw(a,l,s);if(XN({result:c,errorResetBoundary:s,throwOnError:a.throwOnError,query:n.getQueryCache().get(a.queryHash)}))throw c.error;if((p=(f=n.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||p.call(f,a,c),a.experimental_prefetchInRender&&!lo&&QN(c,i)){const h=o?jw(a,l,s):(m=n.getQueryCache().get(a.queryHash))==null?void 0:m.promise;h==null||h.catch(zg).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?c:l.trackResult(c)}function e5(e,t){return ZN(e,zN)}function t5(e,t){const r=fk(),[n]=_.useState(()=>new UN(r,e));_.useEffect(()=>{n.setOptions(e)},[n,e]);const i=_.useSyncExternalStore(_.useCallback(a=>n.subscribe($t.batchCalls(a)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=_.useCallback((a,o)=>{n.mutate(a,o).catch(zg)},[n]);if(i.error&&pk(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}async function mk(e){if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}async function r5(e,t,r){const n=await fetch(t,{method:e,headers:r?{"Content-Type":"application/json"}:{},body:r?JSON.stringify(r):void 0,credentials:"include"});return await mk(n),n}const n5=({on401:e})=>async({queryKey:t})=>{const r=await fetch(t.join("/"),{credentials:"include"});return e==="returnNull"&&r.status===401?null:(await mk(r),await r.json())},gk=new LN({defaultOptions:{queries:{queryFn:n5({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),i5=1,s5=1e6;let Lp=0;function a5(){return Lp=(Lp+1)%Number.MAX_SAFE_INTEGER,Lp.toString()}const zp=new Map,Bw=e=>{if(zp.has(e))return;const t=setTimeout(()=>{zp.delete(e),iu({type:"REMOVE_TOAST",toastId:e})},s5);zp.set(e,t)},o5=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,i5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?Bw(r):e.toasts.forEach(n=>{Bw(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Qf=[];let Jf={toasts:[]};function iu(e){Jf=o5(Jf,e),Qf.forEach(t=>{t(Jf)})}function l5({...e}){const t=a5(),r=i=>iu({type:"UPDATE_TOAST",toast:{...i,id:t}}),n=()=>iu({type:"DISMISS_TOAST",toastId:t});return iu({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:i=>{i||n()}}}),{id:t,dismiss:n,update:r}}function L1(){const[e,t]=_.useState(Jf);return _.useEffect(()=>(Qf.push(t),()=>{const r=Qf.indexOf(t);r>-1&&Qf.splice(r,1)}),[e]),{...e,toast:l5,dismiss:r=>iu({type:"DISMISS_TOAST",toastId:r})}}function Re(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e==null||e(i),r===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function Uw(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function vk(...e){return t=>{let r=!1;const n=e.map(i=>{const s=Uw(i,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let i=0;i<n.length;i++){const s=n[i];typeof s=="function"?s():Uw(e[i],null)}}}}function Je(...e){return _.useCallback(vk(...e),e)}function c5(e,t){const r=_.createContext(t),n=s=>{const{children:a,...o}=s,l=_.useMemo(()=>o,Object.values(o));return x.jsx(r.Provider,{value:l,children:a})};n.displayName=e+"Provider";function i(s){const a=_.useContext(r);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,i]}function ua(e,t=[]){let r=[];function n(s,a){const o=_.createContext(a),l=r.length;r=[...r,a];const c=d=>{var v;const{scope:f,children:p,...m}=d,h=((v=f==null?void 0:f[e])==null?void 0:v[l])||o,g=_.useMemo(()=>m,Object.values(m));return x.jsx(h.Provider,{value:g,children:p})};c.displayName=s+"Provider";function u(d,f){var h;const p=((h=f==null?void 0:f[e])==null?void 0:h[l])||o,m=_.useContext(p);if(m)return m;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const i=()=>{const s=r.map(a=>_.createContext(a));return function(o){const l=(o==null?void 0:o[e])||s;return _.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return i.scopeName=e,[n,u5(i,...t)]}function u5(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const a=n.reduce((o,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...o,...d}},{});return _.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}function uo(e){const t=d5(e),r=_.forwardRef((n,i)=>{const{children:s,...a}=n,o=_.Children.toArray(s),l=o.find(h5);if(l){const c=l.props.children,u=o.map(d=>d===l?_.Children.count(c)>1?_.Children.only(null):_.isValidElement(c)?c.props.children:null:d);return x.jsx(t,{...a,ref:i,children:_.isValidElement(c)?_.cloneElement(c,void 0,u):null})}return x.jsx(t,{...a,ref:i,children:s})});return r.displayName=`${e}.Slot`,r}var xk=uo("Slot");function d5(e){const t=_.forwardRef((r,n)=>{const{children:i,...s}=r;if(_.isValidElement(i)){const a=m5(i),o=p5(s,i.props);return i.type!==_.Fragment&&(o.ref=n?vk(n,a):a),_.cloneElement(i,o)}return _.Children.count(i)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var yk=Symbol("radix.slottable");function f5(e){const t=({children:r})=>x.jsx(x.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=yk,t}function h5(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===yk}function p5(e,t){const r={...t};for(const n in t){const i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...o)=>{s(...o),i(...o)}:i&&(r[n]=i):n==="style"?r[n]={...i,...s}:n==="className"&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}function m5(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function wk(e){const t=e+"CollectionProvider",[r,n]=ua(t),[i,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=h=>{const{scope:g,children:v}=h,w=mi.useRef(null),y=mi.useRef(new Map).current;return x.jsx(i,{scope:g,itemMap:y,collectionRef:w,children:v})};a.displayName=t;const o=e+"CollectionSlot",l=uo(o),c=mi.forwardRef((h,g)=>{const{scope:v,children:w}=h,y=s(o,v),b=Je(g,y.collectionRef);return x.jsx(l,{ref:b,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",f=uo(u),p=mi.forwardRef((h,g)=>{const{scope:v,children:w,...y}=h,b=mi.useRef(null),E=Je(g,b),k=s(u,v);return mi.useEffect(()=>(k.itemMap.set(b,{ref:b,...y}),()=>void k.itemMap.delete(b))),x.jsx(f,{[d]:"",ref:E,children:w})});p.displayName=u;function m(h){const g=s(e+"CollectionConsumer",h);return mi.useCallback(()=>{const w=g.collectionRef.current;if(!w)return[];const y=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((k,S)=>y.indexOf(k.ref.current)-y.indexOf(S.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:a,Slot:c,ItemSlot:p},m,n]}var g5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Le=g5.reduce((e,t)=>{const r=uo(`Primitive.${t}`),n=_.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),x.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function bk(e,t){e&&_o.flushSync(()=>e.dispatchEvent(t))}function cn(e){const t=_.useRef(e);return _.useEffect(()=>{t.current=e}),_.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function v5(e,t=globalThis==null?void 0:globalThis.document){const r=cn(e);_.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var x5="DismissableLayer",jg="dismissableLayer.update",y5="dismissableLayer.pointerDownOutside",w5="dismissableLayer.focusOutside",$w,_k=_.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ic=_.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=e,c=_.useContext(_k),[u,d]=_.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=_.useState({}),m=Je(t,S=>d(S)),h=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=h.indexOf(g),w=u?h.indexOf(u):-1,y=c.layersWithOutsidePointerEventsDisabled.size>0,b=w>=v,E=_5(S=>{const C=S.target,T=[...c.branches].some(P=>P.contains(C));!b||T||(i==null||i(S),a==null||a(S),S.defaultPrevented||o==null||o())},f),k=S5(S=>{const C=S.target;[...c.branches].some(P=>P.contains(C))||(s==null||s(S),a==null||a(S),S.defaultPrevented||o==null||o())},f);return v5(S=>{w===c.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&o&&(S.preventDefault(),o()))},f),_.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&($w=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),Vw(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=$w)}},[u,f,r,c]),_.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),Vw())},[u,c]),_.useEffect(()=>{const S=()=>p({});return document.addEventListener(jg,S),()=>document.removeEventListener(jg,S)},[]),x.jsx(Le.div,{...l,ref:m,style:{pointerEvents:y?b?"auto":"none":void 0,...e.style},onFocusCapture:Re(e.onFocusCapture,k.onFocusCapture),onBlurCapture:Re(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Re(e.onPointerDownCapture,E.onPointerDownCapture)})});ic.displayName=x5;var b5="DismissableLayerBranch",Sk=_.forwardRef((e,t)=>{const r=_.useContext(_k),n=_.useRef(null),i=Je(t,n);return _.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),x.jsx(Le.div,{...e,ref:i})});Sk.displayName=b5;function _5(e,t=globalThis==null?void 0:globalThis.document){const r=cn(e),n=_.useRef(!1),i=_.useRef(()=>{});return _.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let l=function(){Ek(y5,r,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=l,t.addEventListener("click",i.current,{once:!0})):l()}else t.removeEventListener("click",i.current);n.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",s),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function S5(e,t=globalThis==null?void 0:globalThis.document){const r=cn(e),n=_.useRef(!1);return _.useEffect(()=>{const i=s=>{s.target&&!n.current&&Ek(w5,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Vw(){const e=new CustomEvent(jg);document.dispatchEvent(e)}function Ek(e,t,r,{discrete:n}){const i=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?bk(i,s):i.dispatchEvent(s)}var E5=ic,T5=Sk,Sr=globalThis!=null&&globalThis.document?_.useLayoutEffect:()=>{},k5="Portal",gd=_.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[i,s]=_.useState(!1);Sr(()=>s(!0),[]);const a=r||i&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?qD.createPortal(x.jsx(Le.div,{...n,ref:t}),a):null});gd.displayName=k5;function C5(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var as=e=>{const{present:t,children:r}=e,n=A5(t),i=typeof r=="function"?r({present:n.isPresent}):_.Children.only(r),s=Je(n.ref,R5(i));return typeof r=="function"||n.isPresent?_.cloneElement(i,{ref:s}):null};as.displayName="Presence";function A5(e){const[t,r]=_.useState(),n=_.useRef({}),i=_.useRef(e),s=_.useRef("none"),a=e?"mounted":"unmounted",[o,l]=C5(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return _.useEffect(()=>{const c=Yd(n.current);s.current=o==="mounted"?c:"none"},[o]),Sr(()=>{const c=n.current,u=i.current;if(u!==e){const f=s.current,p=Yd(c);e?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),Sr(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=p=>{const h=Yd(n.current).includes(p.animationName);if(p.target===t&&h&&(l("ANIMATION_END"),!i.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},f=p=>{p.target===t&&(s.current=Yd(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:_.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function Yd(e){return(e==null?void 0:e.animationName)||"none"}function R5(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function fo({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,i]=P5({defaultProp:t,onChange:r}),s=e!==void 0,a=s?e:n,o=cn(r),l=_.useCallback(c=>{if(s){const d=typeof c=="function"?c(e):c;d!==e&&o(d)}else i(c)},[s,e,i,o]);return[a,l]}function P5({defaultProp:e,onChange:t}){const r=_.useState(e),[n]=r,i=_.useRef(n),s=cn(t);return _.useEffect(()=>{i.current!==n&&(s(n),i.current=n)},[n,i,s]),r}var O5="VisuallyHidden",vd=_.forwardRef((e,t)=>x.jsx(Le.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));vd.displayName=O5;var I5=vd,z1="ToastProvider",[j1,D5,N5]=wk("Toast"),[Tk,kJ]=ua("Toast",[N5]),[F5,A0]=Tk(z1),kk=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:i="right",swipeThreshold:s=50,children:a}=e,[o,l]=_.useState(null),[c,u]=_.useState(0),d=_.useRef(!1),f=_.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${z1}\`. Expected non-empty \`string\`.`),x.jsx(j1.Provider,{scope:t,children:x.jsx(F5,{scope:t,label:r,duration:n,swipeDirection:i,swipeThreshold:s,toastCount:c,viewport:o,onViewportChange:l,onToastAdd:_.useCallback(()=>u(p=>p+1),[]),onToastRemove:_.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:a})})};kk.displayName=z1;var Ck="ToastViewport",M5=["F8"],Bg="toast.viewportPause",Ug="toast.viewportResume",Ak=_.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=M5,label:i="Notifications ({hotkey})",...s}=e,a=A0(Ck,r),o=D5(r),l=_.useRef(null),c=_.useRef(null),u=_.useRef(null),d=_.useRef(null),f=Je(t,d,a.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=a.toastCount>0;_.useEffect(()=>{const g=v=>{var y;n.length!==0&&n.every(b=>v[b]||v.code===b)&&((y=d.current)==null||y.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[n]),_.useEffect(()=>{const g=l.current,v=d.current;if(m&&g&&v){const w=()=>{if(!a.isClosePausedRef.current){const k=new CustomEvent(Bg);v.dispatchEvent(k),a.isClosePausedRef.current=!0}},y=()=>{if(a.isClosePausedRef.current){const k=new CustomEvent(Ug);v.dispatchEvent(k),a.isClosePausedRef.current=!1}},b=k=>{!g.contains(k.relatedTarget)&&y()},E=()=>{g.contains(document.activeElement)||y()};return g.addEventListener("focusin",w),g.addEventListener("focusout",b),g.addEventListener("pointermove",w),g.addEventListener("pointerleave",E),window.addEventListener("blur",w),window.addEventListener("focus",y),()=>{g.removeEventListener("focusin",w),g.removeEventListener("focusout",b),g.removeEventListener("pointermove",w),g.removeEventListener("pointerleave",E),window.removeEventListener("blur",w),window.removeEventListener("focus",y)}}},[m,a.isClosePausedRef]);const h=_.useCallback(({tabbingDirection:g})=>{const w=o().map(y=>{const b=y.ref.current,E=[b,...X5(b)];return g==="forwards"?E:E.reverse()});return(g==="forwards"?w.reverse():w).flat()},[o]);return _.useEffect(()=>{const g=d.current;if(g){const v=w=>{var E,k,S;const y=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!y){const C=document.activeElement,T=w.shiftKey;if(w.target===g&&T){(E=c.current)==null||E.focus();return}const R=h({tabbingDirection:T?"backwards":"forwards"}),H=R.findIndex(q=>q===C);jp(R.slice(H+1))?w.preventDefault():T?(k=c.current)==null||k.focus():(S=u.current)==null||S.focus()}};return g.addEventListener("keydown",v),()=>g.removeEventListener("keydown",v)}},[o,h]),x.jsxs(T5,{ref:l,role:"region","aria-label":i.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&x.jsx($g,{ref:c,onFocusFromOutsideViewport:()=>{const g=h({tabbingDirection:"forwards"});jp(g)}}),x.jsx(j1.Slot,{scope:r,children:x.jsx(Le.ol,{tabIndex:-1,...s,ref:f})}),m&&x.jsx($g,{ref:u,onFocusFromOutsideViewport:()=>{const g=h({tabbingDirection:"backwards"});jp(g)}})]})});Ak.displayName=Ck;var Rk="ToastFocusProxy",$g=_.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...i}=e,s=A0(Rk,r);return x.jsx(vd,{"aria-hidden":!0,tabIndex:0,...i,ref:t,style:{position:"fixed"},onFocus:a=>{var c;const o=a.relatedTarget;!((c=s.viewport)!=null&&c.contains(o))&&n()}})});$g.displayName=Rk;var R0="Toast",L5="toast.swipeStart",z5="toast.swipeMove",j5="toast.swipeCancel",B5="toast.swipeEnd",Pk=_.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:i,onOpenChange:s,...a}=e,[o=!0,l]=fo({prop:n,defaultProp:i,onChange:s});return x.jsx(as,{present:r||o,children:x.jsx(V5,{open:o,...a,ref:t,onClose:()=>l(!1),onPause:cn(e.onPause),onResume:cn(e.onResume),onSwipeStart:Re(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Re(e.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Re(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Re(e.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});Pk.displayName=R0;var[U5,$5]=Tk(R0,{onClose(){}}),V5=_.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:i,open:s,onClose:a,onEscapeKeyDown:o,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:p,...m}=e,h=A0(R0,r),[g,v]=_.useState(null),w=Je(t,q=>v(q)),y=_.useRef(null),b=_.useRef(null),E=i||h.duration,k=_.useRef(0),S=_.useRef(E),C=_.useRef(0),{onToastAdd:T,onToastRemove:P}=h,I=cn(()=>{var X;(g==null?void 0:g.contains(document.activeElement))&&((X=h.viewport)==null||X.focus()),a()}),R=_.useCallback(q=>{!q||q===1/0||(window.clearTimeout(C.current),k.current=new Date().getTime(),C.current=window.setTimeout(I,q))},[I]);_.useEffect(()=>{const q=h.viewport;if(q){const X=()=>{R(S.current),c==null||c()},K=()=>{const Q=new Date().getTime()-k.current;S.current=S.current-Q,window.clearTimeout(C.current),l==null||l()};return q.addEventListener(Bg,K),q.addEventListener(Ug,X),()=>{q.removeEventListener(Bg,K),q.removeEventListener(Ug,X)}}},[h.viewport,E,l,c,R]),_.useEffect(()=>{s&&!h.isClosePausedRef.current&&R(E)},[s,E,h.isClosePausedRef,R]),_.useEffect(()=>(T(),()=>P()),[T,P]);const H=_.useMemo(()=>g?Lk(g):null,[g]);return h.viewport?x.jsxs(x.Fragment,{children:[H&&x.jsx(H5,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:H}),x.jsx(U5,{scope:r,onClose:I,children:_o.createPortal(x.jsx(j1.ItemSlot,{scope:r,children:x.jsx(E5,{asChild:!0,onEscapeKeyDown:Re(o,()=>{h.isFocusedToastEscapeKeyDownRef.current||I(),h.isFocusedToastEscapeKeyDownRef.current=!1}),children:x.jsx(Le.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":h.swipeDirection,...m,ref:w,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Re(e.onKeyDown,q=>{q.key==="Escape"&&(o==null||o(q.nativeEvent),q.nativeEvent.defaultPrevented||(h.isFocusedToastEscapeKeyDownRef.current=!0,I()))}),onPointerDown:Re(e.onPointerDown,q=>{q.button===0&&(y.current={x:q.clientX,y:q.clientY})}),onPointerMove:Re(e.onPointerMove,q=>{if(!y.current)return;const X=q.clientX-y.current.x,K=q.clientY-y.current.y,Q=!!b.current,G=["left","right"].includes(h.swipeDirection),z=["left","up"].includes(h.swipeDirection)?Math.min:Math.max,ie=G?z(0,X):0,ae=G?0:z(0,K),D=q.pointerType==="touch"?10:2,V={x:ie,y:ae},B={originalEvent:q,delta:V};Q?(b.current=V,Qd(z5,d,B,{discrete:!1})):Hw(V,h.swipeDirection,D)?(b.current=V,Qd(L5,u,B,{discrete:!1}),q.target.setPointerCapture(q.pointerId)):(Math.abs(X)>D||Math.abs(K)>D)&&(y.current=null)}),onPointerUp:Re(e.onPointerUp,q=>{const X=b.current,K=q.target;if(K.hasPointerCapture(q.pointerId)&&K.releasePointerCapture(q.pointerId),b.current=null,y.current=null,X){const Q=q.currentTarget,G={originalEvent:q,delta:X};Hw(X,h.swipeDirection,h.swipeThreshold)?Qd(B5,p,G,{discrete:!0}):Qd(j5,f,G,{discrete:!0}),Q.addEventListener("click",z=>z.preventDefault(),{once:!0})}})})})}),h.viewport)})]}):null}),H5=e=>{const{__scopeToast:t,children:r,...n}=e,i=A0(R0,t),[s,a]=_.useState(!1),[o,l]=_.useState(!1);return K5(()=>a(!0)),_.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),o?null:x.jsx(gd,{asChild:!0,children:x.jsx(vd,{...n,children:s&&x.jsxs(x.Fragment,{children:[i.label," ",r]})})})},W5="ToastTitle",Ok=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return x.jsx(Le.div,{...n,ref:t})});Ok.displayName=W5;var G5="ToastDescription",Ik=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return x.jsx(Le.div,{...n,ref:t})});Ik.displayName=G5;var Dk="ToastAction",Nk=_.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?x.jsx(Mk,{altText:r,asChild:!0,children:x.jsx(B1,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Dk}\`. Expected non-empty \`string\`.`),null)});Nk.displayName=Dk;var Fk="ToastClose",B1=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,i=$5(Fk,r);return x.jsx(Mk,{asChild:!0,children:x.jsx(Le.button,{type:"button",...n,ref:t,onClick:Re(e.onClick,i.onClose)})})});B1.displayName=Fk;var Mk=_.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...i}=e;return x.jsx(Le.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...i,ref:t})});function Lk(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),q5(n)){const i=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!i)if(s){const a=n.dataset.radixToastAnnounceAlt;a&&t.push(a)}else t.push(...Lk(n))}}),t}function Qd(e,t,r,{discrete:n}){const i=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?bk(i,s):i.dispatchEvent(s)}var Hw=(e,t,r=0)=>{const n=Math.abs(e.x),i=Math.abs(e.y),s=n>i;return t==="left"||t==="right"?s&&n>r:!s&&i>r};function K5(e=()=>{}){const t=cn(e);Sr(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function q5(e){return e.nodeType===e.ELEMENT_NODE}function X5(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function jp(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Y5=kk,zk=Ak,jk=Pk,Bk=Ok,Uk=Ik,$k=Nk,Vk=B1;function Hk(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=Hk(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Wk(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=Hk(e))&&(n&&(n+=" "),n+=t);return n}const Ww=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Gw=Wk,So=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return Gw(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:s}=t,a=Object.keys(i).map(c=>{const u=r==null?void 0:r[c],d=s==null?void 0:s[c];if(u===null)return null;const f=Ww(u)||Ww(d);return i[c][f]}),o=r&&Object.entries(r).reduce((c,u)=>{let[d,f]=u;return f===void 0||(c[d]=f),c},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,u)=>{let{class:d,className:f,...p}=u;return Object.entries(p).every(m=>{let[h,g]=m;return Array.isArray(g)?g.includes({...s,...o}[h]):{...s,...o}[h]===g})?[...c,d,f]:c},[]);return Gw(e,a,l,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q5=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Gk=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var J5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z5=_.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...o},l)=>_.createElement("svg",{ref:l,...J5,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Gk("lucide",i),...o},[...a.map(([c,u])=>_.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=(e,t)=>{const r=_.forwardRef(({className:n,...i},s)=>_.createElement(Z5,{ref:s,iconNode:t,className:Gk(`lucide-${Q5(e)}`,n),...i}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=et("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=et("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=et("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=et("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=et("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=et("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=et("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=et("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=et("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=et("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=et("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=et("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=et("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=et("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=et("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=et("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=et("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=et("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=et("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=et("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=et("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=et("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=et("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=et("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=et("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=et("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=et("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),$1="-",wF=e=>{const t=_F(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:a=>{const o=a.split($1);return o[0]===""&&o.length!==1&&o.shift(),qk(o,t)||bF(a)},getConflictingClassGroupIds:(a,o)=>{const l=r[a]||[];return o&&n[a]?[...l,...n[a]]:l}}},qk=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),i=n?qk(e.slice(1),n):void 0;if(i)return i;if(t.validators.length===0)return;const s=e.join($1);return(a=t.validators.find(({validator:o})=>o(s)))==null?void 0:a.classGroupId},Xw=/^\[(.+)\]$/,bF=e=>{if(Xw.test(e)){const t=Xw.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},_F=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return EF(Object.entries(e.classGroups),r).forEach(([s,a])=>{Vg(a,n,s,t)}),n},Vg=(e,t,r,n)=>{e.forEach(i=>{if(typeof i=="string"){const s=i===""?t:Yw(t,i);s.classGroupId=r;return}if(typeof i=="function"){if(SF(i)){Vg(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([s,a])=>{Vg(a,Yw(t,s),r,n)})})},Yw=(e,t)=>{let r=e;return t.split($1).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},SF=e=>e.isThemeGetter,EF=(e,t)=>t?e.map(([r,n])=>{const i=n.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([a,o])=>[t+a,o])):s);return[r,i]}):e,TF=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const i=(s,a)=>{r.set(s,a),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let a=r.get(s);if(a!==void 0)return a;if((a=n.get(s))!==void 0)return i(s,a),a},set(s,a){r.has(s)?r.set(s,a):i(s,a)}}},Xk="!",kF=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,i=t[0],s=t.length,a=o=>{const l=[];let c=0,u=0,d;for(let g=0;g<o.length;g++){let v=o[g];if(c===0){if(v===i&&(n||o.slice(g,g+s)===t)){l.push(o.slice(u,g)),u=g+s;continue}if(v==="/"){d=g;continue}}v==="["?c++:v==="]"&&c--}const f=l.length===0?o:o.substring(u),p=f.startsWith(Xk),m=p?f.substring(1):f,h=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:h}};return r?o=>r({className:o,parseClassName:a}):a},CF=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},AF=e=>({cache:TF(e.cacheSize),parseClassName:kF(e),...wF(e)}),RF=/\s+/,PF=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=t,s=[],a=e.trim().split(RF);let o="";for(let l=a.length-1;l>=0;l-=1){const c=a[l],{modifiers:u,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:p}=r(c);let m=!!p,h=n(m?f.substring(0,p):f);if(!h){if(!m){o=c+(o.length>0?" "+o:o);continue}if(h=n(f),!h){o=c+(o.length>0?" "+o:o);continue}m=!1}const g=CF(u).join(":"),v=d?g+Xk:g,w=v+h;if(s.includes(w))continue;s.push(w);const y=i(h,m);for(let b=0;b<y.length;++b){const E=y[b];s.push(v+E)}o=c+(o.length>0?" "+o:o)}return o};function OF(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=Yk(t))&&(n&&(n+=" "),n+=r);return n}const Yk=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=Yk(e[n]))&&(r&&(r+=" "),r+=t);return r};function IF(e,...t){let r,n,i,s=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return r=AF(c),n=r.cache.get,i=r.cache.set,s=o,o(l)}function o(l){const c=n(l);if(c)return c;const u=PF(l,r);return i(l,u),u}return function(){return s(OF.apply(null,arguments))}}const st=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},Qk=/^\[(?:([a-z-]+):)?(.+)\]$/i,DF=/^\d+\/\d+$/,NF=new Set(["px","full","screen"]),FF=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,MF=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,LF=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,zF=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,jF=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Di=e=>fl(e)||NF.has(e)||DF.test(e),cs=e=>sc(e,"length",KF),fl=e=>!!e&&!Number.isNaN(Number(e)),Up=e=>sc(e,"number",fl),Cc=e=>!!e&&Number.isInteger(Number(e)),BF=e=>e.endsWith("%")&&fl(e.slice(0,-1)),Ne=e=>Qk.test(e),us=e=>FF.test(e),UF=new Set(["length","size","percentage"]),$F=e=>sc(e,UF,Jk),VF=e=>sc(e,"position",Jk),HF=new Set(["image","url"]),WF=e=>sc(e,HF,XF),GF=e=>sc(e,"",qF),Ac=()=>!0,sc=(e,t,r)=>{const n=Qk.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},KF=e=>MF.test(e)&&!LF.test(e),Jk=()=>!1,qF=e=>zF.test(e),XF=e=>jF.test(e),YF=()=>{const e=st("colors"),t=st("spacing"),r=st("blur"),n=st("brightness"),i=st("borderColor"),s=st("borderRadius"),a=st("borderSpacing"),o=st("borderWidth"),l=st("contrast"),c=st("grayscale"),u=st("hueRotate"),d=st("invert"),f=st("gap"),p=st("gradientColorStops"),m=st("gradientColorStopPositions"),h=st("inset"),g=st("margin"),v=st("opacity"),w=st("padding"),y=st("saturate"),b=st("scale"),E=st("sepia"),k=st("skew"),S=st("space"),C=st("translate"),T=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto",Ne,t],R=()=>[Ne,t],H=()=>["",Di,cs],q=()=>["auto",fl,Ne],X=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],K=()=>["solid","dashed","dotted","double","none"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],G=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",Ne],ie=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ae=()=>[fl,Ne];return{cacheSize:500,separator:":",theme:{colors:[Ac],spacing:[Di,cs],blur:["none","",us,Ne],brightness:ae(),borderColor:[e],borderRadius:["none","","full",us,Ne],borderSpacing:R(),borderWidth:H(),contrast:ae(),grayscale:z(),hueRotate:ae(),invert:z(),gap:R(),gradientColorStops:[e],gradientColorStopPositions:[BF,cs],inset:I(),margin:I(),opacity:ae(),padding:R(),saturate:ae(),scale:ae(),sepia:z(),skew:ae(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",Ne]}],container:["container"],columns:[{columns:[us]}],"break-after":[{"break-after":ie()}],"break-before":[{"break-before":ie()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...X(),Ne]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[h]}],"inset-x":[{"inset-x":[h]}],"inset-y":[{"inset-y":[h]}],start:[{start:[h]}],end:[{end:[h]}],top:[{top:[h]}],right:[{right:[h]}],bottom:[{bottom:[h]}],left:[{left:[h]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Cc,Ne]}],basis:[{basis:I()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ne]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Cc,Ne]}],"grid-cols":[{"grid-cols":[Ac]}],"col-start-end":[{col:["auto",{span:["full",Cc,Ne]},Ne]}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":[Ac]}],"row-start-end":[{row:["auto",{span:[Cc,Ne]},Ne]}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ne]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ne]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...G()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...G(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...G(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ne,t]}],"min-w":[{"min-w":[Ne,t,"min","max","fit"]}],"max-w":[{"max-w":[Ne,t,"none","full","min","max","fit","prose",{screen:[us]},us]}],h:[{h:[Ne,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ne,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ne,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ne,t,"auto","min","max","fit"]}],"font-size":[{text:["base",us,cs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Up]}],"font-family":[{font:[Ac]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ne]}],"line-clamp":[{"line-clamp":["none",fl,Up]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Di,Ne]}],"list-image":[{"list-image":["none",Ne]}],"list-style-type":[{list:["none","disc","decimal",Ne]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...K(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Di,cs]}],"underline-offset":[{"underline-offset":["auto",Di,Ne]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ne]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ne]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...X(),VF]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",$F]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},WF]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...K(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:K()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...K()]}],"outline-offset":[{"outline-offset":[Di,Ne]}],"outline-w":[{outline:[Di,cs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:H()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[Di,cs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",us,GF]}],"shadow-color":[{shadow:[Ac]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...Q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Q()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",us,Ne]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[y]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ne]}],duration:[{duration:ae()}],ease:[{ease:["linear","in","out","in-out",Ne]}],delay:[{delay:ae()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ne]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[Cc,Ne]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ne]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ne]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ne]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Di,cs,Up]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},QF=IF(YF);function _e(...e){return QF(Wk(e))}const JF=Y5,Zk=_.forwardRef(({className:e,...t},r)=>x.jsx(zk,{ref:r,className:_e("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Zk.displayName=zk.displayName;const ZF=So("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),eC=_.forwardRef(({className:e,variant:t,...r},n)=>x.jsx(jk,{ref:n,className:_e(ZF({variant:t}),e),...r}));eC.displayName=jk.displayName;const e8=_.forwardRef(({className:e,...t},r)=>x.jsx($k,{ref:r,className:_e("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));e8.displayName=$k.displayName;const tC=_.forwardRef(({className:e,...t},r)=>x.jsx(Vk,{ref:r,className:_e("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:x.jsx(P0,{className:"h-4 w-4"})}));tC.displayName=Vk.displayName;const rC=_.forwardRef(({className:e,...t},r)=>x.jsx(Bk,{ref:r,className:_e("text-sm font-semibold",e),...t}));rC.displayName=Bk.displayName;const nC=_.forwardRef(({className:e,...t},r)=>x.jsx(Uk,{ref:r,className:_e("text-sm opacity-90",e),...t}));nC.displayName=Uk.displayName;function t8(){const{toasts:e}=L1();return x.jsxs(JF,{children:[e.map(function({id:t,title:r,description:n,action:i,...s}){return x.jsxs(eC,{...s,children:[x.jsxs("div",{className:"grid gap-1",children:[r&&x.jsx(rC,{children:r}),n&&x.jsx(nC,{children:n})]}),i,x.jsx(tC,{})]},t)}),x.jsx(Zk,{})]})}var r8=LS[" useId ".trim().toString()]||(()=>{}),n8=0;function Xs(e){const[t,r]=_.useState(r8());return Sr(()=>{r(n=>n??String(n8++))},[e]),t?`radix-${t}`:""}const i8=["top","right","bottom","left"],ta=Math.min,Jr=Math.max,Mh=Math.round,Jd=Math.floor,Si=e=>({x:e,y:e}),s8={left:"right",right:"left",bottom:"top",top:"bottom"},a8={start:"end",end:"start"};function Hg(e,t,r){return Jr(e,ta(t,r))}function rs(e,t){return typeof e=="function"?e(t):e}function ns(e){return e.split("-")[0]}function ac(e){return e.split("-")[1]}function V1(e){return e==="x"?"y":"x"}function H1(e){return e==="y"?"height":"width"}function ra(e){return["top","bottom"].includes(ns(e))?"y":"x"}function W1(e){return V1(ra(e))}function o8(e,t,r){r===void 0&&(r=!1);const n=ac(e),i=W1(e),s=H1(i);let a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=Lh(a)),[a,Lh(a)]}function l8(e){const t=Lh(e);return[Wg(e),t,Wg(t)]}function Wg(e){return e.replace(/start|end/g,t=>a8[t])}function c8(e,t,r){const n=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return r?t?i:n:t?n:i;case"left":case"right":return t?s:a;default:return[]}}function u8(e,t,r,n){const i=ac(e);let s=c8(ns(e),r==="start",n);return i&&(s=s.map(a=>a+"-"+i),t&&(s=s.concat(s.map(Wg)))),s}function Lh(e){return e.replace(/left|right|bottom|top/g,t=>s8[t])}function d8(e){return{top:0,right:0,bottom:0,left:0,...e}}function iC(e){return typeof e!="number"?d8(e):{top:e,right:e,bottom:e,left:e}}function zh(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function Qw(e,t,r){let{reference:n,floating:i}=e;const s=ra(t),a=W1(t),o=H1(a),l=ns(t),c=s==="y",u=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,f=n[o]/2-i[o]/2;let p;switch(l){case"top":p={x:u,y:n.y-i.height};break;case"bottom":p={x:u,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:d};break;case"left":p={x:n.x-i.width,y:d};break;default:p={x:n.x,y:n.y}}switch(ac(t)){case"start":p[a]-=f*(r&&c?-1:1);break;case"end":p[a]+=f*(r&&c?-1:1);break}return p}const f8=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=Qw(c,n,l),f=n,p={},m=0;for(let h=0;h<o.length;h++){const{name:g,fn:v}=o[h],{x:w,y,data:b,reset:E}=await v({x:u,y:d,initialPlacement:n,placement:f,strategy:i,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=y??d,p={...p,[g]:{...p[g],...b}},E&&m<=50&&(m++,typeof E=="object"&&(E.placement&&(f=E.placement),E.rects&&(c=E.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):E.rects),{x:u,y:d}=Qw(c,f,l)),h=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:p}};async function zu(e,t){var r;t===void 0&&(t={});const{x:n,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=rs(t,e),m=iC(p),g=o[f?d==="floating"?"reference":"floating":d],v=zh(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(g)))==null||r?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,y=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),b=await(s.isElement==null?void 0:s.isElement(y))?await(s.getScale==null?void 0:s.getScale(y))||{x:1,y:1}:{x:1,y:1},E=zh(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:y,strategy:l}):w);return{top:(v.top-E.top+m.top)/b.y,bottom:(E.bottom-v.bottom+m.bottom)/b.y,left:(v.left-E.left+m.left)/b.x,right:(E.right-v.right+m.right)/b.x}}const h8=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=rs(e,t)||{};if(c==null)return{};const d=iC(u),f={x:r,y:n},p=W1(i),m=H1(p),h=await a.getDimensions(c),g=p==="y",v=g?"top":"left",w=g?"bottom":"right",y=g?"clientHeight":"clientWidth",b=s.reference[m]+s.reference[p]-f[p]-s.floating[m],E=f[p]-s.reference[p],k=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let S=k?k[y]:0;(!S||!await(a.isElement==null?void 0:a.isElement(k)))&&(S=o.floating[y]||s.floating[m]);const C=b/2-E/2,T=S/2-h[m]/2-1,P=ta(d[v],T),I=ta(d[w],T),R=P,H=S-h[m]-I,q=S/2-h[m]/2+C,X=Hg(R,q,H),K=!l.arrow&&ac(i)!=null&&q!==X&&s.reference[m]/2-(q<R?P:I)-h[m]/2<0,Q=K?q<R?q-R:q-H:0;return{[p]:f[p]+Q,data:{[p]:X,centerOffset:q-X-Q,...K&&{alignmentOffset:Q}},reset:K}}}),p8=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:h=!0,...g}=rs(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const v=ns(i),w=ra(o),y=ns(o)===o,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),E=f||(y||!h?[Lh(o)]:l8(o)),k=m!=="none";!f&&k&&E.push(...u8(o,h,m,b));const S=[o,...E],C=await zu(t,g),T=[];let P=((n=s.flip)==null?void 0:n.overflows)||[];if(u&&T.push(C[v]),d){const q=o8(i,a,b);T.push(C[q[0]],C[q[1]])}if(P=[...P,{placement:i,overflows:T}],!T.every(q=>q<=0)){var I,R;const q=(((I=s.flip)==null?void 0:I.index)||0)+1,X=S[q];if(X)return{data:{index:q,overflows:P},reset:{placement:X}};let K=(R=P.filter(Q=>Q.overflows[0]<=0).sort((Q,G)=>Q.overflows[1]-G.overflows[1])[0])==null?void 0:R.placement;if(!K)switch(p){case"bestFit":{var H;const Q=(H=P.filter(G=>{if(k){const z=ra(G.placement);return z===w||z==="y"}return!0}).map(G=>[G.placement,G.overflows.filter(z=>z>0).reduce((z,ie)=>z+ie,0)]).sort((G,z)=>G[1]-z[1])[0])==null?void 0:H[0];Q&&(K=Q);break}case"initialPlacement":K=o;break}if(i!==K)return{reset:{placement:K}}}return{}}}};function Jw(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Zw(e){return i8.some(t=>e[t]>=0)}const m8=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...i}=rs(e,t);switch(n){case"referenceHidden":{const s=await zu(t,{...i,elementContext:"reference"}),a=Jw(s,r.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:Zw(a)}}}case"escaped":{const s=await zu(t,{...i,altBoundary:!0}),a=Jw(s,r.floating);return{data:{escapedOffsets:a,escaped:Zw(a)}}}default:return{}}}}};async function g8(e,t){const{placement:r,platform:n,elements:i}=e,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),a=ns(r),o=ac(r),l=ra(r)==="y",c=["left","top"].includes(a)?-1:1,u=s&&l?-1:1,d=rs(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof m=="number"&&(p=o==="end"?m*-1:m),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const v8=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:s,placement:a,middlewareData:o}=t,l=await g8(t,e);return a===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},x8=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:g=>{let{x:v,y:w}=g;return{x:v,y:w}}},...l}=rs(e,t),c={x:r,y:n},u=await zu(t,l),d=ra(ns(i)),f=V1(d);let p=c[f],m=c[d];if(s){const g=f==="y"?"top":"left",v=f==="y"?"bottom":"right",w=p+u[g],y=p-u[v];p=Hg(w,p,y)}if(a){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",w=m+u[g],y=m-u[v];m=Hg(w,m,y)}const h=o.fn({...t,[f]:p,[d]:m});return{...h,data:{x:h.x-r,y:h.y-n,enabled:{[f]:s,[d]:a}}}}}},y8=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:s,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=rs(e,t),u={x:r,y:n},d=ra(i),f=V1(d);let p=u[f],m=u[d];const h=rs(o,t),g=typeof h=="number"?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(l){const y=f==="y"?"height":"width",b=s.reference[f]-s.floating[y]+g.mainAxis,E=s.reference[f]+s.reference[y]-g.mainAxis;p<b?p=b:p>E&&(p=E)}if(c){var v,w;const y=f==="y"?"width":"height",b=["top","left"].includes(ns(i)),E=s.reference[d]-s.floating[y]+(b&&((v=a.offset)==null?void 0:v[d])||0)+(b?0:g.crossAxis),k=s.reference[d]+s.reference[y]+(b?0:((w=a.offset)==null?void 0:w[d])||0)-(b?g.crossAxis:0);m<E?m=E:m>k&&(m=k)}return{[f]:p,[d]:m}}}},w8=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:i,rects:s,platform:a,elements:o}=t,{apply:l=()=>{},...c}=rs(e,t),u=await zu(t,c),d=ns(i),f=ac(i),p=ra(i)==="y",{width:m,height:h}=s.floating;let g,v;d==="top"||d==="bottom"?(g=d,v=f===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(v=d,g=f==="end"?"top":"bottom");const w=h-u.top-u.bottom,y=m-u.left-u.right,b=ta(h-u[g],w),E=ta(m-u[v],y),k=!t.middlewareData.shift;let S=b,C=E;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(C=y),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(S=w),k&&!f){const P=Jr(u.left,0),I=Jr(u.right,0),R=Jr(u.top,0),H=Jr(u.bottom,0);p?C=m-2*(P!==0||I!==0?P+I:Jr(u.left,u.right)):S=h-2*(R!==0||H!==0?R+H:Jr(u.top,u.bottom))}await l({...t,availableWidth:C,availableHeight:S});const T=await a.getDimensions(o.floating);return m!==T.width||h!==T.height?{reset:{rects:!0}}:{}}}};function O0(){return typeof window<"u"}function oc(e){return sC(e)?(e.nodeName||"").toLowerCase():"#document"}function on(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ri(e){var t;return(t=(sC(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function sC(e){return O0()?e instanceof Node||e instanceof on(e).Node:!1}function si(e){return O0()?e instanceof Element||e instanceof on(e).Element:!1}function Ci(e){return O0()?e instanceof HTMLElement||e instanceof on(e).HTMLElement:!1}function e2(e){return!O0()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof on(e).ShadowRoot}function xd(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=ai(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function b8(e){return["table","td","th"].includes(oc(e))}function I0(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function G1(e){const t=K1(),r=si(e)?ai(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function _8(e){let t=na(e);for(;Ci(t)&&!Vl(t);){if(G1(t))return t;if(I0(t))return null;t=na(t)}return null}function K1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Vl(e){return["html","body","#document"].includes(oc(e))}function ai(e){return on(e).getComputedStyle(e)}function D0(e){return si(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function na(e){if(oc(e)==="html")return e;const t=e.assignedSlot||e.parentNode||e2(e)&&e.host||Ri(e);return e2(t)?t.host:t}function aC(e){const t=na(e);return Vl(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ci(t)&&xd(t)?t:aC(t)}function ju(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=aC(e),s=i===((n=e.ownerDocument)==null?void 0:n.body),a=on(i);if(s){const o=Gg(a);return t.concat(a,a.visualViewport||[],xd(i)?i:[],o&&r?ju(o):[])}return t.concat(i,ju(i,[],r))}function Gg(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function oC(e){const t=ai(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=Ci(e),s=i?e.offsetWidth:r,a=i?e.offsetHeight:n,o=Mh(r)!==s||Mh(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function q1(e){return si(e)?e:e.contextElement}function hl(e){const t=q1(e);if(!Ci(t))return Si(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:s}=oC(t);let a=(s?Mh(r.width):r.width)/n,o=(s?Mh(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const S8=Si(0);function lC(e){const t=on(e);return!K1()||!t.visualViewport?S8:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function E8(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==on(e)?!1:t}function ho(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),s=q1(e);let a=Si(1);t&&(n?si(n)&&(a=hl(n)):a=hl(e));const o=E8(s,r,n)?lC(s):Si(0);let l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,u=i.width/a.x,d=i.height/a.y;if(s){const f=on(s),p=n&&si(n)?on(n):n;let m=f,h=Gg(m);for(;h&&n&&p!==m;){const g=hl(h),v=h.getBoundingClientRect(),w=ai(h),y=v.left+(h.clientLeft+parseFloat(w.paddingLeft))*g.x,b=v.top+(h.clientTop+parseFloat(w.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=y,c+=b,m=on(h),h=Gg(m)}}return zh({width:u,height:d,x:l,y:c})}function X1(e,t){const r=D0(e).scrollLeft;return t?t.left+r:ho(Ri(e)).left+r}function cC(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),i=n.left+t.scrollLeft-(r?0:X1(e,n)),s=n.top+t.scrollTop;return{x:i,y:s}}function T8(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const s=i==="fixed",a=Ri(n),o=t?I0(t.floating):!1;if(n===a||o&&s)return r;let l={scrollLeft:0,scrollTop:0},c=Si(1);const u=Si(0),d=Ci(n);if((d||!d&&!s)&&((oc(n)!=="body"||xd(a))&&(l=D0(n)),Ci(n))){const p=ho(n);c=hl(n),u.x=p.x+n.clientLeft,u.y=p.y+n.clientTop}const f=a&&!d&&!s?cC(a,l,!0):Si(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:r.y*c.y-l.scrollTop*c.y+u.y+f.y}}function k8(e){return Array.from(e.getClientRects())}function C8(e){const t=Ri(e),r=D0(e),n=e.ownerDocument.body,i=Jr(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=Jr(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+X1(e);const o=-r.scrollTop;return ai(n).direction==="rtl"&&(a+=Jr(t.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function A8(e,t){const r=on(e),n=Ri(e),i=r.visualViewport;let s=n.clientWidth,a=n.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const c=K1();(!c||c&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function R8(e,t){const r=ho(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,s=Ci(e)?hl(e):Si(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=i*s.x,c=n*s.y;return{width:a,height:o,x:l,y:c}}function t2(e,t,r){let n;if(t==="viewport")n=A8(e,r);else if(t==="document")n=C8(Ri(e));else if(si(t))n=R8(t,r);else{const i=lC(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return zh(n)}function uC(e,t){const r=na(e);return r===t||!si(r)||Vl(r)?!1:ai(r).position==="fixed"||uC(r,t)}function P8(e,t){const r=t.get(e);if(r)return r;let n=ju(e,[],!1).filter(o=>si(o)&&oc(o)!=="body"),i=null;const s=ai(e).position==="fixed";let a=s?na(e):e;for(;si(a)&&!Vl(a);){const o=ai(a),l=G1(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||xd(a)&&!l&&uC(e,a))?n=n.filter(u=>u!==a):i=o,a=na(a)}return t.set(e,n),n}function O8(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const a=[...r==="clippingAncestors"?I0(t)?[]:P8(t,this._c):[].concat(r),n],o=a[0],l=a.reduce((c,u)=>{const d=t2(t,u,i);return c.top=Jr(d.top,c.top),c.right=ta(d.right,c.right),c.bottom=ta(d.bottom,c.bottom),c.left=Jr(d.left,c.left),c},t2(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function I8(e){const{width:t,height:r}=oC(e);return{width:t,height:r}}function D8(e,t,r){const n=Ci(t),i=Ri(t),s=r==="fixed",a=ho(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=Si(0);if(n||!n&&!s)if((oc(t)!=="body"||xd(i))&&(o=D0(t)),n){const f=ho(t,!0,s,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else i&&(l.x=X1(i));const c=i&&!n&&!s?cC(i,o):Si(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function $p(e){return ai(e).position==="static"}function r2(e,t){if(!Ci(e)||ai(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Ri(e)===r&&(r=r.ownerDocument.body),r}function dC(e,t){const r=on(e);if(I0(e))return r;if(!Ci(e)){let i=na(e);for(;i&&!Vl(i);){if(si(i)&&!$p(i))return i;i=na(i)}return r}let n=r2(e,t);for(;n&&b8(n)&&$p(n);)n=r2(n,t);return n&&Vl(n)&&$p(n)&&!G1(n)?r:n||_8(e)||r}const N8=async function(e){const t=this.getOffsetParent||dC,r=this.getDimensions,n=await r(e.floating);return{reference:D8(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function F8(e){return ai(e).direction==="rtl"}const M8={convertOffsetParentRelativeRectToViewportRelativeRect:T8,getDocumentElement:Ri,getClippingRect:O8,getOffsetParent:dC,getElementRects:N8,getClientRects:k8,getDimensions:I8,getScale:hl,isElement:si,isRTL:F8};function fC(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function L8(e,t){let r=null,n;const i=Ri(e);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:u,top:d,width:f,height:p}=c;if(o||t(),!f||!p)return;const m=Jd(d),h=Jd(i.clientWidth-(u+f)),g=Jd(i.clientHeight-(d+p)),v=Jd(u),y={rootMargin:-m+"px "+-h+"px "+-g+"px "+-v+"px",threshold:Jr(0,ta(1,l))||1};let b=!0;function E(k){const S=k[0].intersectionRatio;if(S!==l){if(!b)return a();S?a(!1,S):n=setTimeout(()=>{a(!1,1e-7)},1e3)}S===1&&!fC(c,e.getBoundingClientRect())&&a(),b=!1}try{r=new IntersectionObserver(E,{...y,root:i.ownerDocument})}catch{r=new IntersectionObserver(E,y)}r.observe(e)}return a(!0),s}function z8(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=q1(e),u=i||s?[...c?ju(c):[],...ju(t)]:[];u.forEach(v=>{i&&v.addEventListener("scroll",r,{passive:!0}),s&&v.addEventListener("resize",r)});const d=c&&o?L8(c,r):null;let f=-1,p=null;a&&(p=new ResizeObserver(v=>{let[w]=v;w&&w.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var y;(y=p)==null||y.observe(t)})),r()}),c&&!l&&p.observe(c),p.observe(t));let m,h=l?ho(e):null;l&&g();function g(){const v=ho(e);h&&!fC(h,v)&&r(),h=v,m=requestAnimationFrame(g)}return r(),()=>{var v;u.forEach(w=>{i&&w.removeEventListener("scroll",r),s&&w.removeEventListener("resize",r)}),d==null||d(),(v=p)==null||v.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const j8=v8,B8=x8,U8=p8,$8=w8,V8=m8,n2=h8,H8=y8,W8=(e,t,r)=>{const n=new Map,i={platform:M8,...r},s={...i.platform,_c:n};return f8(e,t,{...i,platform:s})};var Zf=typeof document<"u"?_.useLayoutEffect:_.useEffect;function jh(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!jh(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const s=i[n];if(!(s==="_owner"&&e.$$typeof)&&!jh(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function hC(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function i2(e,t){const r=hC(e);return Math.round(t*r)/r}function Vp(e){const t=_.useRef(e);return Zf(()=>{t.current=e}),t}function G8(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=_.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=_.useState(n);jh(f,n)||p(n);const[m,h]=_.useState(null),[g,v]=_.useState(null),w=_.useCallback(G=>{G!==k.current&&(k.current=G,h(G))},[]),y=_.useCallback(G=>{G!==S.current&&(S.current=G,v(G))},[]),b=s||m,E=a||g,k=_.useRef(null),S=_.useRef(null),C=_.useRef(u),T=l!=null,P=Vp(l),I=Vp(i),R=Vp(c),H=_.useCallback(()=>{if(!k.current||!S.current)return;const G={placement:t,strategy:r,middleware:f};I.current&&(G.platform=I.current),W8(k.current,S.current,G).then(z=>{const ie={...z,isPositioned:R.current!==!1};q.current&&!jh(C.current,ie)&&(C.current=ie,_o.flushSync(()=>{d(ie)}))})},[f,t,r,I,R]);Zf(()=>{c===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,d(G=>({...G,isPositioned:!1})))},[c]);const q=_.useRef(!1);Zf(()=>(q.current=!0,()=>{q.current=!1}),[]),Zf(()=>{if(b&&(k.current=b),E&&(S.current=E),b&&E){if(P.current)return P.current(b,E,H);H()}},[b,E,H,P,T]);const X=_.useMemo(()=>({reference:k,floating:S,setReference:w,setFloating:y}),[w,y]),K=_.useMemo(()=>({reference:b,floating:E}),[b,E]),Q=_.useMemo(()=>{const G={position:r,left:0,top:0};if(!K.floating)return G;const z=i2(K.floating,u.x),ie=i2(K.floating,u.y);return o?{...G,transform:"translate("+z+"px, "+ie+"px)",...hC(K.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:z,top:ie}},[r,o,K.floating,u.x,u.y]);return _.useMemo(()=>({...u,update:H,refs:X,elements:K,floatingStyles:Q}),[u,H,X,K,Q])}const K8=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?n2({element:n.current,padding:i}).fn(r):{}:n?n2({element:n,padding:i}).fn(r):{}}}},q8=(e,t)=>({...j8(e),options:[e,t]}),X8=(e,t)=>({...B8(e),options:[e,t]}),Y8=(e,t)=>({...H8(e),options:[e,t]}),Q8=(e,t)=>({...U8(e),options:[e,t]}),J8=(e,t)=>({...$8(e),options:[e,t]}),Z8=(e,t)=>({...V8(e),options:[e,t]}),e6=(e,t)=>({...K8(e),options:[e,t]});var t6="Arrow",pC=_.forwardRef((e,t)=>{const{children:r,width:n=10,height:i=5,...s}=e;return x.jsx(Le.svg,{...s,ref:t,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:x.jsx("polygon",{points:"0,0 30,0 15,10"})})});pC.displayName=t6;var r6=pC;function mC(e){const[t,r]=_.useState(void 0);return Sr(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;r({width:a,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var Y1="Popper",[gC,lc]=ua(Y1),[n6,vC]=gC(Y1),xC=e=>{const{__scopePopper:t,children:r}=e,[n,i]=_.useState(null);return x.jsx(n6,{scope:t,anchor:n,onAnchorChange:i,children:r})};xC.displayName=Y1;var yC="PopperAnchor",wC=_.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...i}=e,s=vC(yC,r),a=_.useRef(null),o=Je(t,a);return _.useEffect(()=>{s.onAnchorChange((n==null?void 0:n.current)||a.current)}),n?null:x.jsx(Le.div,{...i,ref:o})});wC.displayName=yC;var Q1="PopperContent",[i6,s6]=gC(Q1),bC=_.forwardRef((e,t)=>{var te,oe,le,ne,he,F;const{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...h}=e,g=vC(Q1,r),[v,w]=_.useState(null),y=Je(t,Se=>w(Se)),[b,E]=_.useState(null),k=mC(b),S=(k==null?void 0:k.width)??0,C=(k==null?void 0:k.height)??0,T=n+(s!=="center"?"-"+s:""),P=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},I=Array.isArray(c)?c:[c],R=I.length>0,H={padding:P,boundary:I.filter(o6),altBoundary:R},{refs:q,floatingStyles:X,placement:K,isPositioned:Q,middlewareData:G}=G8({strategy:"fixed",placement:T,whileElementsMounted:(...Se)=>z8(...Se,{animationFrame:p==="always"}),elements:{reference:g.anchor},middleware:[q8({mainAxis:i+C,alignmentAxis:a}),l&&X8({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Y8():void 0,...H}),l&&Q8({...H}),J8({...H,apply:({elements:Se,rects:Ee,availableWidth:Fe,availableHeight:ke})=>{const{width:fe,height:tt}=Ee.reference,St=Se.floating.style;St.setProperty("--radix-popper-available-width",`${Fe}px`),St.setProperty("--radix-popper-available-height",`${ke}px`),St.setProperty("--radix-popper-anchor-width",`${fe}px`),St.setProperty("--radix-popper-anchor-height",`${tt}px`)}}),b&&e6({element:b,padding:o}),l6({arrowWidth:S,arrowHeight:C}),f&&Z8({strategy:"referenceHidden",...H})]}),[z,ie]=EC(K),ae=cn(m);Sr(()=>{Q&&(ae==null||ae())},[Q,ae]);const D=(te=G.arrow)==null?void 0:te.x,V=(oe=G.arrow)==null?void 0:oe.y,B=((le=G.arrow)==null?void 0:le.centerOffset)!==0,[U,Y]=_.useState();return Sr(()=>{v&&Y(window.getComputedStyle(v).zIndex)},[v]),x.jsx("div",{ref:q.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:Q?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:U,"--radix-popper-transform-origin":[(ne=G.transformOrigin)==null?void 0:ne.x,(he=G.transformOrigin)==null?void 0:he.y].join(" "),...((F=G.hide)==null?void 0:F.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:x.jsx(i6,{scope:r,placedSide:z,onArrowChange:E,arrowX:D,arrowY:V,shouldHideArrow:B,children:x.jsx(Le.div,{"data-side":z,"data-align":ie,...h,ref:y,style:{...h.style,animation:Q?void 0:"none"}})})})});bC.displayName=Q1;var _C="PopperArrow",a6={top:"bottom",right:"left",bottom:"top",left:"right"},SC=_.forwardRef(function(t,r){const{__scopePopper:n,...i}=t,s=s6(_C,n),a=a6[s.placedSide];return x.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:x.jsx(r6,{...i,ref:r,style:{...i.style,display:"block"}})})});SC.displayName=_C;function o6(e){return e!==null}var l6=e=>({name:"transformOrigin",options:e,fn(t){var g,v,w;const{placement:r,rects:n,middlewareData:i}=t,a=((g=i.arrow)==null?void 0:g.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=EC(r),d={start:"0%",center:"50%",end:"100%"}[u],f=(((v=i.arrow)==null?void 0:v.x)??0)+o/2,p=(((w=i.arrow)==null?void 0:w.y)??0)+l/2;let m="",h="";return c==="bottom"?(m=a?d:`${f}px`,h=`${-l}px`):c==="top"?(m=a?d:`${f}px`,h=`${n.floating.height+l}px`):c==="right"?(m=`${-l}px`,h=a?d:`${p}px`):c==="left"&&(m=`${n.floating.width+l}px`,h=a?d:`${p}px`),{data:{x:m,y:h}}}});function EC(e){const[t,r="center"]=e.split("-");return[t,r]}var J1=xC,N0=wC,Z1=bC,ex=SC,[F0,CJ]=ua("Tooltip",[lc]),M0=lc(),TC="TooltipProvider",c6=700,Kg="tooltip.open",[u6,tx]=F0(TC),kC=e=>{const{__scopeTooltip:t,delayDuration:r=c6,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:s}=e,a=_.useRef(!0),o=_.useRef(!1),l=_.useRef(0);return _.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),x.jsx(u6,{scope:t,isOpenDelayedRef:a,delayDuration:r,onOpen:_.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:_.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:_.useCallback(c=>{o.current=c},[]),disableHoverableContent:i,children:s})};kC.displayName=TC;var L0="Tooltip",[d6,z0]=F0(L0),CC=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:i=!1,onOpenChange:s,disableHoverableContent:a,delayDuration:o}=e,l=tx(L0,e.__scopeTooltip),c=M0(t),[u,d]=_.useState(null),f=Xs(),p=_.useRef(0),m=a??l.disableHoverableContent,h=o??l.delayDuration,g=_.useRef(!1),[v=!1,w]=fo({prop:n,defaultProp:i,onChange:S=>{S?(l.onOpen(),document.dispatchEvent(new CustomEvent(Kg))):l.onClose(),s==null||s(S)}}),y=_.useMemo(()=>v?g.current?"delayed-open":"instant-open":"closed",[v]),b=_.useCallback(()=>{window.clearTimeout(p.current),p.current=0,g.current=!1,w(!0)},[w]),E=_.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),k=_.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{g.current=!0,w(!0),p.current=0},h)},[h,w]);return _.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),x.jsx(J1,{...c,children:x.jsx(d6,{scope:t,contentId:f,open:v,stateAttribute:y,trigger:u,onTriggerChange:d,onTriggerEnter:_.useCallback(()=>{l.isOpenDelayedRef.current?k():b()},[l.isOpenDelayedRef,k,b]),onTriggerLeave:_.useCallback(()=>{m?E():(window.clearTimeout(p.current),p.current=0)},[E,m]),onOpen:b,onClose:E,disableHoverableContent:m,children:r})})};CC.displayName=L0;var qg="TooltipTrigger",AC=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,i=z0(qg,r),s=tx(qg,r),a=M0(r),o=_.useRef(null),l=Je(t,o,i.onTriggerChange),c=_.useRef(!1),u=_.useRef(!1),d=_.useCallback(()=>c.current=!1,[]);return _.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),x.jsx(N0,{asChild:!0,...a,children:x.jsx(Le.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...n,ref:l,onPointerMove:Re(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:Re(e.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:Re(e.onPointerDown,()=>{i.open&&i.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Re(e.onFocus,()=>{c.current||i.onOpen()}),onBlur:Re(e.onBlur,i.onClose),onClick:Re(e.onClick,i.onClose)})})});AC.displayName=qg;var f6="TooltipPortal",[AJ,h6]=F0(f6,{forceMount:void 0}),Hl="TooltipContent",RC=_.forwardRef((e,t)=>{const r=h6(Hl,e.__scopeTooltip),{forceMount:n=r.forceMount,side:i="top",...s}=e,a=z0(Hl,e.__scopeTooltip);return x.jsx(as,{present:n||a.open,children:a.disableHoverableContent?x.jsx(PC,{side:i,...s,ref:t}):x.jsx(p6,{side:i,...s,ref:t})})}),p6=_.forwardRef((e,t)=>{const r=z0(Hl,e.__scopeTooltip),n=tx(Hl,e.__scopeTooltip),i=_.useRef(null),s=Je(t,i),[a,o]=_.useState(null),{trigger:l,onClose:c}=r,u=i.current,{onPointerInTransitChange:d}=n,f=_.useCallback(()=>{o(null),d(!1)},[d]),p=_.useCallback((m,h)=>{const g=m.currentTarget,v={x:m.clientX,y:m.clientY},w=y6(v,g.getBoundingClientRect()),y=w6(v,w),b=b6(h.getBoundingClientRect()),E=S6([...y,...b]);o(E),d(!0)},[d]);return _.useEffect(()=>()=>f(),[f]),_.useEffect(()=>{if(l&&u){const m=g=>p(g,u),h=g=>p(g,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",h),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",h)}}},[l,u,p,f]),_.useEffect(()=>{if(a){const m=h=>{const g=h.target,v={x:h.clientX,y:h.clientY},w=(l==null?void 0:l.contains(g))||(u==null?void 0:u.contains(g)),y=!_6(v,a);w?f():y&&(f(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,a,c,f]),x.jsx(PC,{...e,ref:s})}),[m6,g6]=F0(L0,{isInside:!1}),v6=f5("TooltipContent"),PC=_.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:a,...o}=e,l=z0(Hl,r),c=M0(r),{onClose:u}=l;return _.useEffect(()=>(document.addEventListener(Kg,u),()=>document.removeEventListener(Kg,u)),[u]),_.useEffect(()=>{if(l.trigger){const d=f=>{const p=f.target;p!=null&&p.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),x.jsx(ic,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:x.jsxs(Z1,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[x.jsx(v6,{children:n}),x.jsx(m6,{scope:r,isInside:!0,children:x.jsx(I5,{id:l.contentId,role:"tooltip",children:i||n})})]})})});RC.displayName=Hl;var OC="TooltipArrow",x6=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,i=M0(r);return g6(OC,r).isInside?null:x.jsx(ex,{...i,...n,ref:t})});x6.displayName=OC;function y6(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),i=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,n,i,s)){case s:return"left";case i:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function w6(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function b6(e){const{top:t,right:r,bottom:n,left:i}=e;return[{x:i,y:t},{x:r,y:t},{x:r,y:n},{x:i,y:n}]}function _6(e,t){const{x:r,y:n}=e;let i=!1;for(let s=0,a=t.length-1;s<t.length;a=s++){const o=t[s].x,l=t[s].y,c=t[a].x,u=t[a].y;l>n!=u>n&&r<(c-o)*(n-l)/(u-l)+o&&(i=!i)}return i}function S6(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),E6(t)}function E6(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const i=e[n];for(;t.length>=2;){const s=t[t.length-1],a=t[t.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))t.pop();else break}t.push(i)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const i=e[n];for(;r.length>=2;){const s=r[r.length-1],a=r[r.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))r.pop();else break}r.push(i)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var T6=kC,k6=CC,C6=AC,IC=RC;const DC=T6,A6=k6,R6=C6,NC=_.forwardRef(({className:e,sideOffset:t=4,...r},n)=>x.jsx(IC,{ref:n,sideOffset:t,className:_e("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...r}));NC.displayName=IC.displayName;const Hp=768;function P6(){const[e,t]=_.useState(void 0);return _.useEffect(()=>{const r=window.matchMedia(`(max-width: ${Hp-1}px)`),n=()=>{t(window.innerWidth<Hp)};return r.addEventListener("change",n),t(window.innerWidth<Hp),()=>r.removeEventListener("change",n)},[]),!!e}const O6=So("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent",link:"text-primary underline-offset-4 hover:underline"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ir=_.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},s)=>{const a=n?xk:"button";return x.jsx(a,{className:_e(O6({variant:t,size:r,className:e})),ref:s,...i})});ir.displayName="Button";const Ei=_.forwardRef(({className:e,type:t,...r},n)=>x.jsx("input",{type:t,className:_e("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Ei.displayName="Input";var I6="Separator",s2="horizontal",D6=["horizontal","vertical"],FC=_.forwardRef((e,t)=>{const{decorative:r,orientation:n=s2,...i}=e,s=N6(n)?n:s2,o=r?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return x.jsx(Le.div,{"data-orientation":s,...o,...i,ref:t})});FC.displayName=I6;function N6(e){return D6.includes(e)}var MC=FC;const LC=_.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},i)=>x.jsx(MC,{ref:i,decorative:r,orientation:t,className:_e("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));LC.displayName=MC.displayName;var Wp="focusScope.autoFocusOnMount",Gp="focusScope.autoFocusOnUnmount",a2={bubbles:!1,cancelable:!0},F6="FocusScope",j0=_.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=e,[o,l]=_.useState(null),c=cn(i),u=cn(s),d=_.useRef(null),f=Je(t,h=>l(h)),p=_.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;_.useEffect(()=>{if(n){let h=function(y){if(p.paused||!o)return;const b=y.target;o.contains(b)?d.current=b:ms(d.current,{select:!0})},g=function(y){if(p.paused||!o)return;const b=y.relatedTarget;b!==null&&(o.contains(b)||ms(d.current,{select:!0}))},v=function(y){if(document.activeElement===document.body)for(const E of y)E.removedNodes.length>0&&ms(o)};document.addEventListener("focusin",h),document.addEventListener("focusout",g);const w=new MutationObserver(v);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",h),document.removeEventListener("focusout",g),w.disconnect()}}},[n,o,p.paused]),_.useEffect(()=>{if(o){l2.add(p);const h=document.activeElement;if(!o.contains(h)){const v=new CustomEvent(Wp,a2);o.addEventListener(Wp,c),o.dispatchEvent(v),v.defaultPrevented||(M6(U6(zC(o)),{select:!0}),document.activeElement===h&&ms(o))}return()=>{o.removeEventListener(Wp,c),setTimeout(()=>{const v=new CustomEvent(Gp,a2);o.addEventListener(Gp,u),o.dispatchEvent(v),v.defaultPrevented||ms(h??document.body,{select:!0}),o.removeEventListener(Gp,u),l2.remove(p)},0)}}},[o,c,u,p]);const m=_.useCallback(h=>{if(!r&&!n||p.paused)return;const g=h.key==="Tab"&&!h.altKey&&!h.ctrlKey&&!h.metaKey,v=document.activeElement;if(g&&v){const w=h.currentTarget,[y,b]=L6(w);y&&b?!h.shiftKey&&v===b?(h.preventDefault(),r&&ms(y,{select:!0})):h.shiftKey&&v===y&&(h.preventDefault(),r&&ms(b,{select:!0})):v===w&&h.preventDefault()}},[r,n,p.paused]);return x.jsx(Le.div,{tabIndex:-1,...a,ref:f,onKeyDown:m})});j0.displayName=F6;function M6(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ms(n,{select:t}),document.activeElement!==r)return}function L6(e){const t=zC(e),r=o2(t,e),n=o2(t.reverse(),e);return[r,n]}function zC(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function o2(e,t){for(const r of e)if(!z6(r,{upTo:t}))return r}function z6(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function j6(e){return e instanceof HTMLInputElement&&"select"in e}function ms(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&j6(e)&&t&&e.select()}}var l2=B6();function B6(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=c2(e,t),e.unshift(t)},remove(t){var r;e=c2(e,t),(r=e[0])==null||r.resume()}}}function c2(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function U6(e){return e.filter(t=>t.tagName!=="A")}var Kp=0;function rx(){_.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??u2()),document.body.insertAdjacentElement("beforeend",e[1]??u2()),Kp++,()=>{Kp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Kp--}},[])}function u2(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Xg=function(e,t){return Xg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Xg(e,t)};function jC(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Xg(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var En=function(){return En=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},En.apply(this,arguments)};function da(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function BC(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function UC(e,t){return function(r,n){t(r,n,e)}}function $C(e,t,r,n,i,s){function a(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var o=n.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?n.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),d,f=!1,p=r.length-1;p>=0;p--){var m={};for(var h in n)m[h]=h==="access"?{}:n[h];for(var h in n.access)m.access[h]=n.access[h];m.addInitializer=function(v){if(f)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(v||null))};var g=(0,r[p])(o==="accessor"?{get:u.get,set:u.set}:u[l],m);if(o==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(d=a(g.get))&&(u.get=d),(d=a(g.set))&&(u.set=d),(d=a(g.init))&&i.unshift(d)}else(d=a(g))&&(o==="field"?i.unshift(d):u[l]=d)}c&&Object.defineProperty(c,n.name,u),f=!0}function VC(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function HC(e){return typeof e=="symbol"?e:"".concat(e)}function WC(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function GC(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function we(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})}function KC(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){r.label=c[1];break}if(c[0]===6&&r.label<s[1]){r.label=s[1],s=c;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(c);break}s[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var B0=Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function qC(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&B0(t,e,r)}function Bh(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function nx(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function XC(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(nx(arguments[t]));return e}function YC(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n}function ix(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function Wl(e){return this instanceof Wl?(this.v=e,this):new Wl(e)}function QC(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(p){return function(m){return Promise.resolve(m).then(p,d)}}function o(p,m){n[p]&&(i[p]=function(h){return new Promise(function(g,v){s.push([p,h,g,v])>1||l(p,h)})},m&&(i[p]=m(i[p])))}function l(p,m){try{c(n[p](m))}catch(h){f(s[0][3],h)}}function c(p){p.value instanceof Wl?Promise.resolve(p.value.v).then(u,d):f(s[0][2],p)}function u(p){l("next",p)}function d(p){l("throw",p)}function f(p,m){p(m),s.shift(),s.length&&l(s[0][0],s[0][1])}}function JC(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:Wl(e[i](a)),done:!1}:s?s(a):a}:s}}function ZC(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Bh=="function"?Bh(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(o,l){a=e[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(c){s({value:c,done:o})},a)}}function eA(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var $6=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Yg=function(e){return Yg=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Yg(e)};function tA(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Yg(e),n=0;n<r.length;n++)r[n]!=="default"&&B0(t,e,r[n]);return $6(t,e),t}function rA(e){return e&&e.__esModule?e:{default:e}}function nA(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function iA(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function sA(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function aA(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var V6=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function oA(e){function t(s){e.error=e.hasError?new V6(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var r,n=0;function i(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,function(a){return t(a),i()})}else n|=1}catch(a){t(a)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function lA(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,s,a){return n?t?".jsx":".js":i&&(!s||!a)?r:i+s+"."+a.toLowerCase()+"js"}):e}const H6={__extends:jC,__assign:En,__rest:da,__decorate:BC,__param:UC,__esDecorate:$C,__runInitializers:VC,__propKey:HC,__setFunctionName:WC,__metadata:GC,__awaiter:we,__generator:KC,__createBinding:B0,__exportStar:qC,__values:Bh,__read:nx,__spread:XC,__spreadArrays:YC,__spreadArray:ix,__await:Wl,__asyncGenerator:QC,__asyncDelegator:JC,__asyncValues:ZC,__makeTemplateObject:eA,__importStar:tA,__importDefault:rA,__classPrivateFieldGet:nA,__classPrivateFieldSet:iA,__classPrivateFieldIn:sA,__addDisposableResource:aA,__disposeResources:oA,__rewriteRelativeImportExtension:lA},W6=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:aA,get __assign(){return En},__asyncDelegator:JC,__asyncGenerator:QC,__asyncValues:ZC,__await:Wl,__awaiter:we,__classPrivateFieldGet:nA,__classPrivateFieldIn:sA,__classPrivateFieldSet:iA,__createBinding:B0,__decorate:BC,__disposeResources:oA,__esDecorate:$C,__exportStar:qC,__extends:jC,__generator:KC,__importDefault:rA,__importStar:tA,__makeTemplateObject:eA,__metadata:GC,__param:UC,__propKey:HC,__read:nx,__rest:da,__rewriteRelativeImportExtension:lA,__runInitializers:VC,__setFunctionName:WC,__spread:XC,__spreadArray:ix,__spreadArrays:YC,__values:Bh,default:H6},Symbol.toStringTag,{value:"Module"}));var eh="right-scroll-bar-position",th="width-before-scroll-bar",G6="with-scroll-bars-hidden",K6="--removed-body-scroll-bar-size";function qp(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function q6(e,t){var r=_.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var X6=typeof window<"u"?_.useLayoutEffect:_.useEffect,d2=new WeakMap;function Y6(e,t){var r=q6(null,function(n){return e.forEach(function(i){return qp(i,n)})});return X6(function(){var n=d2.get(r);if(n){var i=new Set(n),s=new Set(e),a=r.current;i.forEach(function(o){s.has(o)||qp(o,null)}),s.forEach(function(o){i.has(o)||qp(o,a)})}d2.set(r,e)},[e]),r}function Q6(e){return e}function J6(e,t){t===void 0&&(t=Q6);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var a=t(s,n);return r.push(a),function(){r=r.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(n=!0;r.length;){var a=r;r=[],a.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var a=[];if(r.length){var o=r;r=[],o.forEach(s),a=r}var l=function(){var u=a;a=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),r}}}};return i}function Z6(e){e===void 0&&(e={});var t=J6(null);return t.options=En({async:!0,ssr:!1},e),t}var cA=function(e){var t=e.sideCar,r=da(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return _.createElement(n,En({},r))};cA.isSideCarExport=!0;function eM(e,t){return e.useMedium(t),cA}var uA=Z6(),Xp=function(){},U0=_.forwardRef(function(e,t){var r=_.useRef(null),n=_.useState({onScrollCapture:Xp,onWheelCapture:Xp,onTouchMoveCapture:Xp}),i=n[0],s=n[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,m=e.inert,h=e.allowPinchZoom,g=e.as,v=g===void 0?"div":g,w=e.gapMode,y=da(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=f,E=Y6([r,t]),k=En(En({},y),i);return _.createElement(_.Fragment,null,u&&_.createElement(b,{sideCar:uA,removeScrollBar:c,shards:d,noIsolation:p,inert:m,setCallbacks:s,allowPinchZoom:!!h,lockRef:r,gapMode:w}),a?_.cloneElement(_.Children.only(o),En(En({},k),{ref:E})):_.createElement(v,En({},k,{className:l,ref:E}),o))});U0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};U0.classNames={fullWidth:th,zeroRight:eh};var tM=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function rM(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=tM();return t&&e.setAttribute("nonce",t),e}function nM(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function iM(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var sM=function(){var e=0,t=null;return{add:function(r){e==0&&(t=rM())&&(nM(t,r),iM(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},aM=function(){var e=sM();return function(t,r){_.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},dA=function(){var e=aM(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t},oM={left:0,top:0,right:0,gap:0},Yp=function(e){return parseInt(e||"",10)||0},lM=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[Yp(r),Yp(n),Yp(i)]},cM=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return oM;var t=lM(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},uM=dA(),pl="data-scroll-locked",dM=function(e,t,r,n){var i=e.left,s=e.top,a=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(G6,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(pl,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(eh,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(th,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(eh," .").concat(eh,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(th," .").concat(th,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(pl,`] {
    `).concat(K6,": ").concat(o,`px;
  }
`)},f2=function(){var e=parseInt(document.body.getAttribute(pl)||"0",10);return isFinite(e)?e:0},fM=function(){_.useEffect(function(){return document.body.setAttribute(pl,(f2()+1).toString()),function(){var e=f2()-1;e<=0?document.body.removeAttribute(pl):document.body.setAttribute(pl,e.toString())}},[])},hM=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;fM();var s=_.useMemo(function(){return cM(i)},[i]);return _.createElement(uM,{styles:dM(s,!t,i,r?"":"!important")})},Qg=!1;if(typeof window<"u")try{var Zd=Object.defineProperty({},"passive",{get:function(){return Qg=!0,!0}});window.addEventListener("test",Zd,Zd),window.removeEventListener("test",Zd,Zd)}catch{Qg=!1}var Io=Qg?{passive:!1}:!1,pM=function(e){return e.tagName==="TEXTAREA"},fA=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!pM(e)&&r[t]==="visible")},mM=function(e){return fA(e,"overflowY")},gM=function(e){return fA(e,"overflowX")},h2=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=hA(e,n);if(i){var s=pA(e,n),a=s[1],o=s[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},vM=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},xM=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},hA=function(e,t){return e==="v"?mM(t):gM(t)},pA=function(e,t){return e==="v"?vM(t):xM(t)},yM=function(e,t){return e==="h"&&t==="rtl"?-1:1},wM=function(e,t,r,n,i){var s=yM(e,window.getComputedStyle(t).direction),a=s*n,o=r.target,l=t.contains(o),c=!1,u=a>0,d=0,f=0;do{var p=pA(e,o),m=p[0],h=p[1],g=p[2],v=h-g-s*m;(m||v)&&hA(e,o)&&(d+=v,f+=m),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&(Math.abs(d)<1||!i)||!u&&(Math.abs(f)<1||!i))&&(c=!0),c},ef=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},p2=function(e){return[e.deltaX,e.deltaY]},m2=function(e){return e&&"current"in e?e.current:e},bM=function(e,t){return e[0]===t[0]&&e[1]===t[1]},_M=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},SM=0,Do=[];function EM(e){var t=_.useRef([]),r=_.useRef([0,0]),n=_.useRef(),i=_.useState(SM++)[0],s=_.useState(dA)[0],a=_.useRef(e);_.useEffect(function(){a.current=e},[e]),_.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var h=ix([e.lockRef.current],(e.shards||[]).map(m2),!0).filter(Boolean);return h.forEach(function(g){return g.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),h.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=_.useCallback(function(h,g){if("touches"in h&&h.touches.length===2||h.type==="wheel"&&h.ctrlKey)return!a.current.allowPinchZoom;var v=ef(h),w=r.current,y="deltaX"in h?h.deltaX:w[0]-v[0],b="deltaY"in h?h.deltaY:w[1]-v[1],E,k=h.target,S=Math.abs(y)>Math.abs(b)?"h":"v";if("touches"in h&&S==="h"&&k.type==="range")return!1;var C=h2(S,k);if(!C)return!0;if(C?E=S:(E=S==="v"?"h":"v",C=h2(S,k)),!C)return!1;if(!n.current&&"changedTouches"in h&&(y||b)&&(n.current=E),!E)return!0;var T=n.current||E;return wM(T,g,h,T==="h"?y:b,!0)},[]),l=_.useCallback(function(h){var g=h;if(!(!Do.length||Do[Do.length-1]!==s)){var v="deltaY"in g?p2(g):ef(g),w=t.current.filter(function(E){return E.name===g.type&&(E.target===g.target||g.target===E.shadowParent)&&bM(E.delta,v)})[0];if(w&&w.should){g.cancelable&&g.preventDefault();return}if(!w){var y=(a.current.shards||[]).map(m2).filter(Boolean).filter(function(E){return E.contains(g.target)}),b=y.length>0?o(g,y[0]):!a.current.noIsolation;b&&g.cancelable&&g.preventDefault()}}},[]),c=_.useCallback(function(h,g,v,w){var y={name:h,delta:g,target:v,should:w,shadowParent:TM(v)};t.current.push(y),setTimeout(function(){t.current=t.current.filter(function(b){return b!==y})},1)},[]),u=_.useCallback(function(h){r.current=ef(h),n.current=void 0},[]),d=_.useCallback(function(h){c(h.type,p2(h),h.target,o(h,e.lockRef.current))},[]),f=_.useCallback(function(h){c(h.type,ef(h),h.target,o(h,e.lockRef.current))},[]);_.useEffect(function(){return Do.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Io),document.addEventListener("touchmove",l,Io),document.addEventListener("touchstart",u,Io),function(){Do=Do.filter(function(h){return h!==s}),document.removeEventListener("wheel",l,Io),document.removeEventListener("touchmove",l,Io),document.removeEventListener("touchstart",u,Io)}},[]);var p=e.removeScrollBar,m=e.inert;return _.createElement(_.Fragment,null,m?_.createElement(s,{styles:_M(i)}):null,p?_.createElement(hM,{gapMode:e.gapMode}):null)}function TM(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const kM=eM(uA,EM);var $0=_.forwardRef(function(e,t){return _.createElement(U0,En({},e,{ref:t,sideCar:kM}))});$0.classNames=U0.classNames;var CM=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},No=new WeakMap,tf=new WeakMap,rf={},Qp=0,mA=function(e){return e&&(e.host||mA(e.parentNode))},AM=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=mA(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},RM=function(e,t,r,n){var i=AM(t,Array.isArray(e)?e:[e]);rf[r]||(rf[r]=new WeakMap);var s=rf[r],a=[],o=new Set,l=new Set(i),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(o.has(f))u(f);else try{var p=f.getAttribute(n),m=p!==null&&p!=="false",h=(No.get(f)||0)+1,g=(s.get(f)||0)+1;No.set(f,h),s.set(f,g),a.push(f),h===1&&m&&tf.set(f,!0),g===1&&f.setAttribute(r,"true"),m||f.setAttribute(n,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return u(t),o.clear(),Qp++,function(){a.forEach(function(d){var f=No.get(d)-1,p=s.get(d)-1;No.set(d,f),s.set(d,p),f||(tf.has(d)||d.removeAttribute(n),tf.delete(d)),p||d.removeAttribute(r)}),Qp--,Qp||(No=new WeakMap,No=new WeakMap,tf=new WeakMap,rf={})}},sx=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=CM(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),RM(n,i,r,"aria-hidden")):function(){return null}},ax="Dialog",[gA,RJ]=ua(ax),[PM,oi]=gA(ax),vA=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:i,onOpenChange:s,modal:a=!0}=e,o=_.useRef(null),l=_.useRef(null),[c=!1,u]=fo({prop:n,defaultProp:i,onChange:s});return x.jsx(PM,{scope:t,triggerRef:o,contentRef:l,contentId:Xs(),titleId:Xs(),descriptionId:Xs(),open:c,onOpenChange:u,onOpenToggle:_.useCallback(()=>u(d=>!d),[u]),modal:a,children:r})};vA.displayName=ax;var xA="DialogTrigger",OM=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=oi(xA,r),s=Je(t,i.triggerRef);return x.jsx(Le.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":cx(i.open),...n,ref:s,onClick:Re(e.onClick,i.onOpenToggle)})});OM.displayName=xA;var ox="DialogPortal",[IM,yA]=gA(ox,{forceMount:void 0}),wA=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:i}=e,s=oi(ox,t);return x.jsx(IM,{scope:t,forceMount:r,children:_.Children.map(n,a=>x.jsx(as,{present:r||s.open,children:x.jsx(gd,{asChild:!0,container:i,children:a})}))})};wA.displayName=ox;var Uh="DialogOverlay",bA=_.forwardRef((e,t)=>{const r=yA(Uh,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,s=oi(Uh,e.__scopeDialog);return s.modal?x.jsx(as,{present:n||s.open,children:x.jsx(NM,{...i,ref:t})}):null});bA.displayName=Uh;var DM=uo("DialogOverlay.RemoveScroll"),NM=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=oi(Uh,r);return x.jsx($0,{as:DM,allowPinchZoom:!0,shards:[i.contentRef],children:x.jsx(Le.div,{"data-state":cx(i.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),po="DialogContent",_A=_.forwardRef((e,t)=>{const r=yA(po,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,s=oi(po,e.__scopeDialog);return x.jsx(as,{present:n||s.open,children:s.modal?x.jsx(FM,{...i,ref:t}):x.jsx(MM,{...i,ref:t})})});_A.displayName=po;var FM=_.forwardRef((e,t)=>{const r=oi(po,e.__scopeDialog),n=_.useRef(null),i=Je(t,r.contentRef,n);return _.useEffect(()=>{const s=n.current;if(s)return sx(s)},[]),x.jsx(SA,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(e.onCloseAutoFocus,s=>{var a;s.preventDefault(),(a=r.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Re(e.onPointerDownOutside,s=>{const a=s.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&s.preventDefault()}),onFocusOutside:Re(e.onFocusOutside,s=>s.preventDefault())})}),MM=_.forwardRef((e,t)=>{const r=oi(po,e.__scopeDialog),n=_.useRef(!1),i=_.useRef(!1);return x.jsx(SA,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((c=r.triggerRef.current)==null?void 0:c.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),SA=_.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:s,...a}=e,o=oi(po,r),l=_.useRef(null),c=Je(t,l);return rx(),x.jsxs(x.Fragment,{children:[x.jsx(j0,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:s,children:x.jsx(ic,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":cx(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),x.jsxs(x.Fragment,{children:[x.jsx(LM,{titleId:o.titleId}),x.jsx(jM,{contentRef:l,descriptionId:o.descriptionId})]})]})}),lx="DialogTitle",EA=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=oi(lx,r);return x.jsx(Le.h2,{id:i.titleId,...n,ref:t})});EA.displayName=lx;var TA="DialogDescription",kA=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=oi(TA,r);return x.jsx(Le.p,{id:i.descriptionId,...n,ref:t})});kA.displayName=TA;var CA="DialogClose",AA=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=oi(CA,r);return x.jsx(Le.button,{type:"button",...n,ref:t,onClick:Re(e.onClick,()=>i.onOpenChange(!1))})});AA.displayName=CA;function cx(e){return e?"open":"closed"}var RA="DialogTitleWarning",[PJ,PA]=c5(RA,{contentName:po,titleName:lx,docsSlug:"dialog"}),LM=({titleId:e})=>{const t=PA(RA),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return _.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},zM="DialogDescriptionWarning",jM=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${PA(zM).contentName}}.`;return _.useEffect(()=>{var s;const i=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},OA=vA,IA=wA,V0=bA,H0=_A,W0=EA,G0=kA,DA=AA;const BM=OA,UM=IA,NA=_.forwardRef(({className:e,...t},r)=>x.jsx(V0,{className:_e("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));NA.displayName=V0.displayName;const $M=So("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),FA=_.forwardRef(({side:e="right",className:t,children:r,...n},i)=>x.jsxs(UM,{children:[x.jsx(NA,{}),x.jsxs(H0,{ref:i,className:_e($M({side:e}),t),...n,children:[r,x.jsxs(DA,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[x.jsx(P0,{className:"h-4 w-4"}),x.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));FA.displayName=H0.displayName;const MA=({className:e,...t})=>x.jsx("div",{className:_e("flex flex-col space-y-2 text-center sm:text-left",e),...t});MA.displayName="SheetHeader";const LA=_.forwardRef(({className:e,...t},r)=>x.jsx(W0,{ref:r,className:_e("text-lg font-semibold text-foreground",e),...t}));LA.displayName=W0.displayName;const zA=_.forwardRef(({className:e,...t},r)=>x.jsx(G0,{ref:r,className:_e("text-sm text-muted-foreground",e),...t}));zA.displayName=G0.displayName;const VM="sidebar_state",HM=60*60*24*7,WM="16rem",GM="18rem",KM="3rem",qM="b",jA=_.createContext(null);function ux(){const e=_.useContext(jA);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}function XM({defaultOpen:e=!0,open:t,onOpenChange:r,className:n,style:i,children:s,...a}){const o=P6(),[l,c]=_.useState(!1),[u,d]=_.useState(e),f=t??u,p=_.useCallback(v=>{const w=typeof v=="function"?v(f):v;r?r(w):d(w),document.cookie=`${VM}=${w}; path=/; max-age=${HM}`},[r,f]),m=_.useCallback(()=>o?c(v=>!v):p(v=>!v),[o,p,c]);_.useEffect(()=>{const v=w=>{w.key===qM&&(w.metaKey||w.ctrlKey)&&(w.preventDefault(),m())};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[m]);const h=f?"expanded":"collapsed",g=_.useMemo(()=>({state:h,open:f,setOpen:p,isMobile:o,openMobile:l,setOpenMobile:c,toggleSidebar:m}),[h,f,p,o,l,c,m]);return x.jsx(jA.Provider,{value:g,children:x.jsx(DC,{delayDuration:0,children:x.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":WM,"--sidebar-width-icon":KM,...i},className:_e("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",n),...a,children:s})})})}function YM({side:e="left",variant:t="sidebar",collapsible:r="offcanvas",className:n,children:i,...s}){const{isMobile:a,state:o,openMobile:l,setOpenMobile:c}=ux();return r==="none"?x.jsx("div",{"data-slot":"sidebar",className:_e("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",n),...s,children:i}):a?x.jsx(BM,{open:l,onOpenChange:c,...s,children:x.jsxs(FA,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden",style:{"--sidebar-width":GM},side:e,children:[x.jsxs(MA,{className:"sr-only",children:[x.jsx(LA,{children:"Sidebar"}),x.jsx(zA,{children:"Displays the mobile sidebar."})]}),x.jsx("div",{className:"flex h-full w-full flex-col",children:i})]})}):x.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":o,"data-collapsible":o==="collapsed"?r:"","data-variant":t,"data-side":e,"data-slot":"sidebar",children:[x.jsx("div",{"data-slot":"sidebar-gap",className:_e("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]")}),x.jsx("div",{"data-slot":"sidebar-container",className:_e("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...s,children:x.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:i})})]})}function BA({className:e,onClick:t,...r}){const{toggleSidebar:n}=ux();return x.jsxs(ir,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:_e("h-7 w-7",e),onClick:i=>{t==null||t(i),n()},...r,children:[x.jsx(mF,{}),x.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function QM({className:e,...t}){return x.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:_e("flex flex-col gap-2 p-2",e),...t})}function JM({className:e,...t}){return x.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:_e("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t})}function g2({className:e,...t}){return x.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:_e("relative flex w-full min-w-0 flex-col p-2",e),...t})}function v2({className:e,...t}){return x.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:_e("w-full text-sm",e),...t})}function x2({className:e,...t}){return x.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:_e("flex w-full min-w-0 flex-col gap-1",e),...t})}function y2({className:e,...t}){return x.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:_e("group/menu-item relative",e),...t})}const ZM=So("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function w2({asChild:e=!1,isActive:t=!1,variant:r="default",size:n="default",tooltip:i,className:s,...a}){const o=e?xk:"button",{isMobile:l,state:c}=ux(),u=x.jsx(o,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":n,"data-active":t,className:_e(ZM({variant:r,size:n}),s),...a});return i?(typeof i=="string"&&(i={children:i}),x.jsxs(A6,{children:[x.jsx(R6,{asChild:!0,children:u}),x.jsx(NC,{side:"right",align:"center",hidden:c!=="collapsed"||l,...i})]})):u}const eL=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class dx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class tL extends dx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class b2 extends dx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class _2 extends dx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Jg;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Jg||(Jg={}));class rL{constructor(t,{headers:r={},customFetch:n,region:i=Jg.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=eL(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return we(this,arguments,void 0,function*(r,n={}){var i;let s,a;try{const{headers:o,method:l,body:c,signal:u,timeout:d}=n;let f={},{region:p}=n;p||(p=this.region);const m=new URL(`${this.url}/${r}`);p&&p!=="any"&&(f["x-region"]=p,m.searchParams.set("forceFunctionRegion",p));let h;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",h=c):typeof c=="string"?(f["Content-Type"]="text/plain",h=c):typeof FormData<"u"&&c instanceof FormData?h=c:(f["Content-Type"]="application/json",h=JSON.stringify(c)):h=c;let g=u;d&&(a=new AbortController,s=setTimeout(()=>a.abort(),d),u?(g=a.signal,u.addEventListener("abort",()=>a.abort())):g=a.signal);const v=yield this.fetch(m.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:h,signal:g}).catch(E=>{throw new tL(E)}),w=v.headers.get("x-relay-error");if(w&&w==="true")throw new b2(v);if(!v.ok)throw new _2(v);let y=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield v.json():y==="application/octet-stream"||y==="application/pdf"?b=yield v.blob():y==="text/event-stream"?b=v:y==="multipart/form-data"?b=yield v.formData():b=yield v.text(),{data:b,error:null,response:v}}catch(o){return{data:null,error:o,response:o instanceof _2||o instanceof b2?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var Or={};const cc=_I(W6);var nf={},sf={},af={},of={},lf={},cf={},S2;function UA(){if(S2)return cf;S2=1,Object.defineProperty(cf,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return cf.default=e,cf}var E2;function $A(){if(E2)return lf;E2=1,Object.defineProperty(lf,"__esModule",{value:!0});const t=cc.__importDefault(UA());class r{constructor(i){var s,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let o=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,u,d,f;let p=null,m=null,h=null,g=l.status,v=l.statusText;if(l.ok){if(this.method!=="HEAD"){const E=await l.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?m=E:m=JSON.parse(E))}const y=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),b=(d=l.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");y&&b&&b.length>1&&(h=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(p={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,h=null,g=406,v="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const y=await l.text();try{p=JSON.parse(y),Array.isArray(p)&&l.status===404&&(m=[],p=null,g=200,v="OK")}catch{l.status===404&&y===""?(g=204,v="No Content"):p={message:y}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,g=200,v="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:m,count:h,status:g,statusText:v}});return this.shouldThrowOnError||(o=o.catch(l=>{var c,u,d;return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(u=l==null?void 0:l.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(d=l==null?void 0:l.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),o.then(i,s)}returns(){return this}overrideTypes(){return this}}return lf.default=r,lf}var T2;function VA(){if(T2)return of;T2=1,Object.defineProperty(of,"__esModule",{value:!0});const t=cc.__importDefault($A());class r extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this.url.searchParams.set(c,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const d=[i?"analyze":null,s?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${f}"; options=${d};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return of.default=r,of}var k2;function fx(){if(k2)return af;k2=1,Object.defineProperty(af,"__esModule",{value:!0});const t=cc.__importDefault(VA()),r=new RegExp("[,()]");class n extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&r.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:o,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const u=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${c}fts${u}.${a}`),this}match(s){return Object.entries(s).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(s,a,o){return this.url.searchParams.append(s,`not.${a}.${o}`),this}or(s,{foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${s})`),this}filter(s,a,o){return this.url.searchParams.append(s,`${a}.${o}`),this}}return af.default=n,af}var C2;function HA(){if(C2)return sf;C2=1,Object.defineProperty(sf,"__esModule",{value:!0});const t=cc.__importDefault(fx());class r{constructor(i,{headers:s={},schema:a,fetch:o}){this.url=i,this.headers=new Headers(s),this.schema=a,this.fetch=o}select(i,s){const{head:a=!1,count:o}=s??{},l=a?"HEAD":"GET";let c=!1;const u=(i??"*").split("").map(d=>/\s/.test(d)&&!c?"":(d==='"'&&(c=!c),d)).join("");return this.url.searchParams.set("select",u),o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const c=i.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(d.length>0){const f=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(i,{count:s}={}){var a;const o="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var s;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return sf.default=r,sf}var A2;function nL(){if(A2)return nf;A2=1,Object.defineProperty(nf,"__esModule",{value:!0});const e=cc,t=e.__importDefault(HA()),r=e.__importDefault(fx());class n{constructor(s,{headers:a={},schema:o,fetch:l}={}){this.url=s,this.headers=new Headers(a),this.schemaName=o,this.fetch=l}from(s){const a=new URL(`${this.url}/${s}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:o=!1,get:l=!1,count:c}={}){var u;let d;const f=new URL(`${this.url}/rpc/${s}`);let p;o||l?(d=o?"HEAD":"GET",Object.entries(a).filter(([h,g])=>g!==void 0).map(([h,g])=>[h,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([h,g])=>{f.searchParams.append(h,g)})):(d="POST",p=a);const m=new Headers(this.headers);return c&&m.set("Prefer",`count=${c}`),new r.default({method:d,url:f,headers:m,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return nf.default=n,nf}Object.defineProperty(Or,"__esModule",{value:!0});var WA=Or.PostgrestError=t4=Or.PostgrestBuilder=ZA=Or.PostgrestTransformBuilder=QA=Or.PostgrestFilterBuilder=XA=Or.PostgrestQueryBuilder=KA=Or.PostgrestClient=void 0;const uc=cc,GA=uc.__importDefault(nL());var KA=Or.PostgrestClient=GA.default;const qA=uc.__importDefault(HA());var XA=Or.PostgrestQueryBuilder=qA.default;const YA=uc.__importDefault(fx());var QA=Or.PostgrestFilterBuilder=YA.default;const JA=uc.__importDefault(VA());var ZA=Or.PostgrestTransformBuilder=JA.default;const e4=uc.__importDefault($A());var t4=Or.PostgrestBuilder=e4.default;const r4=uc.__importDefault(UA());WA=Or.PostgrestError=r4.default;var n4=Or.default={PostgrestClient:GA.default,PostgrestQueryBuilder:qA.default,PostgrestFilterBuilder:YA.default,PostgrestTransformBuilder:JA.default,PostgrestBuilder:e4.default,PostgrestError:r4.default};const iL=TS({__proto__:null,get PostgrestBuilder(){return t4},get PostgrestClient(){return KA},get PostgrestError(){return WA},get PostgrestFilterBuilder(){return QA},get PostgrestQueryBuilder(){return XA},get PostgrestTransformBuilder(){return ZA},default:n4},[Or]),{PostgrestClient:sL,PostgrestQueryBuilder:OJ,PostgrestFilterBuilder:IJ,PostgrestTransformBuilder:DJ,PostgrestBuilder:NJ,PostgrestError:FJ}=n4||iL;class aL{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const oL="2.81.1",lL=`realtime-js/${oL}`,i4="1.0.0",cL="2.0.0",R2=i4,Zg=1e4,uL=1e3,dL=100;var Oa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Oa||(Oa={}));var jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(jt||(jt={}));var bn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(bn||(bn={}));var ev;(function(e){e.websocket="websocket"})(ev||(ev={}));var Ia;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ia||(Ia={}));class fL{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,r){if(this._isArrayBuffer(t.payload))return r(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodePush(t){const{join_ref:r,ref:n,event:i,topic:s,payload:a}=t,o=this.META_LENGTH+r.length+n.length+s.length+i.length,l=new ArrayBuffer(this.HEADER_LENGTH+o);let c=new DataView(l),u=0;c.setUint8(u++,this.KINDS.push),c.setUint8(u++,r.length),c.setUint8(u++,n.length),c.setUint8(u++,s.length),c.setUint8(u++,i.length),Array.from(r,f=>c.setUint8(u++,f.charCodeAt(0))),Array.from(n,f=>c.setUint8(u++,f.charCodeAt(0))),Array.from(s,f=>c.setUint8(u++,f.charCodeAt(0))),Array.from(i,f=>c.setUint8(u++,f.charCodeAt(0)));var d=new Uint8Array(l.byteLength+a.byteLength);return d.set(new Uint8Array(l),0),d.set(new Uint8Array(a),l.byteLength),d.buffer}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const{join_ref:i,ref:s,topic:a}=t,o=t.payload.event,l=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0),c=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+a.length+o.length,u=new ArrayBuffer(this.HEADER_LENGTH+c);let d=new DataView(u),f=0;d.setUint8(f++,this.KINDS.userBroadcastPush),d.setUint8(f++,i.length),d.setUint8(f++,s.length),d.setUint8(f++,a.length),d.setUint8(f++,o.length),d.setUint8(f++,this.BINARY_ENCODING),Array.from(i,m=>d.setUint8(f++,m.charCodeAt(0))),Array.from(s,m=>d.setUint8(f++,m.charCodeAt(0))),Array.from(a,m=>d.setUint8(f++,m.charCodeAt(0))),Array.from(o,m=>d.setUint8(f++,m.charCodeAt(0)));var p=new Uint8Array(u.byteLength+l.byteLength);return p.set(new Uint8Array(u),0),p.set(new Uint8Array(l),u.byteLength),p.buffer}_encodeJsonUserBroadcastPush(t){var r,n;const{join_ref:i,ref:s,topic:a}=t,o=t.payload.event,l=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},u=new TextEncoder().encode(JSON.stringify(l)).buffer,d=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+s.length+a.length+o.length,f=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(f),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,i.length),p.setUint8(m++,s.length),p.setUint8(m++,a.length),p.setUint8(m++,o.length),p.setUint8(m++,this.JSON_ENCODING),Array.from(i,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(s,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(a,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(o,g=>p.setUint8(m++,g.charCodeAt(0)));var h=new Uint8Array(f.byteLength+u.byteLength);return h.set(new Uint8Array(f),0),h.set(new Uint8Array(u),f.byteLength),h.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,a,o,l]=n;return r({join_ref:i,ref:s,topic:a,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.push:return this._decodePush(t,r,i);case this.KINDS.reply:return this._decodeReply(t,r,i);case this.KINDS.broadcast:return this._decodeBroadcast(t,r,i);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodePush(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3);let o=this.HEADER_LENGTH+this.META_LENGTH-1;const l=n.decode(t.slice(o,o+i));o=o+i;const c=n.decode(t.slice(o,o+s));o=o+s;const u=n.decode(t.slice(o,o+a));o=o+a;const d=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{join_ref:l,ref:null,topic:c,event:u,payload:d}}_decodeReply(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+this.META_LENGTH;const c=n.decode(t.slice(l,l+i));l=l+i;const u=n.decode(t.slice(l,l+s));l=l+s;const d=n.decode(t.slice(l,l+a));l=l+a;const f=n.decode(t.slice(l,l+o));l=l+o;const p=JSON.parse(n.decode(t.slice(l,t.byteLength))),m={status:f,response:p};return{join_ref:c,ref:u,topic:d,event:bn.reply,payload:m}}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+i));a=a+i;const l=n.decode(t.slice(a,a+s));a=a+s;const c=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{join_ref:null,ref:null,topic:o,event:l,payload:c}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+i));l=l+i;const u=n.decode(t.slice(l,l+s));l=l+s;const d=n.decode(t.slice(l,l+a));l=l+a;const f=t.slice(l,t.byteLength),p=o===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,m={type:this.BROADCAST,event:u,payload:p};return a>0&&(m.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST,payload:m}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class s4{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(rt||(rt={}));const P2=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=hL(a,e,t,i),s),{}):{}},hL=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?a4(s,a):tv(a)},a4=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return vL(t,r)}switch(e){case rt.bool:return pL(t);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return mL(t);case rt.json:case rt.jsonb:return gL(t);case rt.timestamp:return xL(t);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return tv(t);default:return tv(t)}},tv=e=>e,pL=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},mL=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},gL=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},vL=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>a4(t,o))}return e},xL=e=>typeof e=="string"?e.replace(" ","T"):e,o4=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Jp{constructor(t,r,n={},i=Zg){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var O2;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(O2||(O2={}));class su{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=su.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=su.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=su.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const d=s[c];if(d){const f=u.map(g=>g.presence_ref),p=d.map(g=>g.presence_ref),m=u.filter(g=>p.indexOf(g.presence_ref)<0),h=d.filter(g=>f.indexOf(g.presence_ref)<0);m.length>0&&(o[c]=m),h.length>0&&(l[c]=h)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const d=t[o].map(p=>p.presence_ref),f=u.filter(p=>d.indexOf(p.presence_ref)<0);t[o].unshift(...f)}n(o,u,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),t[o]=c,i(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var I2;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(I2||(I2={}));var au;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(au||(au={}));var Bi;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Bi||(Bi={}));class hx{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Jp(this,bn.join,this.params,this.timeout),this.rejoinTimer=new s4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(bn.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new su(this),this.broadcastEndpointURL=o4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==jt.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[au.PRESENCE]&&this.bindings[au.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},f={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Bi.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Bi.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket.setAuth(),p===void 0){t==null||t(Bi.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,g=(m=h==null?void 0:h.length)!==null&&m!==void 0?m:0,v=[];for(let w=0;w<g;w++){const y=h[w],{filter:{event:b,schema:E,table:k,filter:S}}=y,C=p&&p[w];if(C&&C.event===b&&C.schema===E&&C.table===k&&C.filter===S)v.push(Object.assign(Object.assign({},y),{id:C.id}));else{this.unsubscribe(),this.state=jt.errored,t==null||t(Bi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Bi.SUBSCRIBED);return}}).receive("error",p=>{this.state=jt.errored,t==null||t(Bi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Bi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===jt.joined&&t===au.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(bn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Jp(this,bn.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Jp(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>dL){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=bn;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var m,h,g;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(h=p.filter)===null||h===void 0?void 0:h.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(p=>p.callback(f,n)):(s=this.bindings[a])===null||s===void 0||s.filter(p=>{var m,h,g,v,w,y;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const b=p.id,E=(m=p.filter)===null||m===void 0?void 0:m.event;return b&&((h=r.ids)===null||h===void 0?void 0:h.includes(b))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(w=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return b==="*"||b===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:h,table:g,commit_timestamp:v,type:w,errors:y}=m;f=Object.assign(Object.assign({},{schema:h,table:g,commit_timestamp:v,eventType:w,new:{},old:{},errors:y}),this._getPayloadRecords(m))}p.callback(f,n)})}_isClosed(){return this.state===jt.closed}_isJoined(){return this.state===jt.joined}_isJoining(){return this.state===jt.joining}_isLeaving(){return this.state===jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&hx.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(bn.close,{},t)}_onError(t){this._on(bn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=P2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=P2(t.columns,t.old_record)),r}}const Zp=()=>{},uf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},yL=[1e3,2e3,5e3,1e4],wL=1e4,bL=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _L{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zg,this.transport=null,this.heartbeatIntervalMs=uf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zp,this.ref=0,this.reconnectTimer=null,this.vsn=R2,this.logger=Zp,this.conn=null,this.sendBuffer=[],this.serializer=new fL,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ev.websocket}`,this.httpEndpoint=o4(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=aL.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Oa.connecting:return Ia.Connecting;case Oa.open:return Ia.Open;case Oa.closing:return Ia.Closing;default:return Ia.Closed}}isConnected(){return this.connectionState()===Ia.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new hx(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(uL,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},uf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Oa.open||this.conn.readyState===Oa.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(bn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([bL],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:lL};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(bn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new s4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},uf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,a,o,l,c,u,d,f,p;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Zg,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:uf.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Zp,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:R2,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:m=>yL[m-1]||wL,this.vsn){case i4:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(m,h)=>h(JSON.stringify(m)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:(m,h)=>h(JSON.parse(m));break;case cL:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=t==null?void 0:t.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class px extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function pt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class SL extends px{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class rv extends px{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const mx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),EL=()=>Response,nv=e=>{if(Array.isArray(e))return e.map(r=>nv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=nv(n)}),t},TL=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},em=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},kL=(e,t,r)=>we(void 0,void 0,void 0,function*(){const n=yield EL();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{const s=e.status||500,a=(i==null?void 0:i.statusCode)||s+"";t(new SL(em(i),s,a))}).catch(i=>{t(new rv(em(i),i))}):t(new rv(em(e),e))}),CL=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(TL(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function yd(e,t,r,n,i,s){return we(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,CL(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>kL(l,o,n))})})}function Bu(e,t,r,n){return we(this,void 0,void 0,function*(){return yd(e,"GET",t,r,n)})}function Wn(e,t,r,n,i){return we(this,void 0,void 0,function*(){return yd(e,"POST",t,n,i,r)})}function iv(e,t,r,n,i){return we(this,void 0,void 0,function*(){return yd(e,"PUT",t,n,i,r)})}function AL(e,t,r,n){return we(this,void 0,void 0,function*(){return yd(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function gx(e,t,r,n,i){return we(this,void 0,void 0,function*(){return yd(e,"DELETE",t,n,i,r)})}class RL{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return we(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pt(t))return{data:null,error:t};throw t}})}}var l4;class PL{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[l4]="BlobDownloadBuilder",this.promise=null}asStream(){return new RL(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return we(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pt(t))return{data:null,error:t};throw t}})}}l4=Symbol.toStringTag;const OL={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},D2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class IL{constructor(t,r={},n,i){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=mx(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,i){return we(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},D2),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),l&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),d=yield(t=="PUT"?iv:Wn)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return we(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:D2.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield iv(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:d.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return we(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield Wn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new px("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pt(n))return{data:null,error:n};throw n}})}update(t,r,n){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return we(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pt(i))return{data:null,error:i};throw i}})}copy(t,r,n){return we(this,void 0,void 0,function*(){try{return{data:{path:(yield Wn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pt(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return we(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield Wn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pt(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return we(this,void 0,void 0,function*(){try{const i=yield Wn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pt(i))return{data:null,error:i};throw i}})}download(t,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"",o=this._getFinalPath(t),l=()=>Bu(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new PL(l,this.shouldThrowOnError)}info(t){return we(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Bu(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:nv(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pt(n))return{data:null,error:n};throw n}})}exists(t){return we(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield AL(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pt(n)&&n instanceof rv){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return we(this,void 0,void 0,function*(){try{return{data:yield gx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}list(t,r,n){return we(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},OL),r),{prefix:t||""});return{data:yield Wn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pt(i))return{data:null,error:i};throw i}})}listV2(t,r){return we(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Wn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const c4="2.81.1",u4={"X-Client-Info":`storage-js/${c4}`};class DL{constructor(t,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},u4),r),this.fetch=mx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return we(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield Bu(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}getBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield Bu(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}createBucket(t){return we(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Wn(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pt(i))return{data:null,error:i};throw i}})}updateBucket(t,r){return we(this,void 0,void 0,function*(){try{return{data:yield iv(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield gx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class NL{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},u4),r),this.fetch=mx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}listBuckets(t){return we(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Bu(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield gx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pt(r))return{data:null,error:r};throw r}})}}const vx={"X-Client-Info":`storage-js/${c4}`,"Content-Type":"application/json"};class d4 extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function en(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class tm extends d4{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class FL extends d4{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var N2;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(N2||(N2={}));const xx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ML=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},F2=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),LL=(e,t,r)=>we(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||i+"";t(new tm(F2(a),i,o))}).catch(()=>{const a=i+"",o=s.statusText||`HTTP ${i} error`;t(new tm(o,i,a))});else{const a=i+"",o=s.statusText||`HTTP ${i} error`;t(new tm(o,i,a))}}else t(new FL(F2(e),e))}),zL=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(ML(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function jL(e,t,r,n,i,s){return we(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,zL(t,n,i,s)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>LL(l,o,n))})})}function tn(e,t,r,n,i){return we(this,void 0,void 0,function*(){return jL(e,"POST",t,n,i,r)})}class BL{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},vx),r),this.fetch=xx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return we(this,void 0,void 0,function*(){try{return{data:(yield tn(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}getIndex(t,r){return we(this,void 0,void 0,function*(){try{return{data:yield tn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}listIndexes(t){return we(this,void 0,void 0,function*(){try{return{data:yield tn(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return we(this,void 0,void 0,function*(){try{return{data:(yield tn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}}class UL{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},vx),r),this.fetch=xx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return we(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield tn(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}getVectors(t){return we(this,void 0,void 0,function*(){try{return{data:yield tn(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}listVectors(t){return we(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield tn(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}queryVectors(t){return we(this,void 0,void 0,function*(){try{return{data:yield tn(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}deleteVectors(t){return we(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield tn(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}}class $L{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},vx),r),this.fetch=xx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return we(this,void 0,void 0,function*(){try{return{data:(yield tn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}getBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield tn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}listBuckets(){return we(this,arguments,void 0,function*(t={}){try{return{data:yield tn(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}deleteBucket(t){return we(this,void 0,void 0,function*(){try{return{data:(yield tn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}}class VL extends $L{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new HL(this.url,this.headers,t,this.fetch)}}class HL extends BL{constructor(t,r,n,i){super(t,r,i),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return we(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return we(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return we(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return we(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new WL(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class WL extends UL{constructor(t,r,n,i,s){super(t,r,s),this.vectorBucketName=n,this.indexName=i}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return we(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return we(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return we(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return we(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return we(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class GL extends DL{constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new IL(this.url,this.headers,t,this.fetch)}get vectors(){return new VL(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new NL(this.url+"/iceberg",this.headers,this.fetch)}}const KL="2.81.1";let jc="";typeof Deno<"u"?jc="deno":typeof document<"u"?jc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?jc="react-native":jc="node";const qL={"X-Client-Info":`supabase-js-${jc}/${KL}`},XL={headers:qL},YL={schema:"public"},QL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},JL={},ZL=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ez=()=>Headers,tz=(e,t,r)=>{const n=ZL(r),i=ez();return async(s,a)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:c}))}};function rz(e){return e.endsWith("/")?e:e+"/"}function nz(e,t){var r,n;const{db:i,auth:s,realtime:a,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,f={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function iz(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(rz(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const f4="2.81.1",Vo=30*1e3,sv=3,rm=sv*Vo,sz="http://localhost:9999",az="supabase.auth.token",oz={"X-Client-Info":`gotrue-js/${f4}`},av="X-Supabase-Api-Version",h4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lz=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,cz=10*60*1e3;class Uu extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function be(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class uz extends Uu{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function dz(e){return be(e)&&e.name==="AuthApiError"}class Da extends Uu{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class fa extends Uu{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Un extends fa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function fz(e){return be(e)&&e.name==="AuthSessionMissingError"}class Fo extends fa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class df extends fa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ff extends fa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function hz(e){return be(e)&&e.name==="AuthImplicitGrantRedirectError"}class M2 extends fa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ov extends fa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function nm(e){return be(e)&&e.name==="AuthRetryableFetchError"}class L2 extends fa{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class lv extends fa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const $h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),z2=` 	
\r=`.split(""),pz=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<z2.length;t+=1)e[z2[t].charCodeAt(0)]=-2;for(let t=0;t<$h.length;t+=1)e[$h[t].charCodeAt(0)]=t;return e})();function j2(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r($h[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r($h[n]),t.queuedBits-=6}}function p4(e,t,r){const n=pz[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function B2(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{vz(a,n,r)};for(let a=0;a<e.length;a+=1)p4(e.charCodeAt(a),i,s);return t.join("")}function mz(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function gz(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}mz(n,t)}}function vz(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ml(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)p4(e.charCodeAt(i),r,n);return new Uint8Array(t)}function xz(e){const t=[];return gz(e,r=>t.push(r)),new Uint8Array(t)}function za(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>j2(i,r,n)),j2(null,r,n),t.join("")}function yz(e){return Math.round(Date.now()/1e3)+e}function wz(){return Symbol("auth-callback")}const tr=()=>typeof window<"u"&&typeof document<"u",wa={tested:!1,writable:!1},m4=()=>{if(!tr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(wa.tested)return wa.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),wa.tested=!0,wa.writable=!0}catch{wa.tested=!0,wa.writable=!1}return wa.writable};function bz(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const g4=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),_z=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ho=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ba=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ds=async(e,t)=>{await e.removeItem(t)};class K0{constructor(){this.promise=new K0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}K0.promiseConstructor=Promise;function im(e){const t=e.split(".");if(t.length!==3)throw new lv("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!lz.test(t[n]))throw new lv("JWT not in base64url format");return{header:JSON.parse(B2(t[0])),payload:JSON.parse(B2(t[1])),signature:ml(t[2]),raw:{header:t[0],payload:t[1]}}}async function Sz(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Ez(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function Tz(e){return("0"+e.toString(16)).substr(-2)}function kz(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Tz).join("")}async function Cz(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function Az(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Cz(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mo(e,t,r=!1){const n=kz();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Ho(e,`${t}-code-verifier`,i);const s=await Az(n);return[s,n===s?"plain":"s256"]}const Rz=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Pz(e){const t=e.headers.get(av);if(!t||!t.match(Rz))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Oz(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Iz(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Dz=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Lo(e){if(!Dz.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function sm(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Nz(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function U2(e){return JSON.parse(JSON.stringify(e))}const Aa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Fz=[502,503,504];async function $2(e){var t;if(!_z(e))throw new ov(Aa(e),0);if(Fz.includes(e.status))throw new ov(Aa(e),e.status);let r;try{r=await e.json()}catch(s){throw new Da(Aa(s),s)}let n;const i=Pz(e);if(i&&i.getTime()>=h4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new L2(Aa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Un}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new L2(Aa(r),e.status,r.weak_password.reasons);throw new uz(Aa(r),e.status||500,n)}const Mz=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ce(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[av]||(s[av]=h4["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Lz(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Lz(e,t,r,n,i,s){const a=Mz(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new ov(Aa(l),0)}if(o.ok||await $2(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await $2(l)}}function $n(e){var t;let r=null;Bz(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=yz(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function V2(e){const t=$n(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function bs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function zz(e){return{data:e,error:null}}function jz(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=da(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function H2(e){return e}function Bz(e){return e.access_token&&e.refresh_token&&e.expires_in}const am=["global","local","others"];class Uz{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=g4(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=am[0]){if(am.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${am.join(", ")}`);try{return await Ce(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ce(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:bs})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=da(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ce(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:jz,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(be(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ce(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:bs})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ce(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:H2});if(u.error)throw u.error;const d=await u.json(),f=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const h=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=h}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(be(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Lo(t);try{return await Ce(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:bs})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Lo(t);try{return await Ce(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:bs})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Lo(t);try{return await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:bs})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Lo(t.userId);try{const{data:r,error:n}=await Ce(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Lo(t.userId),Lo(t.id);try{return{data:await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ce(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:H2});if(u.error)throw u.error;const d=await u.json(),f=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const h=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=h}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(be(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Ce(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ce(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ce(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ce(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ce(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}}function W2(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const zo={debug:!!(globalThis&&m4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class v4 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class $z extends v4{}async function Vz(e,t,r){zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),zo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new $z(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(zo.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Hz(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function x4(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Wz(e){return parseInt(e,16)}function Gz(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Kz(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:u,uri:d,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=x4(e.address),m=u?`${u}://${n}`:n,h=e.statement?`${e.statement}
`:"",g=`${m} wants you to sign in with your Ethereum account:
${p}

${h}`;let v=`URI: ${d}
Version: ${f}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(v+=`
Expiration Time: ${i.toISOString()}`),o&&(v+=`
Not Before: ${o.toISOString()}`),l&&(v+=`
Request ID: ${l}`),c){let w=`
Resources:`;for(const y of c){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);w+=`
- ${y}`}v+=w}return`${g}
${v}`}class Nt extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Vh extends Nt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function qz({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Nt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Nt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Nt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Nt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Nt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Nt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Nt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Nt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(y4(a)){if(s.rp.id!==a)return new Nt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Nt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Xz({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Nt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Nt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(y4(n)){if(r.rpId!==n)return new Nt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Yz{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Qz=new Yz;function Jz(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=da(e,["challenge","user","excludeCredentials"]),s=ml(t).buffer,a=Object.assign(Object.assign({},r),{id:ml(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:ml(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function Zz(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=da(e,["challenge","allowCredentials"]),i=ml(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},o),{id:ml(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function ej(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:za(new Uint8Array(e.response.attestationObject)),clientDataJSON:za(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function tj(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:za(new Uint8Array(i.authenticatorData)),clientDataJSON:za(new Uint8Array(i.clientDataJSON)),signature:za(new Uint8Array(i.signature)),userHandle:i.userHandle?za(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function y4(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function G2(){var e,t;return!!(tr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function rj(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Vh("Browser returned unexpected credential type",t)}:{data:null,error:new Vh("Empty credential response",t)}}catch(t){return{data:null,error:qz({error:t,options:e})}}}async function nj(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Vh("Browser returned unexpected credential type",t)}:{data:null,error:new Vh("Empty credential response",t)}}catch(t){return{data:null,error:Xz({error:t,options:e})}}}const ij={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},sj={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Hh(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(t(a)){const o=n[s];t(o)?n[s]=Hh(o,a):n[s]=Hh(a)}else n[s]=a}return n}function aj(e,t){return Hh(ij,e,t||{})}function oj(e,t){return Hh(sj,e,t||{})}class lj{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!a)return{data:null,error:o};const l=i??Qz.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=aj(a.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:u,error:d}=await rj({publicKey:c,signal:l});return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:d}}case"request":{const c=oj(a.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:u,error:d}=await nj(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:d}}}}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new Da("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Uu("rpId is required for WebAuthn authentication")};try{if(!G2())return{data:null,error:new Da("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new Da("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Uu("rpId is required for WebAuthn registration")};try{if(!G2())return{data:null,error:new Da("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(u=>{var d;return(d=u.data)===null||d===void 0?void 0:d.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new Da("Unexpected error in register",a)}}}}Hz();const cj={url:sz,storageKey:az,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:oz,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function K2(e,t,r){return await r()}const jo={};class $u{get jwks(){var t,r;return(r=(t=jo[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){jo[this.storageKey]=Object.assign(Object.assign({},jo[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=jo[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){jo[this.storageKey]=Object.assign(Object.assign({},jo[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},cj),t);if(this.storageKey=s.storageKey,this.instanceID=(r=$u.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,$u.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&tr()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Uz({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=g4(s.fetch),this.lock=s.lock||K2,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:tr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Vz:this.lock=K2,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new lj(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:m4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=W2(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=W2(this.memoryStorage)),tr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${f4}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(tr()&&(r=bz(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),tr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),hz(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return be(r)?this._returnResult({error:r}):this._returnResult({error:new Da("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:$n}),{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(be(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:d,options:f}=t;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Mo(this.storage,this.storageKey)),s=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:m},xform:$n})}else if("phone"in t){const{phone:u,password:d,options:f}=t;s=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:$n})}else throw new df("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(be(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:V2})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:V2})}else throw new df("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Fo;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,a,o,l,c,u,d,f;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:h,wallet:g,statement:v,options:w}=t;let y;if(tr())if(typeof g=="object")y=g;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")y=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=g}const b=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),E=await y.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=x4(E[0]);let S=(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const T=await y.request({method:"eth_chainId"});S=Wz(T)}const C={domain:b.host,address:k,statement:v,uri:b.href,version:"1",chainId:S,nonce:(i=w==null?void 0:w.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=Kz(C),m=await y.request({method:"personal_sign",params:[Gz(p),k]})}try{const{data:h,error:g}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:m},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:$n});if(g)throw g;if(!h||!h.session||!h.user){const v=new Fo;return this._returnResult({data:{user:null,session:null},error:v})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:Object.assign({},h),error:g})}catch(h){if(be(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signInWithSolana(t){var r,n,i,s,a,o,l,c,u,d,f,p;let m,h;if("message"in t)m=t.message,h=t.signature;else{const{chain:g,wallet:v,statement:w,options:y}=t;let b;if(tr())if(typeof v=="object")b=v;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))b=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=v}const E=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const k=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),w?{statement:w}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)m=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),h=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${E.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(i=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((d=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...y.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await b.signMessage(new TextEncoder().encode(m),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");h=k}}try{const{data:g,error:v}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:za(h)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:$n});if(v)throw v;if(!g||!g.session||!g.user){const w=new Fo;return this._returnResult({data:{user:null,session:null},error:w})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:v})}catch(g){if(be(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ba(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:$n});if(await ds(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const o=new Fo;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(be(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:$n}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Fo;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Mo(this.storage,this.storageKey));const{error:d}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new df("You must provide either an email or phone number.")}catch(o){if(be(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Ce(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:$n});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(be(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Mo(this.storage,this.storageKey));const c=await Ce(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:zz});return!((s=c.data)===null||s===void 0)&&s.url&&tr()&&!(!((a=t.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Un;const{error:i}=await Ce(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(be(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await Ce(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await Ce(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new df("You must provide either an email or phone number and a type")}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ba(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<rm:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await ba(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=sm()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=Nz(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:bs}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Un}:await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:bs})})}catch(r){if(be(r))return fz(r)&&(await this._removeSession(),await ds(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Un;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Mo(this.storage,this.storageKey));const{data:c,error:u}=await Ce(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:bs});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(be(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Un;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=im(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(be(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Un;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!tr())throw new ff("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ff(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new M2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ff("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new M2("No code detected.");const{data:w,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!a||!c)throw new ff("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(o);let f=u+d;l&&(f=parseInt(l));const p=f-u;p*1e3<=Vo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const m=f-d;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,u);const{data:h,error:g}=await this._getUser(s);if(g)throw g;const v={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:f,refresh_token:a,token_type:c,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:t.type},error:null})}catch(n){if(be(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ba(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(dz(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await ds(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=wz(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Mo(this.storage,this.storageKey,!0));try{return await Ce(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(be(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:d,error:f}=s;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ce(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return tr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(be(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:o,token:l,access_token:c,nonce:u}=t,d=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:$n}),{data:f,error:p}=d;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Fo}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(i){if(be(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await Ce(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Ez(async i=>(i>0&&await Sz(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ce(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:$n})),(i,s)=>{const a=200*Math.pow(2,i);return s&&nm(s)&&Date.now()+a-n<Vo})}catch(n){if(this._debug(r,"error",n),be(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),tr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await ba(this.storage,this.storageKey);if(i&&this.userStorage){let a=await ba(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Ho(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:sm()}else if(i&&!i.user&&!i.user){const a=await ba(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await ds(this.storage,this.storageKey+"-user"),await Ho(this.storage,this.storageKey,i)):i.user=sm()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<rm;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${rm}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),nm(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Un;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new K0;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Un;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),be(s)){const a={data:null,error:s};return nm(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ho(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=U2(i);await Ho(this.storage,this.storageKey,s)}else{const i=U2(r);await Ho(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await ds(this.storage,this.storageKey),await ds(this.storage,this.storageKey+"-code-verifier"),await ds(this.storage,this.storageKey+"-user"),this.userStorage&&await ds(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&tr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Vo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Vo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Vo}ms, refresh threshold is ${sv} ticks`),i<=sv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof v4)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await Mo(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Ce(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await Ce(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?ej(t.webauthn.credential_response):tj(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await Ce(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await Ce(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Jz(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Zz(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=im(n.access_token);let a=null;s.aal&&(a=s.aal);let o=a;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=s.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Ce(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Un})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Un});const a=await Ce(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&tr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(be(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Un});const a=await Ce(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&tr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(be(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+cz>i)return n;const{data:s,error:a}=await Ce(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:m}=await this.getSession();if(m||!p.session)return this._returnResult({data:null,error:m});n=p.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=im(n);r!=null&&r.allowExpired||Oz(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:a},error:null}}const u=Iz(i.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,a,xz(`${o}.${l}`)))throw new lv("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(be(n))return this._returnResult({data:null,error:n});throw n}}}$u.nextInstanceID={};const uj=$u;class dj extends uj{constructor(t){super(t)}}class fj{constructor(t,r,n){var i,s,a;this.supabaseUrl=t,this.supabaseKey=r;const o=iz(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:YL,realtime:JL,auth:Object.assign(Object.assign({},QL),{storageKey:l}),global:XL},u=nz(n??{},c);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=tz(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new sL(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new GL(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new rL(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,storageKey:a,flowType:o,lock:l,debug:c,throwOnError:u},d,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dj({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),d),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,flowType:o,lock:l,debug:c,throwOnError:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new _L(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const hj=(e,t,r)=>new fj(e,t,r);function pj(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}pj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const mj="https://caubhppwypkymsixsrco.supabase.co",gj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNhdWJocHB3eXBreW1zaXhzcmNvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEyMTkwODcsImV4cCI6MjA3Njc5NTA4N30.OqfYc2Xj4YULWrINf_eS6Hhj-SJf_iO8Ejp6KHDlBxI",ze=hj(mj,gj,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:typeof window<"u"?window.localStorage:void 0},global:{fetch:(e,t={})=>fetch(e,{...t,signal:AbortSignal.timeout(5e3)}).catch(r=>{var n;throw r.name==="AbortError"||(n=r.message)!=null&&n.includes("ERR_NAME_NOT_RESOLVED"),r})}}),q0=()=>{const[e,t]=_.useState(null),[r,n]=_.useState(!0),[i,s]=_.useState(null);_.useEffect(()=>{let f=!0,p=!1,m=null;ze.auth.getSession().then(({data:{session:g},error:v})=>{var w,y,b;if(!(!f||p)){if(p=!0,v){(w=v.message)!=null&&w.includes("ERR_NAME_NOT_RESOLVED")||(y=v.message)!=null&&y.includes("Failed to fetch")||(b=v.message)!=null&&b.includes("NetworkError")?(console.warn(" Supabase non raggiungibile. L'app funzioner in modalit offline."),console.warn(" Verifica le credenziali Supabase nel file .env")):console.error("Errore nel recupero sessione:",v),n(!1);return}s(g),g!=null&&g.user?t({...g.user,role:"admin",company_id:null}):t(null),n(!1)}}).catch(g=>{var v,w;if((v=g.message)!=null&&v.includes("ERR_NAME_NOT_RESOLVED")||(w=g.message)!=null&&w.includes("Failed to fetch")||g.name==="AbortError"){if(console.warn(" Impossibile connettersi a Supabase. Modalit offline."),!f)return;n(!1);return}console.error("Errore nel recupero sessione:",g),f&&n(!1)});const{data:{subscription:h}}=ze.auth.onAuthStateChange((g,v)=>{f&&(g==="INITIAL_SESSION"&&p||(m&&clearTimeout(m),m=setTimeout(()=>{var w,y;if(f)try{s(v),v!=null&&v.user?t({...v.user,role:"admin",company_id:null}):t(null),n(!1)}catch(b){if((w=b==null?void 0:b.message)!=null&&w.includes("ERR_NAME_NOT_RESOLVED")||(y=b==null?void 0:b.message)!=null&&y.includes("Failed to fetch")){if(console.warn(" Errore connessione Supabase durante auth state change"),!f)return;n(!1)}}},100)))});return()=>{f=!1,m&&clearTimeout(m),h.unsubscribe()}},[]);const a=async(f,p)=>{const{data:m,error:h}=await ze.auth.signInWithPassword({email:f,password:p});if(h)throw h;return m},o=async(f,p,m="client",h)=>{const{data:g,error:v}=await ze.auth.signUp({email:f,password:p});if(v)throw v;if(g.user){const{error:w}=await ze.from("users").insert({id:g.user.id,email:f,role:m,company_id:h});if(w)throw w}if(g.user&&!g.user.email_confirmed_at){const{error:w}=await ze.auth.admin.updateUserById(g.user.id,{email_confirm:!0});w&&console.warn("Could not auto-confirm email:",w)}return g},l=async()=>{var f,p,m,h,g;try{const{error:v}=await ze.auth.signOut();v&&((f=v.message)!=null&&f.includes("Failed to fetch")||(p=v.message)!=null&&p.includes("ERR_NAME_NOT_RESOLVED")||(m=v.message)!=null&&m.includes("NetworkError")?console.warn("Supabase non disponibile, logout locale"):console.error("Errore Supabase signOut:",v))}catch(v){(h=v==null?void 0:v.message)!=null&&h.includes("Failed to fetch")||(g=v==null?void 0:v.message)!=null&&g.includes("ERR_NAME_NOT_RESOLVED")||(v==null?void 0:v.name)==="AbortError"?console.warn("Supabase non disponibile, logout locale"):console.error("Errore durante logout:",v)}finally{t(null),s(null);try{const v=[];for(let w=0;w<localStorage.length;w++){const y=localStorage.key(w);y&&(y.startsWith("sb-")||y.includes("supabase"))&&v.push(y)}v.forEach(w=>localStorage.removeItem(w)),sessionStorage.clear()}catch{try{localStorage.clear(),sessionStorage.clear()}catch{}}}},c=_.useMemo(()=>(e==null?void 0:e.role)==="admin",[e==null?void 0:e.role]),u=_.useMemo(()=>(e==null?void 0:e.role)==="client",[e==null?void 0:e.role]);return _.useMemo(()=>({user:e,session:i,loading:r,signIn:a,signUp:o,signOut:l,isAdmin:c,isClient:u}),[e,i,r,c,u])},vj="/bilanci_dashboard/assets/Imment%20-%20logo%20-%20web_Orizzontale%20-%20colori%20-%20chiaro-DyQ8Ll3u.png",xj=[{title:"Dashboard",icon:hF,url:"/"},{title:"Source",icon:Kw,url:"/source"},{title:"CE Dettaglio",icon:Kw,url:"/ce-dettaglio"},{title:"CE Dettaglio Mensile",icon:aF,url:"/ce-dettaglio-mensile"},{title:"CE Sintetico",icon:vF,url:"/ce-sintetico"},{title:"CE Sintetico Mensile",icon:oF,url:"/ce-sintetico-mensile"},{title:"Partitari",icon:iF,url:"/partitari"},{title:"Importa Dati",icon:yF,url:"/import"}];function yj(){var a;const[e,t]=QT(),{user:r,signOut:n,isAdmin:i}=q0(),s=async()=>{try{await n(),t("/"),window.location.reload()}catch(o){console.error("Errore durante il logout:",o),t("/"),window.location.reload()}};return x.jsxs(YM,{className:"border-none group-data-[collapsible=icon]:w-16",collapsible:"icon",style:{background:"linear-gradient(180deg, #335C96 0%, #17334F 100%)",backgroundColor:"#335C96",boxShadow:"4px 0 12px rgba(23, 51, 79, 0.2)"},children:[x.jsx(QM,{className:"px-6 py-6 pb-8 group-data-[collapsible=icon]:px-0 group-data-[collapsible=icon]:py-4 group-data-[collapsible=icon]:flex group-data-[collapsible=icon]:items-center group-data-[collapsible=icon]:justify-center",children:x.jsxs("div",{className:"flex items-start justify-between group-data-[collapsible=icon]:flex-col group-data-[collapsible=icon]:items-center",children:[x.jsxs("div",{className:"group-data-[collapsible=icon]:hidden",children:[x.jsx("img",{src:vj,alt:"Imment Logo",className:"w-40 h-auto","data-testid":"img-sidebar-logo"}),x.jsx("div",{className:"text-sm text-white/95 font-medium mt-3","data-testid":"text-sidebar-subtitle",children:"Dashboard Bilanci 2025"}),r&&x.jsxs("div",{className:"text-xs text-white/80 mt-2",children:[r.email||((a=r.user_metadata)==null?void 0:a.email)||"Utente",i&&x.jsx("div",{className:"text-xs text-yellow-300 font-semibold mt-1",children:"ADMIN"})]})]}),x.jsx(BA,{className:"text-white hover:text-white hover:bg-white/20 rounded-md p-4 h-12 w-12 group-data-[collapsible=icon]:p-2 group-data-[collapsible=icon]:h-10 group-data-[collapsible=icon]:w-10","data-testid":"button-sidebar-close"})]})}),x.jsxs(JM,{className:"px-6 group-data-[collapsible=icon]:px-0 group-data-[collapsible=icon]:hidden",children:[x.jsx(g2,{children:x.jsx(v2,{children:x.jsx(x2,{children:xj.map(o=>x.jsx(y2,{children:x.jsx(w2,{asChild:!0,isActive:e===o.url,className:"text-white hover:text-white hover:bg-white/20 data-[active=true]:bg-white/25 data-[active=true]:text-white data-[active=true]:font-semibold data-[active=true]:border-l-[3px] data-[active=true]:border-l-white px-4 py-3.5 mb-2 rounded-[10px] text-[15px]","data-testid":`nav-${o.title.toLowerCase().replace(/\s+/g,"-")}`,children:x.jsxs(Ih,{href:o.url,className:"flex items-center gap-3",children:[x.jsx(o.icon,{className:"w-5 h-5"}),x.jsx("span",{children:o.title})]})})},o.title))})})}),x.jsx(g2,{className:"mt-auto",children:x.jsx(v2,{children:x.jsx(x2,{children:x.jsx(y2,{children:x.jsxs(w2,{onClick:s,className:"text-white hover:text-white hover:bg-white/20 px-4 py-3.5 mb-2 rounded-[10px] text-[15px]","data-testid":"button-logout",children:[x.jsx(pF,{className:"w-5 h-5"}),x.jsx("span",{children:"Logout"})]})})})})})]})]})}const w4=_.createContext(void 0);function wj({children:e}){const{user:t,isAdmin:r}=q0(),[n,i]=_.useState([]),[s,a]=_.useState(null),[o,l]=_.useState(!0),c=_.useRef(!1),u=C=>{C?localStorage.setItem("selectedCompany",JSON.stringify(C)):localStorage.removeItem("selectedCompany")},d=_.useCallback(async()=>{if(!r){l(!1);return}try{const{data:C,error:T}=await ze.from("companies").select("*").order("name");if(T){console.error("Errore nel caricamento aziende:",T);return}if(i(C||[]),!c.current){try{const P=localStorage.getItem("selectedCompany");if(P){const I=JSON.parse(P);C&&C.some(R=>R.id===I.id)?(console.log(" Azienda selezionata caricata dal localStorage:",I.name),a(I)):(console.log("  Azienda salvata non trovata nella lista, rimuovo dal localStorage"),localStorage.removeItem("selectedCompany"))}}catch(P){console.error("Errore nel caricamento azienda salvata:",P),localStorage.removeItem("selectedCompany")}c.current=!0}}catch(C){console.error("Errore generale:",C)}finally{l(!1)}},[r]);_.useEffect(()=>{d()},[d]);const f=_.useCallback(async(C,T,P,I)=>{try{let R=ze.from("financial_data").select("*").eq("company_id",C).eq("data_type",T);P&&(R=R.eq("year",P)),I!==void 0&&(R=R.eq("month",I));const{data:H,error:q}=await R.order("created_at",{ascending:!1});return q?(console.error("Errore nel caricamento dati finanziari:",q),null):H}catch(R){return console.error("Errore generale:",R),null}},[]),p=async(C,T,P,I,R)=>{const{data:H,error:q}=await ze.from("financial_data").upsert({company_id:C,data_type:T,data:P,year:I,month:R}).select();if(q)throw console.error("Errore nel salvataggio dati finanziari:",q),q;return H},m=_.useCallback(async C=>{try{const{data:T,error:P}=await ze.from("financial_data").select("*").eq("company_id",C).eq("data_type","dashboard").order("year",{ascending:!1}).order("month",{ascending:!1,nullsFirst:!1}).limit(1);if(P)return console.error("Errore nel caricamento dati dashboard:",P),null;if(T&&T.length>0){const I=T[0];console.log(` Dati dashboard caricati per azienda ${C}:`,{anno:I.year,mese:I.month,tipo:I.data_type})}else console.log(` Nessun dato dashboard trovato per azienda ${C}`);return T}catch(T){return console.error("Errore generale getDashboardData:",T),null}},[]),h=async C=>await f(C,"ce-dettaglio",2025),g=async C=>await f(C,"ce-dettaglio-mensile",2025),v=async C=>await f(C,"ce-sintetico",2025),w=async C=>await f(C,"ce-sintetico-mensile",2025),y=async C=>await f(C,"partitari",2025),b=_.useCallback(async C=>await f(C,"source"),[f]),E=C=>{a(C),u(C)},k=async(C,T)=>{const{error:P}=await ze.from("financial_data").delete().eq("company_id",C).eq("year",T);if(P)throw console.error("Errore nella cancellazione dati finanziari:",P),P},S=async C=>{try{const T=C.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),{data:P,error:I}=await ze.from("companies").insert([{name:C,slug:T}]).select().single();return I?(console.error("Errore creazione azienda:",I),null):P?(i(R=>[...R,P].sort((H,q)=>H.name.localeCompare(q.name))),P):null}catch(T){return console.error("Errore generale creazione azienda:",T),null}};return x.jsx(w4.Provider,{value:{companies:n,selectedCompany:s,setSelectedCompany:E,createCompany:S,loading:o,setLoading:l,loadFinancialData:f,saveFinancialData:p,deleteFinancialData:k,getDashboardData:m,getCEDettaglioData:h,getCEDettaglioMensileData:g,getCESinteticoData:v,getCESinteticoMensileData:w,getSourceData:b,getPartitariData:y,loadCompanies:d},children:e})}function Nn(){const e=_.useContext(w4);if(e===void 0)throw new Error("useFinancialData must be used within a FinancialDataProvider");return e}const Rt=_.forwardRef(({className:e,...t},r)=>x.jsx("div",{ref:r,className:_e("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",e),...t}));Rt.displayName="Card";const Ja=_.forwardRef(({className:e,...t},r)=>x.jsx("div",{ref:r,className:_e("flex flex-col space-y-1.5 p-6",e),...t}));Ja.displayName="CardHeader";const Za=_.forwardRef(({className:e,...t},r)=>x.jsx("div",{ref:r,className:_e("text-2xl font-semibold leading-none tracking-tight",e),...t}));Za.displayName="CardTitle";const Wh=_.forwardRef(({className:e,...t},r)=>x.jsx("div",{ref:r,className:_e("text-sm text-muted-foreground",e),...t}));Wh.displayName="CardDescription";const qi=_.forwardRef(({className:e,...t},r)=>x.jsx("div",{ref:r,className:_e("p-6 pt-0",e),...t}));qi.displayName="CardContent";const b4=_.forwardRef(({className:e,...t},r)=>x.jsx("div",{ref:r,className:_e("flex items-center p-6 pt-0",e),...t}));b4.displayName="CardFooter";var bj="Label",_4=_.forwardRef((e,t)=>x.jsx(Le.label,{...e,ref:t,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));_4.displayName=bj;var S4=_4;const _j=So("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Tn=_.forwardRef(({className:e,...t},r)=>x.jsx(S4,{ref:r,className:_e(_j(),e),...t}));Tn.displayName=S4.displayName;const Sj=So("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),E4=_.forwardRef(({className:e,variant:t,...r},n)=>x.jsx("div",{ref:n,role:"alert",className:_e(Sj({variant:t}),e),...r}));E4.displayName="Alert";const Ej=_.forwardRef(({className:e,...t},r)=>x.jsx("h5",{ref:r,className:_e("mb-1 font-medium leading-none tracking-tight",e),...t}));Ej.displayName="AlertTitle";const T4=_.forwardRef(({className:e,...t},r)=>x.jsx("div",{ref:r,className:_e("text-sm [&_p]:leading-relaxed",e),...t}));T4.displayName="AlertDescription";function Tj(){const[,e]=QT(),{signIn:t,signUp:r,loading:n}=q0(),[i,s]=_.useState(!1),[a,o]=_.useState(""),[l,c]=_.useState(""),[u,d]=_.useState(""),[f,p]=_.useState(""),[m,h]=_.useState(!1),g=async v=>{v.preventDefault(),p(""),h(!0);try{if(i){if(l!==u){p("Le password non coincidono");return}await r(a,l,"client"),p(""),e("/")}else await t(a,l),e("/")}catch(w){p(w.message||"Errore durante l'autenticazione")}finally{h(!1)}};return n?x.jsx("div",{className:"min-h-screen flex items-center justify-center",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:x.jsxs(Rt,{className:"w-full max-w-md",children:[x.jsxs(Ja,{className:"space-y-1",children:[x.jsx(Za,{className:"text-2xl font-bold text-center",children:i?"Crea Account":"Accedi"}),x.jsx(Wh,{className:"text-center",children:i?"Crea un nuovo account per accedere alla dashboard":"Inserisci le tue credenziali per accedere"})]}),x.jsxs(qi,{children:[x.jsxs("form",{onSubmit:g,className:"space-y-4",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx(Tn,{htmlFor:"email",children:"Email"}),x.jsx(Ei,{id:"email",type:"email",value:a,onChange:v=>o(v.target.value),required:!0,disabled:m,autoComplete:"email"})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(Tn,{htmlFor:"password",children:"Password"}),x.jsx(Ei,{id:"password",type:"password",value:l,onChange:v=>c(v.target.value),required:!0,disabled:m,autoComplete:i?"new-password":"current-password"})]}),i&&x.jsxs("div",{className:"space-y-2",children:[x.jsx(Tn,{htmlFor:"confirmPassword",children:"Conferma Password"}),x.jsx(Ei,{id:"confirmPassword",type:"password",value:u,onChange:v=>d(v.target.value),required:!0,disabled:m,autoComplete:"new-password"})]}),f&&x.jsx(E4,{variant:"destructive",children:x.jsx(T4,{children:f})}),x.jsx(ir,{type:"submit",className:"w-full",disabled:m,children:m?"Caricamento...":i?"Crea Account":"Accedi"})]}),x.jsx("div",{className:"mt-4 text-center",children:x.jsx(ir,{variant:"link",onClick:()=>s(!i),disabled:m,children:i?"Hai gi un account? Accedi":"Non hai un account? Registrati"})})]})]})})}async function kj(){console.log(`
 Verifica dati finanziari in Supabase...
`);const{data:e,error:t}=await ze.from("companies").select("*").order("name");if(t){console.error(" Errore nel caricamento aziende:",t);return}if(!e||e.length===0){console.log("  Nessuna azienda trovata nel database");return}console.log(` Trovate ${e.length} azienda/e:
`);const r=[{type:"dashboard",description:"Dashboard (KPIs, trend, summary)"},{type:"ce-dettaglio",description:"CE Dettaglio (progressivo 2025 e 2024)"},{type:"ce-dettaglio-mensile",description:"CE Dettaglio Mensile"},{type:"ce-sintetico",description:"CE Sintetico (progressivo 2025 e 2024)"},{type:"ce-sintetico-mensile",description:"CE Sintetico Mensile"},{type:"partitari",description:"Partitari"}];for(const n of e){console.log(`
 ${n.name} (ID: ${n.id})`),console.log("".repeat(60));for(const i of r){const{data:s,error:a}=await ze.from("financial_data").select("id, year, month, data_type, created_at").eq("company_id",n.id).eq("data_type",i.type).eq("year",2025).order("created_at",{ascending:!1});if(a)console.log(`   ${i.type}: Errore - ${a.message}`);else if(!s||s.length===0)console.log(`    ${i.type}: MANCA`);else{const o=s.map(c=>c.month).filter(c=>c!==null),l=o.length>0?` (mesi: ${o.join(", ")})`:"";console.log(`   ${i.type}: ${s.length} record${l}`)}}console.log("".repeat(60))}console.log(`
 Verifica completata!
`)}async function Cj(e){console.log(`
 Verifica dettagliata dati per companyId: ${e}
`);const{data:t,error:r}=await ze.from("companies").select("*").eq("id",e).single();if(r){console.error(" Errore nel caricamento azienda:",r);return}if(!t){console.error(" Azienda non trovata");return}console.log(` Azienda: ${t.name} (${t.slug||"N/A"})
`),console.log("".repeat(80));const{data:n,error:i}=await ze.from("financial_data").select("*").eq("company_id",e).order("created_at",{ascending:!1});if(i){console.error(" Errore nel caricamento dati:",i);return}if(!n||n.length===0){console.log(`  Nessun dato trovato per questa azienda
`);return}console.log(`
 Trovati ${n.length} record totali:
`);const s={};for(const o of n){const l=o.data_type||"unknown";s[l]||(s[l]=[]),s[l].push(o)}for(const[o,l]of Object.entries(s)){console.log(`
 ${o}: ${l.length} record`);for(const c of l){if(console.log(`   - ID: ${c.id}`),console.log(`     Year: ${c.year||"N/A"}, Month: ${c.month!==null&&c.month!==void 0?c.month:"null"}`),console.log(`     Created: ${c.created_at}`),console.log(`     Data presente: ${c.data?"":""}`),c.data){const u=Object.keys(c.data);console.log(`     Chiavi dati: ${u.join(", ")}`)}console.log("")}}console.log(`
 Verifica specifica per DASHBOARD:`);const a=n.filter(o=>o.data_type==="dashboard");if(a.length===0)console.log('     Nessun record con data_type="dashboard" trovato');else{console.log(`    Trovati ${a.length} record dashboard:`);for(const o of a)if(console.log(`      - Year: ${o.year}, Month: ${o.month!==null&&o.month!==void 0?o.month:"null"}`),o.data){const l=!!o.data.kpis,c=!!o.data.monthlyTrend,u=!!o.data.summary,d=!!o.data.trends,f=!!o.data.table;console.log(`        Struttura: kpis=${l?"":""}, monthlyTrend=${c?"":""}, summary=${u?"":""}`),console.log(`        Alternativa: trends=${d?"":""}, table=${f?"":""}`),d&&console.log("         Struttura trends:",{keys:Object.keys(o.data.trends),hasMonthlyTrend:!!o.data.trends.monthlyTrend,hasLabels:!!o.data.trends.labels,hasRicavi:!!o.data.trends.ricavi,hasEbitda:!!o.data.trends.ebitda})}}console.log(`
`.repeat(80)),console.log(` Verifica completata!
`)}typeof window<"u"&&(window.checkSupabaseData=kj,window.checkCompanyData=Cj);const Aj="modulepreload",Rj=function(e){return"/bilanci_dashboard/"+e},q2={},Pj=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=Rj(l),l in q2)return;q2[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Aj,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},zn={dashboard:{kpis:{ricavi2025:231136,ricavi2024:43656,costi2025:289007,costi2024:200302,ebitda2025:-21178,ebitda2024:-148217,risultato2025:-57871,risultato2024:-156646,margineEbitda2025:-9.2,margineEbitda2024:-339.5},monthlyTrend:{labels:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago"],ricavi:[56600,82100,117340,142840,161441,186441,230030,231136],ebitda:[45971,21850,-17092,-15105,-19148,-22632,-61,-21178]},summary:[{voce:"Totale Ricavi",value2025:231136,percentage:100,value2024:43656},{voce:"Costi Diretti",value2025:15095,percentage:6.5,value2024:1710},{voce:"Costi Indiretti",value2025:1750,percentage:.8,value2024:5500},{voce:"Totale Costi Diretti e Indiretti",value2025:16845,percentage:7.3,value2024:7210},{voce:"Gross Profit",value2025:214290,percentage:92.7,value2024:36446},{voce:"Spese Commerciali",value2025:15279,percentage:6.6,value2024:13162},{voce:"Personale",value2025:137119,percentage:59.3,value2024:55950},{voce:"Compensi Amministratore",value2025:0,percentage:0,value2024:31166},{voce:"EBITDA",value2025:-21178,percentage:-9.2,value2024:-148217},{voce:"Ammortamenti",value2025:35091,percentage:15.2,value2024:5933},{voce:"EBIT",value2025:-56268,percentage:-24.4,value2024:-154150},{voce:"Gestione Finanziaria",value2025:1603,percentage:.7,value2024:2496},{voce:"Risultato ante Imposte",value2025:-57871,percentage:-25,value2024:-156646},{voce:"Imposte",value2025:0,percentage:0,value2024:0},{voce:"Risultato dell'Esercizio",value2025:-57871,percentage:-25,value2024:-156646}]},ceDettaglio:{progressivo2025:{ricaviCaratteristici:219789,altriRicavi:11347,totaleRicavi:231136,serviziDiretti:14289,consulenzeDirette:0,serviziInformatici:806,serviziCloud:0,costiDiretti:15095,altriServizi:1750,costiIndiretti:1750,totaleCostiDirettiIndiretti:16845,grossProfit:214290,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:3031,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:4562,mostreFiere:5890,serviziCommerciali:443,carburante:1352,speseCommerciali:15279,beniIndeducibili:2182,speseGenerali:23150,materialeConsumo:0,spesePulizia:0,utenze:826,assicurazioni:171,rimanenze:0,tasseValori:585,sanzioniMulte:371,compensiAmministratore:0,rimborsiAmministratore:0,personale:137119,serviziAmministrativi:12617,serviziAmministrativiPaghe:0,consulenzeTecniche:29150,consulenzeLegali:1794,locazioniNoleggi:7133,serviziIndeducibili:1052,utiliPerditeCambi:513,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:226,altriOneri:3288,abbuoniArrotondamenti:12,speseStruttura:220189,totaleGestioneStruttura:235468,ebitda:-21178,ammortamentiImmateriali:34520,ammortamentiMateriali:571,svalutazioni:0,totaleAmmortamenti:35091,gestioneStraordinaria:0,ebit:-56268,speseCommissioniBancarie:257,interessiPassiviMutui:1170,altriInteressi:176,gestioneFinanziaria:1603,ebt:-57871,imposteDirette:0,risultatoEsercizio:-57871},progressivo2024:{ricaviCaratteristici:41650,altriRicavi:2006,totaleRicavi:43656,serviziDiretti:1161,consulenzeDirette:0,serviziInformatici:549,serviziCloud:0,costiDiretti:1710,altriServizi:5500,costiIndiretti:5500,totaleCostiDirettiIndiretti:7210,grossProfit:36446,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:7007,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:2834,mostreFiere:1895,serviziCommerciali:428,carburante:998,speseCommerciali:13162,beniIndeducibili:3064,speseGenerali:2801,materialeConsumo:0,spesePulizia:0,utenze:600,assicurazioni:261,rimanenze:0,tasseValori:630,sanzioniMulte:118,compensiAmministratore:31166,rimborsiAmministratore:3002,personale:55950,serviziAmministrativi:11156,serviziAmministrativiPaghe:0,consulenzeTecniche:49865,consulenzeLegali:0,locazioniNoleggi:4150,serviziIndeducibili:4797,utiliPerditeCambi:139,perditeSuCrediti:0,licenzeUso:1365,utenzeTelefoniche:1223,altriOneri:1211,abbuoniArrotondamenti:2,speseStruttura:171501,totaleGestioneStruttura:184663,ebitda:-148217,ammortamentiImmateriali:5648,ammortamentiMateriali:285,svalutazioni:0,totaleAmmortamenti:5933,gestioneStraordinaria:0,ebit:-154150,speseCommissioniBancarie:334,interessiPassiviMutui:1526,altriInteressi:636,gestioneFinanziaria:2496,ebt:-156646,imposteDirette:0,risultatoEsercizio:-156646},gennaio2025:{ricaviCaratteristici:56600,altriRicavi:0,totaleRicavi:56600,serviziDiretti:530,consulenzeDirette:0,serviziInformatici:106,serviziCloud:0,costiDiretti:636,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:636,grossProfit:55964,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:372,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:336,mostreFiere:5890,serviziCommerciali:58,carburante:120,speseCommerciali:6777,beniIndeducibili:113,speseGenerali:194,materialeConsumo:0,spesePulizia:0,utenze:0,assicurazioni:0,rimanenze:0,tasseValori:10,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:-6063,serviziAmministrativi:930,serviziAmministrativiPaghe:0,consulenzeTecniche:4877,consulenzeLegali:0,locazioniNoleggi:683,serviziIndeducibili:737,utiliPerditeCambi:22,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:10,altriOneri:1700,abbuoniArrotondamenti:4,speseStruttura:3217,totaleGestioneStruttura:9993,ebitda:45971,ammortamentiImmateriali:4346,ammortamentiMateriali:36,svalutazioni:0,totaleAmmortamenti:4382,gestioneStraordinaria:0,ebit:41589,speseCommissioniBancarie:25,interessiPassiviMutui:125,altriInteressi:0,gestioneFinanziaria:150,ebt:41439,imposteDirette:0,risultatoEsercizio:41439},gennaio2024:{ricaviCaratteristici:0,altriRicavi:0,totaleRicavi:0,serviziDiretti:254,consulenzeDirette:0,serviziInformatici:0,serviziCloud:0,costiDiretti:254,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:254,grossProfit:-253,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:297,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:389,mostreFiere:0,serviziCommerciali:0,carburante:0,speseCommerciali:686,beniIndeducibili:0,speseGenerali:1908,materialeConsumo:0,spesePulizia:0,utenze:0,assicurazioni:0,rimanenze:0,tasseValori:0,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:8380,serviziAmministrativi:818,serviziAmministrativiPaghe:0,consulenzeTecniche:850,consulenzeLegali:1500,locazioniNoleggi:450,serviziIndeducibili:0,utiliPerditeCambi:0,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:0,altriOneri:749,abbuoniArrotondamenti:0,speseStruttura:14655,totaleGestioneStruttura:15341,ebitda:-15594,ammortamentiImmateriali:0,ammortamentiMateriali:0,svalutazioni:0,totaleAmmortamenti:0,gestioneStraordinaria:0,ebit:-15594,speseCommissioniBancarie:9,interessiPassiviMutui:0,altriInteressi:0,gestioneFinanziaria:9,ebt:-15603,imposteDirette:0,risultatoEsercizio:-15603},febbraio2024:{ricaviCaratteristici:0,altriRicavi:0,totaleRicavi:0,serviziDiretti:261,consulenzeDirette:0,serviziInformatici:0,serviziCloud:0,costiDiretti:261,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:261,grossProfit:-260,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:399,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:438,mostreFiere:0,serviziCommerciali:0,carburante:0,speseCommerciali:837,beniIndeducibili:0,speseGenerali:2042,materialeConsumo:0,spesePulizia:0,utenze:128,assicurazioni:0,rimanenze:0,tasseValori:0,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:17510,serviziAmministrativi:1932,serviziAmministrativiPaghe:0,consulenzeTecniche:32614,consulenzeLegali:0,locazioniNoleggi:900,serviziIndeducibili:0,utiliPerditeCambi:27,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:15,altriOneri:749,abbuoniArrotondamenti:0,speseStruttura:55917,totaleGestioneStruttura:56754,ebitda:-57014,ammortamentiImmateriali:0,ammortamentiMateriali:0,svalutazioni:0,totaleAmmortamenti:0,gestioneStraordinaria:0,ebit:-57014,speseCommissioniBancarie:14,interessiPassiviMutui:0,altriInteressi:140,gestioneFinanziaria:153,ebt:-57168,imposteDirette:0,risultatoEsercizio:-57168},marzo2024:{ricaviCaratteristici:0,altriRicavi:0,totaleRicavi:0,serviziDiretti:26,consulenzeDirette:0,serviziInformatici:0,serviziCloud:0,costiDiretti:26,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:26,grossProfit:-26,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:476,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:239,mostreFiere:0,serviziCommerciali:0,carburante:0,speseCommerciali:714,beniIndeducibili:0,speseGenerali:235,materialeConsumo:0,spesePulizia:0,utenze:82,assicurazioni:0,rimanenze:0,tasseValori:516,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:9429,serviziAmministrativi:0,serviziAmministrativiPaghe:0,consulenzeTecniche:-9233,consulenzeLegali:0,locazioniNoleggi:450,serviziIndeducibili:0,utiliPerditeCambi:0,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:466,altriOneri:0,abbuoniArrotondamenti:0,speseStruttura:1947,totaleGestioneStruttura:2661,ebitda:-2687,ammortamentiImmateriali:0,ammortamentiMateriali:0,svalutazioni:0,totaleAmmortamenti:0,gestioneStraordinaria:0,ebit:-2687,speseCommissioniBancarie:28,interessiPassiviMutui:271,altriInteressi:0,gestioneFinanziaria:298,ebt:-2986,imposteDirette:0,risultatoEsercizio:-2986},febbraio2025:{ricaviCaratteristici:82100,altriRicavi:0,totaleRicavi:82100,serviziDiretti:5151,consulenzeDirette:0,serviziInformatici:210,serviziCloud:0,costiDiretti:5361,altriServizi:1250,costiIndiretti:1250,totaleCostiDirettiIndiretti:6611,grossProfit:75490,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:1468,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:1113,mostreFiere:5890,serviziCommerciali:113,carburante:292,speseCommerciali:8876,beniIndeducibili:877,speseGenerali:20406,materialeConsumo:0,spesePulizia:0,utenze:146,assicurazioni:0,rimanenze:0,tasseValori:19,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:5129,serviziAmministrativi:1781,serviziAmministrativiPaghe:0,consulenzeTecniche:11659,consulenzeLegali:0,locazioniNoleggi:1707,serviziIndeducibili:779,utiliPerditeCambi:497,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:41,altriOneri:1720,abbuoniArrotondamenti:4,speseStruttura:44764,totaleGestioneStruttura:53639,ebitda:21850,ammortamentiImmateriali:8306,ammortamentiMateriali:134,svalutazioni:0,totaleAmmortamenti:8440,gestioneStraordinaria:0,ebit:13410,speseCommissioniBancarie:56,interessiPassiviMutui:301,altriInteressi:0,gestioneFinanziaria:357,ebt:13054,imposteDirette:0,risultatoEsercizio:13054},marzo2025:{ricaviCaratteristici:107100,altriRicavi:10240,totaleRicavi:117340,serviziDiretti:6478,consulenzeDirette:0,serviziInformatici:344,serviziCloud:0,costiDiretti:6821,altriServizi:1250,costiIndiretti:1250,totaleCostiDirettiIndiretti:8071,grossProfit:109269,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:1908,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:2538,mostreFiere:5890,serviziCommerciali:168,carburante:662,speseCommerciali:11167,beniIndeducibili:1854,speseGenerali:20888,materialeConsumo:0,spesePulizia:0,utenze:262,assicurazioni:0,rimanenze:0,tasseValori:543,sanzioniMulte:20,compensiAmministratore:0,rimborsiAmministratore:0,personale:59963,serviziAmministrativi:6879,serviziAmministrativiPaghe:0,consulenzeTecniche:17594,consulenzeLegali:0,locazioniNoleggi:3013,serviziIndeducibili:887,utiliPerditeCambi:510,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:72,altriOneri:2705,abbuoniArrotondamenti:4,speseStruttura:115194,totaleGestioneStruttura:126361,ebitda:-17092,ammortamentiImmateriali:12784,ammortamentiMateriali:204,svalutazioni:0,totaleAmmortamenti:12988,gestioneStraordinaria:0,ebit:-30081,speseCommissioniBancarie:70,interessiPassiviMutui:467,altriInteressi:0,gestioneFinanziaria:537,ebt:-30618,imposteDirette:0,risultatoEsercizio:-30618},aprile2025:{ricaviCaratteristici:132600,altriRicavi:10240,totaleRicavi:142840,serviziDiretti:8163,consulenzeDirette:0,serviziInformatici:544,serviziCloud:0,costiDiretti:8707,altriServizi:1250,costiIndiretti:1250,totaleCostiDirettiIndiretti:9957,grossProfit:132883,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:2250,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:2982,mostreFiere:5890,serviziCommerciali:223,carburante:802,speseCommerciali:12148,beniIndeducibili:2123,speseGenerali:21862,materialeConsumo:0,spesePulizia:0,utenze:344,assicurazioni:0,rimanenze:0,tasseValori:552,sanzioniMulte:78,compensiAmministratore:0,rimborsiAmministratore:0,personale:72552,serviziAmministrativi:8233,serviziAmministrativiPaghe:0,consulenzeTecniche:21724,consulenzeLegali:0,locazioniNoleggi:3866,serviziIndeducibili:896,utiliPerditeCambi:512,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:102,altriOneri:2991,abbuoniArrotondamenti:5,speseStruttura:135841,totaleGestioneStruttura:147988,ebitda:-15105,ammortamentiImmateriali:17037,ammortamentiMateriali:272,svalutazioni:0,totaleAmmortamenti:17310,gestioneStraordinaria:0,ebit:-32415,speseCommissioniBancarie:124,interessiPassiviMutui:624,altriInteressi:57,gestioneFinanziaria:806,ebt:-33220,imposteDirette:0,risultatoEsercizio:-33220},maggio2025:{ricaviCaratteristici:151200,altriRicavi:10241,totaleRicavi:161441,serviziDiretti:9213,consulenzeDirette:0,serviziInformatici:606,serviziCloud:0,costiDiretti:9819,altriServizi:1250,costiIndiretti:1250,totaleCostiDirettiIndiretti:11069,grossProfit:150372,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:2795,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:3766,mostreFiere:5890,serviziCommerciali:278,carburante:1028,speseCommerciali:13758,beniIndeducibili:2236,speseGenerali:22205,materialeConsumo:0,spesePulizia:0,utenze:438,assicurazioni:0,rimanenze:0,tasseValori:560,sanzioniMulte:78,compensiAmministratore:0,rimborsiAmministratore:0,personale:85234,serviziAmministrativi:9579,serviziAmministrativiPaghe:0,consulenzeTecniche:25854,consulenzeLegali:0,locazioniNoleggi:4960,serviziIndeducibili:956,utiliPerditeCambi:513,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:133,altriOneri:3004,abbuoniArrotondamenti:10,speseStruttura:155761,totaleGestioneStruttura:169520,ebitda:-19148,ammortamentiImmateriali:21448,ammortamentiMateriali:355,svalutazioni:0,totaleAmmortamenti:21803,gestioneStraordinaria:0,ebit:-40951,speseCommissioniBancarie:133,interessiPassiviMutui:773,altriInteressi:57,gestioneFinanziaria:963,ebt:-41914,imposteDirette:0,risultatoEsercizio:-41914},giugno2025:{ricaviCaratteristici:176200,altriRicavi:10241,totaleRicavi:186441,serviziDiretti:10367,consulenzeDirette:0,serviziInformatici:627,serviziCloud:0,costiDiretti:10995,altriServizi:1250,costiIndiretti:1250,totaleCostiDirettiIndiretti:12245,grossProfit:174196,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:2813,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:4081,mostreFiere:5890,serviziCommerciali:333,carburante:1028,speseCommerciali:14146,beniIndeducibili:2236,speseGenerali:22311,materialeConsumo:0,spesePulizia:0,utenze:545,assicurazioni:0,rimanenze:0,tasseValori:568,sanzioniMulte:109,compensiAmministratore:0,rimborsiAmministratore:0,personale:109029,serviziAmministrativi:10605,serviziAmministrativiPaghe:0,consulenzeTecniche:26854,consulenzeLegali:0,locazioniNoleggi:5686,serviziIndeducibili:956,utiliPerditeCambi:513,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:164,altriOneri:3094,abbuoniArrotondamenti:12,speseStruttura:182683,totaleGestioneStruttura:196829,ebitda:-22632,ammortamentiImmateriali:25702,ammortamentiMateriali:425,svalutazioni:0,totaleAmmortamenti:26127,gestioneStraordinaria:0,ebit:-48759,speseCommissioniBancarie:139,interessiPassiviMutui:913,altriInteressi:106,gestioneFinanziaria:1158,ebt:-49917,imposteDirette:0,risultatoEsercizio:-49917},luglio2025:{ricaviCaratteristici:219789,altriRicavi:10241,totaleRicavi:230030,serviziDiretti:11901,consulenzeDirette:0,serviziInformatici:673,serviziCloud:0,costiDiretti:12574,altriServizi:1750,costiIndiretti:1750,totaleCostiDirettiIndiretti:14324,grossProfit:215705,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:2987,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:4402,mostreFiere:5890,serviziCommerciali:388,carburante:1303,speseCommerciali:14971,beniIndeducibili:2182,speseGenerali:22311,materialeConsumo:0,spesePulizia:0,utenze:707,assicurazioni:171,rimanenze:0,tasseValori:577,sanzioniMulte:143,compensiAmministratore:0,rimborsiAmministratore:0,personale:122992,serviziAmministrativi:11591,serviziAmministrativiPaghe:0,consulenzeTecniche:26854,consulenzeLegali:1794,locazioniNoleggi:6509,serviziIndeducibili:956,utiliPerditeCambi:513,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:195,altriOneri:3288,abbuoniArrotondamenti:12,speseStruttura:200796,totaleGestioneStruttura:215767,ebitda:-61,ammortamentiImmateriali:30111,ammortamentiMateriali:498,svalutazioni:0,totaleAmmortamenti:30609,gestioneStraordinaria:0,ebit:-30670,speseCommissioniBancarie:195,interessiPassiviMutui:1044,altriInteressi:176,gestioneFinanziaria:1415,ebt:-32085,imposteDirette:0,risultatoEsercizio:-32085},agosto2025:{ricaviCaratteristici:0,altriRicavi:1106,totaleRicavi:1106,serviziDiretti:2388,consulenzeDirette:0,serviziInformatici:133,serviziCloud:0,costiDiretti:2521,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:2521,grossProfit:-1415,speseViaggio:45,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:160,mostreFiere:0,serviziCommerciali:55,carburante:49,speseCommerciali:309,beniIndeducibili:0,speseGenerali:839,materialeConsumo:0,spesePulizia:0,utenze:119,assicurazioni:0,rimanenze:0,tasseValori:8,sanzioniMulte:227,compensiAmministratore:0,rimborsiAmministratore:0,personale:14126,serviziAmministrativi:1026,serviziAmministrativiPaghe:0,consulenzeTecniche:2296,consulenzeLegali:0,locazioniNoleggi:624,serviziIndeducibili:95,utiliPerditeCambi:0,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:31,altriOneri:0,abbuoniArrotondamenti:0,speseStruttura:19393,totaleGestioneStruttura:19701,ebitda:-21116,ammortamentiImmateriali:4409,ammortamentiMateriali:73,svalutazioni:0,totaleAmmortamenti:4482,gestioneStraordinaria:0,ebit:-25598,speseCommissioniBancarie:62,interessiPassiviMutui:126,altriInteressi:0,gestioneFinanziaria:188,ebt:-25787,imposteDirette:0,risultatoEsercizio:-25787},agosto2024:{ricaviCaratteristici:11581,altriRicavi:0,totaleRicavi:11581,serviziDiretti:179,consulenzeDirette:0,serviziInformatici:68,serviziCloud:0,costiDiretti:248,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:248,grossProfit:11333,speseViaggio:39,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:0,mostreFiere:0,serviziCommerciali:49,carburante:0,speseCommerciali:88,beniIndeducibili:173,speseGenerali:179,materialeConsumo:0,spesePulizia:0,utenze:124,assicurazioni:0,rimanenze:0,tasseValori:8,sanzioniMulte:96,compensiAmministratore:5557,rimborsiAmministratore:46,personale:4937,serviziAmministrativi:818,serviziAmministrativiPaghe:0,consulenzeTecniche:2596,consulenzeLegali:0,locazioniNoleggi:510,serviziIndeducibili:63,utiliPerditeCambi:26,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:111,altriOneri:24,abbuoniArrotondamenti:1,speseStruttura:15269,totaleGestioneStruttura:15357,ebitda:-4024,ammortamentiImmateriali:719,ammortamentiMateriali:36,svalutazioni:0,totaleAmmortamenti:756,gestioneStraordinaria:0,ebit:-4779,speseCommissioniBancarie:61,interessiPassiviMutui:235,altriInteressi:1,gestioneFinanziaria:297,ebt:-5076,imposteDirette:0,risultatoEsercizio:-5076}},ceSintetico:{progressivo2025:{ricaviCaratteristici:219789,altriRicavi:11347,totaleRicavi:231136,serviziDiretti:14289,consulenzeDirette:0,serviziInformatici:806,serviziCloud:0,costiDiretti:15095,altriServizi:1750,costiIndiretti:1750,totaleCostiDirettiIndiretti:16845,margine:214290,ricaviNonTipici:0,costiCommerciali:15279,personale:137119,compensiAmministratore:0,rimborsiAmministratore:0,serviziContabiliPaghe:12617,consulenzeLegali:1794,consulenzeTecniche:29150,altreSpeseFunzionamento:39509,totaleStrutturaAltreVociNonTipiche:235468,ebitda:-21178,ammortamentiSvalutazioni:35091,gestioneStraordinaria:0,gestioneFinanziaria:1603,totaleAltreVociNonTipiche:36694,risultatoAnteImposte:-57871,imposte:0,risultatoEsercizio:-57871},progressivo2024:{ricaviCaratteristici:41650,altriRicavi:2006,totaleRicavi:43656,serviziDiretti:1161,consulenzeDirette:0,serviziInformatici:549,serviziCloud:0,costiDiretti:1710,altriServizi:5500,costiIndiretti:5500,totaleCostiDirettiIndiretti:7210,margine:36446,ricaviNonTipici:0,costiCommerciali:13162,personale:55950,compensiAmministratore:31166,rimborsiAmministratore:3002,serviziContabiliPaghe:11156,consulenzeLegali:0,consulenzeTecniche:49865,altreSpeseFunzionamento:20362,totaleStrutturaAltreVociNonTipiche:184663,ebitda:-148217,ammortamentiSvalutazioni:5933,gestioneStraordinaria:0,gestioneFinanziaria:2496,totaleAltreVociNonTipiche:8429,risultatoAnteImposte:-156646,imposte:0,risultatoEsercizio:-156646},agosto2025:{ricaviCaratteristici:0,altriRicavi:1106,totaleRicavi:1106,serviziDiretti:2388,consulenzeDirette:0,serviziInformatici:133,serviziCloud:0,costiDiretti:2521,beniStrumentali:0,speseManutenzione:0,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:2521,margine:-1415,ricaviNonTipici:0,costiCommerciali:309,personale:14126,compensiAmministratore:0,rimborsiAmministratore:0,serviziContabiliPaghe:1026,consulenzeLegali:0,consulenzeTecniche:2296,altreSpeseFunzionamento:1944,totaleStrutturaAltreVociNonTipiche:19701,ebitda:-21116,ammortamentiSvalutazioni:4482,gestioneStraordinaria:0,gestioneFinanziaria:188,totaleAltreVociNonTipiche:4670,risultatoAnteImposte:-25787,imposte:0,risultatoEsercizio:-25787},agosto2024:{ricaviCaratteristici:11581,altriRicavi:0,totaleRicavi:11581,serviziDiretti:179,consulenzeDirette:0,serviziInformatici:68,serviziCloud:0,costiDiretti:248,beniStrumentali:0,speseManutenzione:0,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:248,margine:11333,ricaviNonTipici:0,costiCommerciali:88,personale:4937,compensiAmministratore:5557,rimborsiAmministratore:46,serviziContabiliPaghe:818,consulenzeLegali:0,consulenzeTecniche:2596,altreSpeseFunzionamento:1315,totaleStrutturaAltreVociNonTipiche:15357,ebitda:-4024,ammortamentiSvalutazioni:756,gestioneStraordinaria:0,gestioneFinanziaria:297,totaleAltreVociNonTipiche:1053,risultatoAnteImposte:-5076,imposte:0,risultatoEsercizio:-5076}},ceDettaglioMensile:{progressivo2025:{months:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago"],ricaviCaratteristici:[56600,82100,107100,132600,151200,176200,219789,219789],altriRicavi:[0,0,10240,10240,10241,10241,10241,11347],totaleRicavi:[56600,82100,117340,142840,161441,186441,230030,231136],serviziDiretti:[530,5151,6478,8163,9213,10367,11901,14289],consulenzeDirette:[0,0,0,0,0,0,0,0],serviziInformatici:[106,210,344,544,606,627,673,806],serviziCloud:[0,0,0,0,0,0,0,0],costiDiretti:[636,5361,6821,8707,9819,10995,12574,15095],beniStrumentali:[0,0,0,0,0,0,0,0],speseManutenzione:[0,0,0,0,0,0,0,0],altriServizi:[0,1250,1250,1250,1250,1250,1750,1750],costiIndiretti:[0,1250,1250,1250,1250,1250,1750,1750],totaleCostiDirettiIndiretti:[636,6611,8071,9957,11069,12245,14324,16845],grossProfit:[55964,75490,109269,132883,150372,174196,215705,214290],autofatture:[0,0,0,0,0,0,0,0],rimborsiSpese:[0,0,0,0,0,0,0,0],altriProventi:[0,0,0,0,0,0,0,0],ricaviNonTipici:[0,0,0,0,0,0,0,0],speseViaggio:[372,1468,1908,2250,2795,2813,2987,3031],pedaggi:[0,0,0,0,0,0,0,0],pubblicita:[0,0,0,0,0,0,0,0],materialePubblicitario:[0,0,0,0,0,0,0,0],omaggi:[0,0,0,0,0,0,0,0],speseRappresentanza:[336,1113,2538,2982,3766,4081,4402,4562],mostreFiere:[5890,5890,5890,5890,5890,5890,5890,5890],serviziCommerciali:[58,113,168,223,278,333,388,443],carburante:[120,292,662,802,1028,1028,1303,1352],speseCommerciali:[6777,8876,11167,12148,13758,14146,14971,15279],beniIndeducibili:[113,877,1854,2123,2236,2236,2182,2182],speseGenerali:[194,20406,20888,21862,22205,22311,22311,23150],materialeConsumo:[0,0,0,0,0,0,0,0],spesePulizia:[0,0,0,0,0,0,0,0],utenze:[0,146,262,344,438,545,707,826],merci:[0,0,0,0,0,0,0,0],assicurazioni:[0,0,0,0,0,0,171,171],rimanenze:[0,0,0,0,0,0,0,0],tasseValori:[10,19,543,552,560,568,577,585],sanzioniMulte:[0,0,20,78,78,109,143,371],compensiAmministratore:[0,0,0,0,0,0,0,0],rimborsiAmministratore:[0,0,0,0,0,0,0,0],personale:[-6063,5129,59963,72552,85234,109029,122992,137119],serviziContabiliPaghe:[930,1781,6879,8233,9579,10605,11591,12617],consulenzeTecniche:[4877,11659,17594,21724,25854,26854,26854,29150],altreSpeseFunzionamento:[3473,26195,30758,33332,35094,36195,37565,39509],serviziAmministrativi:[930,1781,6879,8233,9579,10605,11591,12617],serviziAmministrativiPaghe:[0,0,0,0,0,0,0,0],consulenzeLegali:[0,0,0,0,0,0,1794,1794],locazioniNoleggi:[683,1707,3013,3866,4960,5686,6509,7133],serviziIndeducibili:[737,779,887,896,956,956,956,1052],utiliPerditeCambi:[22,497,510,512,513,513,513,513],perditeSuCrediti:[0,0,0,0,0,0,0,0],licenzeUso:[0,0,0,0,0,0,0,0],utenzeTelefoniche:[10,41,72,102,133,164,195,226],altriOneri:[1700,1720,2705,2991,3004,3094,3288,3288],abbuoniArrotondamenti:[4,4,4,5,10,12,12,12],speseStruttura:[3217,44764,115194,135841,155761,182683,200796,220189],totaleStruttura:[9993,53639,126361,147988,169520,196829,215767,235468],ebitda:[45971,21850,-17092,-15105,-19148,-22632,-61,-21178],ammortamentiImmateriali:[4346,8306,12784,17037,21448,25702,30111,34520],ammortamentiMateriali:[36,134,204,272,355,425,498,571],svalutazioni:[0,0,0,0,0,0,0,0],ammortamenti:[4382,8440,12988,17310,21803,26127,30609,35091],gestioneStraordinaria:[0,0,0,0,0,0,0,0],ebit:[41589,13410,-30081,-32415,-40951,-48759,-30670,-56268],speseCommissioniBancarie:[25,56,70,124,133,139,195,257],interessiPassiviMutui:[125,301,467,624,773,913,1044,1170],altriInteressi:[0,0,0,57,57,106,176,176],gestioneFinanziaria:[150,357,537,806,963,1158,1415,1603],ebt:[41439,13054,-30618,-33220,-41914,-49917,-32085,-57871],imposteDirette:[0,0,0,0,0,0,0,0],risultato:[41439,13054,-30618,-33220,-41914,-49917,-32085,-57871]},incrementiMensili2025:{months:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago"],ricaviCaratteristici:[56600,25500,25e3,25500,18600,25e3,43589,0],altriRicavi:[0,0,10240,0,1,0,0,1106],totaleRicavi:[56600,25500,35240,25500,18601,25e3,43589,1106],costiDiretti:[636,4725,1461,1886,1112,1176,1580,2521],costiIndiretti:[0,1250,0,0,0,0,500,0],grossProfit:[55964,19525,33779,23614,17489,23824,41509,-1415],speseCommerciali:[6777,2099,2292,980,1611,387,825,309],personale:[-6063,11192,54834,12589,12682,23795,13963,14126],compensiAmministratore:[0,0,0,0,0,0,0,0],serviziContabiliPaghe:[930,851,5098,1354,1346,1026,986,1026],consulenzeTecniche:[4877,6782,5936,4130,4130,1e3,0,2296],altreSpeseFunzionamento:[3473,22722,4563,2574,1762,1101,1370,1944],totaleStruttura:[9993,43646,72722,21627,21531,27309,18938,19701],ebitda:[45971,-24121,-38943,1987,-4042,-3485,22571,-21116],ammortamenti:[4382,4058,4548,4321,4494,4323,4482,4482],gestioneFinanziaria:[150,207,180,269,158,195,257,188],risultato:[41439,-28386,-43671,-2603,-8694,-8003,17832,-25787]}},ceSinteticoMensile:{progressivo2025:{months:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago"],ricaviCaratteristici:[56600,82100,107100,132600,151200,176200,219789,219789],altriRicavi:[0,0,10240,10240,10241,10241,10241,11347],totaleRicavi:[56600,82100,117340,142840,161441,186441,230030,231136],serviziDiretti:[530,5151,6478,8163,9213,10367,11901,14289],consulenzeDirette:[0,0,0,0,0,0,0,0],serviziInformaticiWeb:[106,210,344,544,606,627,673,806],serviziCloud:[0,0,0,0,0,0,0,0],costiDiretti:[636,5361,6821,8707,9819,10995,12574,15095],beniStrumentali:[0,0,0,0,0,0,0,0],speseManutenzione:[0,0,0,0,0,0,0,0],altriServiziPrestazioni:[0,1250,1250,1250,1250,1250,1750,1750],costiIndiretti:[0,1250,1250,1250,1250,1250,1750,1750],totaleCostiDirettiIndiretti:[636,6611,8071,9957,11069,12245,14324,16845],grossProfit:[55964,75490,109269,132883,150372,174196,215705,214290],ricaviNonTipici:[0,0,0,0,0,0,0,0],costiCommerciali:[6777,8876,11167,12148,13758,14146,14971,15279],personale:[-6063,5129,59963,72552,85234,109029,122992,137119],compensiAmministratore:[0,0,0,0,0,0,0,0],rimborsiAmministratore:[0,0,0,0,0,0,0,0],serviziContabiliPaghe:[930,1781,6879,8233,9579,10605,11591,12617],consulenzeLegali:[0,0,0,0,0,0,1794,1794],consulenzeTecniche:[4877,11659,17594,21724,25854,26854,26854,29150],altreSpeseFunzionamento:[3473,26195,30758,33332,35094,36195,37565,39509],totaleStruttura:[9993,53639,126361,147988,169520,196829,215767,235468],ebitda:[45971,21850,-17092,-15105,-19148,-22632,-61,-21178],ammortamentiSvalutazioni:[4382,8440,12988,17310,21803,26127,30609,35091],gestioneStraordinaria:[0,0,0,0,0,0,0,0],gestioneFinanziaria:[150,357,537,806,963,1158,1415,1603],totaleAltreVociNonTipiche:[4532,8797,13526,18115,22767,27285,32023,36694],risultatoAnteImposte:[41439,13054,-30618,-33220,-41914,-49917,-32085,-57871],imposte:[0,0,0,0,0,0,0,0],risultatoEsercizio:[41439,13054,-30618,-33220,-41914,-49917,-32085,-57871]},incrementiMensili2025:{months:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago"],ricaviCaratteristici:[56600,25500,25e3,25500,18600,25e3,43589,0],altriRicavi:[0,0,10240,0,1,0,0,1106],totaleRicavi:[56600,25500,35240,25500,18601,25e3,43589,1106],costiDiretti:[636,4725,1461,1886,1112,1176,1580,2521],costiIndiretti:[0,1250,0,0,0,0,500,0],totaleCostiDirettiIndiretti:[636,5975,1461,1886,1112,1176,2080,2521],grossProfit:[55964,19525,33779,23614,17489,23824,41509,-1415],ricaviNonTipici:[0,0,0,0,0,0,0,0],costiCommerciali:[6777,2099,2292,980,1611,387,825,309],personale:[-6063,11192,54834,12589,12682,23795,13963,14126],compensiAmministratore:[0,0,0,0,0,0,0,0],rimborsiAmministratore:[0,0,0,0,0,0,0,0],serviziContabiliPaghe:[930,851,5098,1354,1346,1026,986,1026],consulenzeLegali:[0,0,0,0,0,0,1794,0],consulenzeTecniche:[4877,6782,5936,4130,4130,1e3,0,2296],altreSpeseFunzionamento:[3473,22722,4563,2574,1762,1101,1370,1944],totaleStruttura:[9993,43646,72722,21627,21531,27309,18938,19701],ebitda:[45971,-24121,-38943,1987,-4042,-3485,22571,-21116],ammortamentiSvalutazioni:[4382,4058,4548,4321,4494,4323,4482,4482],gestioneStraordinaria:[0,0,0,0,0,0,0,0],gestioneFinanziaria:[150,207,180,269,158,195,257,188],totaleAltreVociNonTipiche:[4532,4265,4729,4590,4651,4518,4739,4670],risultatoAnteImposte:[41439,-28386,-43671,-2603,-8694,-8003,17832,-25787],imposte:[0,0,0,0,0,0,0,0],risultatoEsercizio:[41439,-28386,-43671,-2603,-8694,-8003,17832,-25787]}},ceDettaglio2024:{gennaio:{progressivo:{values2025:{ricaviCaratteristici:56600,altriRicavi:0,totaleRicavi:56600,serviziDiretti:530,consulenzeDirette:0,serviziInformatici:106,serviziCloud:0,costiDiretti:636,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:636,grossProfit:55964,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:372,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:336,mostreFiere:5890,serviziCommerciali:58,carburante:120,speseCommerciali:6777,beniIndeducibili:113,speseGenerali:194,materialeConsumo:0,spesePulizia:0,utenze:0,assicurazioni:0,rimanenze:0,tasseValori:10,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:-6063,serviziAmministrativi:930,serviziAmministrativiPaghe:0,consulenzeTecniche:4877,consulenzeLegali:0,locazioniNoleggi:683,serviziIndeducibili:737,utiliPerditeCambi:22,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:10,altriOneri:1700,abbuoniArrotondamenti:4,speseStruttura:3217,totaleGestioneStruttura:9993,ebitda:45971,ammortamentiImmateriali:4346,ammortamentiMateriali:36,svalutazioni:0,totaleAmmortamenti:4382,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:41589,speseCommissioniBancarie:25,interessiPassiviMutui:125,altriInteressi:0,gestioneFinanziaria:150,ebt:41439,imposteDirette:0,risultatoEsercizio:41439},values2024:{ricaviCaratteristici:0,altriRicavi:0,totaleRicavi:0,serviziDiretti:254,consulenzeDirette:0,serviziInformatici:0,serviziCloud:0,costiDiretti:254,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:254,grossProfit:-253,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:297,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:389,mostreFiere:0,serviziCommerciali:0,carburante:0,speseCommerciali:686,beniIndeducibili:0,speseGenerali:1908,materialeConsumo:0,spesePulizia:0,utenze:0,assicurazioni:0,rimanenze:0,tasseValori:0,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:8380,serviziAmministrativi:818,serviziAmministrativiPaghe:0,consulenzeTecniche:850,consulenzeLegali:1500,locazioniNoleggi:450,serviziIndeducibili:0,utiliPerditeCambi:0,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:0,altriOneri:749,abbuoniArrotondamenti:0,speseStruttura:14655,totaleGestioneStruttura:15341,ebitda:-15594,ammortamentiImmateriali:0,ammortamentiMateriali:0,svalutazioni:0,totaleAmmortamenti:0,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:-15594,speseCommissioniBancarie:9,interessiPassiviMutui:0,altriInteressi:0,gestioneFinanziaria:9,ebt:-15603,imposteDirette:0,risultatoEsercizio:-15603},variazioni:{ricaviCaratteristici:56600,altriRicavi:0,totaleRicavi:56600,serviziDiretti:276,consulenzeDirette:0,serviziInformatici:106,serviziCloud:0,costiDiretti:382,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:382,grossProfit:56217,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:75,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:-53,mostreFiere:5890,serviziCommerciali:58,carburante:120,speseCommerciali:6091,beniIndeducibili:113,speseGenerali:-1714,materialeConsumo:0,spesePulizia:0,utenze:0,assicurazioni:0,rimanenze:0,tasseValori:10,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:-14443,serviziAmministrativi:112,serviziAmministrativiPaghe:0,consulenzeTecniche:4027,consulenzeLegali:-1500,locazioniNoleggi:233,serviziIndeducibili:737,utiliPerditeCambi:22,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:10,altriOneri:951,abbuoniArrotondamenti:4,speseStruttura:-11438,totaleGestioneStruttura:-5348,ebitda:61565,ammortamentiImmateriali:4346,ammortamentiMateriali:36,svalutazioni:0,totaleAmmortamenti:4382,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:57183,speseCommissioniBancarie:16,interessiPassiviMutui:125,altriInteressi:0,gestioneFinanziaria:141,ebt:57042,imposteDirette:0,risultatoEsercizio:57042},variazioniPercentuali:{ricaviCaratteristici:0,altriRicavi:0,totaleRicavi:0,serviziDiretti:108.7,consulenzeDirette:0,serviziInformatici:0,serviziCloud:0,costiDiretti:150.4,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:150.4,grossProfit:22220.2,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:25.3,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:-13.6,mostreFiere:0,serviziCommerciali:0,carburante:0,speseCommerciali:887.9,beniIndeducibili:0,speseGenerali:-89.8,materialeConsumo:0,spesePulizia:0,utenze:0,assicurazioni:0,rimanenze:0,tasseValori:0,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:-172.4,serviziAmministrativi:13.7,serviziAmministrativiPaghe:0,consulenzeTecniche:473.8,consulenzeLegali:-100,locazioniNoleggi:51.8,serviziIndeducibili:0,utiliPerditeCambi:0,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:0,altriOneri:127,abbuoniArrotondamenti:0,speseStruttura:-78,totaleGestioneStruttura:-34.9,ebitda:394.8,ammortamentiImmateriali:0,ammortamentiMateriali:0,svalutazioni:0,totaleAmmortamenti:0,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:366.7,speseCommissioniBancarie:177.8,interessiPassiviMutui:0,altriInteressi:0,gestioneFinanziaria:1566.7,ebt:365.6,imposteDirette:0,risultatoEsercizio:365.6}}},febbraio:{progressivo:{values2025:{ricaviCaratteristici:82100,altriRicavi:0,totaleRicavi:82100,serviziDiretti:5151,consulenzeDirette:0,serviziInformatici:210,serviziCloud:0,costiDiretti:5361,altriServizi:1250,costiIndiretti:1250,totaleCostiDirettiIndiretti:6611,grossProfit:75490,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:1468,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:1113,mostreFiere:5890,serviziCommerciali:113,carburante:292,speseCommerciali:8876,beniIndeducibili:877,speseGenerali:20406,materialeConsumo:0,spesePulizia:0,utenze:146,assicurazioni:0,rimanenze:0,tasseValori:19,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:5129,serviziAmministrativi:1781,serviziAmministrativiPaghe:0,consulenzeTecniche:11659,consulenzeLegali:0,locazioniNoleggi:1707,serviziIndeducibili:779,utiliPerditeCambi:497,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:41,altriOneri:1720,abbuoniArrotondamenti:4,speseStruttura:44764,totaleGestioneStruttura:53639,ebitda:21850,ammortamentiImmateriali:8306,ammortamentiMateriali:134,svalutazioni:0,totaleAmmortamenti:8440,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:13410,speseCommissioniBancarie:56,interessiPassiviMutui:301,altriInteressi:0,gestioneFinanziaria:357,ebt:13054,imposteDirette:0,risultatoEsercizio:13054},values2024:{ricaviCaratteristici:0,altriRicavi:0,totaleRicavi:0,serviziDiretti:261,consulenzeDirette:0,serviziInformatici:0,serviziCloud:0,costiDiretti:261,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:261,grossProfit:-260,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:399,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:438,mostreFiere:0,serviziCommerciali:0,carburante:0,speseCommerciali:837,beniIndeducibili:0,speseGenerali:2042,materialeConsumo:0,spesePulizia:0,utenze:128,assicurazioni:0,rimanenze:0,tasseValori:0,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:17510,serviziAmministrativi:1932,serviziAmministrativiPaghe:0,consulenzeTecniche:32614,consulenzeLegali:0,locazioniNoleggi:900,serviziIndeducibili:0,utiliPerditeCambi:27,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:15,altriOneri:749,abbuoniArrotondamenti:0,speseStruttura:55917,totaleGestioneStruttura:56754,ebitda:-57014,ammortamentiImmateriali:0,ammortamentiMateriali:0,svalutazioni:0,totaleAmmortamenti:0,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:-57014,speseCommissioniBancarie:14,interessiPassiviMutui:0,altriInteressi:140,gestioneFinanziaria:153,ebt:-57168,imposteDirette:0,risultatoEsercizio:-57168},variazioni:{ricaviCaratteristici:82100,altriRicavi:0,totaleRicavi:82100,serviziDiretti:4890,consulenzeDirette:0,serviziInformatici:210,serviziCloud:0,costiDiretti:5100,altriServizi:1250,costiIndiretti:1250,totaleCostiDirettiIndiretti:6350,grossProfit:75750,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:1069,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:675,mostreFiere:5890,serviziCommerciali:113,carburante:292,speseCommerciali:8039,beniIndeducibili:877,speseGenerali:18364,materialeConsumo:0,spesePulizia:0,utenze:18,assicurazioni:0,rimanenze:0,tasseValori:19,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:-12381,serviziAmministrativi:-151,serviziAmministrativiPaghe:0,consulenzeTecniche:-20955,consulenzeLegali:0,locazioniNoleggi:807,serviziIndeducibili:779,utiliPerditeCambi:470,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:26,altriOneri:971,abbuoniArrotondamenti:4,speseStruttura:-11153,totaleGestioneStruttura:-3115,ebitda:78864,ammortamentiImmateriali:8306,ammortamentiMateriali:134,svalutazioni:0,totaleAmmortamenti:8440,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:70424,speseCommissioniBancarie:42,interessiPassiviMutui:301,altriInteressi:-140,gestioneFinanziaria:204,ebt:70222,imposteDirette:0,risultatoEsercizio:70222},variazioniPercentuali:{ricaviCaratteristici:0,altriRicavi:0,totaleRicavi:0,serviziDiretti:1873.6,consulenzeDirette:0,serviziInformatici:0,serviziCloud:0,costiDiretti:1954,altriServizi:0,costiIndiretti:0,totaleCostiDirettiIndiretti:2433,grossProfit:29134.6,autofatture:0,rimborsiSpese:0,altriProventi:0,ricaviNonTipici:0,speseViaggio:267.9,pedaggi:0,pubblicita:0,materialePubblicitario:0,omaggi:0,speseRappresentanza:154.1,mostreFiere:0,serviziCommerciali:0,carburante:0,speseCommerciali:960.5,beniIndeducibili:0,speseGenerali:899.3,materialeConsumo:0,spesePulizia:0,utenze:14.1,assicurazioni:0,rimanenze:0,tasseValori:0,sanzioniMulte:0,compensiAmministratore:0,rimborsiAmministratore:0,personale:-70.7,serviziAmministrativi:-7.8,serviziAmministrativiPaghe:0,consulenzeTecniche:-64.3,consulenzeLegali:0,locazioniNoleggi:89.7,serviziIndeducibili:0,utiliPerditeCambi:1740.7,perditeSuCrediti:0,licenzeUso:0,utenzeTelefoniche:173.3,altriOneri:129.6,abbuoniArrotondamenti:0,speseStruttura:-19.9,totaleGestioneStruttura:-5.5,ebitda:138.3,ammortamentiImmateriali:0,ammortamentiMateriali:0,svalutazioni:0,totaleAmmortamenti:0,plusvalenzeStraordinarie:0,altriProventiStraordinari:0,gestioneStraordinaria:0,ebit:123.5,speseCommissioniBancarie:300,interessiPassiviMutui:0,altriInteressi:-100,gestioneFinanziaria:133.3,ebt:122.8,imposteDirette:0,risultatoEsercizio:122.8}}}}};function At(e){return e==null||isNaN(e)?" 0":new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function Qt(e,t=1){return e==null||isNaN(e)?"0.0%":`${e.toFixed(t)}%`}function Yn(e,t){return e==null||t===null||t===void 0||t===0?0:(e-t)/Math.abs(t)*100}const _a="ffd64e5f-4692-4254-8ef4-f1611935f08e";async function Oj(){console.log(`
 Caricamento dati finanziari in Supabase...
`);try{console.log(" Caricamento Dashboard...");const e={kpis:zn.dashboard.kpis,monthlyTrend:zn.dashboard.monthlyTrend,summary:zn.dashboard.summary},{data:t,error:r}=await ze.from("financial_data").upsert({company_id:_a,data_type:"dashboard",data:e,year:2025,month:8}).select();r?console.error(" Errore Dashboard:",r):console.log(" Dashboard caricata:",t),console.log(" Caricamento CE Dettaglio...");const n={progressivo2025:zn.ceDettaglio.progressivo2025,progressivo2024:zn.ceDettaglio.progressivo2024},{data:i,error:s}=await ze.from("financial_data").upsert({company_id:_a,data_type:"ce-dettaglio",data:n,year:2025,month:null}).select();s?console.error(" Errore CE Dettaglio:",s):console.log(" CE Dettaglio caricato:",i),console.log(`
 Caricamento CE Sintetico...`);const a={progressivo2025:zn.ceSintetico.progressivo2025,progressivo2024:zn.ceSintetico.progressivo2024},{data:o,error:l}=await ze.from("financial_data").upsert({company_id:_a,data_type:"ce-sintetico",data:a,year:2025,month:null}).select();l?console.error(" Errore CE Sintetico:",l):console.log(" CE Sintetico caricato:",o),console.log(`
 Caricamento CE Sintetico Mensile...`);const c={progressivo2025:zn.ceSinteticoMensile.progressivo2025,incrementiMensili2025:zn.ceSinteticoMensile.incrementiMensili2025},{data:u,error:d}=await ze.from("financial_data").upsert({company_id:_a,data_type:"ce-sintetico-mensile",data:c,year:2025,month:null}).select();d?console.error(" Errore CE Sintetico Mensile:",d):console.log(" CE Sintetico Mensile caricato:",u),console.log(`
 Caricamento CE Dettaglio Mensile (dati per singolo mese)...`);const f=[{name:"gennaio",num:1,key2025:"gennaio2025",key2024:"gennaio2024"},{name:"febbraio",num:2,key2025:"febbraio2025",key2024:"febbraio2024"},{name:"marzo",num:3,key2025:"marzo2025",key2024:"marzo2024"},{name:"aprile",num:4,key2025:"aprile2025",key2024:"aprile2024"},{name:"maggio",num:5,key2025:"maggio2025",key2024:"maggio2024"},{name:"giugno",num:6,key2025:"giugno2025",key2024:"giugno2024"},{name:"luglio",num:7,key2025:"luglio2025",key2024:"luglio2024"},{name:"agosto",num:8,key2025:"agosto2025",key2024:"agosto2024"}];for(const E of f){const k=zn.ceDettaglio,S=k[E.key2025],C=k[E.key2024];if(S||C){const T={...S&&{[E.key2025]:S},...C&&{[E.key2024]:C}},{data:P,error:I}=await ze.from("financial_data").upsert({company_id:_a,data_type:"ce-dettaglio-mensile",data:T,year:2025,month:E.num}).select();I?console.error(` Errore ${E.name}:`,I):console.log(` ${E.name} caricato`)}}console.log(`
 Caricamento CE Dettaglio Mensile (vista progressiva)...`);const p={progressivo2025:zn.ceDettaglioMensile.progressivo2025},{data:m,error:h}=await ze.from("financial_data").upsert({company_id:_a,data_type:"ce-dettaglio-mensile",data:p,year:2025,month:null}).select();h?console.error(" Errore CE Dettaglio Mensile progressivo:",h):console.log(" CE Dettaglio Mensile progressivo caricato"),console.log(`
 Caricamento Partitari...`);const{partitariHeaders:g,partitariData:v}=await Pj(async()=>{const{partitariHeaders:E,partitariData:k}=await import("./partitariData-DvbNNJt_.js");return{partitariHeaders:E,partitariData:k}},[]),w={headers:g,data:v},{data:y,error:b}=await ze.from("financial_data").upsert({company_id:_a,data_type:"partitari",data:w,year:2025,month:8}).select();b?console.error(" Errore Partitari:",b):console.log(" Partitari caricati:",y),console.log(`
 Caricamento completato!
`),console.log(" Esegui checkSupabaseData() per verificare i dati caricati")}catch(e){console.error(" Errore generale:",e)}}typeof window<"u"&&(window.loadFinancialDataToSupabase=Oj);async function Ij(){console.log(`
 Diagnostica dati Sherpa42 in Supabase...
`),console.log(` STEP 1: Verifica esistenza azienda Sherpa42
`);const{data:e,error:t}=await ze.from("companies").select("*").or("name.ilike.%sherpa42%,name.ilike.%sherpa%,slug.ilike.%sherpa42%,slug.ilike.%sherpa%").order("name");if(t){console.error(" Errore nel caricamento aziende:",t);return}if(!e||e.length===0){console.log("  Sherpa42 NON trovata nella tabella companies"),console.log(`
 Azione necessaria: Creare l'azienda Sherpa42 nella tabella companies`),console.log("   Query SQL suggerita:"),console.log("   INSERT INTO companies (name, slug) VALUES ('Sherpa42', 'sherpa42') RETURNING *;");return}console.log(` Trovata/e ${e.length} azienda/e corrispondente/i:
`);for(const r of e)console.log(`   - ID: ${r.id}`),console.log(`     Nome: ${r.name}`),console.log(`     Slug: ${r.slug||"N/A"}`),console.log(`     Creata: ${r.created_at}
`);for(const r of e){console.log(`
 STEP 2: Verifica dati finanziari per ${r.name} (ID: ${r.id})
`);const{data:n,error:i}=await ze.from("financial_data").select("*").eq("company_id",r.id).order("created_at",{ascending:!1});if(i){console.error(" Errore nel caricamento dati:",i);continue}if(!n||n.length===0){console.log("  Nessun dato finanziario trovato per questa azienda"),console.log(`
 Azione necessaria: Caricare i dati finanziari per Sherpa42`);continue}console.log(` Trovati ${n.length} record finanziari:
`);const s={};for(const o of n){const l=o.data_type||"unknown";s[l]||(s[l]=[]),s[l].push(o)}for(const[o,l]of Object.entries(s)){console.log(`    ${o}: ${l.length} record`);for(const c of l){if(console.log(`      - Year: ${c.year||"N/A"}, Month: ${c.month!==null&&c.month!==void 0?c.month:"null"}`),console.log(`        Created: ${c.created_at}`),c.data){const u=Object.keys(c.data);if(console.log(`        Chiavi dati: ${u.join(", ")}`),o==="dashboard"&&c.data.kpis){const d=Object.keys(c.data.kpis);console.log(`        KPIs presenti: ${d.join(", ")}`);const f=!!c.data.monthlyTrend&&!!c.data.summary,p=!!c.data.trends&&!!c.data.table;console.log(f?"         Struttura STANDARD (kpis, monthlyTrend, summary)":p?"          Struttura ALTERNATIVA (kpis, trends, table)":"          Struttura NON RICONOSCIUTA")}}console.log("")}}console.log(`
    Verifica specifica per DASHBOARD:`);const a=n.filter(o=>o.data_type==="dashboard");if(a.length===0)console.log('        Nessun record con data_type="dashboard" trovato'),console.log(`
       Azione necessaria: Caricare dati dashboard per Sherpa42`);else{console.log(`       Trovati ${a.length} record dashboard:`);for(const o of a)if(console.log(`         - Year: ${o.year}, Month: ${o.month!==null&&o.month!==void 0?o.month:"null"}`),o.data){const l=!!o.data.kpis,c=!!o.data.monthlyTrend,u=!!o.data.summary,d=!!o.data.trends,f=!!o.data.table;console.log(`           Struttura: kpis=${l?"":""}, monthlyTrend=${c?"":""}, summary=${u?"":""}`),console.log(`           Alternativa: trends=${d?"":""}, table=${f?"":""}`),l||console.log("             PROBLEMA: KPIs mancanti!")}}}console.log(`
`+"".repeat(80)),console.log(` Diagnostica completata!
`),console.log(" Prossimi passi:"),console.log("   1. Se Sherpa42 non esiste, crearla nella tabella companies"),console.log("   2. Se mancano dati, caricarli usando loadFinancialDataToSupabase() o SQL"),console.log(`   3. Verificare che la struttura dati sia corretta
`)}typeof window<"u"&&(window.checkSherpa42Data=Ij);const om="0fb5063a-4b54-4ab1-ae2b-afd04865a1a1";async function Dj(){console.log(`
 Diagnostica rapida Sherpa42...
`),console.log(` ID Azienda: ${om}
`);const{data:e,error:t}=await ze.from("companies").select("*").eq("id",om).single();if(t){console.error(" Errore nel caricamento azienda:",t);return}if(!e){console.error(" Azienda non trovata");return}console.log(` Azienda trovata: ${e.name} (${e.slug})
`),console.log("".repeat(60));const{data:r,error:n}=await ze.from("financial_data").select("*").eq("company_id",om).order("created_at",{ascending:!1});if(n){console.error(" Errore nel caricamento dati:",n);return}if(!r||r.length===0){console.log("  NESSUN DATO FINANZIARIO TROVATO per Sherpa42"),console.log(`
 Azione necessaria: Caricare i dati finanziari`);return}console.log(`
 Trovati ${r.length} record finanziari:
`);const i={};for(const a of r){const o=a.data_type||"unknown";i[o]||(i[o]=[]),i[o].push(a)}for(const[a,o]of Object.entries(i)){console.log(` ${a}: ${o.length} record`);for(const l of o)if(console.log(`   - Year: ${l.year}, Month: ${l.month??"null"}, Created: ${l.created_at}`),l.data){const c=Object.keys(l.data);if(console.log(`     Keys: ${c.join(", ")}`),a==="dashboard"&&l.data.kpis){const u=!!(l.data.monthlyTrend&&l.data.summary),d=!!(l.data.trends&&l.data.table);console.log(`     Struttura: ${u?"STANDARD ":d?"ALTERNATIVA ":"NON RICONOSCIUTA "}`)}}console.log("")}const s=r.filter(a=>a.data_type==="dashboard");if(console.log(" Verifica DASHBOARD:"),s.length===0)console.log("     NESSUN RECORD DASHBOARD TROVATO"),console.log("    Caricare dati dashboard per Sherpa42");else{console.log(`    ${s.length} record dashboard trovati`);for(const a of s)console.log(`      Year: ${a.year}, Month: ${a.month??"null"}`),a.data&&(console.log(`      KPIs: ${a.data.kpis?"":""}`),console.log(`      monthlyTrend: ${a.data.monthlyTrend?"":""}`),console.log(`      summary: ${a.data.summary?"":""}`),console.log(`      trends: ${a.data.trends?"":""}`),console.log(`      table: ${a.data.table?"":""}`))}console.log(`
`+"".repeat(60)),console.log(` Diagnostica completata!
`)}typeof window<"u"&&(window.diagnoseSherpa42=Dj);const hf="0fb5063a-4b54-4ab1-ae2b-afd04865a1a1";async function Nj(){console.log(`
 TEST: Caricamento dati Sherpa42
`),console.log(` ID: ${hf}
`),console.log("1 Verifica azienda...");const{data:e,error:t}=await ze.from("companies").select("*").eq("id",hf).single();if(t){console.error(" Errore:",t);return}console.log(` Azienda: ${e.name}
`),console.log("2 Carica dati dashboard (month=9)...");const{data:r,error:n}=await ze.from("financial_data").select("*").eq("company_id",hf).eq("data_type","dashboard").eq("year",2025).eq("month",9).order("created_at",{ascending:!1}).limit(1);if(n){console.error(" Errore:",n);return}if(!r||r.length===0){console.log(`  Nessun dato trovato con month=9
`),console.log("3 Prova senza filtro month...");const{data:s,error:a}=await ze.from("financial_data").select("*").eq("company_id",hf).eq("data_type","dashboard").order("created_at",{ascending:!1}).limit(1);if(a){console.error(" Errore:",a);return}if(!s||s.length===0){console.log(" Nessun dato dashboard trovato per Sherpa42");return}console.log(` Trovato record: Year=${s[0].year}, Month=${s[0].month}`),console.log(" Struttura dati:",Object.keys(s[0].data||{}));return}console.log(` Trovato record: Year=${r[0].year}, Month=${r[0].month}`),console.log(" Struttura dati:",Object.keys(r[0].data||{})),console.log(`
3 Verifica struttura dati...`);const i=r[0].data;i&&(console.log("   KPIs:",i.kpis?"":""),console.log("   monthlyTrend:",i.monthlyTrend?"":""),console.log("   summary:",i.summary?"":""),console.log("   trends:",i.trends?"":""),console.log("   table:",i.table?"":""),i.kpis&&(console.log(`
    KPIs presenti:`),console.log("      Ricavi 2025:",i.kpis.ricavi2025||"N/A"),console.log("      EBITDA 2025:",i.kpis.ebitda2025||"N/A"))),console.log(`
 Test completato!
`)}typeof window<"u"&&(window.testSherpa42Load=Nj);const Fj="0fb5063a-4b54-4ab1-ae2b-afd04865a1a1";async function Mj(){console.log(`
 Ispezione dati Sherpa42...
`);const{data:e,error:t}=await ze.from("financial_data").select("*").eq("company_id",Fj).eq("data_type","dashboard").eq("year",2025).eq("month",9).single();if(t){console.error(" Errore:",t);return}if(!e||!e.data){console.error(" Nessun dato trovato");return}const r=e.data;console.log(" Chiavi principali:",Object.keys(r)),console.log(`
 KPIs:`,r.kpis),console.log(`
 TRENDS struttura completa:`),console.log(JSON.stringify(r.trends,null,2)),console.log(`
 TABLE tipo:`,Array.isArray(r.table)?"array":typeof r.table),console.log(" TABLE lunghezza:",Array.isArray(r.table)?r.table.length:"N/A"),Array.isArray(r.table)&&r.table.length>0&&console.log(" TABLE primo elemento:",r.table[0]),r.trends&&(console.log(`
 Analisi TRENDS:`),console.log("   Keys:",Object.keys(r.trends)),console.log("   Ha monthlyTrend?",!!r.trends.monthlyTrend),console.log("   Ha labels?",!!r.trends.labels),console.log("   Ha ricavi?",!!r.trends.ricavi),console.log("   Ha ebitda?",!!r.trends.ebitda),r.trends.monthlyTrend&&console.log("   monthlyTrend keys:",Object.keys(r.trends.monthlyTrend))),console.log(`
 Ispezione completata!
`)}typeof window<"u"&&(window.inspectSherpa42Data=Mj);const lm="0fb5063a-4b54-4ab1-ae2b-afd04865a1a1";async function Lj(){var s,a,o;console.log(`
 ========== DEBUG COMPLETO FLUSSO DASHBOARD ==========
`),console.log(" STEP 1: Verifica azienda in Supabase");const{data:e,error:t}=await ze.from("companies").select("*").eq("id",lm).single();if(t){console.error(" Errore:",t);return}console.log(` Azienda trovata: ${e.name}
`),console.log(" STEP 2: Simula getDashboardData()");let{data:r,error:n}=await ze.from("financial_data").select("*").eq("company_id",lm).eq("data_type","dashboard").eq("year",2025).eq("month",8).order("created_at",{ascending:!1});if(console.log(`   Tentativo 1 (month=8): ${(r==null?void 0:r.length)||0} record`),(!r||r.length===0)&&!n){const l=await ze.from("financial_data").select("*").eq("company_id",lm).eq("data_type","dashboard").eq("year",2025).eq("month",9).order("created_at",{ascending:!1});r=l.data,n=l.error,console.log(`   Tentativo 2 (month=9): ${(r==null?void 0:r.length)||0} record `)}if(n){console.error(" Errore query:",n);return}if(!r||r.length===0){console.error(" Nessun dato trovato");return}console.log(` Dati trovati: ${r.length} record
`),console.log(" STEP 3: Verifica struttura dati");const i=r[0].data;if(console.log("   Chiavi:",Object.keys(i)),console.log("   Ha kpis?",!!i.kpis),console.log("   Ha trends?",!!i.trends),console.log("   Ha table?",!!i.table),console.log("   Ha monthlyTrend?",!!i.monthlyTrend),console.log("   Ha summary?",!!i.summary),console.log(""),console.log(" STEP 4: Simula conversione KPIs"),i.kpis){const l=i.kpis;if(console.log("   Struttura KPIs:",Object.keys(l)),l.ricavi2025!==void 0)console.log("    KPIs gi in formato standard");else{console.log("     KPIs in formato Sherpa42, converto...");const c=((s=l.ricavi)==null?void 0:s.value)||0,u=((a=l.ebitda)==null?void 0:a.value)||0,d=((o=l.margine)==null?void 0:o.value)||0;console.log(`   Ricavi 2025: ${c}`),console.log(`   EBITDA 2025: ${u}`),console.log(`   Margine 2025: ${d}`);const f={ricavi2025:c,ricavi2024:0,costi2025:c-u,costi2024:0,ebitda2025:u,ebitda2024:0,risultato2025:u,risultato2024:0,margineEbitda2025:d*100,margineEbitda2024:0};console.log("    KPIs convertiti:",f)}}if(console.log(""),console.log(" STEP 5: Simula conversione trends"),i.trends){const l=i.trends;if(console.log("   Struttura trends:",Object.keys(l)),l.ricavi&&Array.isArray(l.ricavi)){const d={labels:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set"].slice(0,l.ricavi.length),ricavi:l.ricavi,ebitda:[]};console.log("    Trends convertito:",{labels:d.labels.length,ricavi:d.ricavi.length,ebitda:d.ebitda.length})}}if(console.log(""),console.log(" STEP 6: Simula conversione table"),Array.isArray(i.table)&&(console.log(`   Table lunghezza: ${i.table.length}`),i.table.length>0)){console.log("   Primo elemento:",i.table[0]);const l=i.table.map(c=>({voce:c.voce||"",value2025:c.valore||0,percentage:c.percentuale||0,value2024:0}));console.log(`    Summary convertito: ${l.length} elementi`)}console.log(""),console.log(` ========== DEBUG COMPLETATO ==========
`),console.log(" Se tutti gli step sono , il problema  nel rendering React"),console.log(` Controlla se setDashboardData viene chiamato con i dati convertiti
`)}typeof window<"u"&&(window.debugDashboardFlow=Lj);const zj="ffd64e5f-4692-4254-8ef4-f1611935f08e",jj="0fb5063a-4b54-4ab1-ae2b-afd04865a1a1";async function Bj(){var i;console.log(`
 ========== CONFRONTO AWENTIA vs SHERPA42 ==========
`),console.log(" AWENTIA:");const{data:e,error:t}=await ze.from("financial_data").select("*").eq("company_id",zj).eq("data_type","dashboard").eq("year",2025).eq("month",8).limit(1).single();if(t)console.error("    Errore:",t);else if(e&&e.data){const s=e.data;console.log("    Dati trovati"),console.log("    Struttura:",Object.keys(s)),console.log("    KPIs tipo:",typeof s.kpis),console.log("    monthlyTrend:",!!s.monthlyTrend,s.monthlyTrend?`(${((i=s.monthlyTrend.labels)==null?void 0:i.length)||0} labels)`:""),console.log("    summary:",Array.isArray(s.summary)?`${s.summary.length} elementi`:"non array"),console.log("    trends:",!!s.trends),console.log("    table:",!!s.table),s.kpis&&(console.log("    KPIs keys:",Object.keys(s.kpis)),s.kpis.ricavi2025!==void 0&&(console.log("    Ricavi 2025:",s.kpis.ricavi2025),console.log("    EBITDA 2025:",s.kpis.ebitda2025)))}else console.log("    Nessun dato trovato");console.log(`
 SHERPA42:`);const{data:r,error:n}=await ze.from("financial_data").select("*").eq("company_id",jj).eq("data_type","dashboard").eq("year",2025).eq("month",9).limit(1).single();if(n)console.error("    Errore:",n);else if(r&&r.data){const s=r.data;console.log("    Dati trovati"),console.log("    Struttura:",Object.keys(s)),console.log("    KPIs tipo:",typeof s.kpis),console.log("    monthlyTrend:",!!s.monthlyTrend),console.log("    summary:",Array.isArray(s.summary)?`${s.summary.length} elementi`:"non array"),console.log("    trends:",!!s.trends,s.trends?`(${Object.keys(s.trends).join(", ")})`:""),console.log("    table:",Array.isArray(s.table)?`${s.table.length} elementi`:"non array"),s.kpis&&(console.log("    KPIs keys:",Object.keys(s.kpis)),s.kpis.ricavi&&console.log("    Ricavi (Sherpa42):",s.kpis.ricavi),s.kpis.ricavi2025!==void 0&&console.log("    Ricavi 2025:",s.kpis.ricavi2025))}else console.log("    Nessun dato trovato");console.log(`
 DIFFERENZE CHIAVE:`),console.log("   1. Awentia usa struttura STANDARD: {kpis, monthlyTrend, summary}"),console.log("   2. Sherpa42 usa struttura ALTERNATIVA: {kpis, table, trends}"),console.log("   3. Awentia ha month=8, Sherpa42 ha month=9"),console.log("   4. Awentia KPIs: {ricavi2025, ebitda2025, ...}"),console.log("   5. Sherpa42 KPIs: {ricavi: {value, variance}, ebitda: {value, variance}, ...}"),console.log(`
 ========== CONFRONTO COMPLETATO ==========
`)}typeof window<"u"&&(window.compareCompanies=Bj);const Uj=So("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function $j({className:e,variant:t,...r}){return x.jsx("div",{className:_e(Uj({variant:t}),e),...r})}function Vj(){const{companies:e,selectedCompany:t,setSelectedCompany:r,loading:n}=Nn(),[i,s]=_.useState(!1);return n?x.jsx(Rt,{className:"mb-6",children:x.jsx(qi,{className:"p-4",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),x.jsx("span",{className:"text-sm text-muted-foreground",children:"Caricamento aziende..."})]})})}):x.jsxs(Rt,{className:"mb-6",children:[x.jsx(Ja,{className:"pb-3",children:x.jsxs(Za,{className:"text-lg flex items-center gap-2",children:[x.jsx(Bp,{className:"w-5 h-5"}),"Seleziona Azienda"]})}),x.jsxs(qi,{children:[x.jsxs("div",{className:"relative",children:[x.jsxs(ir,{variant:"outline",onClick:()=>s(!i),className:"w-full justify-between",children:[x.jsx("span",{children:t?t.name:"Seleziona un'azienda"}),x.jsx(Bp,{className:"w-4 h-4"})]}),i&&x.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border rounded-md shadow-lg z-50 max-h-60 overflow-y-auto",children:[x.jsxs("button",{onClick:()=>{r(null),s(!1)},className:"w-full text-left px-4 py-3 hover:bg-muted flex items-center justify-between border-b",children:[x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-muted-foreground",children:"Nessuna azienda"}),x.jsx("div",{className:"text-sm text-muted-foreground",children:"Deseleziona"})]}),!t&&x.jsx(Fh,{className:"w-4 h-4 text-primary"})]}),e.length===0?x.jsx("div",{className:"p-4 text-sm text-muted-foreground text-center",children:"Nessuna azienda disponibile"}):e.map(a=>x.jsxs("button",{onClick:()=>{r(a),s(!1)},className:"w-full text-left px-4 py-3 hover:bg-muted flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("div",{className:"font-medium",children:a.name}),x.jsx("div",{className:"text-sm text-muted-foreground",children:a.slug})]}),(t==null?void 0:t.id)===a.id&&x.jsx(Fh,{className:"w-4 h-4 text-primary"})]},a.id))]})]}),t?x.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[x.jsxs($j,{variant:"secondary",className:"flex items-center gap-1",children:[x.jsx(Bp,{className:"w-3 h-3"}),t.name]}),x.jsx("span",{className:"text-sm text-muted-foreground",children:"Azienda selezionata"})]}):x.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),x.jsx("span",{className:"text-sm text-yellow-800",children:"Seleziona un'azienda per visualizzare i dati"})]})})]})]})}const cm="/bilanci_dashboard/assets/awentia-logo-standard_1760537986689-DNVtUaVg.png",Hj="/bilanci_dashboard/assets/logo_sherpa42-BS4wHs9Y.png",Wj=(e,t)=>{if(!e&&!t)return cm;const r=(e||t||"").toLowerCase();return r.includes("awentia")?cm:r.includes("sherpa42")||r.includes("sherpa")?Hj:cm};function Ze({title:e,subtitle:t}){const{selectedCompany:r}=Nn(),n=Wj(r==null?void 0:r.name,r==null?void 0:r.slug),i=(r==null?void 0:r.name)||"Awentia";return x.jsx("div",{className:"p-8 rounded-xl mb-8 page-header-gradient","data-testid":"page-header",children:x.jsxs("div",{className:"flex items-start justify-between gap-6",children:[x.jsxs("div",{className:"flex-1",children:[x.jsx("h1",{className:"text-3xl font-bold text-white mb-2","data-testid":"text-page-title",children:e}),t&&x.jsx("p",{className:"text-white/95","data-testid":"text-page-subtitle",children:t})]}),x.jsx("div",{className:"flex-shrink-0",children:x.jsx("img",{src:n,alt:`${i} Logo`,className:"h-16 w-auto brightness-0 invert","data-testid":"img-page-header-logo"})})]})})}function _s({label:e,value:t,change:r,changeType:n,description:i}){return x.jsxs(Rt,{className:"p-6 hover-elevate active-elevate-2 transition-all duration-200","data-testid":`kpi-card-${e.toLowerCase().replace(/\s+/g,"-")}`,children:[x.jsxs("div",{className:"flex flex-col mb-2",children:[x.jsx("div",{className:"text-sm text-muted-foreground font-medium","data-testid":"text-kpi-label",children:e}),i&&x.jsx("div",{className:"text-xs text-muted-foreground/70 mt-0.5",children:i})]}),x.jsx("div",{className:"text-3xl font-bold mb-2","data-testid":"text-kpi-value",children:t}),r&&x.jsxs("div",{className:`text-sm font-semibold flex items-center gap-1 ${n==="positive"?"text-[#4A82BF] dark:text-[#9cbfe0]":"text-[#9e005c] dark:text-[#c41d7a]"}`,"data-testid":"text-kpi-change",children:[n==="positive"?x.jsx(nF,{className:"w-4 h-4"}):x.jsx(eF,{className:"w-4 h-4"}),r]})]})}function cv({title:e,children:t}){return x.jsxs(Rt,{className:"p-6","data-testid":`chart-card-${e.toLowerCase().replace(/\s+/g,"-")}`,children:[x.jsx("h3",{className:"text-lg font-bold mb-5","data-testid":"text-chart-title",children:e}),x.jsx("div",{className:"h-[300px]","data-testid":"chart-container",children:t})]})}const Gj=e=>{switch(e){case"result":return"bg-yellow-100 dark:bg-yellow-900/40 font-bold";case"key-metric":return"bg-blue-50 dark:bg-blue-950/20 font-bold";case"total-dark":return"bg-blue-900/10 dark:bg-blue-900/30 font-bold";case"highlight":return"font-semibold";default:return"hover:bg-muted/50"}};function X0({title:e,columns:t,data:r,highlightRows:n=[],totalRows:i=[],keyMetricRows:s=[],resultRow:a=[]}){return x.jsxs(Rt,{className:"p-3 md:p-6","data-testid":e?`table-${e.toLowerCase().replace(/\s+/g,"-")}`:"data-table",children:[e&&x.jsx("h3",{className:"text-base md:text-lg font-bold mb-3 md:mb-5","data-testid":"text-table-title",children:e}),x.jsx("div",{className:"overflow-x-auto -mx-3 md:mx-0 scrollbar-thin",children:x.jsxs("table",{className:"w-full border-collapse","data-testid":"table",children:[x.jsx("thead",{children:x.jsx("tr",{children:t.map(o=>x.jsx("th",{className:`bg-muted px-2 md:px-3 py-2 md:py-3 text-xs md:text-sm font-semibold text-muted-foreground border-b-2 border-border text-${o.align||"left"} whitespace-nowrap`,"data-testid":`th-${o.key}`,children:o.label},o.key))})}),x.jsx("tbody",{children:r.map((o,l)=>{var h;const c=n.includes(l),u=i.includes(l),d=s.includes(l),f=a.includes(l),p=(h=o.className)==null?void 0:h.includes("font-bold");let m="";return o.className?m=Gj(o.className):m=f?"bg-yellow-100 dark:bg-yellow-900/40 font-bold":d?"bg-blue-50 dark:bg-blue-950/20 font-bold":u?"bg-blue-900/10 dark:bg-blue-900/30 font-bold":c?"font-semibold":p?"font-bold hover:bg-muted/50":"hover:bg-muted/50",x.jsx("tr",{className:m,"data-testid":`row-${l}`,children:t.map(g=>x.jsx("td",{className:`px-2 md:px-3 py-2 md:py-3 text-xs md:text-sm border-b border-border text-${g.align||"left"} ${g.className||""} ${g.align==="right"?"whitespace-nowrap":""}`,"data-testid":`cell-${l}-${g.key}`,children:o[g.key]},g.key))},l)})})]})})]})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function wd(e){return e+.5|0}const Ms=(e,t,r)=>Math.max(Math.min(e,r),t);function Bc(e){return Ms(wd(e*2.55),0,255)}function Ys(e){return Ms(wd(e*255),0,255)}function $i(e){return Ms(wd(e/2.55)/100,0,1)}function X2(e){return Ms(wd(e*100),0,100)}const mn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},uv=[..."0123456789ABCDEF"],Kj=e=>uv[e&15],qj=e=>uv[(e&240)>>4]+uv[e&15],pf=e=>(e&240)>>4===(e&15),Xj=e=>pf(e.r)&&pf(e.g)&&pf(e.b)&&pf(e.a);function Yj(e){var t=e.length,r;return e[0]==="#"&&(t===4||t===5?r={r:255&mn[e[1]]*17,g:255&mn[e[2]]*17,b:255&mn[e[3]]*17,a:t===5?mn[e[4]]*17:255}:(t===7||t===9)&&(r={r:mn[e[1]]<<4|mn[e[2]],g:mn[e[3]]<<4|mn[e[4]],b:mn[e[5]]<<4|mn[e[6]],a:t===9?mn[e[7]]<<4|mn[e[8]]:255})),r}const Qj=(e,t)=>e<255?t(e):"";function Jj(e){var t=Xj(e)?Kj:qj;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Qj(e.a,t):void 0}const Zj=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function k4(e,t,r){const n=t*Math.min(r,1-r),i=(s,a=(s+e/30)%12)=>r-n*Math.max(Math.min(a-3,9-a,1),-1);return[i(0),i(8),i(4)]}function e9(e,t,r){const n=(i,s=(i+e/60)%6)=>r-r*t*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function t9(e,t,r){const n=k4(e,1,.5);let i;for(t+r>1&&(i=1/(t+r),t*=i,r*=i),i=0;i<3;i++)n[i]*=1-t-r,n[i]+=t;return n}function r9(e,t,r,n,i){return e===i?(t-r)/n+(t<r?6:0):t===i?(r-e)/n+2:(e-t)/n+4}function yx(e){const r=e.r/255,n=e.g/255,i=e.b/255,s=Math.max(r,n,i),a=Math.min(r,n,i),o=(s+a)/2;let l,c,u;return s!==a&&(u=s-a,c=o>.5?u/(2-s-a):u/(s+a),l=r9(r,n,i,u,s),l=l*60+.5),[l|0,c||0,o]}function wx(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(Ys)}function bx(e,t,r){return wx(k4,e,t,r)}function n9(e,t,r){return wx(t9,e,t,r)}function i9(e,t,r){return wx(e9,e,t,r)}function C4(e){return(e%360+360)%360}function s9(e){const t=Zj.exec(e);let r=255,n;if(!t)return;t[5]!==n&&(r=t[6]?Bc(+t[5]):Ys(+t[5]));const i=C4(+t[2]),s=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?n=n9(i,s,a):t[1]==="hsv"?n=i9(i,s,a):n=bx(i,s,a),{r:n[0],g:n[1],b:n[2],a:r}}function a9(e,t){var r=yx(e);r[0]=C4(r[0]+t),r=bx(r),e.r=r[0],e.g=r[1],e.b=r[2]}function o9(e){if(!e)return;const t=yx(e),r=t[0],n=X2(t[1]),i=X2(t[2]);return e.a<255?`hsla(${r}, ${n}%, ${i}%, ${$i(e.a)})`:`hsl(${r}, ${n}%, ${i}%)`}const Y2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Q2={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function l9(){const e={},t=Object.keys(Q2),r=Object.keys(Y2);let n,i,s,a,o;for(n=0;n<t.length;n++){for(a=o=t[n],i=0;i<r.length;i++)s=r[i],o=o.replace(s,Y2[s]);s=parseInt(Q2[a],16),e[o]=[s>>16&255,s>>8&255,s&255]}return e}let mf;function c9(e){mf||(mf=l9(),mf.transparent=[0,0,0,0]);const t=mf[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const u9=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function d9(e){const t=u9.exec(e);let r=255,n,i,s;if(t){if(t[7]!==n){const a=+t[7];r=t[8]?Bc(a):Ms(a*255,0,255)}return n=+t[1],i=+t[3],s=+t[5],n=255&(t[2]?Bc(n):Ms(n,0,255)),i=255&(t[4]?Bc(i):Ms(i,0,255)),s=255&(t[6]?Bc(s):Ms(s,0,255)),{r:n,g:i,b:s,a:r}}}function f9(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${$i(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const um=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Bo=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function h9(e,t,r){const n=Bo($i(e.r)),i=Bo($i(e.g)),s=Bo($i(e.b));return{r:Ys(um(n+r*(Bo($i(t.r))-n))),g:Ys(um(i+r*(Bo($i(t.g))-i))),b:Ys(um(s+r*(Bo($i(t.b))-s))),a:e.a+r*(t.a-e.a)}}function gf(e,t,r){if(e){let n=yx(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*r,t===0?360:1)),n=bx(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function A4(e,t){return e&&Object.assign(t||{},e)}function J2(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Ys(e[3]))):(t=A4(e,{r:0,g:0,b:0,a:1}),t.a=Ys(t.a)),t}function p9(e){return e.charAt(0)==="r"?d9(e):s9(e)}class Vu{constructor(t){if(t instanceof Vu)return t;const r=typeof t;let n;r==="object"?n=J2(t):r==="string"&&(n=Yj(t)||c9(t)||p9(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=A4(this._rgb);return t&&(t.a=$i(t.a)),t}set rgb(t){this._rgb=J2(t)}rgbString(){return this._valid?f9(this._rgb):void 0}hexString(){return this._valid?Jj(this._rgb):void 0}hslString(){return this._valid?o9(this._rgb):void 0}mix(t,r){if(t){const n=this.rgb,i=t.rgb;let s;const a=r===s?.5:r,o=2*a-1,l=n.a-i.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;s=1-c,n.r=255&c*n.r+s*i.r+.5,n.g=255&c*n.g+s*i.g+.5,n.b=255&c*n.b+s*i.b+.5,n.a=a*n.a+(1-a)*i.a,this.rgb=n}return this}interpolate(t,r){return t&&(this._rgb=h9(this._rgb,t._rgb,r)),this}clone(){return new Vu(this.rgb)}alpha(t){return this._rgb.a=Ys(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=wd(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return gf(this._rgb,2,t),this}darken(t){return gf(this._rgb,2,-t),this}saturate(t){return gf(this._rgb,1,t),this}desaturate(t){return gf(this._rgb,1,-t),this}rotate(t){return a9(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ni(){}const m9=(()=>{let e=0;return()=>e++})();function qe(e){return e==null}function Vt(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ke(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function On(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function ci(e,t){return On(e)?e:t}function je(e,t){return typeof e>"u"?t:e}const g9=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function ot(e,t,r){if(e&&typeof e.call=="function")return e.apply(r,t)}function Ye(e,t,r,n){let i,s,a;if(Vt(e))for(s=e.length,i=0;i<s;i++)t.call(r,e[i],i);else if(Ke(e))for(a=Object.keys(e),s=a.length,i=0;i<s;i++)t.call(r,e[a[i]],a[i])}function Gh(e,t){let r,n,i,s;if(!e||!t||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;++r)if(i=e[r],s=t[r],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function Kh(e){if(Vt(e))return e.map(Kh);if(Ke(e)){const t=Object.create(null),r=Object.keys(e),n=r.length;let i=0;for(;i<n;++i)t[r[i]]=Kh(e[r[i]]);return t}return e}function R4(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function v9(e,t,r,n){if(!R4(e))return;const i=t[e],s=r[e];Ke(i)&&Ke(s)?Hu(i,s,n):t[e]=Kh(s)}function Hu(e,t,r){const n=Vt(t)?t:[t],i=n.length;if(!Ke(e))return e;r=r||{};const s=r.merger||v9;let a;for(let o=0;o<i;++o){if(a=n[o],!Ke(a))continue;const l=Object.keys(a);for(let c=0,u=l.length;c<u;++c)s(l[c],e,a,r)}return e}function ou(e,t){return Hu(e,t,{merger:x9})}function x9(e,t,r){if(!R4(e))return;const n=t[e],i=r[e];Ke(n)&&Ke(i)?ou(n,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Kh(i))}const Z2={"":e=>e,x:e=>e.x,y:e=>e.y};function y9(e){const t=e.split("."),r=[];let n="";for(const i of t)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function w9(e){const t=y9(e);return r=>{for(const n of t){if(n==="")break;r=r&&r[n]}return r}}function Gl(e,t){return(Z2[t]||(Z2[t]=w9(t)))(e)}function _x(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Wu=e=>typeof e<"u",ia=e=>typeof e=="function",eb=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};function b9(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Zt=Math.PI,Ti=2*Zt,_9=Ti+Zt,qh=Number.POSITIVE_INFINITY,S9=Zt/180,Jn=Zt/2,Sa=Zt/4,tb=Zt*2/3,dv=Math.log10,ki=Math.sign;function lu(e,t,r){return Math.abs(e-t)<r}function rb(e){const t=Math.round(e);e=lu(e,t,e/1e3)?t:e;const r=Math.pow(10,Math.floor(dv(e))),n=e/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function E9(e){const t=[],r=Math.sqrt(e);let n;for(n=1;n<r;n++)e%n===0&&(t.push(n),t.push(e/n));return r===(r|0)&&t.push(r),t.sort((i,s)=>i-s).pop(),t}function T9(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Gu(e){return!T9(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function k9(e,t){const r=Math.round(e);return r-t<=e&&r+t>=e}function C9(e,t,r){let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n][r],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function ja(e){return e*(Zt/180)}function A9(e){return e*(180/Zt)}function nb(e){if(!On(e))return;let t=1,r=0;for(;Math.round(e*t)/t!==e;)t*=10,r++;return r}function R9(e,t){const r=t.x-e.x,n=t.y-e.y,i=Math.sqrt(r*r+n*n);let s=Math.atan2(n,r);return s<-.5*Zt&&(s+=Ti),{angle:s,distance:i}}function fv(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function P9(e,t){return(e-t+_9)%Ti-Zt}function gs(e){return(e%Ti+Ti)%Ti}function P4(e,t,r,n){const i=gs(e),s=gs(t),a=gs(r),o=gs(s-i),l=gs(a-i),c=gs(i-s),u=gs(i-a);return i===s||i===a||n&&s===a||o>l&&c<u}function sn(e,t,r){return Math.max(t,Math.min(r,e))}function O9(e){return sn(e,-32768,32767)}function Ba(e,t,r,n=1e-6){return e>=Math.min(t,r)-n&&e<=Math.max(t,r)+n}function Sx(e,t,r){r=r||(a=>e[a]<t);let n=e.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,r(s)?i=s:n=s;return{lo:i,hi:n}}const Ua=(e,t,r,n)=>Sx(e,r,n?i=>{const s=e[i][t];return s<r||s===r&&e[i+1][t]===r}:i=>e[i][t]<r),I9=(e,t,r)=>Sx(e,r,n=>e[n][t]>=r);function D9(e,t,r){let n=0,i=e.length;for(;n<i&&e[n]<t;)n++;for(;i>n&&e[i-1]>r;)i--;return n>0||i<e.length?e.slice(n,i):e}const O4=["push","pop","shift","splice","unshift"];function N9(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),O4.forEach(r=>{const n="_onData"+_x(r),i=e[r];Object.defineProperty(e,r,{configurable:!0,enumerable:!1,value(...s){const a=i.apply(this,s);return e._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...s)}),a}})})}function ib(e,t){const r=e._chartjs;if(!r)return;const n=r.listeners,i=n.indexOf(t);i!==-1&&n.splice(i,1),!(n.length>0)&&(O4.forEach(s=>{delete e[s]}),delete e._chartjs)}function I4(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const D4=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function N4(e,t){let r=[],n=!1;return function(...i){r=i,n||(n=!0,D4.call(window,()=>{n=!1,e.apply(t,r)}))}}function F9(e,t){let r;return function(...n){return t?(clearTimeout(r),r=setTimeout(e,t,n)):e.apply(this,n),t}}const Ex=e=>e==="start"?"left":e==="end"?"right":"center",mr=(e,t,r)=>e==="start"?t:e==="end"?r:(t+r)/2,M9=(e,t,r,n)=>e===(n?"left":"right")?r:e==="center"?(t+r)/2:t;function L9(e,t,r){const n=t.length;let i=0,s=n;if(e._sorted){const{iScale:a,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,u=a.axis,{min:d,max:f,minDefined:p,maxDefined:m}=a.getUserBounds();if(p){if(i=Math.min(Ua(l,u,d).lo,r?n:Ua(t,u,a.getPixelForValue(d)).lo),c){const h=l.slice(0,i+1).reverse().findIndex(g=>!qe(g[o.axis]));i-=Math.max(0,h)}i=sn(i,0,n-1)}if(m){let h=Math.max(Ua(l,a.axis,f,!0).hi+1,r?0:Ua(t,u,a.getPixelForValue(f),!0).hi+1);if(c){const g=l.slice(h-1).findIndex(v=>!qe(v[o.axis]));h+=Math.max(0,g)}s=sn(h,i,n)-i}else s=n-i}return{start:i,count:s}}function z9(e){const{xScale:t,yScale:r,_scaleRanges:n}=e,i={xmin:t.min,xmax:t.max,ymin:r.min,ymax:r.max};if(!n)return e._scaleRanges=i,!0;const s=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==r.min||n.ymax!==r.max;return Object.assign(n,i),s}const vf=e=>e===0||e===1,sb=(e,t,r)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Ti/r)),ab=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*Ti/r)+1,cu={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Jn)+1,easeOutSine:e=>Math.sin(e*Jn),easeInOutSine:e=>-.5*(Math.cos(Zt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>vf(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>vf(e)?e:sb(e,.075,.3),easeOutElastic:e=>vf(e)?e:ab(e,.075,.3),easeInOutElastic(e){return vf(e)?e:e<.5?.5*sb(e*2,.1125,.45):.5+.5*ab(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-cu.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?cu.easeInBounce(e*2)*.5:cu.easeOutBounce(e*2-1)*.5+.5};function Tx(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function ob(e){return Tx(e)?e:new Vu(e)}function dm(e){return Tx(e)?e:new Vu(e).saturate(.5).darken(.1).hexString()}const j9=["x","y","borderWidth","radius","tension"],B9=["color","borderColor","backgroundColor"];function U9(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:B9},numbers:{type:"number",properties:j9}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function $9(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const lb=new Map;function V9(e,t){t=t||{};const r=e+JSON.stringify(t);let n=lb.get(r);return n||(n=new Intl.NumberFormat(e,t),lb.set(r,n)),n}function F4(e,t,r){return V9(t,r).format(e)}const M4={values(e){return Vt(e)?e:""+e},numeric(e,t,r){if(e===0)return"0";const n=this.chart.options.locale;let i,s=e;if(r.length>1){const c=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),s=H9(e,r)}const a=dv(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:i,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),F4(e,n,l)},logarithmic(e,t,r){if(e===0)return"0";const n=r[t].significand||e/Math.pow(10,Math.floor(dv(e)));return[1,2,3,5,10,15].includes(n)||t>.8*r.length?M4.numeric.call(this,e,t,r):""}};function H9(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e)),r}var L4={formatters:M4};function W9(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:L4.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const mo=Object.create(null),hv=Object.create(null);function uu(e,t){if(!t)return e;const r=t.split(".");for(let n=0,i=r.length;n<i;++n){const s=r[n];e=e[s]||(e[s]=Object.create(null))}return e}function fm(e,t,r){return typeof t=="string"?Hu(uu(e,t),r):Hu(uu(e,""),t)}class G9{constructor(t,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>dm(i.backgroundColor),this.hoverBorderColor=(n,i)=>dm(i.borderColor),this.hoverColor=(n,i)=>dm(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(r)}set(t,r){return fm(this,t,r)}get(t){return uu(this,t)}describe(t,r){return fm(hv,t,r)}override(t,r){return fm(mo,t,r)}route(t,r,n,i){const s=uu(this,t),a=uu(this,n),o="_"+r;Object.defineProperties(s,{[o]:{value:s[r],writable:!0},[r]:{enumerable:!0,get(){const l=this[o],c=a[i];return Ke(l)?Object.assign({},c,l):je(l,c)},set(l){this[o]=l}}})}apply(t){t.forEach(r=>r(this))}}var Pt=new G9({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[U9,$9,W9]);function K9(e){return!e||qe(e.size)||qe(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function cb(e,t,r,n,i){let s=t[i];return s||(s=t[i]=e.measureText(i).width,r.push(i)),s>n&&(n=s),n}function Ea(e,t,r){const n=e.currentDevicePixelRatio,i=r!==0?Math.max(r/2,.5):0;return Math.round((t-i)*n)/n+i}function ub(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function pv(e,t,r,n){z4(e,t,r,n,null)}function z4(e,t,r,n,i){let s,a,o,l,c,u,d,f;const p=t.pointStyle,m=t.rotation,h=t.radius;let g=(m||0)*S9;if(p&&typeof p=="object"&&(s=p.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){e.save(),e.translate(r,n),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),e.restore();return}if(!(isNaN(h)||h<=0)){switch(e.beginPath(),p){default:i?e.ellipse(r,n,i/2,h,0,0,Ti):e.arc(r,n,h,0,Ti),e.closePath();break;case"triangle":u=i?i/2:h,e.moveTo(r+Math.sin(g)*u,n-Math.cos(g)*h),g+=tb,e.lineTo(r+Math.sin(g)*u,n-Math.cos(g)*h),g+=tb,e.lineTo(r+Math.sin(g)*u,n-Math.cos(g)*h),e.closePath();break;case"rectRounded":c=h*.516,l=h-c,a=Math.cos(g+Sa)*l,d=Math.cos(g+Sa)*(i?i/2-c:l),o=Math.sin(g+Sa)*l,f=Math.sin(g+Sa)*(i?i/2-c:l),e.arc(r-d,n-o,c,g-Zt,g-Jn),e.arc(r+f,n-a,c,g-Jn,g),e.arc(r+d,n+o,c,g,g+Jn),e.arc(r-f,n+a,c,g+Jn,g+Zt),e.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*h,u=i?i/2:l,e.rect(r-u,n-l,2*u,2*l);break}g+=Sa;case"rectRot":d=Math.cos(g)*(i?i/2:h),a=Math.cos(g)*h,o=Math.sin(g)*h,f=Math.sin(g)*(i?i/2:h),e.moveTo(r-d,n-o),e.lineTo(r+f,n-a),e.lineTo(r+d,n+o),e.lineTo(r-f,n+a),e.closePath();break;case"crossRot":g+=Sa;case"cross":d=Math.cos(g)*(i?i/2:h),a=Math.cos(g)*h,o=Math.sin(g)*h,f=Math.sin(g)*(i?i/2:h),e.moveTo(r-d,n-o),e.lineTo(r+d,n+o),e.moveTo(r+f,n-a),e.lineTo(r-f,n+a);break;case"star":d=Math.cos(g)*(i?i/2:h),a=Math.cos(g)*h,o=Math.sin(g)*h,f=Math.sin(g)*(i?i/2:h),e.moveTo(r-d,n-o),e.lineTo(r+d,n+o),e.moveTo(r+f,n-a),e.lineTo(r-f,n+a),g+=Sa,d=Math.cos(g)*(i?i/2:h),a=Math.cos(g)*h,o=Math.sin(g)*h,f=Math.sin(g)*(i?i/2:h),e.moveTo(r-d,n-o),e.lineTo(r+d,n+o),e.moveTo(r+f,n-a),e.lineTo(r-f,n+a);break;case"line":a=i?i/2:Math.cos(g)*h,o=Math.sin(g)*h,e.moveTo(r-a,n-o),e.lineTo(r+a,n+o);break;case"dash":e.moveTo(r,n),e.lineTo(r+Math.cos(g)*(i?i/2:h),n+Math.sin(g)*h);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Ku(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function kx(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Cx(e){e.restore()}function q9(e,t,r,n,i){if(!t)return e.lineTo(r.x,r.y);if(i==="middle"){const s=(t.x+r.x)/2;e.lineTo(s,t.y),e.lineTo(s,r.y)}else i==="after"!=!!n?e.lineTo(t.x,r.y):e.lineTo(r.x,t.y);e.lineTo(r.x,r.y)}function X9(e,t,r,n){if(!t)return e.lineTo(r.x,r.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function Y9(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),qe(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function Q9(e,t,r,n,i){if(i.strikethrough||i.underline){const s=e.measureText(n),a=t-s.actualBoundingBoxLeft,o=t+s.actualBoundingBoxRight,l=r-s.actualBoundingBoxAscent,c=r+s.actualBoundingBoxDescent,u=i.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(a,u),e.lineTo(o,u),e.stroke()}}function J9(e,t){const r=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=r}function qu(e,t,r,n,i,s={}){const a=Vt(t)?t:[t],o=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(e.save(),e.font=i.string,Y9(e,s),l=0;l<a.length;++l)c=a[l],s.backdrop&&J9(e,s.backdrop),o&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),qe(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(c,r,n,s.maxWidth)),e.fillText(c,r,n,s.maxWidth),Q9(e,r,n,c,s),n+=Number(i.lineHeight);e.restore()}function Xh(e,t){const{x:r,y:n,w:i,h:s,radius:a}=t;e.arc(r+a.topLeft,n+a.topLeft,a.topLeft,1.5*Zt,Zt,!0),e.lineTo(r,n+s-a.bottomLeft),e.arc(r+a.bottomLeft,n+s-a.bottomLeft,a.bottomLeft,Zt,Jn,!0),e.lineTo(r+i-a.bottomRight,n+s),e.arc(r+i-a.bottomRight,n+s-a.bottomRight,a.bottomRight,Jn,0,!0),e.lineTo(r+i,n+a.topRight),e.arc(r+i-a.topRight,n+a.topRight,a.topRight,0,-Jn,!0),e.lineTo(r+a.topLeft,n)}const Z9=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,e7=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function t7(e,t){const r=(""+e).match(Z9);if(!r||r[1]==="normal")return t*1.2;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100;break}return t*e}const r7=e=>+e||0;function j4(e,t){const r={},n=Ke(t),i=n?Object.keys(t):t,s=Ke(e)?n?a=>je(e[a],e[t[a]]):a=>e[a]:()=>e;for(const a of i)r[a]=r7(s(a));return r}function B4(e){return j4(e,{top:"y",right:"x",bottom:"y",left:"x"})}function gl(e){return j4(e,["topLeft","topRight","bottomLeft","bottomRight"])}function In(e){const t=B4(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function yr(e,t){e=e||{},t=t||Pt.font;let r=je(e.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let n=je(e.style,t.style);n&&!(""+n).match(e7)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:je(e.family,t.family),lineHeight:t7(je(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:je(e.weight,t.weight),string:""};return i.string=K9(i),i}function xf(e,t,r,n){let i,s,a;for(i=0,s=e.length;i<s;++i)if(a=e[i],a!==void 0&&a!==void 0)return a}function n7(e,t,r){const{min:n,max:i}=e,s=g9(t,(i-n)/2),a=(o,l)=>r&&o===0?0:o+l;return{min:a(n,-Math.abs(s)),max:a(i,s)}}function Eo(e,t){return Object.assign(Object.create(e),t)}function Ax(e,t=[""],r,n,i=()=>e[0]){const s=r||e;typeof n>"u"&&(n=H4("_fallback",e));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:s,_fallback:n,_getTarget:i,override:o=>Ax([o,...e],t,s,n)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete e[0][l],!0},get(o,l){return $4(o,l,()=>d7(l,t,e,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(o,l){return fb(o).includes(l)},ownKeys(o){return fb(o)},set(o,l,c){const u=o._storage||(o._storage=i());return o[l]=u[l]=c,delete o._keys,!0}})}function Kl(e,t,r,n){const i={_cacheable:!1,_proxy:e,_context:t,_subProxy:r,_stack:new Set,_descriptors:U4(e,n),setContext:s=>Kl(e,s,r,n),override:s=>Kl(e.override(s),t,r,n)};return new Proxy(i,{deleteProperty(s,a){return delete s[a],delete e[a],!0},get(s,a,o){return $4(s,a,()=>s7(s,a,o))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(e,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,a)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(s,a){return Reflect.has(e,a)},ownKeys(){return Reflect.ownKeys(e)},set(s,a,o){return e[a]=o,delete s[a],!0}})}function U4(e,t={scriptable:!0,indexable:!0}){const{_scriptable:r=t.scriptable,_indexable:n=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:r,indexable:n,isScriptable:ia(r)?r:()=>r,isIndexable:ia(n)?n:()=>n}}const i7=(e,t)=>e?e+_x(t):t,Rx=(e,t)=>Ke(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function $4(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const n=r();return e[t]=n,n}function s7(e,t,r){const{_proxy:n,_context:i,_subProxy:s,_descriptors:a}=e;let o=n[t];return ia(o)&&a.isScriptable(t)&&(o=a7(t,o,e,r)),Vt(o)&&o.length&&(o=o7(t,o,e,a.isIndexable)),Rx(t,o)&&(o=Kl(o,i,s&&s[t],a)),o}function a7(e,t,r,n){const{_proxy:i,_context:s,_subProxy:a,_stack:o}=r;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(s,a||n);return o.delete(e),Rx(e,l)&&(l=Px(i._scopes,i,e,l)),l}function o7(e,t,r,n){const{_proxy:i,_context:s,_subProxy:a,_descriptors:o}=r;if(typeof s.index<"u"&&n(e))return t[s.index%t.length];if(Ke(t[0])){const l=t,c=i._scopes.filter(u=>u!==l);t=[];for(const u of l){const d=Px(c,i,e,u);t.push(Kl(d,s,a&&a[e],o))}}return t}function V4(e,t,r){return ia(e)?e(t,r):e}const l7=(e,t)=>e===!0?t:typeof e=="string"?Gl(t,e):void 0;function c7(e,t,r,n,i){for(const s of t){const a=l7(r,s);if(a){e.add(a);const o=V4(a._fallback,r,i);if(typeof o<"u"&&o!==r&&o!==n)return o}else if(a===!1&&typeof n<"u"&&r!==n)return null}return!1}function Px(e,t,r,n){const i=t._rootScopes,s=V4(t._fallback,r,n),a=[...e,...i],o=new Set;o.add(n);let l=db(o,a,r,s||r,n);return l===null||typeof s<"u"&&s!==r&&(l=db(o,a,s,l,n),l===null)?!1:Ax(Array.from(o),[""],i,s,()=>u7(t,r,n))}function db(e,t,r,n,i){for(;r;)r=c7(e,t,r,n,i);return r}function u7(e,t,r){const n=e._getTarget();t in n||(n[t]={});const i=n[t];return Vt(i)&&Ke(r)?r:i||{}}function d7(e,t,r,n){let i;for(const s of t)if(i=H4(i7(s,e),r),typeof i<"u")return Rx(e,i)?Px(r,n,e,i):i}function H4(e,t){for(const r of t){if(!r)continue;const n=r[e];if(typeof n<"u")return n}}function fb(e){let t=e._keys;return t||(t=e._keys=f7(e._scopes)),t}function f7(e){const t=new Set;for(const r of e)for(const n of Object.keys(r).filter(i=>!i.startsWith("_")))t.add(n);return Array.from(t)}const h7=Number.EPSILON||1e-14,ql=(e,t)=>t<e.length&&!e[t].skip&&e[t],W4=e=>e==="x"?"y":"x";function p7(e,t,r,n){const i=e.skip?t:e,s=t,a=r.skip?t:r,o=fv(s,i),l=fv(a,s);let c=o/(o+l),u=l/(o+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=n*c,f=n*u;return{previous:{x:s.x-d*(a.x-i.x),y:s.y-d*(a.y-i.y)},next:{x:s.x+f*(a.x-i.x),y:s.y+f*(a.y-i.y)}}}function m7(e,t,r){const n=e.length;let i,s,a,o,l,c=ql(e,0);for(let u=0;u<n-1;++u)if(l=c,c=ql(e,u+1),!(!l||!c)){if(lu(t[u],0,h7)){r[u]=r[u+1]=0;continue}i=r[u]/t[u],s=r[u+1]/t[u],o=Math.pow(i,2)+Math.pow(s,2),!(o<=9)&&(a=3/Math.sqrt(o),r[u]=i*a*t[u],r[u+1]=s*a*t[u])}}function g7(e,t,r="x"){const n=W4(r),i=e.length;let s,a,o,l=ql(e,0);for(let c=0;c<i;++c){if(a=o,o=l,l=ql(e,c+1),!o)continue;const u=o[r],d=o[n];a&&(s=(u-a[r])/3,o[`cp1${r}`]=u-s,o[`cp1${n}`]=d-s*t[c]),l&&(s=(l[r]-u)/3,o[`cp2${r}`]=u+s,o[`cp2${n}`]=d+s*t[c])}}function v7(e,t="x"){const r=W4(t),n=e.length,i=Array(n).fill(0),s=Array(n);let a,o,l,c=ql(e,0);for(a=0;a<n;++a)if(o=l,l=c,c=ql(e,a+1),!!l){if(c){const u=c[t]-l[t];i[a]=u!==0?(c[r]-l[r])/u:0}s[a]=o?c?ki(i[a-1])!==ki(i[a])?0:(i[a-1]+i[a])/2:i[a-1]:i[a]}m7(e,i,s),g7(e,s,t)}function yf(e,t,r){return Math.max(Math.min(e,r),t)}function x7(e,t){let r,n,i,s,a,o=Ku(e[0],t);for(r=0,n=e.length;r<n;++r)a=s,s=o,o=r<n-1&&Ku(e[r+1],t),s&&(i=e[r],a&&(i.cp1x=yf(i.cp1x,t.left,t.right),i.cp1y=yf(i.cp1y,t.top,t.bottom)),o&&(i.cp2x=yf(i.cp2x,t.left,t.right),i.cp2y=yf(i.cp2y,t.top,t.bottom)))}function y7(e,t,r,n,i){let s,a,o,l;if(t.spanGaps&&(e=e.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")v7(e,i);else{let c=n?e[e.length-1]:e[0];for(s=0,a=e.length;s<a;++s)o=e[s],l=p7(c,o,e[Math.min(s+1,a-(n?0:1))%a],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}t.capBezierPoints&&x7(e,r)}function Ox(){return typeof window<"u"&&typeof document<"u"}function Ix(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Yh(e,t,r){let n;return typeof e=="string"?(n=parseInt(e,10),e.indexOf("%")!==-1&&(n=n/100*t.parentNode[r])):n=e,n}const Y0=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function w7(e,t){return Y0(e).getPropertyValue(t)}const b7=["top","right","bottom","left"];function eo(e,t,r){const n={};r=r?"-"+r:"";for(let i=0;i<4;i++){const s=b7[i];n[s]=parseFloat(e[t+"-"+s+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const _7=(e,t,r)=>(e>0||t>0)&&(!r||!r.shadowRoot);function S7(e,t){const r=e.touches,n=r&&r.length?r[0]:e,{offsetX:i,offsetY:s}=n;let a=!1,o,l;if(_7(i,s,e.target))o=i,l=s;else{const c=t.getBoundingClientRect();o=n.clientX-c.left,l=n.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function Ra(e,t){if("native"in e)return e;const{canvas:r,currentDevicePixelRatio:n}=t,i=Y0(r),s=i.boxSizing==="border-box",a=eo(i,"padding"),o=eo(i,"border","width"),{x:l,y:c,box:u}=S7(e,r),d=a.left+(u&&o.left),f=a.top+(u&&o.top);let{width:p,height:m}=t;return s&&(p-=a.width+o.width,m-=a.height+o.height),{x:Math.round((l-d)/p*r.width/n),y:Math.round((c-f)/m*r.height/n)}}function E7(e,t,r){let n,i;if(t===void 0||r===void 0){const s=e&&Ix(e);if(!s)t=e.clientWidth,r=e.clientHeight;else{const a=s.getBoundingClientRect(),o=Y0(s),l=eo(o,"border","width"),c=eo(o,"padding");t=a.width-c.width-l.width,r=a.height-c.height-l.height,n=Yh(o.maxWidth,s,"clientWidth"),i=Yh(o.maxHeight,s,"clientHeight")}}return{width:t,height:r,maxWidth:n||qh,maxHeight:i||qh}}const Ls=e=>Math.round(e*10)/10;function T7(e,t,r,n){const i=Y0(e),s=eo(i,"margin"),a=Yh(i.maxWidth,e,"clientWidth")||qh,o=Yh(i.maxHeight,e,"clientHeight")||qh,l=E7(e,t,r);let{width:c,height:u}=l;if(i.boxSizing==="content-box"){const f=eo(i,"border","width"),p=eo(i,"padding");c-=p.width+f.width,u-=p.height+f.height}return c=Math.max(0,c-s.width),u=Math.max(0,n?c/n:u-s.height),c=Ls(Math.min(c,a,l.maxWidth)),u=Ls(Math.min(u,o,l.maxHeight)),c&&!u&&(u=Ls(c/2)),(t!==void 0||r!==void 0)&&n&&l.height&&u>l.height&&(u=l.height,c=Ls(Math.floor(u*n))),{width:c,height:u}}function hb(e,t,r){const n=t||1,i=Ls(e.height*n),s=Ls(e.width*n);e.height=Ls(e.height),e.width=Ls(e.width);const a=e.canvas;return a.style&&(r||!a.style.height&&!a.style.width)&&(a.style.height=`${e.height}px`,a.style.width=`${e.width}px`),e.currentDevicePixelRatio!==n||a.height!==i||a.width!==s?(e.currentDevicePixelRatio=n,a.height=i,a.width=s,e.ctx.setTransform(n,0,0,n,0,0),!0):!1}const k7=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Ox()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function pb(e,t){const r=w7(e,t),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Pa(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)}}function C7(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:n==="middle"?r<.5?e.y:t.y:n==="after"?r<1?e.y:t.y:r>0?t.y:e.y}}function A7(e,t,r,n){const i={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},a=Pa(e,i,r),o=Pa(i,s,r),l=Pa(s,t,r),c=Pa(a,o,r),u=Pa(o,l,r);return Pa(c,u,r)}const R7=function(e,t){return{x(r){return e+e+t-r},setWidth(r){t=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},P7=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function vl(e,t,r){return e?R7(t,r):P7()}function G4(e,t){let r,n;(t==="ltr"||t==="rtl")&&(r=e.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),e.prevTextDirection=n)}function K4(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function q4(e){return e==="angle"?{between:P4,compare:P9,normalize:gs}:{between:Ba,compare:(t,r)=>t-r,normalize:t=>t}}function mb({start:e,end:t,count:r,loop:n,style:i}){return{start:e%r,end:t%r,loop:n&&(t-e+1)%r===0,style:i}}function O7(e,t,r){const{property:n,start:i,end:s}=r,{between:a,normalize:o}=q4(n),l=t.length;let{start:c,end:u,loop:d}=e,f,p;if(d){for(c+=l,u+=l,f=0,p=l;f<p&&a(o(t[c%l][n]),i,s);++f)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:e.style}}function I7(e,t,r){if(!r)return[e];const{property:n,start:i,end:s}=r,a=t.length,{compare:o,between:l,normalize:c}=q4(n),{start:u,end:d,loop:f,style:p}=O7(e,t,r),m=[];let h=!1,g=null,v,w,y;const b=()=>l(i,y,v)&&o(i,y)!==0,E=()=>o(s,v)===0||l(s,y,v),k=()=>h||b(),S=()=>!h||E();for(let C=u,T=u;C<=d;++C)w=t[C%a],!w.skip&&(v=c(w[n]),v!==y&&(h=l(v,i,s),g===null&&k()&&(g=o(v,i)===0?C:T),g!==null&&S()&&(m.push(mb({start:g,end:C,loop:f,count:a,style:p})),g=null),T=C,y=v));return g!==null&&m.push(mb({start:g,end:d,loop:f,count:a,style:p})),m}function D7(e,t){const r=[],n=e.segments;for(let i=0;i<n.length;i++){const s=I7(n[i],e.points,t);s.length&&r.push(...s)}return r}function N7(e,t,r,n){let i=0,s=t-1;if(r&&!n)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,r&&(s+=i);s>i&&e[s%t].skip;)s--;return s%=t,{start:i,end:s}}function F7(e,t,r,n){const i=e.length,s=[];let a=t,o=e[t],l;for(l=t+1;l<=r;++l){const c=e[l%i];c.skip||c.stop?o.skip||(n=!1,s.push({start:t%i,end:(l-1)%i,loop:n}),t=a=c.stop?l:null):(a=l,o.skip&&(t=l)),o=c}return a!==null&&s.push({start:t%i,end:a%i,loop:n}),s}function M7(e,t){const r=e.points,n=e.options.spanGaps,i=r.length;if(!i)return[];const s=!!e._loop,{start:a,end:o}=N7(r,i,s,n);if(n===!0)return gb(e,[{start:a,end:o,loop:s}],r,t);const l=o<a?o+i:o,c=!!e._fullLoop&&a===0&&o===i-1;return gb(e,F7(r,a,l,c),r,t)}function gb(e,t,r,n){return!n||!n.setContext||!r?t:L7(e,t,r,n)}function L7(e,t,r,n){const i=e._chart.getContext(),s=vb(e.options),{_datasetIndex:a,options:{spanGaps:o}}=e,l=r.length,c=[];let u=s,d=t[0].start,f=d;function p(m,h,g,v){const w=o?-1:1;if(m!==h){for(m+=l;r[m%l].skip;)m-=w;for(;r[h%l].skip;)h+=w;m%l!==h%l&&(c.push({start:m%l,end:h%l,loop:g,style:v}),u=v,d=h%l)}}for(const m of t){d=o?d:m.start;let h=r[d%l],g;for(f=d+1;f<=m.end;f++){const v=r[f%l];g=vb(n.setContext(Eo(i,{type:"segment",p0:h,p1:v,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:a}))),z7(g,u)&&p(d,f-1,m.loop,u),h=v,u=g}d<f-1&&p(d,f-1,m.loop,u)}return c}function vb(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function z7(e,t){if(!t)return!1;const r=[],n=function(i,s){return Tx(s)?(r.includes(s)||r.push(s),r.indexOf(s)):s};return JSON.stringify(e,n)!==JSON.stringify(t,n)}function wf(e,t,r){return e.options.clip?e[r]:t[r]}function j7(e,t){const{xScale:r,yScale:n}=e;return r&&n?{left:wf(r,t,"left"),right:wf(r,t,"right"),top:wf(n,t,"top"),bottom:wf(n,t,"bottom")}:t}function B7(e,t){const r=t._clip;if(r.disabled)return!1;const n=j7(t,e.chartArea);return{left:r.left===!1?0:n.left-(r.left===!0?0:r.left),right:r.right===!1?e.width:n.right+(r.right===!0?0:r.right),top:r.top===!1?0:n.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?e.height:n.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class U7{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,r,n,i){const s=r.listeners[i],a=r.duration;s.forEach(o=>o({chart:t,initial:r.initial,numSteps:a,currentStep:Math.min(n-r.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=D4.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let r=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let a=s.length-1,o=!1,l;for(;a>=0;--a)l=s[a],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(t),o=!0):(s[a]=s[s.length-1],s.pop());o&&(i.draw(),this._notify(i,n,t,"progress")),s.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),r+=s.length}),this._lastDate=t,r===0&&(this._running=!1)}_getAnims(t){const r=this._charts;let n=r.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(t,n)),n}listen(t,r,n){this._getAnims(t).listeners[r].push(n)}add(t,r){!r||!r.length||this._getAnims(t).items.push(...r)}has(t){return this._getAnims(t).items.length>0}start(t){const r=this._charts.get(t);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const r=this._charts.get(t);return!(!r||!r.running||!r.items.length)}stop(t){const r=this._charts.get(t);if(!r||!r.items.length)return;const n=r.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();r.items=[],this._notify(t,r,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Li=new U7;const xb="transparent",$7={boolean(e,t,r){return r>.5?t:e},color(e,t,r){const n=ob(e||xb),i=n.valid&&ob(t||xb);return i&&i.valid?i.mix(n,r).hexString():t},number(e,t,r){return e+(t-e)*r}};class V7{constructor(t,r,n,i){const s=r[n];i=xf([t.to,i,s,t.from]);const a=xf([t.from,s,i]);this._active=!0,this._fn=t.fn||$7[t.type||typeof a],this._easing=cu[t.easing]||cu.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=r,this._prop=n,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(t,r,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,a=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=xf([t.to,r,i,t.from]),this._from=xf([t.from,i,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const r=t-this._start,n=this._duration,i=this._prop,s=this._from,a=this._loop,o=this._to;let l;if(this._active=s!==o&&(a||r<n),!this._active){this._target[i]=o,this._notify(!0);return}if(r<0){this._target[i]=s;return}l=r/n%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,o,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((r,n)=>{t.push({res:r,rej:n})})}_notify(t){const r=t?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][r]()}}class X4{constructor(t,r){this._chart=t,this._properties=new Map,this.configure(r)}configure(t){if(!Ke(t))return;const r=Object.keys(Pt.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const s=t[i];if(!Ke(s))return;const a={};for(const o of r)a[o]=s[o];(Vt(s.properties)&&s.properties||[i]).forEach(o=>{(o===i||!n.has(o))&&n.set(o,a)})})}_animateOptions(t,r){const n=r.options,i=W7(t,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&H7(t.options.$animations,n).then(()=>{t.options=n},()=>{}),s}_createAnimations(t,r){const n=this._properties,i=[],s=t.$animations||(t.$animations={}),a=Object.keys(r),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(t,r));continue}const u=r[c];let d=s[c];const f=n.get(c);if(d)if(f&&d.active()){d.update(f,u,o);continue}else d.cancel();if(!f||!f.duration){t[c]=u;continue}s[c]=d=new V7(f,t,c,u),i.push(d)}return i}update(t,r){if(this._properties.size===0){Object.assign(t,r);return}const n=this._createAnimations(t,r);if(n.length)return Li.add(this._chart,n),!0}}function H7(e,t){const r=[],n=Object.keys(t);for(let i=0;i<n.length;i++){const s=e[n[i]];s&&s.active()&&r.push(s.wait())}return Promise.all(r)}function W7(e,t){if(!t)return;let r=e.options;if(!r){e.options=t;return}return r.$shared&&(e.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function yb(e,t){const r=e&&e.options||{},n=r.reverse,i=r.min===void 0?t:0,s=r.max===void 0?t:0;return{start:n?s:i,end:n?i:s}}function G7(e,t,r){if(r===!1)return!1;const n=yb(e,r),i=yb(t,r);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function K7(e){let t,r,n,i;return Ke(e)?(t=e.top,r=e.right,n=e.bottom,i=e.left):t=r=n=i=e,{top:t,right:r,bottom:n,left:i,disabled:e===!1}}function Y4(e,t){const r=[],n=e._getSortedDatasetMetas(t);let i,s;for(i=0,s=n.length;i<s;++i)r.push(n[i].index);return r}function wb(e,t,r,n={}){const i=e.keys,s=n.mode==="single";let a,o,l,c;if(t===null)return;let u=!1;for(a=0,o=i.length;a<o;++a){if(l=+i[a],l===r){if(u=!0,n.all)continue;break}c=e.values[l],On(c)&&(s||t===0||ki(t)===ki(c))&&(t+=c)}return!u&&!n.all?0:t}function q7(e,t){const{iScale:r,vScale:n}=t,i=r.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",a=Object.keys(e),o=new Array(a.length);let l,c,u;for(l=0,c=a.length;l<c;++l)u=a[l],o[l]={[i]:u,[s]:e[u]};return o}function hm(e,t){const r=e&&e.options.stacked;return r||r===void 0&&t.stack!==void 0}function X7(e,t,r){return`${e.id}.${t.id}.${r.stack||r.type}`}function Y7(e){const{min:t,max:r,minDefined:n,maxDefined:i}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:i?r:Number.POSITIVE_INFINITY}}function Q7(e,t,r){const n=e[t]||(e[t]={});return n[r]||(n[r]={})}function bb(e,t,r,n){for(const i of t.getMatchingVisibleMetas(n).reverse()){const s=e[i.index];if(r&&s>0||!r&&s<0)return i.index}return null}function _b(e,t){const{chart:r,_cachedMeta:n}=e,i=r._stacks||(r._stacks={}),{iScale:s,vScale:a,index:o}=n,l=s.axis,c=a.axis,u=X7(s,a,n),d=t.length;let f;for(let p=0;p<d;++p){const m=t[p],{[l]:h,[c]:g}=m,v=m._stacks||(m._stacks={});f=v[c]=Q7(i,u,h),f[o]=g,f._top=bb(f,a,!0,n.type),f._bottom=bb(f,a,!1,n.type);const w=f._visualValues||(f._visualValues={});w[o]=g}}function pm(e,t){const r=e.scales;return Object.keys(r).filter(n=>r[n].axis===t).shift()}function J7(e,t){return Eo(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Z7(e,t,r){return Eo(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}function Rc(e,t){const r=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const i of t){const s=i._stacks;if(!s||s[n]===void 0||s[n][r]===void 0)return;delete s[n][r],s[n]._visualValues!==void 0&&s[n]._visualValues[r]!==void 0&&delete s[n]._visualValues[r]}}}const mm=e=>e==="reset"||e==="none",Sb=(e,t)=>t?e:Object.assign({},e),eB=(e,t,r)=>e&&!t.hidden&&t._stacked&&{keys:Y4(r,!0),values:null};class xl{constructor(t,r){this.chart=t,this._ctx=t.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=hm(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Rc(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,r=this._cachedMeta,n=this.getDataset(),i=(d,f,p,m)=>d==="x"?f:d==="r"?m:p,s=r.xAxisID=je(n.xAxisID,pm(t,"x")),a=r.yAxisID=je(n.yAxisID,pm(t,"y")),o=r.rAxisID=je(n.rAxisID,pm(t,"r")),l=r.indexAxis,c=r.iAxisID=i(l,s,a,o),u=r.vAxisID=i(l,a,s,o);r.xScale=this.getScaleForId(s),r.yScale=this.getScaleForId(a),r.rScale=this.getScaleForId(o),r.iScale=this.getScaleForId(c),r.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const r=this._cachedMeta;return t===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&ib(this._data,this),t._stacked&&Rc(t)}_dataCheck(){const t=this.getDataset(),r=t.data||(t.data=[]),n=this._data;if(Ke(r)){const i=this._cachedMeta;this._data=q7(r,i)}else if(n!==r){if(n){ib(n,this);const i=this._cachedMeta;Rc(i),i._parsed=[]}r&&Object.isExtensible(r)&&N9(r,this),this._syncList=[],this._data=r}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const r=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=r._stacked;r._stacked=hm(r.vScale,r),r.stack!==n.stack&&(i=!0,Rc(r),r.stack=n.stack),this._resyncElements(t),(i||s!==r._stacked)&&(_b(this,r._parsed),r._stacked=hm(r.vScale,r))}configure(){const t=this.chart.config,r=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),r,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,r){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:a}=n,o=s.axis;let l=t===0&&r===i.length?!0:n._sorted,c=t>0&&n._parsed[t-1],u,d,f;if(this._parsing===!1)n._parsed=i,n._sorted=!0,f=i;else{Vt(i[t])?f=this.parseArrayData(n,i,t,r):Ke(i[t])?f=this.parseObjectData(n,i,t,r):f=this.parsePrimitiveData(n,i,t,r);const p=()=>d[o]===null||c&&d[o]<c[o];for(u=0;u<r;++u)n._parsed[u+t]=d=f[u],l&&(p()&&(l=!1),c=d);n._sorted=l}a&&_b(this,f)}parsePrimitiveData(t,r,n,i){const{iScale:s,vScale:a}=t,o=s.axis,l=a.axis,c=s.getLabels(),u=s===a,d=new Array(i);let f,p,m;for(f=0,p=i;f<p;++f)m=f+n,d[f]={[o]:u||s.parse(c[m],m),[l]:a.parse(r[m],m)};return d}parseArrayData(t,r,n,i){const{xScale:s,yScale:a}=t,o=new Array(i);let l,c,u,d;for(l=0,c=i;l<c;++l)u=l+n,d=r[u],o[l]={x:s.parse(d[0],u),y:a.parse(d[1],u)};return o}parseObjectData(t,r,n,i){const{xScale:s,yScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let u,d,f,p;for(u=0,d=i;u<d;++u)f=u+n,p=r[f],c[u]={x:s.parse(Gl(p,o),f),y:a.parse(Gl(p,l),f)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,r,n){const i=this.chart,s=this._cachedMeta,a=r[t.axis],o={keys:Y4(i,!0),values:r._stacks[t.axis]._visualValues};return wb(o,a,s.index,{mode:n})}updateRangeFromParsed(t,r,n,i){const s=n[r.axis];let a=s===null?NaN:s;const o=i&&n._stacks[r.axis];i&&o&&(i.values=o,a=wb(i,s,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,r){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&t===n.iScale,a=i.length,o=this._getOtherScale(t),l=eB(r,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=Y7(o);let f,p;function m(){p=i[f];const h=p[o.axis];return!On(p[t.axis])||u>h||d<h}for(f=0;f<a&&!(!m()&&(this.updateRangeFromParsed(c,t,p,l),s));++f);if(s){for(f=a-1;f>=0;--f)if(!m()){this.updateRangeFromParsed(c,t,p,l);break}}return c}getAllParsedValues(t){const r=this._cachedMeta._parsed,n=[];let i,s,a;for(i=0,s=r.length;i<s;++i)a=r[i][t.axis],On(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const r=this._cachedMeta,n=r.iScale,i=r.vScale,s=this.getParsed(t);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(t){const r=this._cachedMeta;this.update(t||"default"),r._clip=K7(je(this.options.clip,G7(r.xScale,r.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,r=this.chart,n=this._cachedMeta,i=n.data||[],s=r.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||i.length-o,c=this.options.drawActiveElementsOnTop;let u;for(n.dataset&&n.dataset.draw(t,s,o,l),u=o;u<o+l;++u){const d=i[u];d.hidden||(d.active&&c?a.push(d):d.draw(t,s))}for(u=0;u<a.length;++u)a[u].draw(t,s)}getStyle(t,r){const n=r?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,r,n){const i=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];s=a.$context||(a.$context=Z7(this.getContext(),t,a)),s.parsed=this.getParsed(t),s.raw=i.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=J7(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!r,s.mode=n,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,r){return this._resolveElementOptions(this.dataElementType.id,r,t)}_resolveElementOptions(t,r="default",n){const i=r==="active",s=this._cachedDataOpts,a=t+"-"+r,o=s[a],l=this.enableOptionSharing&&Wu(n);if(o)return Sb(o,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),d=i?[`${t}Hover`,"hover",t,""]:[t,""],f=c.getOptionScopes(this.getDataset(),u),p=Object.keys(Pt.elements[t]),m=()=>this.getContext(n,i,r),h=c.resolveNamedOptions(f,p,m,d);return h.$shared&&(h.$shared=l,s[a]=Object.freeze(Sb(h,l))),h}_resolveAnimations(t,r,n){const i=this.chart,s=this._cachedDataOpts,a=`animation-${r}`,o=s[a];if(o)return o;let l;if(i.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,r),f=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(f,this.getContext(t,n,r))}const c=new X4(i,l&&l.animations);return l&&l._cacheable&&(s[a]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,r){return!r||mm(t)||this.chart._animationsDisabled}_getSharedOptions(t,r){const n=this.resolveDataElementOptions(t,r),i=this._sharedOptions,s=this.getSharedOptions(n),a=this.includeOptions(r,s)||s!==i;return this.updateSharedOptions(s,r,n),{sharedOptions:s,includeOptions:a}}updateElement(t,r,n,i){mm(i)?Object.assign(t,n):this._resolveAnimations(r,i).update(t,n)}updateSharedOptions(t,r,n){t&&!mm(r)&&this._resolveAnimations(void 0,r).update(t,n)}_setStyle(t,r,n,i){t.active=i;const s=this.getStyle(r,i);this._resolveAnimations(r,n,i).update(t,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(t,r,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,r,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const r=this._data,n=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const i=n.length,s=r.length,a=Math.min(s,i);a&&this.parse(0,a),s>i?this._insertElements(i,s-i,t):s<i&&this._removeElements(s,i-s)}_insertElements(t,r,n=!0){const i=this._cachedMeta,s=i.data,a=t+r;let o;const l=c=>{for(c.length+=r,o=c.length-1;o>=a;o--)c[o]=c[o-r]};for(l(s),o=t;o<a;++o)s[o]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(t,r),n&&this.updateElements(s,t,r,"reset")}updateElements(t,r,n,i){}_removeElements(t,r){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,r);n._stacked&&Rc(n,i)}n.data.splice(t,r)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[r,n,i]=t;this[r](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,r){r&&this._sync(["_removeElements",t,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Pe(xl,"defaults",{}),Pe(xl,"datasetElementType",null),Pe(xl,"dataElementType",null);function tB(e,t){if(!e._cache.$bar){const r=e.getMatchingVisibleMetas(t);let n=[];for(let i=0,s=r.length;i<s;i++)n=n.concat(r[i].controller.getAllParsedValues(e));e._cache.$bar=I4(n.sort((i,s)=>i-s))}return e._cache.$bar}function rB(e){const t=e.iScale,r=tB(t,e.type);let n=t._length,i,s,a,o;const l=()=>{a===32767||a===-32768||(Wu(o)&&(n=Math.min(n,Math.abs(a-o)||n)),o=a)};for(i=0,s=r.length;i<s;++i)a=t.getPixelForValue(r[i]),l();for(o=void 0,i=0,s=t.ticks.length;i<s;++i)a=t.getPixelForTick(i),l();return n}function nB(e,t,r,n){const i=r.barThickness;let s,a;return qe(i)?(s=t.min*r.categoryPercentage,a=r.barPercentage):(s=i*n,a=1),{chunk:s/n,ratio:a,start:t.pixels[e]-s/2}}function iB(e,t,r,n){const i=t.pixels,s=i[e];let a=e>0?i[e-1]:null,o=e<i.length-1?i[e+1]:null;const l=r.categoryPercentage;a===null&&(a=s-(o===null?t.end-t.start:o-s)),o===null&&(o=s+s-a);const c=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/n,ratio:r.barPercentage,start:c}}function sB(e,t,r,n){const i=r.parse(e[0],n),s=r.parse(e[1],n),a=Math.min(i,s),o=Math.max(i,s);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),t[r.axis]=c,t._custom={barStart:l,barEnd:c,start:i,end:s,min:a,max:o}}function Q4(e,t,r,n){return Vt(e)?sB(e,t,r,n):t[r.axis]=r.parse(e,n),t}function Eb(e,t,r,n){const i=e.iScale,s=e.vScale,a=i.getLabels(),o=i===s,l=[];let c,u,d,f;for(c=r,u=r+n;c<u;++c)f=t[c],d={},d[i.axis]=o||i.parse(a[c],c),l.push(Q4(f,d,s,c));return l}function gm(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function aB(e,t,r){return e!==0?ki(e):(t.isHorizontal()?1:-1)*(t.min>=r?1:-1)}function oB(e){let t,r,n,i,s;return e.horizontal?(t=e.base>e.x,r="left",n="right"):(t=e.base<e.y,r="bottom",n="top"),t?(i="end",s="start"):(i="start",s="end"),{start:r,end:n,reverse:t,top:i,bottom:s}}function lB(e,t,r,n){let i=t.borderSkipped;const s={};if(!i){e.borderSkipped=s;return}if(i===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:c,bottom:u}=oB(e);i==="middle"&&r&&(e.enableBorderRadius=!0,(r._top||0)===n?i=c:(r._bottom||0)===n?i=u:(s[Tb(u,a,o,l)]=!0,i=c)),s[Tb(i,a,o,l)]=!0,e.borderSkipped=s}function Tb(e,t,r,n){return n?(e=cB(e,t,r),e=kb(e,r,t)):e=kb(e,t,r),e}function cB(e,t,r){return e===t?r:e===r?t:e}function kb(e,t,r){return e==="start"?t:e==="end"?r:e}function uB(e,{inflateAmount:t},r){e.inflateAmount=t==="auto"?r===1?.33:0:t}class rh extends xl{parsePrimitiveData(t,r,n,i){return Eb(t,r,n,i)}parseArrayData(t,r,n,i){return Eb(t,r,n,i)}parseObjectData(t,r,n,i){const{iScale:s,vScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?o:l,u=a.axis==="x"?o:l,d=[];let f,p,m,h;for(f=n,p=n+i;f<p;++f)h=r[f],m={},m[s.axis]=s.parse(Gl(h,c),f),d.push(Q4(Gl(h,u),m,a,f));return d}updateRangeFromParsed(t,r,n,i){super.updateRangeFromParsed(t,r,n,i);const s=n._custom;s&&r===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const r=this._cachedMeta,{iScale:n,vScale:i}=r,s=this.getParsed(t),a=s._custom,o=gm(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,t)}updateElements(t,r,n,i){const s=i==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),c=o.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:f}=this._getSharedOptions(r,i);for(let p=r;p<r+n;p++){const m=this.getParsed(p),h=s||qe(m[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),g=this._calculateBarIndexPixels(p,u),v=(m._stacks||{})[o.axis],w={horizontal:c,base:h.base,enableBorderRadius:!v||gm(m._custom)||a===v._top||a===v._bottom,x:c?h.head:g.center,y:c?g.center:h.head,height:c?g.size:Math.abs(h.size),width:c?Math.abs(h.size):g.size};f&&(w.options=d||this.resolveDataElementOptions(p,t[p].active?"active":i));const y=w.options||t[p].options;lB(w,y,v,a),uB(w,y,u.ratio),this.updateElement(t[p],p,w,i)}}_getStacks(t,r){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),s=n.options.stacked,a=[],o=this._cachedMeta.controller.getParsed(r),l=o&&o[n.axis],c=u=>{const d=u._parsed.find(p=>p[n.axis]===l),f=d&&d[u.vScale.axis];if(qe(f)||isNaN(f))return!0};for(const u of i)if(!(r!==void 0&&c(u))&&((s===!1||a.indexOf(u.stack)===-1||s===void 0&&u.stack===void 0)&&a.push(u.stack),u.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,r=this.chart.options.indexAxis;return Object.keys(t).filter(n=>t[n].axis===r).shift()}_getAxis(){const t={},r=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)t[je(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,r)]=!0;return Object.keys(t)}_getStackIndex(t,r,n){const i=this._getStacks(t,n),s=r!==void 0?i.indexOf(r):-1;return s===-1?i.length-1:s}_getRuler(){const t=this.options,r=this._cachedMeta,n=r.iScale,i=[];let s,a;for(s=0,a=r.data.length;s<a;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const o=t.barThickness;return{min:o||rB(r),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:r,_stacked:n,index:i},options:{base:s,minBarLength:a}}=this,o=s||0,l=this.getParsed(t),c=l._custom,u=gm(c);let d=l[r.axis],f=0,p=n?this.applyStack(r,l,n):d,m,h;p!==d&&(f=p-d,p=d),u&&(d=c.barStart,p=c.barEnd-c.barStart,d!==0&&ki(d)!==ki(c.barEnd)&&(f=0),f+=d);const g=!qe(s)&&!u?s:f;let v=r.getPixelForValue(g);if(this.chart.getDataVisibility(t)?m=r.getPixelForValue(f+p):m=v,h=m-v,Math.abs(h)<a){h=aB(h,r,o)*a,d===o&&(v-=h/2);const w=r.getPixelForDecimal(0),y=r.getPixelForDecimal(1),b=Math.min(w,y),E=Math.max(w,y);v=Math.max(Math.min(v,E),b),m=v+h,n&&!u&&(l._stacks[r.axis]._visualValues[i]=r.getValueForPixel(m)-r.getValueForPixel(v))}if(v===r.getPixelForValue(o)){const w=ki(h)*r.getLineWidthForValue(o)/2;v+=w,h-=w}return{size:h,base:v,head:m,center:m+h/2}}_calculateBarIndexPixels(t,r){const n=r.scale,i=this.options,s=i.skipNull,a=je(i.maxBarThickness,1/0);let o,l;const c=this._getAxisCount();if(r.grouped){const u=s?this._getStackCount(t):r.stackCount,d=i.barThickness==="flex"?iB(t,r,i,u*c):nB(t,r,i,u*c),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(je(f,this.getFirstScaleIdForIndexAxis())),m=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0)+p;o=d.start+d.chunk*m+d.chunk/2,l=Math.min(a,d.chunk*d.ratio)}else o=n.getPixelForValue(this.getParsed(t)[n.axis],t),l=Math.min(a,r.min*r.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const t=this._cachedMeta,r=t.vScale,n=t.data,i=n.length;let s=0;for(;s<i;++s)this.getParsed(s)[r.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}Pe(rh,"id","bar"),Pe(rh,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Pe(rh,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class nh extends xl{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const r=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=r,a=this.chart._animationsDisabled;let{start:o,count:l}=L9(r,i,a);this._drawStart=o,this._drawCount=l,z9(r)&&(o=0,l=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:c},t),this.updateElements(i,o,l,t)}updateElements(t,r,n,i){const s=i==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(r,i),f=a.axis,p=o.axis,{spanGaps:m,segment:h}=this.options,g=Gu(m)?m:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||s||i==="none",w=r+n,y=t.length;let b=r>0&&this.getParsed(r-1);for(let E=0;E<y;++E){const k=t[E],S=v?k:{};if(E<r||E>=w){S.skip=!0;continue}const C=this.getParsed(E),T=qe(C[p]),P=S[f]=a.getPixelForValue(C[f],E),I=S[p]=s||T?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,C,l):C[p],E);S.skip=isNaN(P)||isNaN(I)||T,S.stop=E>0&&Math.abs(C[f]-b[f])>g,h&&(S.parsed=C,S.raw=c.data[E]),d&&(S.options=u||this.resolveDataElementOptions(E,k.active?"active":i)),v||this.updateElement(k,E,S,i),b=C}}getMaxOverflow(){const t=this._cachedMeta,r=t.dataset,n=r.options&&r.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Pe(nh,"id","line"),Pe(nh,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Pe(nh,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function Ta(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Dx{constructor(t){Pe(this,"options");this.options=t||{}}static override(t){Object.assign(Dx.prototype,t)}init(){}formats(){return Ta()}parse(){return Ta()}format(){return Ta()}add(){return Ta()}diff(){return Ta()}startOf(){return Ta()}endOf(){return Ta()}}var dB={_date:Dx};function fB(e,t,r,n){const{controller:i,data:s,_sorted:a}=e,o=i._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&t!=="r"&&a&&s.length){const c=o._reversePixels?I9:Ua;if(n){if(i._sharedOptions){const u=s[0],d=typeof u.getRange=="function"&&u.getRange(t);if(d){const f=c(s,t,r-d),p=c(s,t,r+d);return{lo:f.lo,hi:p.hi}}}}else{const u=c(s,t,r);if(l){const{vScale:d}=i._cachedMeta,{_parsed:f}=e,p=f.slice(0,u.lo+1).reverse().findIndex(h=>!qe(h[d.axis]));u.lo-=Math.max(0,p);const m=f.slice(u.hi).findIndex(h=>!qe(h[d.axis]));u.hi+=Math.max(0,m)}return u}}return{lo:0,hi:s.length-1}}function bd(e,t,r,n,i){const s=e.getSortedVisibleDatasetMetas(),a=r[t];for(let o=0,l=s.length;o<l;++o){const{index:c,data:u}=s[o],{lo:d,hi:f}=fB(s[o],t,a,i);for(let p=d;p<=f;++p){const m=u[p];m.skip||n(m,c,p)}}}function hB(e){const t=e.indexOf("x")!==-1,r=e.indexOf("y")!==-1;return function(n,i){const s=t?Math.abs(n.x-i.x):0,a=r?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function vm(e,t,r,n,i){const s=[];return!i&&!e.isPointInArea(t)||bd(e,r,t,function(o,l,c){!i&&!Ku(o,e.chartArea,0)||o.inRange(t.x,t.y,n)&&s.push({element:o,datasetIndex:l,index:c})},!0),s}function pB(e,t,r,n){let i=[];function s(a,o,l){const{startAngle:c,endAngle:u}=a.getProps(["startAngle","endAngle"],n),{angle:d}=R9(a,{x:t.x,y:t.y});P4(d,c,u)&&i.push({element:a,datasetIndex:o,index:l})}return bd(e,r,t,s),i}function mB(e,t,r,n,i,s){let a=[];const o=hB(r);let l=Number.POSITIVE_INFINITY;function c(u,d,f){const p=u.inRange(t.x,t.y,i);if(n&&!p)return;const m=u.getCenterPoint(i);if(!(!!s||e.isPointInArea(m))&&!p)return;const g=o(t,m);g<l?(a=[{element:u,datasetIndex:d,index:f}],l=g):g===l&&a.push({element:u,datasetIndex:d,index:f})}return bd(e,r,t,c),a}function xm(e,t,r,n,i,s){return!s&&!e.isPointInArea(t)?[]:r==="r"&&!n?pB(e,t,r,i):mB(e,t,r,n,i,s)}function Cb(e,t,r,n,i){const s=[],a=r==="x"?"inXRange":"inYRange";let o=!1;return bd(e,r,t,(l,c,u)=>{l[a]&&l[a](t[r],i)&&(s.push({element:l,datasetIndex:c,index:u}),o=o||l.inRange(t.x,t.y,i))}),n&&!o?[]:s}var gB={evaluateInteractionItems:bd,modes:{index(e,t,r,n){const i=Ra(t,e),s=r.axis||"x",a=r.includeInvisible||!1,o=r.intersect?vm(e,i,s,n,a):xm(e,i,s,!1,n,a),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(c=>{const u=o[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(e,t,r,n){const i=Ra(t,e),s=r.axis||"xy",a=r.includeInvisible||!1;let o=r.intersect?vm(e,i,s,n,a):xm(e,i,s,!1,n,a);if(o.length>0){const l=o[0].datasetIndex,c=e.getDatasetMeta(l).data;o=[];for(let u=0;u<c.length;++u)o.push({element:c[u],datasetIndex:l,index:u})}return o},point(e,t,r,n){const i=Ra(t,e),s=r.axis||"xy",a=r.includeInvisible||!1;return vm(e,i,s,n,a)},nearest(e,t,r,n){const i=Ra(t,e),s=r.axis||"xy",a=r.includeInvisible||!1;return xm(e,i,s,r.intersect,n,a)},x(e,t,r,n){const i=Ra(t,e);return Cb(e,i,"x",r.intersect,n)},y(e,t,r,n){const i=Ra(t,e);return Cb(e,i,"y",r.intersect,n)}}};const J4=["left","top","right","bottom"];function Pc(e,t){return e.filter(r=>r.pos===t)}function Ab(e,t){return e.filter(r=>J4.indexOf(r.pos)===-1&&r.box.axis===t)}function Oc(e,t){return e.sort((r,n)=>{const i=t?n:r,s=t?r:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function vB(e){const t=[];let r,n,i,s,a,o;for(r=0,n=(e||[]).length;r<n;++r)i=e[r],{position:s,options:{stack:a,stackWeight:o=1}}=i,t.push({index:r,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&s+a,stackWeight:o});return t}function xB(e){const t={};for(const r of e){const{stack:n,pos:i,stackWeight:s}=r;if(!n||!J4.includes(i))continue;const a=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return t}function yB(e,t){const r=xB(e),{vBoxMaxWidth:n,hBoxMaxHeight:i}=t;let s,a,o;for(s=0,a=e.length;s<a;++s){o=e[s];const{fullSize:l}=o.box,c=r[o.stack],u=c&&o.stackWeight/c.weight;o.horizontal?(o.width=u?u*n:l&&t.availableWidth,o.height=i):(o.width=n,o.height=u?u*i:l&&t.availableHeight)}return r}function wB(e){const t=vB(e),r=Oc(t.filter(c=>c.box.fullSize),!0),n=Oc(Pc(t,"left"),!0),i=Oc(Pc(t,"right")),s=Oc(Pc(t,"top"),!0),a=Oc(Pc(t,"bottom")),o=Ab(t,"x"),l=Ab(t,"y");return{fullSize:r,leftAndTop:n.concat(s),rightAndBottom:i.concat(l).concat(a).concat(o),chartArea:Pc(t,"chartArea"),vertical:n.concat(i).concat(l),horizontal:s.concat(a).concat(o)}}function Rb(e,t,r,n){return Math.max(e[r],t[r])+Math.max(e[n],t[n])}function Z4(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function bB(e,t,r,n){const{pos:i,box:s}=r,a=e.maxPadding;if(!Ke(i)){r.size&&(e[i]-=r.size);const d=n[r.stack]||{size:0,count:1};d.size=Math.max(d.size,r.horizontal?s.height:s.width),r.size=d.size/d.count,e[i]+=r.size}s.getPadding&&Z4(a,s.getPadding());const o=Math.max(0,t.outerWidth-Rb(a,e,"left","right")),l=Math.max(0,t.outerHeight-Rb(a,e,"top","bottom")),c=o!==e.w,u=l!==e.h;return e.w=o,e.h=l,r.horizontal?{same:c,other:u}:{same:u,other:c}}function _B(e){const t=e.maxPadding;function r(n){const i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=r("top"),e.x+=r("left"),r("right"),r("bottom")}function SB(e,t){const r=t.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(a=>{s[a]=Math.max(t[a],r[a])}),s}return n(e?["left","right"]:["top","bottom"])}function Uc(e,t,r,n){const i=[];let s,a,o,l,c,u;for(s=0,a=e.length,c=0;s<a;++s){o=e[s],l=o.box,l.update(o.width||t.w,o.height||t.h,SB(o.horizontal,t));const{same:d,other:f}=bB(t,r,o,n);c|=d&&i.length,u=u||f,l.fullSize||i.push(o)}return c&&Uc(i,t,r,n)||u}function bf(e,t,r,n,i){e.top=r,e.left=t,e.right=t+n,e.bottom=r+i,e.width=n,e.height=i}function Pb(e,t,r,n){const i=r.padding;let{x:s,y:a}=t;for(const o of e){const l=o.box,c=n[o.stack]||{count:1,placed:0,weight:1},u=o.stackWeight/c.weight||1;if(o.horizontal){const d=t.w*u,f=c.size||l.height;Wu(c.start)&&(a=c.start),l.fullSize?bf(l,i.left,a,r.outerWidth-i.right-i.left,f):bf(l,t.left+c.placed,a,d,f),c.start=a,c.placed+=d,a=l.bottom}else{const d=t.h*u,f=c.size||l.width;Wu(c.start)&&(s=c.start),l.fullSize?bf(l,s,i.top,f,r.outerHeight-i.bottom-i.top):bf(l,s,t.top+c.placed,f,d),c.start=s,c.placed+=d,s=l.right}}t.x=s,t.y=a}var Cn={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(r){t.draw(r)}}]},e.boxes.push(t)},removeBox(e,t){const r=e.boxes?e.boxes.indexOf(t):-1;r!==-1&&e.boxes.splice(r,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(e,t,r,n){if(!e)return;const i=In(e.options.layout.padding),s=Math.max(t-i.width,0),a=Math.max(r-i.height,0),o=wB(e.boxes),l=o.vertical,c=o.horizontal;Ye(e.boxes,h=>{typeof h.beforeLayout=="function"&&h.beforeLayout()});const u=l.reduce((h,g)=>g.box.options&&g.box.options.display===!1?h:h+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:r,padding:i,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/u,hBoxMaxHeight:a/2}),f=Object.assign({},i);Z4(f,In(n));const p=Object.assign({maxPadding:f,w:s,h:a,x:i.left,y:i.top},i),m=yB(l.concat(c),d);Uc(o.fullSize,p,d,m),Uc(l,p,d,m),Uc(c,p,d,m)&&Uc(l,p,d,m),_B(p),Pb(o.leftAndTop,p,d,m),p.x+=p.w,p.y+=p.h,Pb(o.rightAndBottom,p,d,m),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Ye(o.chartArea,h=>{const g=h.box;Object.assign(g,e.chartArea),g.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class eR{acquireContext(t,r){}releaseContext(t){return!1}addEventListener(t,r,n){}removeEventListener(t,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,r,n,i){return r=Math.max(0,r||t.width),n=n||t.height,{width:r,height:Math.max(0,i?Math.floor(r/i):n)}}isAttached(t){return!0}updateConfig(t){}}class EB extends eR{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const ih="$chartjs",TB={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ob=e=>e===null||e==="";function kB(e,t){const r=e.style,n=e.getAttribute("height"),i=e.getAttribute("width");if(e[ih]={initial:{height:n,width:i,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",Ob(i)){const s=pb(e,"width");s!==void 0&&(e.width=s)}if(Ob(n))if(e.style.height==="")e.height=e.width/(t||2);else{const s=pb(e,"height");s!==void 0&&(e.height=s)}return e}const tR=k7?{passive:!0}:!1;function CB(e,t,r){e&&e.addEventListener(t,r,tR)}function AB(e,t,r){e&&e.canvas&&e.canvas.removeEventListener(t,r,tR)}function RB(e,t){const r=TB[e.type]||e.type,{x:n,y:i}=Ra(e,t);return{type:r,chart:t,native:e,x:n!==void 0?n:null,y:i!==void 0?i:null}}function Qh(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function PB(e,t,r){const n=e.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||Qh(o.addedNodes,n),a=a&&!Qh(o.removedNodes,n);a&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}function OB(e,t,r){const n=e.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||Qh(o.removedNodes,n),a=a&&!Qh(o.addedNodes,n);a&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}const Xu=new Map;let Ib=0;function rR(){const e=window.devicePixelRatio;e!==Ib&&(Ib=e,Xu.forEach((t,r)=>{r.currentDevicePixelRatio!==e&&t()}))}function IB(e,t){Xu.size||window.addEventListener("resize",rR),Xu.set(e,t)}function DB(e){Xu.delete(e),Xu.size||window.removeEventListener("resize",rR)}function NB(e,t,r){const n=e.canvas,i=n&&Ix(n);if(!i)return;const s=N4((o,l)=>{const c=i.clientWidth;r(o,l),c<i.clientWidth&&r()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return a.observe(i),IB(e,s),a}function ym(e,t,r){r&&r.disconnect(),t==="resize"&&DB(e)}function FB(e,t,r){const n=e.canvas,i=N4(s=>{e.ctx!==null&&r(RB(s,e))},e);return CB(n,t,i),i}class MB extends eR{acquireContext(t,r){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(kB(t,r),n):null}releaseContext(t){const r=t.canvas;if(!r[ih])return!1;const n=r[ih].initial;["height","width"].forEach(s=>{const a=n[s];qe(a)?r.removeAttribute(s):r.setAttribute(s,a)});const i=n.style||{};return Object.keys(i).forEach(s=>{r.style[s]=i[s]}),r.width=r.width,delete r[ih],!0}addEventListener(t,r,n){this.removeEventListener(t,r);const i=t.$proxies||(t.$proxies={}),a={attach:PB,detach:OB,resize:NB}[r]||FB;i[r]=a(t,r,n)}removeEventListener(t,r){const n=t.$proxies||(t.$proxies={}),i=n[r];if(!i)return;({attach:ym,detach:ym,resize:ym}[r]||AB)(t,r,i),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,r,n,i){return T7(t,r,n,i)}isAttached(t){const r=t&&Ix(t);return!!(r&&r.isConnected)}}function LB(e){return!Ox()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?EB:MB}var Lf;let ha=(Lf=class{constructor(){Pe(this,"x");Pe(this,"y");Pe(this,"active",!1);Pe(this,"options");Pe(this,"$animations")}tooltipPosition(t){const{x:r,y:n}=this.getProps(["x","y"],t);return{x:r,y:n}}hasValue(){return Gu(this.x)&&Gu(this.y)}getProps(t,r){const n=this.$animations;if(!r||!n)return this;const i={};return t.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}},Pe(Lf,"defaults",{}),Pe(Lf,"defaultRoutes"),Lf);function zB(e,t){const r=e.options.ticks,n=jB(e),i=Math.min(r.maxTicksLimit||n,n),s=r.major.enabled?UB(t):[],a=s.length,o=s[0],l=s[a-1],c=[];if(a>i)return $B(t,c,s,a/i),c;const u=BB(s,t,i);if(a>0){let d,f;const p=a>1?Math.round((l-o)/(a-1)):null;for(_f(t,c,u,qe(p)?0:o-p,o),d=0,f=a-1;d<f;d++)_f(t,c,u,s[d],s[d+1]);return _f(t,c,u,l,qe(p)?t.length:l+p),c}return _f(t,c,u),c}function jB(e){const t=e.options.offset,r=e._tickSize(),n=e._length/r+(t?0:1),i=e._maxLength/r;return Math.floor(Math.min(n,i))}function BB(e,t,r){const n=VB(e),i=t.length/r;if(!n)return Math.max(i,1);const s=E9(n);for(let a=0,o=s.length-1;a<o;a++){const l=s[a];if(l>i)return l}return Math.max(i,1)}function UB(e){const t=[];let r,n;for(r=0,n=e.length;r<n;r++)e[r].major&&t.push(r);return t}function $B(e,t,r,n){let i=0,s=r[0],a;for(n=Math.ceil(n),a=0;a<e.length;a++)a===s&&(t.push(e[a]),i++,s=r[i*n])}function _f(e,t,r,n,i){const s=je(n,0),a=Math.min(je(i,e.length),e.length);let o=0,l,c,u;for(r=Math.ceil(r),i&&(l=i-n,r=l/Math.floor(l/r)),u=s;u<0;)o++,u=Math.round(s+o*r);for(c=Math.max(s,0);c<a;c++)c===u&&(t.push(e[c]),o++,u=Math.round(s+o*r))}function VB(e){const t=e.length;let r,n;if(t<2)return!1;for(n=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==n)return!1;return n}const HB=e=>e==="left"?"right":e==="right"?"left":e,Db=(e,t,r)=>t==="top"||t==="left"?e[t]+r:e[t]-r,Nb=(e,t)=>Math.min(t||e,e);function Fb(e,t){const r=[],n=e.length/t,i=e.length;let s=0;for(;s<i;s+=n)r.push(e[Math.floor(s)]);return r}function WB(e,t,r){const n=e.ticks.length,i=Math.min(t,n-1),s=e._startPixel,a=e._endPixel,o=1e-6;let l=e.getPixelForTick(i),c;if(!(r&&(n===1?c=Math.max(l-s,a-l):t===0?c=(e.getPixelForTick(1)-l)/2:c=(l-e.getPixelForTick(i-1))/2,l+=i<t?c:-c,l<s-o||l>a+o)))return l}function GB(e,t){Ye(e,r=>{const n=r.gc,i=n.length/2;let s;if(i>t){for(s=0;s<i;++s)delete r.data[n[s]];n.splice(0,i)}})}function Ic(e){return e.drawTicks?e.tickLength:0}function Mb(e,t){if(!e.display)return 0;const r=yr(e.font,t),n=In(e.padding);return(Vt(e.text)?e.text.length:1)*r.lineHeight+n.height}function KB(e,t){return Eo(e,{scale:t,type:"scale"})}function qB(e,t,r){return Eo(e,{tick:r,index:t,type:"tick"})}function XB(e,t,r){let n=Ex(e);return(r&&t!=="right"||!r&&t==="right")&&(n=HB(n)),n}function YB(e,t,r,n){const{top:i,left:s,bottom:a,right:o,chart:l}=e,{chartArea:c,scales:u}=l;let d=0,f,p,m;const h=a-i,g=o-s;if(e.isHorizontal()){if(p=mr(n,s,o),Ke(r)){const v=Object.keys(r)[0],w=r[v];m=u[v].getPixelForValue(w)+h-t}else r==="center"?m=(c.bottom+c.top)/2+h-t:m=Db(e,r,t);f=o-s}else{if(Ke(r)){const v=Object.keys(r)[0],w=r[v];p=u[v].getPixelForValue(w)-g+t}else r==="center"?p=(c.left+c.right)/2-g+t:p=Db(e,r,t);m=mr(n,a,i),d=r==="left"?-Jn:Jn}return{titleX:p,titleY:m,maxWidth:f,rotation:d}}class dc extends ha{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,r){return t}getUserBounds(){let{_userMin:t,_userMax:r,_suggestedMin:n,_suggestedMax:i}=this;return t=ci(t,Number.POSITIVE_INFINITY),r=ci(r,Number.NEGATIVE_INFINITY),n=ci(n,Number.POSITIVE_INFINITY),i=ci(i,Number.NEGATIVE_INFINITY),{min:ci(t,n),max:ci(r,i),minDefined:On(t),maxDefined:On(r)}}getMinMax(t){let{min:r,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),a;if(i&&s)return{min:r,max:n};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,t),i||(r=Math.min(r,a.min)),s||(n=Math.max(n,a.max));return r=s&&r>n?n:r,n=i&&r>n?r:n,{min:ci(r,ci(n,r)),max:ci(n,ci(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ot(this.options.beforeUpdate,[this])}update(t,r,n){const{beginAtZero:i,grace:s,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=n7(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?Fb(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=zB(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,t=!t),this._startPixel=r,this._endPixel=n,this._reversePixels=t,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ot(this.options.afterUpdate,[this])}beforeSetDimensions(){ot(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ot(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ot(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ot(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const r=this.options.ticks;let n,i,s;for(n=0,i=t.length;n<i;n++)s=t[n],s.label=ot(r.callback,[s.value,n,t],this)}afterTickToLabelConversion(){ot(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ot(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,r=t.ticks,n=Nb(this.ticks.length,t.ticks.maxTicksLimit),i=r.minRotation||0,s=r.maxRotation;let a=i,o,l,c;if(!this._isVisible()||!r.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const u=this._getLabelSizes(),d=u.widest.width,f=u.highest.height,p=sn(this.chart.width-d,0,this.maxWidth);o=t.offset?this.maxWidth/n:p/(n-1),d+6>o&&(o=p/(n-(t.offset?.5:1)),l=this.maxHeight-Ic(t.grid)-r.padding-Mb(t.title,this.chart.options.font),c=Math.sqrt(d*d+f*f),a=A9(Math.min(Math.asin(sn((u.highest.height+6)/o,-1,1)),Math.asin(sn(l/c,-1,1))-Math.asin(sn(f/c,-1,1)))),a=Math.max(i,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){ot(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ot(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:r,options:{ticks:n,title:i,grid:s}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=Mb(i,r.options.font);if(o?(t.width=this.maxWidth,t.height=Ic(s)+l):(t.height=this.maxHeight,t.width=Ic(s)+l),n.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:f}=this._getLabelSizes(),p=n.padding*2,m=ja(this.labelRotation),h=Math.cos(m),g=Math.sin(m);if(o){const v=n.mirror?0:g*d.width+h*f.height;t.height=Math.min(this.maxHeight,t.height+v+p)}else{const v=n.mirror?0:h*d.width+g*f.height;t.width=Math.min(this.maxWidth,t.width+v+p)}this._calculatePadding(c,u,g,h)}}this._handleMargins(),o?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,r,n,i){const{ticks:{align:s,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;l?c?(f=i*t.width,p=n*r.height):(f=n*t.height,p=i*r.width):s==="start"?p=r.width:s==="end"?f=t.width:s!=="inner"&&(f=t.width/2,p=r.width/2),this.paddingLeft=Math.max((f-u+a)*this.width/(this.width-u),0),this.paddingRight=Math.max((p-d+a)*this.width/(this.width-d),0)}else{let u=r.height/2,d=t.height/2;s==="start"?(u=0,d=t.height):s==="end"&&(u=r.height,d=0),this.paddingTop=u+a,this.paddingBottom=d+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ot(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:r}=this.options;return r==="top"||r==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let r,n;for(r=0,n=t.length;r<n;r++)qe(t[r].label)&&(t.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=Fb(n,r)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,r,n){const{ctx:i,_longestTextCache:s}=this,a=[],o=[],l=Math.floor(r/Nb(r,n));let c=0,u=0,d,f,p,m,h,g,v,w,y,b,E;for(d=0;d<r;d+=l){if(m=t[d].label,h=this._resolveTickFontOptions(d),i.font=g=h.string,v=s[g]=s[g]||{data:{},gc:[]},w=h.lineHeight,y=b=0,!qe(m)&&!Vt(m))y=cb(i,v.data,v.gc,y,m),b=w;else if(Vt(m))for(f=0,p=m.length;f<p;++f)E=m[f],!qe(E)&&!Vt(E)&&(y=cb(i,v.data,v.gc,y,E),b+=w);a.push(y),o.push(b),c=Math.max(y,c),u=Math.max(b,u)}GB(s,r);const k=a.indexOf(c),S=o.indexOf(u),C=T=>({width:a[T]||0,height:o[T]||0});return{first:C(0),last:C(r-1),widest:C(k),highest:C(S),widths:a,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,r){return NaN}getValueForPixel(t){}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const r=this._startPixel+t*this._length;return O9(this._alignToPixels?Ea(this.chart,r,0):r)}getDecimalForPixel(t){const r=(t-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:r}=this;return t<0&&r<0?r:t>0&&r>0?t:0}getContext(t){const r=this.ticks||[];if(t>=0&&t<r.length){const n=r[t];return n.$context||(n.$context=qB(this.getContext(),t,n))}return this.$context||(this.$context=KB(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,r=ja(this.labelRotation),n=Math.abs(Math.cos(r)),i=Math.abs(Math.sin(r)),s=this._getLabelSizes(),a=t.autoSkipPadding||0,o=s?s.widest.width+a:0,l=s?s.highest.height+a:0;return this.isHorizontal()?l*n>o*i?o/n:l/i:l*i<o*n?l/n:o/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const r=this.axis,n=this.chart,i=this.options,{grid:s,position:a,border:o}=i,l=s.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),f=Ic(s),p=[],m=o.setContext(this.getContext()),h=m.display?m.width:0,g=h/2,v=function(K){return Ea(n,K,h)};let w,y,b,E,k,S,C,T,P,I,R,H;if(a==="top")w=v(this.bottom),S=this.bottom-f,T=w-g,I=v(t.top)+g,H=t.bottom;else if(a==="bottom")w=v(this.top),I=t.top,H=v(t.bottom)-g,S=w+g,T=this.top+f;else if(a==="left")w=v(this.right),k=this.right-f,C=w-g,P=v(t.left)+g,R=t.right;else if(a==="right")w=v(this.left),P=t.left,R=v(t.right)-g,k=w+g,C=this.left+f;else if(r==="x"){if(a==="center")w=v((t.top+t.bottom)/2+.5);else if(Ke(a)){const K=Object.keys(a)[0],Q=a[K];w=v(this.chart.scales[K].getPixelForValue(Q))}I=t.top,H=t.bottom,S=w+g,T=S+f}else if(r==="y"){if(a==="center")w=v((t.left+t.right)/2);else if(Ke(a)){const K=Object.keys(a)[0],Q=a[K];w=v(this.chart.scales[K].getPixelForValue(Q))}k=w-g,C=k-f,P=t.left,R=t.right}const q=je(i.ticks.maxTicksLimit,d),X=Math.max(1,Math.ceil(d/q));for(y=0;y<d;y+=X){const K=this.getContext(y),Q=s.setContext(K),G=o.setContext(K),z=Q.lineWidth,ie=Q.color,ae=G.dash||[],D=G.dashOffset,V=Q.tickWidth,B=Q.tickColor,U=Q.tickBorderDash||[],Y=Q.tickBorderDashOffset;b=WB(this,y,l),b!==void 0&&(E=Ea(n,b,z),c?k=C=P=R=E:S=T=I=H=E,p.push({tx1:k,ty1:S,tx2:C,ty2:T,x1:P,y1:I,x2:R,y2:H,width:z,color:ie,borderDash:ae,borderDashOffset:D,tickWidth:V,tickColor:B,tickBorderDash:U,tickBorderDashOffset:Y}))}return this._ticksLength=d,this._borderValue=w,p}_computeLabelItems(t){const r=this.axis,n=this.options,{position:i,ticks:s}=n,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=s,f=Ic(n.grid),p=f+u,m=d?-u:p,h=-ja(this.labelRotation),g=[];let v,w,y,b,E,k,S,C,T,P,I,R,H="middle";if(i==="top")k=this.bottom-m,S=this._getXAxisLabelAlignment();else if(i==="bottom")k=this.top+m,S=this._getXAxisLabelAlignment();else if(i==="left"){const X=this._getYAxisLabelAlignment(f);S=X.textAlign,E=X.x}else if(i==="right"){const X=this._getYAxisLabelAlignment(f);S=X.textAlign,E=X.x}else if(r==="x"){if(i==="center")k=(t.top+t.bottom)/2+p;else if(Ke(i)){const X=Object.keys(i)[0],K=i[X];k=this.chart.scales[X].getPixelForValue(K)+p}S=this._getXAxisLabelAlignment()}else if(r==="y"){if(i==="center")E=(t.left+t.right)/2-p;else if(Ke(i)){const X=Object.keys(i)[0],K=i[X];E=this.chart.scales[X].getPixelForValue(K)}S=this._getYAxisLabelAlignment(f).textAlign}r==="y"&&(l==="start"?H="top":l==="end"&&(H="bottom"));const q=this._getLabelSizes();for(v=0,w=o.length;v<w;++v){y=o[v],b=y.label;const X=s.setContext(this.getContext(v));C=this.getPixelForTick(v)+s.labelOffset,T=this._resolveTickFontOptions(v),P=T.lineHeight,I=Vt(b)?b.length:1;const K=I/2,Q=X.color,G=X.textStrokeColor,z=X.textStrokeWidth;let ie=S;a?(E=C,S==="inner"&&(v===w-1?ie=this.options.reverse?"left":"right":v===0?ie=this.options.reverse?"right":"left":ie="center"),i==="top"?c==="near"||h!==0?R=-I*P+P/2:c==="center"?R=-q.highest.height/2-K*P+P:R=-q.highest.height+P/2:c==="near"||h!==0?R=P/2:c==="center"?R=q.highest.height/2-K*P:R=q.highest.height-I*P,d&&(R*=-1),h!==0&&!X.showLabelBackdrop&&(E+=P/2*Math.sin(h))):(k=C,R=(1-I)*P/2);let ae;if(X.showLabelBackdrop){const D=In(X.backdropPadding),V=q.heights[v],B=q.widths[v];let U=R-D.top,Y=0-D.left;switch(H){case"middle":U-=V/2;break;case"bottom":U-=V;break}switch(S){case"center":Y-=B/2;break;case"right":Y-=B;break;case"inner":v===w-1?Y-=B:v>0&&(Y-=B/2);break}ae={left:Y,top:U,width:B+D.width,height:V+D.height,color:X.backdropColor}}g.push({label:b,font:T,textOffset:R,options:{rotation:h,color:Q,strokeColor:G,strokeWidth:z,textAlign:ie,textBaseline:H,translation:[E,k],backdrop:ae}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:r}=this.options;if(-ja(this.labelRotation))return t==="top"?"left":"right";let i="center";return r.align==="start"?i="left":r.align==="end"?i="right":r.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:r,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,a=this._getLabelSizes(),o=t+s,l=a.widest.width;let c,u;return r==="left"?i?(u=this.right+s,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-o,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u=this.left)):r==="right"?i?(u=this.left+s,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+o,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:r},left:n,top:i,width:s,height:a}=this;r&&(t.save(),t.fillStyle=r,t.fillRect(n,i,s,a),t.restore())}getLineWidthForValue(t){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const i=this.ticks.findIndex(s=>s.value===t);return i>=0?r.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const r=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,a;const o=(l,c,u)=>{!u.width||!u.color||(n.save(),n.lineWidth=u.width,n.strokeStyle=u.color,n.setLineDash(u.borderDash||[]),n.lineDashOffset=u.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(r.display)for(s=0,a=i.length;s<a;++s){const l=i[s];r.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),r.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:r,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),a=n.display?s.width:0;if(!a)return;const o=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,f;this.isHorizontal()?(c=Ea(t,this.left,a)-a/2,u=Ea(t,this.right,o)+o/2,d=f=l):(d=Ea(t,this.top,a)-a/2,f=Ea(t,this.bottom,o)+o/2,c=u=l),r.save(),r.lineWidth=s.width,r.strokeStyle=s.color,r.beginPath(),r.moveTo(c,d),r.lineTo(u,f),r.stroke(),r.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&kx(n,i);const s=this.getLabelItems(t);for(const a of s){const o=a.options,l=a.font,c=a.label,u=a.textOffset;qu(n,c,0,u,l,o)}i&&Cx(n)}drawTitle(){const{ctx:t,options:{position:r,title:n,reverse:i}}=this;if(!n.display)return;const s=yr(n.font),a=In(n.padding),o=n.align;let l=s.lineHeight/2;r==="bottom"||r==="center"||Ke(r)?(l+=a.bottom,Vt(n.text)&&(l+=s.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:c,titleY:u,maxWidth:d,rotation:f}=YB(this,l,r,o);qu(t,n.text,0,0,s,{color:n.color,maxWidth:d,rotation:f,textAlign:XB(o,r,i),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,r=t.ticks&&t.ticks.z||0,n=je(t.grid&&t.grid.z,-1),i=je(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==dc.prototype.draw?[{z:r,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:r,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,a;for(s=0,a=r.length;s<a;++s){const o=r[s];o[n]===this.id&&(!t||o.type===t)&&i.push(o)}return i}_resolveTickFontOptions(t){const r=this.options.ticks.setContext(this.getContext(t));return yr(r.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Sf{constructor(t,r,n){this.type=t,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const r=Object.getPrototypeOf(t);let n;ZB(r)&&(n=this.register(r));const i=this.items,s=t.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in i||(i[s]=t,QB(t,a,n),this.override&&Pt.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const r=this.items,n=t.id,i=this.scope;n in r&&delete r[n],i&&n in Pt[i]&&(delete Pt[i][n],this.override&&delete mo[n])}}function QB(e,t,r){const n=Hu(Object.create(null),[r?Pt.get(r):{},Pt.get(t),e.defaults]);Pt.set(t,n),e.defaultRoutes&&JB(t,e.defaultRoutes),e.descriptors&&Pt.describe(t,e.descriptors)}function JB(e,t){Object.keys(t).forEach(r=>{const n=r.split("."),i=n.pop(),s=[e].concat(n).join("."),a=t[r].split("."),o=a.pop(),l=a.join(".");Pt.route(s,i,l,o)})}function ZB(e){return"id"in e&&"defaults"in e}class eU{constructor(){this.controllers=new Sf(xl,"datasets",!0),this.elements=new Sf(ha,"elements"),this.plugins=new Sf(Object,"plugins"),this.scales=new Sf(dc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,r,n){[...r].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(t,s,i):Ye(i,a=>{const o=n||this._getRegistryForType(a);this._exec(t,o,a)})})}_exec(t,r,n){const i=_x(t);ot(n["before"+i],[],n),r[t](n),ot(n["after"+i],[],n)}_getRegistryForType(t){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(t))return n}return this.plugins}_get(t,r,n){const i=r.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return i}}var pi=new eU;class tU{constructor(){this._init=void 0}notify(t,r,n,i){if(r==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const s=i?this._descriptors(t).filter(i):this._descriptors(t),a=this._notify(s,t,r,n);return r==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),a}_notify(t,r,n,i){i=i||{};for(const s of t){const a=s.plugin,o=a[n],l=[r,i,s.options];if(ot(o,l,a)===!1&&i.cancelable)return!1}return!0}invalidate(){qe(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),r}_createDescriptors(t,r){const n=t&&t.config,i=je(n.options&&n.options.plugins,{}),s=rU(n);return i===!1&&!r?[]:iU(t,s,i,r)}_notifyStateChanges(t){const r=this._oldCache||[],n=this._cache,i=(s,a)=>s.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(i(r,n),t,"stop"),this._notify(i(n,r),t,"start")}}function rU(e){const t={},r=[],n=Object.keys(pi.plugins.items);for(let s=0;s<n.length;s++)r.push(pi.getPlugin(n[s]));const i=e.plugins||[];for(let s=0;s<i.length;s++){const a=i[s];r.indexOf(a)===-1&&(r.push(a),t[a.id]=!0)}return{plugins:r,localIds:t}}function nU(e,t){return!t&&e===!1?null:e===!0?{}:e}function iU(e,{plugins:t,localIds:r},n,i){const s=[],a=e.getContext();for(const o of t){const l=o.id,c=nU(n[l],i);c!==null&&s.push({plugin:o,options:sU(e.config,{plugin:o,local:r[l]},c,a)})}return s}function sU(e,{plugin:t,local:r},n,i){const s=e.pluginScopeKeys(t),a=e.getOptionScopes(n,s);return r&&t.defaults&&a.push(t.defaults),e.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function mv(e,t){const r=Pt.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function aU(e,t){let r=e;return e==="_index_"?r=t:e==="_value_"&&(r=t==="x"?"y":"x"),r}function oU(e,t){return e===t?"_index_":"_value_"}function Lb(e){if(e==="x"||e==="y"||e==="r")return e}function lU(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function gv(e,...t){if(Lb(e))return e;for(const r of t){const n=r.axis||lU(r.position)||e.length>1&&Lb(e[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function zb(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function cU(e,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(n=>n.xAxisID===e||n.yAxisID===e);if(r.length)return zb(e,"x",r[0])||zb(e,"y",r[0])}return{}}function uU(e,t){const r=mo[e.type]||{scales:{}},n=t.scales||{},i=mv(e.type,t),s=Object.create(null);return Object.keys(n).forEach(a=>{const o=n[a];if(!Ke(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=gv(a,o,cU(a,e),Pt.scales[o.type]),c=oU(l,i),u=r.scales||{};s[a]=ou(Object.create(null),[{axis:l},o,u[l],u[c]])}),e.data.datasets.forEach(a=>{const o=a.type||e.type,l=a.indexAxis||mv(o,t),u=(mo[o]||{}).scales||{};Object.keys(u).forEach(d=>{const f=aU(d,l),p=a[f+"AxisID"]||f;s[p]=s[p]||Object.create(null),ou(s[p],[{axis:f},n[p],u[d]])})}),Object.keys(s).forEach(a=>{const o=s[a];ou(o,[Pt.scales[o.type],Pt.scale])}),s}function nR(e){const t=e.options||(e.options={});t.plugins=je(t.plugins,{}),t.scales=uU(e,t)}function iR(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function dU(e){return e=e||{},e.data=iR(e.data),nR(e),e}const jb=new Map,sR=new Set;function Ef(e,t){let r=jb.get(e);return r||(r=t(),jb.set(e,r),sR.add(r)),r}const Dc=(e,t,r)=>{const n=Gl(t,r);n!==void 0&&e.add(n)};class fU{constructor(t){this._config=dU(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=iR(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),nR(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Ef(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,r){return Ef(`${t}.transition.${r}`,()=>[[`datasets.${t}.transitions.${r}`,`transitions.${r}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,r){return Ef(`${t}-${r}`,()=>[[`datasets.${t}.elements.${r}`,`datasets.${t}`,`elements.${r}`,""]])}pluginScopeKeys(t){const r=t.id,n=this.type;return Ef(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,r){const n=this._scopeCache;let i=n.get(t);return(!i||r)&&(i=new Map,n.set(t,i)),i}getOptionScopes(t,r,n){const{options:i,type:s}=this,a=this._cachedScopes(t,n),o=a.get(r);if(o)return o;const l=new Set;r.forEach(u=>{t&&(l.add(t),u.forEach(d=>Dc(l,t,d))),u.forEach(d=>Dc(l,i,d)),u.forEach(d=>Dc(l,mo[s]||{},d)),u.forEach(d=>Dc(l,Pt,d)),u.forEach(d=>Dc(l,hv,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),sR.has(r)&&a.set(r,c),c}chartOptionScopes(){const{options:t,type:r}=this;return[t,mo[r]||{},Pt.datasets[r]||{},{type:r},Pt,hv]}resolveNamedOptions(t,r,n,i=[""]){const s={$shared:!0},{resolver:a,subPrefixes:o}=Bb(this._resolverCache,t,i);let l=a;if(pU(a,r)){s.$shared=!1,n=ia(n)?n():n;const c=this.createResolver(t,n,o);l=Kl(a,n,c)}for(const c of r)s[c]=l[c];return s}createResolver(t,r,n=[""],i){const{resolver:s}=Bb(this._resolverCache,t,n);return Ke(r)?Kl(s,r,void 0,i):s}}function Bb(e,t,r){let n=e.get(t);n||(n=new Map,e.set(t,n));const i=r.join();let s=n.get(i);return s||(s={resolver:Ax(t,r),subPrefixes:r.filter(o=>!o.toLowerCase().includes("hover"))},n.set(i,s)),s}const hU=e=>Ke(e)&&Object.getOwnPropertyNames(e).some(t=>ia(e[t]));function pU(e,t){const{isScriptable:r,isIndexable:n}=U4(e);for(const i of t){const s=r(i),a=n(i),o=(a||s)&&e[i];if(s&&(ia(o)||hU(o))||a&&Vt(o))return!0}return!1}var mU="4.5.1";const gU=["top","bottom","left","right","chartArea"];function Ub(e,t){return e==="top"||e==="bottom"||gU.indexOf(e)===-1&&t==="x"}function $b(e,t){return function(r,n){return r[e]===n[e]?r[t]-n[t]:r[e]-n[e]}}function Vb(e){const t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),ot(r&&r.onComplete,[e],t)}function vU(e){const t=e.chart,r=t.options.animation;ot(r&&r.onProgress,[e],t)}function aR(e){return Ox()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const sh={},Hb=e=>{const t=aR(e);return Object.values(sh).filter(r=>r.canvas===t).pop()};function xU(e,t,r){const n=Object.keys(e);for(const i of n){const s=+i;if(s>=t){const a=e[i];delete e[i],(r>0||s>t)&&(e[s+r]=a)}}}function yU(e,t,r,n){return!r||e.type==="mouseout"?null:n?t:e}var hs;let Q0=(hs=class{static register(...t){pi.add(...t),Wb()}static unregister(...t){pi.remove(...t),Wb()}constructor(t,r){const n=this.config=new fU(r),i=aR(t),s=Hb(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||LB(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,u=l&&l.width;if(this.id=m9(),this.ctx=o,this.canvas=l,this.width=u,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new tU,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=F9(d=>this.update(d),a.resizeDelay||0),this._dataChanges=[],sh[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Li.listen(this,"complete",Vb),Li.listen(this,"progress",vU),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:r},width:n,height:i,_aspectRatio:s}=this;return qe(t)?r&&s?s:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return pi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():hb(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ub(this.canvas,this.ctx),this}stop(){return Li.stop(this),this}resize(t,r){Li.running(this)?this._resizeBeforeDraw={width:t,height:r}:this._resize(t,r)}_resize(t,r){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,t,r,s),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,hb(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),ot(n.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};Ye(r,(n,i)=>{n.id=i})}buildOrUpdateScales(){const t=this.options,r=t.scales,n=this.scales,i=Object.keys(n).reduce((a,o)=>(a[o]=!1,a),{});let s=[];r&&(s=s.concat(Object.keys(r).map(a=>{const o=r[a],l=gv(a,o),c=l==="r",u=l==="x";return{options:o,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Ye(s,a=>{const o=a.options,l=o.id,c=gv(l,o),u=je(o.type,a.dtype);(o.position===void 0||Ub(o.position,c)!==Ub(a.dposition))&&(o.position=a.dposition),i[l]=!0;let d=null;if(l in n&&n[l].type===u)d=n[l];else{const f=pi.getScale(u);d=new f({id:l,type:u,ctx:this.ctx,chart:this}),n[d.id]=d}d.init(o,t)}),Ye(i,(a,o)=>{a||delete n[o]}),Ye(n,a=>{Cn.configure(this,a,a.options),Cn.addBox(this,a)})}_updateMetasets(){const t=this._metasets,r=this.data.datasets.length,n=t.length;if(t.sort((i,s)=>i.index-s.index),n>r){for(let i=r;i<n;++i)this._destroyDatasetMeta(i);t.splice(r,n-r)}this._sortedMetasets=t.slice(0).sort($b("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:r}}=this;t.length>r.length&&delete this._stacks,t.forEach((n,i)=>{r.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],r=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=r.length;n<i;n++){const s=r[n];let a=this.getDatasetMeta(n);const o=s.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=s.indexAxis||mv(o,this.options),a.order=s.order||0,a.index=n,a.label=""+s.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const l=pi.getController(o),{datasetElementType:c,dataElementType:u}=Pt.datasets[o];Object.assign(l,{dataElementType:pi.getElement(u),datasetElementType:c&&pi.getElement(c)}),a.controller=new l(this,n),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){Ye(this.data.datasets,(t,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),f=!i&&s.indexOf(d)===-1;d.buildOrUpdateElements(f),a=Math.max(+d.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),i||Ye(s,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort($b("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Ye(this.scales,t=>{Cn.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!eb(r,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of r){const a=n==="_removeElements"?-s:s;xU(t,i,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=s=>new Set(t.filter(a=>a[0]===s).map((a,o)=>o+","+a.splice(1).join(","))),i=n(0);for(let s=1;s<r;s++)if(!eb(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Cn.update(this,this.width,this.height,t);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],Ye(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,ia(t)?t({datasetIndex:r}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,r){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(r),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Li.has(this)?this.attached&&!Li.running(this)&&Li.start(this):(this.draw(),Vb({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(t=0;t<r.length&&r[t].z<=0;++t)r[t].draw(this.chartArea);for(this._drawDatasets();t<r.length;++t)r[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const r=this._sortedMetasets,n=[];let i,s;for(i=0,s=r.length;i<s;++i){const a=r[i];(!t||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let r=t.length-1;r>=0;--r)this._drawDataset(t[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const r=this.ctx,n={meta:t,index:t.index,cancelable:!0},i=B7(this,t);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&kx(r,i),t.controller.draw(),i&&Cx(r),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return Ku(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,r,n,i){const s=gB.modes[r];return typeof s=="function"?s(this,t,n,i):[]}getDatasetMeta(t){const r=this.data.datasets[t],n=this._metasets;let i=n.filter(s=>s&&s._dataset===r).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:t,_dataset:r,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=Eo(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const r=this.data.datasets[t];if(!r)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(t,r){const n=this.getDatasetMeta(t);n.hidden=!r}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,r,n){const i=n?"show":"hide",s=this.getDatasetMeta(t),a=s.controller._resolveAnimations(void 0,i);Wu(r)?(s.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),a.update(s,{visible:n}),this.update(o=>o.datasetIndex===t?i:void 0))}hide(t,r){this._updateVisibility(t,r,!1)}show(t,r){this._updateVisibility(t,r,!0)}_destroyDatasetMeta(t){const r=this._metasets[t];r&&r.controller&&r.controller._destroy(),delete this._metasets[t]}_stop(){let t,r;for(this.stop(),Li.remove(this),t=0,r=this.data.datasets.length;t<r;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:r}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),ub(t,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete sh[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,r=this.platform,n=(s,a)=>{r.addEventListener(this,s,a),t[s]=a},i=(s,a,o)=>{s.offsetX=a,s.offsetY=o,this._eventHandler(s)};Ye(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,r=this.platform,n=(l,c)=>{r.addEventListener(this,l,c),t[l]=c},i=(l,c)=>{t[l]&&(r.removeEventListener(this,l,c),delete t[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",s),n("detach",a)};a=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",o)},r.isAttached(this.canvas)?o():a()}unbindEvents(){Ye(this._listeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._listeners={},Ye(this._responsiveListeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,r,n){const i=n?"set":"remove";let s,a,o,l;for(r==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),o=0,l=t.length;o<l;++o){a=t[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const r=this._active||[],n=t.map(({datasetIndex:s,index:a})=>{const o=this.getDatasetMeta(s);if(!o)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:o.data[a],index:a}});!Gh(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(t,r,n){return this._plugins.notify(this,t,r,n)}isPluginEnabled(t){return this._plugins._cache.filter(r=>r.plugin.id===t).length===1}_updateHoverStyles(t,r,n){const i=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),a=s(r,t),o=n?t:s(t,r);a.length&&this.updateHoverStyle(a,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(t,r){const n={event:t,replay:r,cancelable:!0,inChartArea:this.isPointInArea(t)},i=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(t,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(t,r,n){const{_active:i=[],options:s}=this,a=r,o=this._getActiveElements(t,i,n,a),l=b9(t),c=yU(t,this._lastEvent,n,l);n&&(this._lastEvent=null,ot(s.onHover,[t,o,this],this),l&&ot(s.onClick,[t,o,this],this));const u=!Gh(o,i);return(u||r)&&(this._active=o,this._updateHoverStyles(o,i,r)),this._lastEvent=c,u}_getActiveElements(t,r,n,i){if(t.type==="mouseout")return[];if(!n)return r;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,i)}},Pe(hs,"defaults",Pt),Pe(hs,"instances",sh),Pe(hs,"overrides",mo),Pe(hs,"registry",pi),Pe(hs,"version",mU),Pe(hs,"getChart",Hb),hs);function Wb(){return Ye(Q0.instances,e=>e._plugins.invalidate())}function oR(e,t,r=t){e.lineCap=je(r.borderCapStyle,t.borderCapStyle),e.setLineDash(je(r.borderDash,t.borderDash)),e.lineDashOffset=je(r.borderDashOffset,t.borderDashOffset),e.lineJoin=je(r.borderJoinStyle,t.borderJoinStyle),e.lineWidth=je(r.borderWidth,t.borderWidth),e.strokeStyle=je(r.borderColor,t.borderColor)}function wU(e,t,r){e.lineTo(r.x,r.y)}function bU(e){return e.stepped?q9:e.tension||e.cubicInterpolationMode==="monotone"?X9:wU}function lR(e,t,r={}){const n=e.length,{start:i=0,end:s=n-1}=r,{start:a,end:o}=t,l=Math.max(i,a),c=Math.min(s,o),u=i<a&&s<a||i>o&&s>o;return{count:n,start:l,loop:t.loop,ilen:c<l&&!u?n+c-l:c-l}}function _U(e,t,r,n){const{points:i,options:s}=t,{count:a,start:o,loop:l,ilen:c}=lR(i,r,n),u=bU(s);let{move:d=!0,reverse:f}=n||{},p,m,h;for(p=0;p<=c;++p)m=i[(o+(f?c-p:p))%a],!m.skip&&(d?(e.moveTo(m.x,m.y),d=!1):u(e,h,m,f,s.stepped),h=m);return l&&(m=i[(o+(f?c:0))%a],u(e,h,m,f,s.stepped)),!!l}function SU(e,t,r,n){const i=t.points,{count:s,start:a,ilen:o}=lR(i,r,n),{move:l=!0,reverse:c}=n||{};let u=0,d=0,f,p,m,h,g,v;const w=b=>(a+(c?o-b:b))%s,y=()=>{h!==g&&(e.lineTo(u,g),e.lineTo(u,h),e.lineTo(u,v))};for(l&&(p=i[w(0)],e.moveTo(p.x,p.y)),f=0;f<=o;++f){if(p=i[w(f)],p.skip)continue;const b=p.x,E=p.y,k=b|0;k===m?(E<h?h=E:E>g&&(g=E),u=(d*u+b)/++d):(y(),e.lineTo(b,E),m=k,d=0,h=g=E),v=E}y()}function vv(e){const t=e.options,r=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!r?SU:_U}function EU(e){return e.stepped?C7:e.tension||e.cubicInterpolationMode==="monotone"?A7:Pa}function TU(e,t,r,n){let i=t._path;i||(i=t._path=new Path2D,t.path(i,r,n)&&i.closePath()),oR(e,t.options),e.stroke(i)}function kU(e,t,r,n){const{segments:i,options:s}=t,a=vv(t);for(const o of i)oR(e,s,o.style),e.beginPath(),a(e,t,o,{start:r,end:r+n-1})&&e.closePath(),e.stroke()}const CU=typeof Path2D=="function";function AU(e,t,r,n){CU&&!t.options.segment?TU(e,t,r,n):kU(e,t,r,n)}class $c extends ha{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,r){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;y7(this._points,n,t,i,r),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=M7(this,this.options.segment))}first(){const t=this.segments,r=this.points;return t.length&&r[t[0].start]}last(){const t=this.segments,r=this.points,n=t.length;return n&&r[t[n-1].end]}interpolate(t,r){const n=this.options,i=t[r],s=this.points,a=D7(this,{property:r,start:i,end:i});if(!a.length)return;const o=[],l=EU(n);let c,u;for(c=0,u=a.length;c<u;++c){const{start:d,end:f}=a[c],p=s[d],m=s[f];if(p===m){o.push(p);continue}const h=Math.abs((i-p[r])/(m[r]-p[r])),g=l(p,m,h,n.stepped);g[r]=t[r],o.push(g)}return o.length===1?o[0]:o}pathSegment(t,r,n){return vv(this)(t,this,r,n)}path(t,r,n){const i=this.segments,s=vv(this);let a=this._loop;r=r||0,n=n||this.points.length-r;for(const o of i)a&=s(t,this,o,{start:r,end:r+n-1});return!!a}draw(t,r,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),AU(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Pe($c,"id","line"),Pe($c,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Pe($c,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Pe($c,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function Gb(e,t,r,n){const i=e.options,{[r]:s}=e.getProps([r],n);return Math.abs(t-s)<i.radius+i.hitRadius}class ah extends ha{constructor(r){super();Pe(this,"parsed");Pe(this,"skip");Pe(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,r&&Object.assign(this,r)}inRange(r,n,i){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],i);return Math.pow(r-a,2)+Math.pow(n-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(r,n){return Gb(this,r,"x",n)}inYRange(r,n){return Gb(this,r,"y",n)}getCenterPoint(r){const{x:n,y:i}=this.getProps(["x","y"],r);return{x:n,y:i}}size(r){r=r||this.options||{};let n=r.radius||0;n=Math.max(n,n&&r.hoverRadius||0);const i=n&&r.borderWidth||0;return(n+i)*2}draw(r,n){const i=this.options;this.skip||i.radius<.1||!Ku(this,n,this.size(i)/2)||(r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.fillStyle=i.backgroundColor,pv(r,i,this.x,this.y))}getRange(){const r=this.options||{};return r.radius+r.hitRadius}}Pe(ah,"id","point"),Pe(ah,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Pe(ah,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function cR(e,t){const{x:r,y:n,base:i,width:s,height:a}=e.getProps(["x","y","base","width","height"],t);let o,l,c,u,d;return e.horizontal?(d=a/2,o=Math.min(r,i),l=Math.max(r,i),c=n-d,u=n+d):(d=s/2,o=r-d,l=r+d,c=Math.min(n,i),u=Math.max(n,i)),{left:o,top:c,right:l,bottom:u}}function zs(e,t,r,n){return e?0:sn(t,r,n)}function RU(e,t,r){const n=e.options.borderWidth,i=e.borderSkipped,s=B4(n);return{t:zs(i.top,s.top,0,r),r:zs(i.right,s.right,0,t),b:zs(i.bottom,s.bottom,0,r),l:zs(i.left,s.left,0,t)}}function PU(e,t,r){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),i=e.options.borderRadius,s=gl(i),a=Math.min(t,r),o=e.borderSkipped,l=n||Ke(i);return{topLeft:zs(!l||o.top||o.left,s.topLeft,0,a),topRight:zs(!l||o.top||o.right,s.topRight,0,a),bottomLeft:zs(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:zs(!l||o.bottom||o.right,s.bottomRight,0,a)}}function OU(e){const t=cR(e),r=t.right-t.left,n=t.bottom-t.top,i=RU(e,r/2,n/2),s=PU(e,r/2,n/2);return{outer:{x:t.left,y:t.top,w:r,h:n,radius:s},inner:{x:t.left+i.l,y:t.top+i.t,w:r-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function wm(e,t,r,n){const i=t===null,s=r===null,o=e&&!(i&&s)&&cR(e,n);return o&&(i||Ba(t,o.left,o.right))&&(s||Ba(r,o.top,o.bottom))}function IU(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function DU(e,t){e.rect(t.x,t.y,t.w,t.h)}function bm(e,t,r={}){const n=e.x!==r.x?-t:0,i=e.y!==r.y?-t:0,s=(e.x+e.w!==r.x+r.w?t:0)-n,a=(e.y+e.h!==r.y+r.h?t:0)-i;return{x:e.x+n,y:e.y+i,w:e.w+s,h:e.h+a,radius:e.radius}}class oh extends ha{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:r,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:a}=OU(this),o=IU(a.radius)?Xh:DU;t.save(),(a.w!==s.w||a.h!==s.h)&&(t.beginPath(),o(t,bm(a,r,s)),t.clip(),o(t,bm(s,-r,a)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),o(t,bm(s,r)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,r,n){return wm(this,t,r,n)}inXRange(t,r){return wm(this,t,null,r)}inYRange(t,r){return wm(this,null,t,r)}getCenterPoint(t){const{x:r,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(r+i)/2:r,y:s?n:(n+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Pe(oh,"id","bar"),Pe(oh,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Pe(oh,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Kb=(e,t)=>{let{boxHeight:r=t,boxWidth:n=t}=e;return e.usePointStyle&&(r=Math.min(r,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(t,r)}},NU=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class qb extends ha{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r,n){this.maxWidth=t,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let r=ot(t.generateLabels,[this.chart],this)||[];t.filter&&(r=r.filter(n=>t.filter(n,this.chart.data))),t.sort&&(r=r.sort((n,i)=>t.sort(n,i,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:t,ctx:r}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,i=yr(n.font),s=i.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=Kb(n,s);let c,u;r.font=i.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(a,s,o,l)+10):(u=this.maxHeight,c=this._fitCols(a,i,o,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,r,n,i){const{ctx:s,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=i+o;let d=t;s.textAlign="left",s.textBaseline="middle";let f=-1,p=-u;return this.legendItems.forEach((m,h)=>{const g=n+r/2+s.measureText(m.text).width;(h===0||c[c.length-1]+g+2*o>a)&&(d+=u,c[c.length-(h>0?0:1)]=0,p+=u,f++),l[h]={left:0,top:p,row:f,width:g,height:i},c[c.length-1]+=g+o}),d}_fitCols(t,r,n,i){const{ctx:s,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=a-t;let d=o,f=0,p=0,m=0,h=0;return this.legendItems.forEach((g,v)=>{const{itemWidth:w,itemHeight:y}=FU(n,r,s,g,i);v>0&&p+y+2*o>u&&(d+=f+o,c.push({width:f,height:p}),m+=f+o,h++,f=p=0),l[v]={left:m,top:p,col:h,width:w,height:y},f=Math.max(f,w),p+=y+o}),d+=f,c.push({width:f,height:p}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:i},rtl:s}}=this,a=vl(s,this.left,this.width);if(this.isHorizontal()){let o=0,l=mr(n,this.left+i,this.right-this.lineWidths[o]);for(const c of r)o!==c.row&&(o=c.row,l=mr(n,this.left+i,this.right-this.lineWidths[o])),c.top+=this.top+t+i,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+i}else{let o=0,l=mr(n,this.top+t+i,this.bottom-this.columnSizes[o].height);for(const c of r)c.col!==o&&(o=c.col,l=mr(n,this.top+t+i,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+i,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;kx(t,this),this._draw(),Cx(t)}}_draw(){const{options:t,columnSizes:r,lineWidths:n,ctx:i}=this,{align:s,labels:a}=t,o=Pt.color,l=vl(t.rtl,this.left,this.width),c=yr(a.font),{padding:u}=a,d=c.size,f=d/2;let p;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:m,boxHeight:h,itemHeight:g}=Kb(a,d),v=function(k,S,C){if(isNaN(m)||m<=0||isNaN(h)||h<0)return;i.save();const T=je(C.lineWidth,1);if(i.fillStyle=je(C.fillStyle,o),i.lineCap=je(C.lineCap,"butt"),i.lineDashOffset=je(C.lineDashOffset,0),i.lineJoin=je(C.lineJoin,"miter"),i.lineWidth=T,i.strokeStyle=je(C.strokeStyle,o),i.setLineDash(je(C.lineDash,[])),a.usePointStyle){const P={radius:h*Math.SQRT2/2,pointStyle:C.pointStyle,rotation:C.rotation,borderWidth:T},I=l.xPlus(k,m/2),R=S+f;z4(i,P,I,R,a.pointStyleWidth&&m)}else{const P=S+Math.max((d-h)/2,0),I=l.leftForLtr(k,m),R=gl(C.borderRadius);i.beginPath(),Object.values(R).some(H=>H!==0)?Xh(i,{x:I,y:P,w:m,h,radius:R}):i.rect(I,P,m,h),i.fill(),T!==0&&i.stroke()}i.restore()},w=function(k,S,C){qu(i,C.text,k,S+g/2,c,{strikethrough:C.hidden,textAlign:l.textAlign(C.textAlign)})},y=this.isHorizontal(),b=this._computeTitleHeight();y?p={x:mr(s,this.left+u,this.right-n[0]),y:this.top+u+b,line:0}:p={x:this.left+u,y:mr(s,this.top+b+u,this.bottom-r[0].height),line:0},G4(this.ctx,t.textDirection);const E=g+u;this.legendItems.forEach((k,S)=>{i.strokeStyle=k.fontColor,i.fillStyle=k.fontColor;const C=i.measureText(k.text).width,T=l.textAlign(k.textAlign||(k.textAlign=a.textAlign)),P=m+f+C;let I=p.x,R=p.y;l.setWidth(this.width),y?S>0&&I+P+u>this.right&&(R=p.y+=E,p.line++,I=p.x=mr(s,this.left+u,this.right-n[p.line])):S>0&&R+E>this.bottom&&(I=p.x=I+r[p.line].width+u,p.line++,R=p.y=mr(s,this.top+b+u,this.bottom-r[p.line].height));const H=l.x(I);if(v(H,R,k),I=M9(T,I+m+f,y?I+P:this.right,t.rtl),w(l.x(I),R,k),y)p.x+=P+u;else if(typeof k.text!="string"){const q=c.lineHeight;p.y+=uR(k,q)+u}else p.y+=E}),K4(this.ctx,t.textDirection)}drawTitle(){const t=this.options,r=t.title,n=yr(r.font),i=In(r.padding);if(!r.display)return;const s=vl(t.rtl,this.left,this.width),a=this.ctx,o=r.position,l=n.size/2,c=i.top+l;let u,d=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+c,d=mr(t.align,d,this.right-f);else{const m=this.columnSizes.reduce((h,g)=>Math.max(h,g.height),0);u=c+mr(t.align,this.top,this.bottom-m-t.labels.padding-this._computeTitleHeight())}const p=mr(o,d,d+f);a.textAlign=s.textAlign(Ex(o)),a.textBaseline="middle",a.strokeStyle=r.color,a.fillStyle=r.color,a.font=n.string,qu(a,r.text,p,u,n)}_computeTitleHeight(){const t=this.options.title,r=yr(t.font),n=In(t.padding);return t.display?r.lineHeight+n.height:0}_getLegendItemAt(t,r){let n,i,s;if(Ba(t,this.left,this.right)&&Ba(r,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],Ba(t,i.left,i.left+i.width)&&Ba(r,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(t){const r=this.options;if(!zU(t.type,r))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,s=NU(i,n);i&&!s&&ot(r.onLeave,[t,i,this],this),this._hoveredItem=n,n&&!s&&ot(r.onHover,[t,n,this],this)}else n&&ot(r.onClick,[t,n,this],this)}}function FU(e,t,r,n,i){const s=MU(n,e,t,r),a=LU(i,n,t.lineHeight);return{itemWidth:s,itemHeight:a}}function MU(e,t,r,n){let i=e.text;return i&&typeof i!="string"&&(i=i.reduce((s,a)=>s.length>a.length?s:a)),t+r.size/2+n.measureText(i).width}function LU(e,t,r){let n=e;return typeof t.text!="string"&&(n=uR(t,r)),n}function uR(e,t){const r=e.text?e.text.length:0;return t*r}function zU(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var jU={id:"legend",_element:qb,start(e,t,r){const n=e.legend=new qb({ctx:e.ctx,options:r,chart:e});Cn.configure(e,n,r),Cn.addBox(e,n)},stop(e){Cn.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,r){const n=e.legend;Cn.configure(e,n,r),n.options=r},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,r){const n=t.datasetIndex,i=r.chart;i.isDatasetVisible(n)?(i.hide(n),t.hidden=!0):(i.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:i,color:s,useBorderRadius:a,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(r?0:void 0),u=In(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:a&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class dR extends ha{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=r;const i=Vt(n.text)?n.text.length:1;this._padding=In(n.padding);const s=i*yr(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:r,left:n,bottom:i,right:s,options:a}=this,o=a.align;let l=0,c,u,d;return this.isHorizontal()?(u=mr(o,n,s),d=r+t,c=s-n):(a.position==="left"?(u=n+t,d=mr(o,i,r),l=Zt*-.5):(u=s-t,d=mr(o,r,i),l=Zt*.5),c=i-r),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const t=this.ctx,r=this.options;if(!r.display)return;const n=yr(r.font),s=n.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(s);qu(t,r.text,0,0,n,{color:r.color,maxWidth:l,rotation:c,textAlign:Ex(r.align),textBaseline:"middle",translation:[a,o]})}}function BU(e,t){const r=new dR({ctx:e.ctx,options:t,chart:e});Cn.configure(e,r,t),Cn.addBox(e,r),e.titleBlock=r}var UU={id:"title",_element:dR,start(e,t,r){BU(e,r)},stop(e){const t=e.titleBlock;Cn.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,r){const n=e.titleBlock;Cn.configure(e,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Vc={average(e){if(!e.length)return!1;let t,r,n=new Set,i=0,s=0;for(t=0,r=e.length;t<r;++t){const o=e[t].element;if(o&&o.hasValue()){const l=o.tooltipPosition();n.add(l.x),i+=l.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((o,l)=>o+l)/n.size,y:i/s}},nearest(e,t){if(!e.length)return!1;let r=t.x,n=t.y,i=Number.POSITIVE_INFINITY,s,a,o;for(s=0,a=e.length;s<a;++s){const l=e[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=fv(t,c);u<i&&(i=u,o=l)}}if(o){const l=o.tooltipPosition();r=l.x,n=l.y}return{x:r,y:n}}};function di(e,t){return t&&(Vt(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function zi(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function $U(e,t){const{element:r,datasetIndex:n,index:i}=t,s=e.getDatasetMeta(n).controller,{label:a,value:o}=s.getLabelAndValue(i);return{chart:e,label:a,parsed:s.getParsed(i),raw:e.data.datasets[n].data[i],formattedValue:o,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:r}}function Xb(e,t){const r=e.chart.ctx,{body:n,footer:i,title:s}=e,{boxWidth:a,boxHeight:o}=t,l=yr(t.bodyFont),c=yr(t.titleFont),u=yr(t.footerFont),d=s.length,f=i.length,p=n.length,m=In(t.padding);let h=m.height,g=0,v=n.reduce((b,E)=>b+E.before.length+E.lines.length+E.after.length,0);if(v+=e.beforeBody.length+e.afterBody.length,d&&(h+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),v){const b=t.displayColors?Math.max(o,l.lineHeight):l.lineHeight;h+=p*b+(v-p)*l.lineHeight+(v-1)*t.bodySpacing}f&&(h+=t.footerMarginTop+f*u.lineHeight+(f-1)*t.footerSpacing);let w=0;const y=function(b){g=Math.max(g,r.measureText(b).width+w)};return r.save(),r.font=c.string,Ye(e.title,y),r.font=l.string,Ye(e.beforeBody.concat(e.afterBody),y),w=t.displayColors?a+2+t.boxPadding:0,Ye(n,b=>{Ye(b.before,y),Ye(b.lines,y),Ye(b.after,y)}),w=0,r.font=u.string,Ye(e.footer,y),r.restore(),g+=m.width,{width:g,height:h}}function VU(e,t){const{y:r,height:n}=t;return r<n/2?"top":r>e.height-n/2?"bottom":"center"}function HU(e,t,r,n){const{x:i,width:s}=n,a=r.caretSize+r.caretPadding;if(e==="left"&&i+s+a>t.width||e==="right"&&i-s-a<0)return!0}function WU(e,t,r,n){const{x:i,width:s}=r,{width:a,chartArea:{left:o,right:l}}=e;let c="center";return n==="center"?c=i<=(o+l)/2?"left":"right":i<=s/2?c="left":i>=a-s/2&&(c="right"),HU(c,e,t,r)&&(c="center"),c}function Yb(e,t,r){const n=r.yAlign||t.yAlign||VU(e,r);return{xAlign:r.xAlign||t.xAlign||WU(e,t,r,n),yAlign:n}}function GU(e,t){let{x:r,width:n}=e;return t==="right"?r-=n:t==="center"&&(r-=n/2),r}function KU(e,t,r){let{y:n,height:i}=e;return t==="top"?n+=r:t==="bottom"?n-=i+r:n-=i/2,n}function Qb(e,t,r,n){const{caretSize:i,caretPadding:s,cornerRadius:a}=e,{xAlign:o,yAlign:l}=r,c=i+s,{topLeft:u,topRight:d,bottomLeft:f,bottomRight:p}=gl(a);let m=GU(t,o);const h=KU(t,l,c);return l==="center"?o==="left"?m+=c:o==="right"&&(m-=c):o==="left"?m-=Math.max(u,f)+i:o==="right"&&(m+=Math.max(d,p)+i),{x:sn(m,0,n.width-t.width),y:sn(h,0,n.height-t.height)}}function Tf(e,t,r){const n=In(r.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-n.right:e.x+n.left}function Jb(e){return di([],zi(e))}function qU(e,t,r){return Eo(e,{tooltip:t,tooltipItems:r,type:"tooltip"})}function Zb(e,t){const r=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return r?e.override(r):e}const fR={beforeTitle:Ni,title(e){if(e.length>0){const t=e[0],r=t.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return r[t.dataIndex]}return""},afterTitle:Ni,beforeBody:Ni,beforeLabel:Ni,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const r=e.formattedValue;return qe(r)||(t+=r),t},labelColor(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:Ni,afterBody:Ni,beforeFooter:Ni,footer:Ni,afterFooter:Ni};function jr(e,t,r,n){const i=e[t].call(r,n);return typeof i>"u"?fR[t].call(r,n):i}class xv extends ha{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const r=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&r.options.animation&&n.animations,s=new X4(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=qU(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,r){const{callbacks:n}=r,i=jr(n,"beforeTitle",this,t),s=jr(n,"title",this,t),a=jr(n,"afterTitle",this,t);let o=[];return o=di(o,zi(i)),o=di(o,zi(s)),o=di(o,zi(a)),o}getBeforeBody(t,r){return Jb(jr(r.callbacks,"beforeBody",this,t))}getBody(t,r){const{callbacks:n}=r,i=[];return Ye(t,s=>{const a={before:[],lines:[],after:[]},o=Zb(n,s);di(a.before,zi(jr(o,"beforeLabel",this,s))),di(a.lines,jr(o,"label",this,s)),di(a.after,zi(jr(o,"afterLabel",this,s))),i.push(a)}),i}getAfterBody(t,r){return Jb(jr(r.callbacks,"afterBody",this,t))}getFooter(t,r){const{callbacks:n}=r,i=jr(n,"beforeFooter",this,t),s=jr(n,"footer",this,t),a=jr(n,"afterFooter",this,t);let o=[];return o=di(o,zi(i)),o=di(o,zi(s)),o=di(o,zi(a)),o}_createItems(t){const r=this._active,n=this.chart.data,i=[],s=[],a=[];let o=[],l,c;for(l=0,c=r.length;l<c;++l)o.push($U(this.chart,r[l]));return t.filter&&(o=o.filter((u,d,f)=>t.filter(u,d,f,n))),t.itemSort&&(o=o.sort((u,d)=>t.itemSort(u,d,n))),Ye(o,u=>{const d=Zb(t.callbacks,u);i.push(jr(d,"labelColor",this,u)),s.push(jr(d,"labelPointStyle",this,u)),a.push(jr(d,"labelTextColor",this,u))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=o,o}update(t,r){const n=this.options.setContext(this.getContext()),i=this._active;let s,a=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const o=Vc[n.position].call(this,i,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const l=this._size=Xb(this,n),c=Object.assign({},o,l),u=Yb(this.chart,n,c),d=Qb(n,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(t,r,n,i){const s=this.getCaretPosition(t,n,i);r.lineTo(s.x1,s.y1),r.lineTo(s.x2,s.y2),r.lineTo(s.x3,s.y3)}getCaretPosition(t,r,n){const{xAlign:i,yAlign:s}=this,{caretSize:a,cornerRadius:o}=n,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=gl(o),{x:f,y:p}=t,{width:m,height:h}=r;let g,v,w,y,b,E;return s==="center"?(b=p+h/2,i==="left"?(g=f,v=g-a,y=b+a,E=b-a):(g=f+m,v=g+a,y=b-a,E=b+a),w=g):(i==="left"?v=f+Math.max(l,u)+a:i==="right"?v=f+m-Math.max(c,d)-a:v=this.caretX,s==="top"?(y=p,b=y-a,g=v-a,w=v+a):(y=p+h,b=y+a,g=v+a,w=v-a),E=y),{x1:g,x2:v,x3:w,y1:y,y2:b,y3:E}}drawTitle(t,r,n){const i=this.title,s=i.length;let a,o,l;if(s){const c=vl(n.rtl,this.x,this.width);for(t.x=Tf(this,n.titleAlign,n),r.textAlign=c.textAlign(n.titleAlign),r.textBaseline="middle",a=yr(n.titleFont),o=n.titleSpacing,r.fillStyle=n.titleColor,r.font=a.string,l=0;l<s;++l)r.fillText(i[l],c.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+o,l+1===s&&(t.y+=n.titleMarginBottom-o)}}_drawColorBox(t,r,n,i,s){const a=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:l,boxWidth:c}=s,u=yr(s.bodyFont),d=Tf(this,"left",s),f=i.x(d),p=l<u.lineHeight?(u.lineHeight-l)/2:0,m=r.y+p;if(s.usePointStyle){const h={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},g=i.leftForLtr(f,c)+c/2,v=m+l/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,pv(t,h,g,v),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,pv(t,h,g,v)}else{t.lineWidth=Ke(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const h=i.leftForLtr(f,c),g=i.leftForLtr(i.xPlus(f,1),c-2),v=gl(a.borderRadius);Object.values(v).some(w=>w!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,Xh(t,{x:h,y:m,w:c,h:l,radius:v}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),Xh(t,{x:g,y:m+1,w:c-2,h:l-2,radius:v}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(h,m,c,l),t.strokeRect(h,m,c,l),t.fillStyle=a.backgroundColor,t.fillRect(g,m+1,c-2,l-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,r,n){const{body:i}=this,{bodySpacing:s,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:u}=n,d=yr(n.bodyFont);let f=d.lineHeight,p=0;const m=vl(n.rtl,this.x,this.width),h=function(C){r.fillText(C,m.x(t.x+p),t.y+f/2),t.y+=f+s},g=m.textAlign(a);let v,w,y,b,E,k,S;for(r.textAlign=a,r.textBaseline="middle",r.font=d.string,t.x=Tf(this,g,n),r.fillStyle=n.bodyColor,Ye(this.beforeBody,h),p=o&&g!=="right"?a==="center"?c/2+u:c+2+u:0,b=0,k=i.length;b<k;++b){for(v=i[b],w=this.labelTextColors[b],r.fillStyle=w,Ye(v.before,h),y=v.lines,o&&y.length&&(this._drawColorBox(r,t,b,m,n),f=Math.max(d.lineHeight,l)),E=0,S=y.length;E<S;++E)h(y[E]),f=d.lineHeight;Ye(v.after,h)}p=0,f=d.lineHeight,Ye(this.afterBody,h),t.y-=s}drawFooter(t,r,n){const i=this.footer,s=i.length;let a,o;if(s){const l=vl(n.rtl,this.x,this.width);for(t.x=Tf(this,n.footerAlign,n),t.y+=n.footerMarginTop,r.textAlign=l.textAlign(n.footerAlign),r.textBaseline="middle",a=yr(n.footerFont),r.fillStyle=n.footerColor,r.font=a.string,o=0;o<s;++o)r.fillText(i[o],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+n.footerSpacing}}drawBackground(t,r,n,i){const{xAlign:s,yAlign:a}=this,{x:o,y:l}=t,{width:c,height:u}=n,{topLeft:d,topRight:f,bottomLeft:p,bottomRight:m}=gl(i.cornerRadius);r.fillStyle=i.backgroundColor,r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.beginPath(),r.moveTo(o+d,l),a==="top"&&this.drawCaret(t,r,n,i),r.lineTo(o+c-f,l),r.quadraticCurveTo(o+c,l,o+c,l+f),a==="center"&&s==="right"&&this.drawCaret(t,r,n,i),r.lineTo(o+c,l+u-m),r.quadraticCurveTo(o+c,l+u,o+c-m,l+u),a==="bottom"&&this.drawCaret(t,r,n,i),r.lineTo(o+p,l+u),r.quadraticCurveTo(o,l+u,o,l+u-p),a==="center"&&s==="left"&&this.drawCaret(t,r,n,i),r.lineTo(o,l+d),r.quadraticCurveTo(o,l,o+d,l),r.closePath(),r.fill(),i.borderWidth>0&&r.stroke()}_updateAnimationTarget(t){const r=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const a=Vc[t.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=Xb(this,t),l=Object.assign({},a,this._size),c=Yb(r,t,l),u=Qb(t,l,c,r);(i._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=In(r.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&o&&(t.save(),t.globalAlpha=n,this.drawBackground(s,t,i,r),G4(t,r.textDirection),s.y+=a.top,this.drawTitle(s,t,r),this.drawBody(s,t,r),this.drawFooter(s,t,r),K4(t,r.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,r){const n=this._active,i=t.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),s=!Gh(n,i),a=this._positionChanged(i,r);(s||a)&&(this._active=i,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],a=this._getActiveElements(t,s,r,n),o=this._positionChanged(a,t),l=r||!Gh(a,s)||o;return l&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,r))),l}_getActiveElements(t,r,n,i){const s=this.options;if(t.type==="mouseout")return[];if(!i)return r.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(t,s.mode,s,n);return s.reverse&&a.reverse(),a}_positionChanged(t,r){const{caretX:n,caretY:i,options:s}=this,a=Vc[s.position].call(this,t,r);return a!==!1&&(n!==a.x||i!==a.y)}}Pe(xv,"positioners",Vc);var XU={id:"tooltip",_element:xv,positioners:Vc,afterInit(e,t,r){r&&(e.tooltip=new xv({chart:e,options:r}))},beforeUpdate(e,t,r){e.tooltip&&e.tooltip.initialize(r)},reset(e,t,r){e.tooltip&&e.tooltip.initialize(r)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const r={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",r)}},afterEvent(e,t){if(e.tooltip){const r=t.replay;e.tooltip.handleEvent(t.event,r,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fR},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const YU=(e,t,r,n)=>(typeof t=="string"?(r=e.push(t)-1,n.unshift({index:r,label:t})):isNaN(t)&&(r=null),r);function QU(e,t,r,n){const i=e.indexOf(t);if(i===-1)return YU(e,t,r,n);const s=e.lastIndexOf(t);return i!==s?r:i}const JU=(e,t)=>e===null?null:sn(Math.round(e),0,t);function e_(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class yv extends dc{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:i,label:s}of r)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,r){if(qe(t))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===t?r:QU(n,t,je(r,t),this._addedLabels),JU(r,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),r||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,r=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=t===0&&r===s.length-1?s:s.slice(t,r+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=t;a<=r;a++)i.push({value:a});return i}getLabelForValue(t){return e_.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Pe(yv,"id","category"),Pe(yv,"defaults",{ticks:{callback:e_}});function ZU(e,t){const r=[],{bounds:i,step:s,min:a,max:o,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:f}=e,p=s||1,m=u-1,{min:h,max:g}=t,v=!qe(a),w=!qe(o),y=!qe(c),b=(g-h)/(d+1);let E=rb((g-h)/m/p)*p,k,S,C,T;if(E<1e-14&&!v&&!w)return[{value:h},{value:g}];T=Math.ceil(g/E)-Math.floor(h/E),T>m&&(E=rb(T*E/m/p)*p),qe(l)||(k=Math.pow(10,l),E=Math.ceil(E*k)/k),i==="ticks"?(S=Math.floor(h/E)*E,C=Math.ceil(g/E)*E):(S=h,C=g),v&&w&&s&&k9((o-a)/s,E/1e3)?(T=Math.round(Math.min((o-a)/E,u)),E=(o-a)/T,S=a,C=o):y?(S=v?a:S,C=w?o:C,T=c-1,E=(C-S)/T):(T=(C-S)/E,lu(T,Math.round(T),E/1e3)?T=Math.round(T):T=Math.ceil(T));const P=Math.max(nb(E),nb(S));k=Math.pow(10,qe(l)?P:l),S=Math.round(S*k)/k,C=Math.round(C*k)/k;let I=0;for(v&&(f&&S!==a?(r.push({value:a}),S<a&&I++,lu(Math.round((S+I*E)*k)/k,a,t_(a,b,e))&&I++):S<a&&I++);I<T;++I){const R=Math.round((S+I*E)*k)/k;if(w&&R>o)break;r.push({value:R})}return w&&f&&C!==o?r.length&&lu(r[r.length-1].value,o,t_(o,b,e))?r[r.length-1].value=o:r.push({value:o}):(!w||C===o)&&r.push({value:C}),r}function t_(e,t,{horizontal:r,minRotation:n}){const i=ja(n),s=(r?Math.sin(i):Math.cos(i))||.001,a=.75*t*(""+e).length;return Math.min(t/s,a)}class e$ extends dc{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,r){return qe(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const a=l=>i=r?i:l,o=l=>s=n?s:l;if(t){const l=ki(i),c=ki(s);l<0&&c<0?o(0):l>0&&c>0&&a(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);o(s+l),t||a(i-l)}this.min=i,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=t,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),r=r||11),r&&(i=Math.min(r,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,r=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},s=this._range||this,a=ZU(i,s);return t.bounds==="ticks"&&C9(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-r)/Math.max(t.length-1,1)/2;r-=i,n+=i}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(t){return F4(t,this.chart.options.locale,this.options.ticks.format)}}class wv extends e${determineDataLimits(){const{min:t,max:r}=this.getMinMax(!0);this.min=On(t)?t:0,this.max=On(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),r=t?this.width:this.height,n=ja(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,s.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Pe(wv,"id","linear"),Pe(wv,"defaults",{ticks:{callback:L4.formatters.numeric}});const J0={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Hr=Object.keys(J0);function r_(e,t){return e-t}function n_(e,t){if(qe(t))return null;const r=e._adapter,{parser:n,round:i,isoWeekday:s}=e._parseOpts;let a=t;return typeof n=="function"&&(a=n(a)),On(a)||(a=typeof n=="string"?r.parse(a,n):r.parse(a)),a===null?null:(i&&(a=i==="week"&&(Gu(s)||s===!0)?r.startOf(a,"isoWeek",s):r.startOf(a,i)),+a)}function i_(e,t,r,n){const i=Hr.length;for(let s=Hr.indexOf(e);s<i-1;++s){const a=J0[Hr[s]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((r-t)/(o*a.size))<=n)return Hr[s]}return Hr[i-1]}function t$(e,t,r,n,i){for(let s=Hr.length-1;s>=Hr.indexOf(r);s--){const a=Hr[s];if(J0[a].common&&e._adapter.diff(i,n,a)>=t-1)return a}return Hr[r?Hr.indexOf(r):0]}function r$(e){for(let t=Hr.indexOf(e)+1,r=Hr.length;t<r;++t)if(J0[Hr[t]].common)return Hr[t]}function s_(e,t,r){if(!r)e[t]=!0;else if(r.length){const{lo:n,hi:i}=Sx(r,t),s=r[n]>=t?r[n]:r[i];e[s]=!0}}function n$(e,t,r,n){const i=e._adapter,s=+i.startOf(t[0].value,n),a=t[t.length-1].value;let o,l;for(o=s;o<=a;o=+i.add(o,1,n))l=r[o],l>=0&&(t[l].major=!0);return t}function a_(e,t,r){const n=[],i={},s=t.length;let a,o;for(a=0;a<s;++a)o=t[a],i[o]=a,n.push({value:o,major:!1});return s===0||!r?n:n$(e,n,i,r)}class Jh extends dc{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,r={}){const n=t.time||(t.time={}),i=this._adapter=new dB._date(t.adapters.date);i.init(r),ou(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=r.normalized}parse(t,r){return t===void 0?null:n_(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,r=this._adapter,n=t.time.unit||"day";let{min:i,max:s,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!o&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=On(i)&&!isNaN(i)?i:+r.startOf(Date.now(),n),s=On(s)&&!isNaN(s)?s:+r.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(r=t[0],n=t[t.length-1]),{min:r,max:n}}buildTicks(){const t=this.options,r=t.time,n=t.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,a=this.max,o=D9(i,s,a);return this._unit=r.unit||(n.autoSkip?i_(r.minUnit,this.min,this.max,this._getLabelCapacity(s)):t$(this,o.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:r$(this._unit),this.initOffsets(i),t.reverse&&o.reverse(),a_(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let r=0,n=0,i,s;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?r=1-i:r=(this.getDecimalForValue(t[1])-i)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?n=s:n=(s-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;r=sn(r,0,a),n=sn(n,0,a),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const t=this._adapter,r=this.min,n=this.max,i=this.options,s=i.time,a=s.unit||i_(s.minUnit,r,n,this._getLabelCapacity(r)),o=je(i.ticks.stepSize,1),l=a==="week"?s.isoWeekday:!1,c=Gu(l)||l===!0,u={};let d=r,f,p;if(c&&(d=+t.startOf(d,"isoWeek",l)),d=+t.startOf(d,c?"day":a),t.diff(n,r,a)>1e5*o)throw new Error(r+" and "+n+" are too far apart with stepSize of "+o+" "+a);const m=i.ticks.source==="data"&&this.getDataTimestamps();for(f=d,p=0;f<n;f=+t.add(f,o,a),p++)s_(u,f,m);return(f===n||i.bounds==="ticks"||p===1)&&s_(u,f,m),Object.keys(u).sort(r_).map(h=>+h)}getLabelForValue(t){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(t,n.tooltipFormat):r.format(t,n.displayFormats.datetime)}format(t,r){const i=this.options.time.displayFormats,s=this._unit,a=r||i[s];return this._adapter.format(t,a)}_tickFormatFunction(t,r,n,i){const s=this.options,a=s.ticks.callback;if(a)return ot(a,[t,r,n],this);const o=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&o[l],d=c&&o[c],f=n[r],p=c&&d&&f&&f.major;return this._adapter.format(t,i||(p?d:u))}generateTickLabels(t){let r,n,i;for(r=0,n=t.length;r<n;++r)i=t[r],i.label=this._tickFormatFunction(i.value,r,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const r=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const r=this.options.ticks,n=this.ctx.measureText(t).width,i=ja(this.isHorizontal()?r.maxRotation:r.minRotation),s=Math.cos(i),a=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*s+o*a,h:n*a+o*s}}_getLabelCapacity(t){const r=this.options.time,n=r.displayFormats,i=n[r.unit]||n.millisecond,s=this._tickFormatFunction(t,0,a_(this,[t],this._majorUnit),i),a=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],r,n;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(r=0,n=i.length;r<n;++r)t=t.concat(i[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let r,n;if(t.length)return t;const i=this.getLabels();for(r=0,n=i.length;r<n;++r)t.push(n_(this,i[r]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return I4(t.sort(r_))}}Pe(Jh,"id","time"),Pe(Jh,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function kf(e,t,r){let n=0,i=e.length-1,s,a,o,l;r?(t>=e[n].pos&&t<=e[i].pos&&({lo:n,hi:i}=Ua(e,"pos",t)),{pos:s,time:o}=e[n],{pos:a,time:l}=e[i]):(t>=e[n].time&&t<=e[i].time&&({lo:n,hi:i}=Ua(e,"time",t)),{time:s,pos:o}=e[n],{time:a,pos:l}=e[i]);const c=a-s;return c?o+(l-o)*(t-s)/c:o}class o_ extends Jh{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(t);this._minPos=kf(r,this.min),this._tableRange=kf(r,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:r,max:n}=this,i=[],s=[];let a,o,l,c,u;for(a=0,o=t.length;a<o;++a)c=t[a],c>=r&&c<=n&&i.push(c);if(i.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(a=0,o=i.length;a<o;++a)u=i[a+1],l=i[a-1],c=i[a],Math.round((u+l)/2)!==c&&s.push({time:c,pos:a/(o-1)});return s}_generate(){const t=this.min,r=this.max;let n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(r)||n.length===1)&&n.push(r),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?t=this.normalize(r.concat(n)):t=r.length?r:n,t=this._cache.all=t,t}getDecimalForValue(t){return(kf(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return kf(this._table,n*this._tableRange+this._minPos,!0)}}Pe(o_,"id","timeseries"),Pe(o_,"defaults",Jh.defaults);const hR="label";function l_(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function i$(e,t){const r=e.options;r&&t&&Object.assign(r,t)}function pR(e,t){e.labels=t}function mR(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hR;const n=[];e.datasets=t.map(i=>{const s=e.datasets.find(a=>a[r]===i[r]);return!s||!i.data||n.includes(s)?{...i}:(n.push(s),Object.assign(s,i),s)})}function s$(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hR;const r={labels:[],datasets:[]};return pR(r,e.labels),mR(r,e.datasets,t),r}function a$(e,t){const{height:r=150,width:n=300,redraw:i=!1,datasetIdKey:s,type:a,data:o,options:l,plugins:c=[],fallbackContent:u,updateMode:d,...f}=e,p=_.useRef(null),m=_.useRef(null),h=()=>{p.current&&(m.current=new Q0(p.current,{type:a,data:s$(o,s),options:l&&{...l},plugins:c}),l_(t,m.current))},g=()=>{l_(t,null),m.current&&(m.current.destroy(),m.current=null)};return _.useEffect(()=>{!i&&m.current&&l&&i$(m.current,l)},[i,l]),_.useEffect(()=>{!i&&m.current&&pR(m.current.config.data,o.labels)},[i,o.labels]),_.useEffect(()=>{!i&&m.current&&o.datasets&&mR(m.current.config.data,o.datasets,s)},[i,o.datasets]),_.useEffect(()=>{m.current&&(i?(g(),setTimeout(h)):m.current.update(d))},[i,l,o.labels,o.datasets,d]),_.useEffect(()=>{m.current&&(g(),setTimeout(h))},[a]),_.useEffect(()=>(h(),()=>g()),[]),mi.createElement("canvas",{ref:p,role:"img",height:r,width:n,...f},u)}const o$=_.forwardRef(a$);function gR(e,t){return Q0.register(t),_.forwardRef((r,n)=>mi.createElement(o$,{...r,ref:n,type:e}))}const vR=gR("line",nh),l$=gR("bar",rh);Q0.register(yv,wv,ah,$c,oh,UU,XU,jU);function c$(){var R;const{selectedCompany:e,getDashboardData:t}=Nn(),[r,n]=_.useState(null),[i,s]=_.useState(!1);if(_.useEffect(()=>{e&&n(null)},[e==null?void 0:e.id]),_.useEffect(()=>{(async()=>{if(!e){n(null);return}s(!0);try{const q=await t(e.id);if(!q||q.length===0||!q[0]||!q[0].data){console.warn("Nessun dato dashboard trovato nel DB o struttura vuota."),n(null);return}const X=q[0].data;if(console.log("Dati grezzi ricevuti dal DB (record data):",X),X.kpis){console.log("Trovata propriet 'kpis'. Validazione...");const K=X.kpis,Q=X.monthlyTrend||{labels:[],ricavi:[],ebitda:[]},G=X.summary||[];console.log("Dati Summary (Standard) estratti:",G);const z={kpis:K,monthlyTrend:Q,summary:G,monthReference:X.month},ie=q[0].month;ie&&(z.monthReference=ie),console.log("Imposto dashboard data:",z),n(z)}else if(X.trends||X.table){console.log("Rilevata struttura alternativa (vecchio formato/Sherpa). Tento conversione...");let K={labels:[],ricavi:[],ebitda:[]};X.trends&&(X.trends.monthlyTrend?K=X.trends.monthlyTrend:X.trends.labels&&(K={labels:X.trends.labels,ricavi:X.trends.ricavi||[],ebitda:X.trends.ebitda||[]}));let Q=X.table||[];const z={kpis:X.kpis||{ricavi2025:0,ricavi2024:0,costi2025:0,costi2024:0,ebitda2025:0,ebitda2024:0,risultato2025:0,risultato2024:0,margineEbitda2025:0,margineEbitda2024:0},monthlyTrend:K,summary:Q,monthReference:X.month},ie=q[0].month;ie&&(z.monthReference=ie),console.log("Dati Sherpa42 convertiti:",z),n(z)}else console.warn("Formato dati sconosciuto:",X),n(null)}finally{s(!1)}})()},[e,t]),!e)return x.jsxs("div",{"data-testid":"page-dashboard",children:[x.jsx(Ze,{title:"Dashboard Generale",subtitle:"Analisi Bilanci al 31 Agosto 2025"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati della dashboard"})})]});if(i)return x.jsxs("div",{"data-testid":"page-dashboard",children:[x.jsx(Ze,{title:"Dashboard Generale",subtitle:"Analisi Bilanci al 31 Agosto 2025"}),x.jsxs("div",{className:"p-8 bg-muted rounded-lg text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),x.jsx("p",{className:"text-lg text-muted-foreground",children:"Caricamento dati..."})]})]});if(!r)return x.jsxs("div",{"data-testid":"page-dashboard",children:[x.jsx(Ze,{title:"Dashboard Generale",subtitle:"Analisi Bilanci al 31 Agosto 2025"}),x.jsxs("div",{className:"p-8 bg-muted rounded-lg text-center",children:[x.jsx("p",{className:"text-lg text-muted-foreground",children:"Dati non disponibili"}),x.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:e?`Azienda selezionata: ${e.name}`:"Nessuna azienda selezionata"})]})]});const a=r==null?void 0:r.monthReference,o=a?new Date(0,a-1).toLocaleString("it-IT",{month:"short"}):"",l=((R=r==null?void 0:r.monthlyTrend)==null?void 0:R.labels)||[],c=l.length>0?l[l.length-1]:"Mese Corrente",u=a?`(Gen-${o.charAt(0).toUpperCase()+o.slice(1)})`:l.length>0?`(Gen-${c})`:"",{kpis:d,monthlyTrend:f,summary:p}=r,m=p==null?void 0:p.find(H=>H.voce==="Totale Costi Diretti e Indiretti"),h={ricavi2025:(d==null?void 0:d.ricavi2025)??0,ricavi2024:(d==null?void 0:d.ricavi2024)??0,costi2025:m?m.value2025:(d==null?void 0:d.costi2025)??0,costi2024:m?m.value2024:(d==null?void 0:d.costi2024)??0,ebitda2025:(d==null?void 0:d.ebitda2025)??0,ebitda2024:(d==null?void 0:d.ebitda2024)??0,risultato2025:(d==null?void 0:d.risultato2025)??0,risultato2024:(d==null?void 0:d.risultato2024)??0,margineEbitda2025:(d==null?void 0:d.margineEbitda2025)??0,margineEbitda2024:(d==null?void 0:d.margineEbitda2024)??0},g=Yn(h.ricavi2025,h.ricavi2024),v=Yn(h.costi2025,h.costi2024),w=Yn(h.ebitda2025,h.ebitda2024),y=Yn(h.risultato2025,h.risultato2024),b=h.margineEbitda2025-h.margineEbitda2024,E=f||{labels:[],ricavi:[],ebitda:[]},k={labels:E.labels||[],datasets:[{label:"Ricavi",data:E.ricavi||[],borderColor:"#335C96",backgroundColor:"rgba(51, 92, 150, 0.1)",tension:.4},{label:"EBITDA",data:E.ebitda||[],borderColor:(E.ebitda||[]).some(H=>H<0)?"#9e005c":"#4A82BF",backgroundColor:(E.ebitda||[]).some(H=>H<0)?"rgba(158, 0, 92, 0.1)":"rgba(74, 130, 191, 0.1)",tension:.4}]},S={labels:["Ricavi","EBITDA","Risultato Esercizio"],datasets:[{label:`2024 ${u}`,data:[h.ricavi2024,h.ebitda2024,h.risultato2024],backgroundColor:"#9cbfe0"},{label:`2025 ${u}`,data:[h.ricavi2025,h.ebitda2025,h.risultato2025],backgroundColor:"#335C96"}]},C={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!1}}},T=[{key:"voce",label:"Voce",align:"left",className:"font-bold"},{key:"value2025",label:`2025 ${u}`,align:"right"},{key:"percentage",label:"% sui Ricavi",align:"right"},{key:"value2024",label:`2024 ${u}`,align:"right"},{key:"variance",label:"Var %",align:"right"}],I=(p||[]).map(H=>{const q=Yn(H.value2025,H.value2024);return{voce:H.voce,value2025:At(H.value2025),percentage:Qt(H.percentage),value2024:At(H.value2024),variance:`${q>=0?"+":""}${Qt(q,1)}`}});return e?(console.log("Dati finali tabella (TableData):",I),x.jsxs("div",{"data-testid":"page-dashboard",children:[x.jsx(Ze,{title:"Dashboard Generale",subtitle:`Analisi Bilanci ${u}`}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[x.jsx(_s,{label:"Ricavi 2025",description:"Fatturato complessivo cumulato",value:At(h.ricavi2025),change:`${g>=0?"+":""}${Qt(g,0)} vs 2024`,changeType:g>=0?"positive":"negative"}),x.jsx(_s,{label:"Costi 2025",value:At(h.costi2025),change:`${v>=0?"+":""}${Qt(v,0)} vs 2024`,changeType:v>=0?"negative":"positive",description:"Totale Costi 2025"})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[x.jsx(_s,{label:"EBITDA 2025",description:"Margine operativo lordo",value:At(h.ebitda2025),change:`${w>=0?"+":""}${Qt(w,0)} vs 2024`,changeType:w>=0?"positive":"negative"}),x.jsx(_s,{label:"Risultato esercizio 2025",description:"Utile o Perdita netta",value:At(h.risultato2025),change:`${y>=0?"+":""}${Qt(y,0)} vs 2024`,changeType:y>=0?"positive":"negative"}),x.jsx(_s,{label:"Margine EBITDA",description:"EBITDA in % sui Ricavi",value:Qt(h.margineEbitda2025),change:`${b>=0?"+":""}${Qt(b,1)} punti`,changeType:b>=0?"positive":"negative"})]}),x.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[x.jsx(cv,{title:"Trend Ricavi vs EBITDA",children:x.jsx(vR,{data:k,options:C})}),x.jsx(cv,{title:"Confronto 2024 vs 2025",children:x.jsx(l$,{data:S,options:C})})]}),x.jsx(X0,{title:"Riepilogo Economico",columns:T,data:I.map(H=>{const q=H.voce.toLowerCase().includes("totale")||H.voce.includes("COSTI"),X=["EBITDA","EBIT","Gross Profit"].some(G=>H.voce.includes(G)),K=H.voce.toLowerCase().includes("risultato")||H.voce.toLowerCase().includes("utile");let Q="";return K?Q="result":X?Q="key-metric":q&&(Q="total-dark"),{...H,className:Q}})})]})):x.jsxs("div",{"data-testid":"page-dashboard",children:[x.jsx(Ze,{title:"Dashboard Generale",subtitle:`Analisi Bilanci ${u}`}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati della dashboard"})})]})}function u$(){const{selectedCompany:e,getCEDettaglioData:t}=Nn(),[r,n]=_.useState(null),[i,s]=_.useState(!1),[a,o]=_.useState("Dic");if(_.useEffect(()=>{(async()=>{if(!e){n(null);return}s(!0);try{const h=await t(e.id);h&&h.length>0&&h[0].data?(n(h[0].data),h[0].month&&o(["","Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"][h[0].month]||"Dic")):n(null)}catch(h){console.error("Errore nel caricamento dati CE Dettaglio:",h),n(null)}finally{s(!1)}})()},[e,t]),!e)return x.jsxs("div",{"data-testid":"page-ce-dettaglio",children:[x.jsx(Ze,{title:"CE Dettaglio",subtitle:"Conto Economico Dettagliato - Analisi completa per voce"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati del conto economico dettagliato"})})]});if(i)return x.jsxs("div",{"data-testid":"page-ce-dettaglio",children:[x.jsx(Ze,{title:"CE Dettaglio",subtitle:`Conto Economico Dettagliato - Analisi completa per voce (Progressivo ${a})`}),x.jsxs("div",{className:"p-8 bg-muted rounded-lg text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),x.jsx("p",{className:"text-lg text-muted-foreground",children:"Caricamento dati..."})]})]});if(!r||!r.progressivo2025)return x.jsxs("div",{"data-testid":"page-ce-dettaglio",children:[x.jsx(Ze,{title:"CE Dettaglio",subtitle:`Conto Economico Dettagliato - Analisi completa per voce (Progressivo ${a})`}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Dati non disponibili"})})]});const{progressivo2025:l,progressivo2024:c}=r,u=[{key:"voce",label:"Voce",align:"left"},{key:"value2025",label:`2025 (${a})`,align:"right"},{key:"percentage",label:"% sui Ricavi",align:"right"},{key:"value2024",label:`2024 (${a})`,align:"right"},{key:"varianceEuro",label:"Var ",align:"right"},{key:"variance",label:"Var %",align:"right"}],d=(m,h,g,v=!1,w="")=>{const y=h/l.totaleRicavi*100,b=Yn(h,g),E=h-g;return{voce:m,value2025:At(h),percentage:Qt(y,1),value2024:At(g),varianceEuro:g===0&&h===0?"n/a":At(E),variance:g===0&&h===0?"n/a":`${b>=0?"+":""}${Qt(b,1)}`,className:w||(v?"font-bold":"")}},f={voce:"",value2025:"",percentage:"",value2024:"",varianceEuro:"",variance:""},p=[d("Ricavi caratteristici",l.ricaviCaratteristici,c.ricaviCaratteristici),d("Altri ricavi",l.altriRicavi,c.altriRicavi),d("TOTALE RICAVI",l.totaleRicavi,c.totaleRicavi,!0,"total-dark"),f,d("Servizi diretti",l.serviziDiretti,c.serviziDiretti),d("Consulenze dirette",l.consulenzeDirette,c.consulenzeDirette),d("Servizi informatici web",l.serviziInformatici,c.serviziInformatici),d("Servizi cloud",l.serviziCloud,c.serviziCloud),d("COSTI DIRETTI",l.costiDiretti,c.costiDiretti,!0,"highlight"),d("Altri servizi e prestazioni",l.altriServizi,c.altriServizi),d("COSTI INDIRETTI",l.costiIndiretti,c.costiIndiretti,!0,"highlight"),d("TOTALE COSTI DIRETTI E INDIRETTI",l.totaleCostiDirettiIndiretti,c.totaleCostiDirettiIndiretti,!0,"total-dark"),d("GROSS PROFIT",l.grossProfit,c.grossProfit,!0,"key-metric"),f,d("Autofatture",l.autofatture,c.autofatture),d("Rimborsi spese",l.rimborsiSpese,c.rimborsiSpese),d("Altri proventi",l.altriProventi,c.altriProventi),d("ALTRI RICAVI NON TIPICI",l.ricaviNonTipici,c.ricaviNonTipici,!0,"highlight"),f,d("Spese viaggio",l.speseViaggio,c.speseViaggio),d("Pedaggi autostradali",l.pedaggi,c.pedaggi),d("Pubblicit",l.pubblicita,c.pubblicita),d("Materiale pubblicitario",l.materialePubblicitario,c.materialePubblicitario),d("Omaggi",l.omaggi,c.omaggi),d("Spese di rappresentanza",l.speseRappresentanza,c.speseRappresentanza),d("Mostre e fiere",l.mostreFiere,c.mostreFiere),d("Servizi commerciali",l.serviziCommerciali,c.serviziCommerciali),d("Carburante",l.carburante,c.carburante),d("SPESE COMMERCIALI",l.speseCommerciali,c.speseCommerciali,!0,"total-dark"),f,d("Beni indeducibili",l.beniIndeducibili,c.beniIndeducibili),d("Spese generali",l.speseGenerali,c.speseGenerali),d("Materiale vario e di consumo",l.materialeConsumo,c.materialeConsumo),d("Spese di pulizia",l.spesePulizia,c.spesePulizia),d("Utenze",l.utenze,c.utenze),d("Assicurazioni",l.assicurazioni,c.assicurazioni),d("Rimanenze",l.rimanenze,c.rimanenze),d("Tasse e valori bollati",l.tasseValori,c.tasseValori),d("Sanzioni e multe",l.sanzioniMulte,c.sanzioniMulte),d("Compensi amministratore",l.compensiAmministratore,c.compensiAmministratore),d("Rimborsi amministratore",l.rimborsiAmministratore,c.rimborsiAmministratore),d("Personale",l.personale,c.personale),d("Servizi amministrativi contabilit",l.serviziAmministrativi,c.serviziAmministrativi),d("Servizi amministrativi paghe",l.serviziAmministrativiPaghe,c.serviziAmministrativiPaghe),d("Consulenze tecniche",l.consulenzeTecniche,c.consulenzeTecniche),d("Consulenze legali",l.consulenzeLegali,c.consulenzeLegali),d("Locazioni e noleggi",l.locazioniNoleggi,c.locazioniNoleggi),d("Servizi indeducibili",l.serviziIndeducibili,c.serviziIndeducibili),d("Utili e perdite su cambi",l.utiliPerditeCambi,c.utiliPerditeCambi),d("Perdite su crediti",l.perditeSuCrediti,c.perditeSuCrediti),d("Licenze d'uso",l.licenzeUso,c.licenzeUso),d("Utenze telefoniche e cellulari",l.utenzeTelefoniche,c.utenzeTelefoniche),d("Altri oneri",l.altriOneri,c.altriOneri),d("Abbuoni e arrotondamenti",l.abbuoniArrotondamenti,c.abbuoniArrotondamenti),d("SPESE DI STRUTTURA",l.speseStruttura,c.speseStruttura,!0,"total-dark"),f,d("TOTALE GESTIONE STRUTTURA",l.totaleGestioneStruttura,c.totaleGestioneStruttura,!0,"total-dark"),d("EBITDA",l.ebitda,c.ebitda,!0,"key-metric"),f,d("Ammortamenti immateriali",l.ammortamentiImmateriali,c.ammortamentiImmateriali),d("Ammortamenti materiali",l.ammortamentiMateriali,c.ammortamentiMateriali),d("Svalutazioni e accantonamenti",l.svalutazioni,c.svalutazioni),d("AMMORTAMENTI, ACCANT. SVALUTAZIONI",l.totaleAmmortamenti,c.totaleAmmortamenti,!0,"total-dark"),f,d("Gestione straordinaria",l.gestioneStraordinaria,c.gestioneStraordinaria),d("EBIT",l.ebit,c.ebit,!0,"key-metric"),f,d("Spese e commissioni bancarie",l.speseCommissioniBancarie,c.speseCommissioniBancarie),d("Interessi passivi su mutui",l.interessiPassiviMutui,c.interessiPassiviMutui),d("Altri interessi",l.altriInteressi,c.altriInteressi),d("GESTIONE FINANZIARIA",l.gestioneFinanziaria,c.gestioneFinanziaria,!0,"total-dark"),f,d("EBT (Risultato ante imposte)",l.ebt,c.ebt,!0,"key-metric"),d("Imposte dirette",l.imposteDirette,c.imposteDirette),d("RISULTATO DI ESERCIZIO (UTILE / PERDITA)",l.risultatoEsercizio,c.risultatoEsercizio,!0,"result")];return e?x.jsxs("div",{"data-testid":"page-ce-dettaglio",children:[x.jsx(Ze,{title:"CE Dettaglio",subtitle:`Conto Economico Dettagliato - Analisi completa per voce (Progressivo ${a})`}),x.jsx(X0,{columns:u,data:p})]}):x.jsxs("div",{"data-testid":"page-ce-dettaglio",children:[x.jsx(Ze,{title:"CE Dettaglio",subtitle:"Conto Economico Dettagliato - Analisi completa per voce (Progressivo Ago)"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati del conto economico dettagliato"})})]})}function d$(){const{selectedCompany:e,getCEDettaglioMensileData:t}=Nn(),[r,n]=_.useState(null),[i,s]=_.useState("progressivo2025"),[a,o]=_.useState(!1);_.useEffect(()=>{(async()=>{if(!e){n(null);return}o(!0);try{const w=await t(e.id);w&&w.length>0&&w[0].data?n(w[0].data):n(null)}catch(w){console.error("Errore caricamento dati:",w),n(null)}finally{o(!1)}})()},[e,t]);const l=v=>{s(v)},c=r?r[i]:null;if(!e)return x.jsxs("div",{className:"p-8",children:[x.jsx(Ze,{title:"CE Dettaglio Mensile",subtitle:"Conto Economico Dettagliato"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center mt-6",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati."})})]});if(a)return x.jsx("div",{className:"p-8 text-center",children:"Caricamento..."});if(!r||!c)return x.jsxs("div",{className:"p-8",children:[x.jsx(Ze,{title:"CE Dettaglio Mensile",subtitle:"Dati non disponibili"}),x.jsxs("div",{className:"mt-8 text-center text-muted-foreground",children:["Nessun dato disponibile per questa vista (",i,").",x.jsx("br",{}),"Prova a importare nuovamente il file Excel aggiornato."]})]});const{months:u}=c,d={Gen:"gennaio",Feb:"febbraio",Mar:"marzo",Apr:"aprile",Mag:"maggio",Giu:"giugno",Lug:"luglio",Ago:"agosto",Set:"settembre",Ott:"ottobre",Nov:"novembre",Dic:"dicembre"},f=(v,w,y="")=>{const b=w||new Array((u==null?void 0:u.length)||0).fill(0);return{voce:v,values:b.map(E=>At(E).replace("","").trim()),className:y}},p={voce:"",values:[],className:""},m=[f("Ricavi caratteristici",c.ricaviCaratteristici),f("Altri ricavi",c.altriRicavi),f("TOTALE RICAVI",c.totaleRicavi,"total-dark"),p,f("Servizi diretti",c.serviziDiretti),f("Consulenze dirette",c.consulenzeDirette),f("Servizi informatici web",c.serviziInformatici),f("Servizi cloud",c.serviziCloud),f("COSTI DIRETTI",c.costiDiretti,"highlight"),f("Altri servizi e prestazioni",c.altriServizi),f("COSTI INDIRETTI",c.costiIndiretti,"highlight"),f("TOTALE COSTI DIRETTI E INDIRETTI",c.totaleCostiDirettiIndiretti,"total-dark"),f("GROSS PROFIT",c.grossProfit,"key-metric"),p,f("Autofatture",c.autofatture),f("Rimborsi spese",c.rimborsiSpese),f("Altri proventi",c.altriProventi),f("ALTRI RICAVI NON TIPICI",c.ricaviNonTipici,"highlight"),p,f("Spese viaggio",c.speseViaggio),f("Pedaggi autostradali",c.pedaggi),f("Pubblicit",c.pubblicita),f("Materiale pubblicitario",c.materialePubblicitario),f("Omaggi",c.omaggi),f("Spese di rappresentanza",c.speseRappresentanza),f("Mostre e fiere",c.mostreFiere),f("Servizi commerciali",c.serviziCommerciali),f("Carburante",c.carburante),f("SPESE COMMERCIALI",c.speseCommerciali,"total-dark"),p,f("Beni indeducibili",c.beniIndeducibili),f("Spese generali",c.speseGenerali),f("Materiale vario e di consumo",c.materialeConsumo),f("Spese di pulizia",c.spesePulizia),f("Utenze",c.utenze),f("Assicurazioni",c.assicurazioni),f("Rimanenze",c.rimanenze),f("Tasse e valori bollati",c.tasseValori),f("Sanzioni e multe",c.sanzioniMulte),f("Compensi amministratore",c.compensiAmministratore),f("Rimborsi amministratore",c.rimborsiAmministratore),f("Personale",c.personale),f("Servizi amministrativi contabilit",c.serviziAmministrativi),f("Servizi amministrativi paghe",c.serviziAmministrativiPaghe),f("Consulenze tecniche",c.consulenzeTecniche),f("Consulenze legali",c.consulenzeLegali),f("Locazioni e noleggi",c.locazioniNoleggi),f("Servizi indeducibili",c.serviziIndeducibili),f("Utili e perdite su cambi",c.utiliPerditeCambi),f("Perdite su crediti",c.perditeSuCrediti),f("Licenze d'uso",c.licenzeUso),f("Utenze telefoniche e cellulari",c.utenzeTelefoniche),f("Altri oneri",c.altriOneri),f("Abbuoni e arrotondamenti",c.abbuoniArrotondamenti),f("SPESE DI STRUTTURA",c.speseStruttura,"total-dark"),p,f("TOTALE GESTIONE STRUTTURA",c.totaleStruttura,"total-dark"),f("EBITDA",c.ebitda,"key-metric"),p,f("Ammortamenti immateriali",c.ammortamentiImmateriali),f("Ammortamenti materiali",c.ammortamentiMateriali),f("Svalutazioni e accantonamenti",c.svalutazioni),f("AMMORTAMENTI, ACCANT. SVALUTAZIONI",c.totaleAmmortamenti||c.ammortamenti,"total-dark"),p,f("Gestione straordinaria",c.gestioneStraordinaria),f("EBIT",c.ebit,"key-metric"),p,f("Spese e commissioni bancarie",c.speseCommissioniBancarie),f("Interessi passivi su mutui",c.interessiPassiviMutui),f("Altri interessi",c.altriInteressi),f("GESTIONE FINANZIARIA",c.gestioneFinanziaria,"total-dark"),p,f("EBT (Risultato ante imposte)",c.ebt,"key-metric"),f("Imposte dirette",c.imposteDirette),f("RISULTATO DI ESERCIZIO (UTILE / PERDITA)",c.risultato,"result")],h=v=>{switch(v){case"result":return"bg-yellow-100 dark:bg-yellow-900/40 font-bold";case"key-metric":return"bg-blue-50 dark:bg-blue-950/20 font-bold";case"total-dark":return"bg-blue-900/10 dark:bg-blue-900/30 font-bold";case"highlight":return"font-semibold";default:return"hover:bg-muted/50"}},g=v=>i===v?"bg-primary text-primary-foreground shadow":"bg-muted text-muted-foreground hover:bg-muted/80";return x.jsxs("div",{"data-testid":"page-ce-dettaglio-mensile",className:"space-y-6",children:[x.jsxs("div",{className:"bg-primary rounded-lg p-6 text-primary-foreground shadow-lg",children:[x.jsx("h1",{className:"text-2xl font-bold mb-2",children:"CE Dettaglio Mensile"}),x.jsxs("p",{className:"opacity-90",children:["Conto Economico Dettagliato - Analisi mensile ",i.replace("progressivo","Progressivo ").replace("puntuale","Puntuale "),". Clicca su un mese per vedere il dettaglio."]})]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.jsx("button",{onClick:()=>l("progressivo2025"),className:g("progressivo2025"),children:"Progressivo 2025"}),x.jsx("button",{onClick:()=>l("puntuale2025"),className:g("puntuale2025"),children:"Puntuale 2025"}),x.jsx("button",{onClick:()=>l("progressivo2024"),className:g("progressivo2024"),children:"Progressivo 2024"}),x.jsx("button",{onClick:()=>l("puntuale2024"),className:g("puntuale2024"),children:"Puntuale 2024"})]}),x.jsx(Rt,{className:"p-6 overflow-x-auto",children:x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"w-full border-collapse min-w-max","data-testid":"table-mensile",children:[x.jsx("thead",{children:x.jsxs("tr",{children:[x.jsx("th",{className:"bg-muted px-3 py-3 text-sm font-semibold text-muted-foreground border-b-2 border-border text-left sticky left-0 bg-muted z-20 shadow-[2px_0_4px_rgba(0,0,0,0.05)]",children:"Voce"}),u.map(v=>x.jsx("th",{className:"bg-muted px-3 py-3 text-sm font-semibold border-b-2 border-border text-right whitespace-nowrap",children:x.jsx(Ih,{href:`/ce-dettaglio-mensile/${d[v]}`,className:"text-primary hover:underline cursor-pointer",children:v})},v))]})}),x.jsx("tbody",{children:m.map((v,w)=>{if(v.voce==="")return x.jsx("tr",{children:x.jsx("td",{colSpan:u.length+1,className:"py-1"})},w);const y=h(v.className),b=v.className!=="";return x.jsxs("tr",{className:y,children:[x.jsx("td",{className:`px-3 py-3 text-sm border-b border-border ${b?"font-semibold":""} sticky left-0 z-20 ${y} shadow-[2px_0_4px_rgba(0,0,0,0.05)]`,children:v.voce}),v.values.map((E,k)=>x.jsxs("td",{className:"px-3 py-3 text-sm border-b border-border text-right whitespace-nowrap",children:[" ",E]},k))]},w)})})]})})})]})}const f$={gennaio:0,febbraio:1,marzo:2,aprile:3,maggio:4,giugno:5,luglio:6,agosto:7,settembre:8,ottobre:9,novembre:10,dicembre:11},h$=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];function p$(){var w;const{selectedCompany:e,getCEDettaglioMensileData:t}=Nn(),n=((w=YT().mese)==null?void 0:w.toLowerCase())||"",i=f$[n],[s,a]=_.useState(null),[o,l]=_.useState(!1);if(_.useEffect(()=>{(async()=>{if(!e){a(null);return}l(!0);try{const b=await t(e.id);b&&b.length>0&&b[0].data?a(b[0].data):a(null)}catch(b){console.error("Errore nel caricamento dati mese:",b),a(null)}finally{l(!1)}})()},[e,t]),i===void 0)return x.jsxs("div",{className:"p-8",children:[x.jsx(Ze,{title:"Mese Non Trovato",subtitle:"Data invalida"}),x.jsx(Ih,{href:"/ce-dettaglio-mensile",children:x.jsx("a",{className:"text-primary hover:underline",children:"Torna indietro"})})]});const c=h$[i];if(o)return x.jsx("div",{className:"p-8 text-center",children:"Caricamento..."});if(!e||!s)return x.jsxs("div",{className:"p-8",children:[x.jsx(Ze,{title:`Analisi ${c}`,subtitle:"Dati non disponibili"}),x.jsx("div",{className:"mt-8 text-center text-muted-foreground",children:"Nessun dato disponibile."})]});const u=s.puntuale2025,d=s.puntuale2024,f=!!d,p=(y,b)=>!y||!y[b]?0:y[b][i]||0,m=f?[{key:"voce",label:"Voce",align:"left"},{key:"valueCurrent",label:`${c} 2025`,align:"right"},{key:"percentage",label:"% Incidenza",align:"right"},{key:"valuePrevious",label:`${c} 2024`,align:"right"},{key:"varianceEuro",label:"Var ",align:"right"},{key:"variance",label:"Var %",align:"right"}]:[{key:"voce",label:"Voce",align:"left"},{key:"valueCurrent",label:`${c} 2025`,align:"right"},{key:"percentage",label:"% Incidenza",align:"right"}],h=(y,b,E=!1,k="")=>{const S=p(u,b),C=p(d,b),T=p(u,"totaleRicavi")||1,P=S/T*100,I=S-C,R=Yn(S,C),H={voce:y,valueCurrent:At(S),percentage:Qt(P,1),className:k||(E?"font-bold":"")};return f&&(H.valuePrevious=At(C),H.varianceEuro=S===0&&C===0?"n/a":At(I),H.variance=S===0&&C===0?"n/a":(R>0?"+":"")+Qt(R,1)),H},g=f?{voce:"",valueCurrent:"",percentage:"",valuePrevious:"",varianceEuro:"",variance:""}:{voce:"",valueCurrent:"",percentage:""},v=[h("Ricavi caratteristici","ricaviCaratteristici"),h("Altri ricavi","altriRicavi"),h("TOTALE RICAVI","totaleRicavi",!0,"total-dark"),g,h("Servizi diretti","serviziDiretti"),h("Consulenze dirette","consulenzeDirette"),h("Servizi informatici web","serviziInformatici"),h("Servizi cloud","serviziCloud"),h("COSTI DIRETTI","costiDiretti",!0,"highlight"),h("Altri servizi e prestazioni","altriServizi"),h("COSTI INDIRETTI","costiIndiretti",!0,"highlight"),h("TOTALE COSTI DIRETTI E INDIRETTI","totaleCostiDirettiIndiretti",!0,"total-dark"),h("GROSS PROFIT","grossProfit",!0,"key-metric"),g,h("Autofatture","autofatture"),h("Rimborsi spese","rimborsiSpese"),h("Altri proventi","altriProventi"),h("ALTRI RICAVI NON TIPICI","ricaviNonTipici",!0,"highlight"),g,h("Spese viaggio","speseViaggio"),h("Pedaggi autostradali","pedaggi"),h("Pubblicit","pubblicita"),h("Materiale pubblicitario","materialePubblicitario"),h("Omaggi","omaggi"),h("Spese di rappresentanza","speseRappresentanza"),h("Mostre e fiere","mostreFiere"),h("Servizi commerciali","serviziCommerciali"),h("Carburante","carburante"),h("SPESE COMMERCIALI","speseCommerciali",!0,"total-dark"),g,h("Beni indeducibili","beniIndeducibili"),h("Spese generali","speseGenerali"),h("Materiale vario e di consumo","materialeConsumo"),h("Spese di pulizia","spesePulizia"),h("Utenze","utenze"),h("Assicurazioni","assicurazioni"),h("Rimanenze","rimanenze"),h("Tasse e valori bollati","tasseValori"),h("Sanzioni e multe","sanzioniMulte"),h("Compensi amministratore","compensiAmministratore"),h("Rimborsi amministratore","rimborsiAmministratore"),h("Personale","personale"),h("Servizi amministrativi contabilit","serviziAmministrativi"),h("Servizi amministrativi paghe","serviziAmministrativiPaghe"),h("Consulenze tecniche","consulenzeTecniche"),h("Consulenze legali","consulenzeLegali"),h("Locazioni e noleggi","locazioniNoleggi"),h("Servizi indeducibili","serviziIndeducibili"),h("Utili e perdite su cambi","utiliPerditeCambi"),h("Perdite su crediti","perditeSuCrediti"),h("Licenze d'uso","licenzeUso"),h("Utenze telefoniche e cellulari","utenzeTelefoniche"),h("Altri oneri","altriOneri"),h("Abbuoni e arrotondamenti","abbuoniArrotondamenti"),h("SPESE DI STRUTTURA","speseStruttura",!0,"total-dark"),g,h("TOTALE GESTIONE STRUTTURA","totaleGestioneStruttura",!0,"total-dark"),h("EBITDA","ebitda",!0,"key-metric"),g,h("Ammortamenti immateriali","ammortamentiImmateriali"),h("Ammortamenti materiali","ammortamentiMateriali"),h("Svalutazioni e accantonamenti","svalutazioni"),h("AMMORTAMENTI, ACCANT. SVALUTAZIONI","totaleAmmortamenti",!0,"total-dark"),g,h("Gestione straordinaria","gestioneStraordinaria"),h("EBIT","ebit",!0,"key-metric"),g,h("Spese e commissioni bancarie","speseCommissioniBancarie"),h("Interessi passivi su mutui","interessiPassiviMutui"),h("Altri interessi","altriInteressi"),h("GESTIONE FINANZIARIA","gestioneFinanziaria",!0,"total-dark"),g,h("EBT (Risultato ante imposte)","ebt",!0,"key-metric"),h("Imposte dirette","imposteDirette"),h("RISULTATO DI ESERCIZIO (UTILE / PERDITA)","risultatoEsercizio",!0,"result")];return x.jsxs("div",{"data-testid":"page-ce-mese-specifico",children:[x.jsx("div",{className:"mb-4",children:x.jsx(Ih,{href:"/ce-dettaglio-mensile",children:x.jsxs("a",{className:"text-primary hover:underline flex items-center gap-2 text-sm",children:[x.jsx(tF,{className:"w-4 h-4"}),"Torna a CE Dettaglio Mensile"]})})}),x.jsx(Ze,{title:`Conto Economico - ${c} 2025`,subtitle:`Analisi puntuale del mese di ${c}${f?` con confronto rispetto a ${c} 2024`:""}`}),x.jsxs(Rt,{children:[x.jsx(Ja,{children:x.jsx(Za,{children:"Dettaglio Mensile"})}),x.jsx(qi,{children:x.jsx(X0,{columns:m,data:v})})]})]})}function m$(){const{selectedCompany:e,getCESinteticoData:t}=Nn(),[r,n]=_.useState(null),[i,s]=_.useState(!1),[a,o]=_.useState("Dic");if(_.useEffect(()=>{(async()=>{if(!e){n(null);return}s(!0);try{const E=await t(e.id);E&&E.length>0&&E[0].data?(n(E[0].data),E[0].month&&o(["","Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"][E[0].month]||"Dic")):n(null)}catch(E){console.error("Errore nel caricamento dati CE Sintetico:",E),n(null)}finally{s(!1)}})()},[e,t]),!e)return x.jsxs("div",{"data-testid":"page-ce-sintetico",children:[x.jsx(Ze,{title:"CE Sintetico",subtitle:"Conto Economico Sintetico - Principali aggregati economici"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati del conto economico sintetico"})})]});if(i)return x.jsxs("div",{"data-testid":"page-ce-sintetico",children:[x.jsx(Ze,{title:"CE Sintetico",subtitle:"Conto Economico Sintetico - Principali aggregati economici"}),x.jsxs("div",{className:"p-8 bg-muted rounded-lg text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),x.jsx("p",{className:"text-lg text-muted-foreground",children:"Caricamento dati..."})]})]});if(!r||!r.progressivo2025)return x.jsxs("div",{"data-testid":"page-ce-sintetico",children:[x.jsx(Ze,{title:"CE Sintetico",subtitle:"Conto Economico Sintetico - Principali aggregati economici"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Dati non disponibili"})})]});const{progressivo2025:l,progressivo2024:c}=r,u=[{key:"voce",label:"Voce",align:"left"},{key:"value2025",label:`2025 (Gen-${a})`,align:"right"},{key:"percentage",label:"% sui Ricavi",align:"right"},{key:"value2024",label:`2024 (Gen-${a})`,align:"right"},{key:"varianceEuro",label:"Var ",align:"right"},{key:"variance",label:"Var %",align:"right"}],d=(b,E,k,S=!1)=>{const C=E/l.totaleRicavi*100,T=Yn(E,k),P=E-k;return{voce:b,value2025:At(E),percentage:Qt(C,1),value2024:At(k),varianceEuro:k===0&&E===0?"n/a":At(P),variance:k===0&&E===0?"n/a":`${T>=0?"+":""}${Qt(T,1)}`}},f={voce:"",value2025:"",percentage:"",value2024:"",varianceEuro:"",variance:""},p=l.grossProfit||l.margine||l.totaleRicavi-l.costiDiretti||0,m=c.grossProfit||c.margine||c.totaleRicavi-c.costiDiretti||0,h=[d("Ricavi caratteristici",l.ricaviCaratteristici,c.ricaviCaratteristici),d("Altri ricavi",l.altriRicavi,c.altriRicavi),d("TOTALE RICAVI",l.totaleRicavi,c.totaleRicavi,!0),f,d("Servizi diretti",l.serviziDiretti,c.serviziDiretti),d("Consulenze dirette",l.consulenzeDirette,c.consulenzeDirette),d("Servizi informatici web",l.serviziInformatici,c.serviziInformatici),d("Servizi cloud",l.serviziCloud,c.serviziCloud),d("COSTI DIRETTI",l.costiDiretti,c.costiDiretti,!0),d("Altri servizi e prestazioni",l.altriServizi,c.altriServizi),d("COSTI INDIRETTI",l.costiIndiretti,c.costiIndiretti,!0),d("TOTALE COSTI DIRETTI E INDIRETTI",l.totaleCostiDirettiIndiretti,c.totaleCostiDirettiIndiretti,!0),d("MARGINE",p,m,!0),f,d("Ricavi non tipici",l.ricaviNonTipici,c.ricaviNonTipici),d("Costi commerciali",l.costiCommerciali,c.costiCommerciali),d("Personale",l.personale,c.personale),d("Compensi amministratore",l.compensiAmministratore,c.compensiAmministratore),d("Rimborsi amministratore",l.rimborsiAmministratore,c.rimborsiAmministratore),d("Servizi contabili e paghe",l.serviziContabiliPaghe,c.serviziContabiliPaghe),d("Consulenze legali",l.consulenzeLegali,c.consulenzeLegali),d("Consulenze tecniche",l.consulenzeTecniche,c.consulenzeTecniche),d("Altre spese di funzionamento",l.altreSpeseFunzionamento,c.altreSpeseFunzionamento),d("TOTALE GESTIONE STRUTTURA",l.totaleStrutturaAltreVociNonTipiche||l.totaleGestioneStruttura,c.totaleStrutturaAltreVociNonTipiche||c.totaleGestioneStruttura,!0),d("EBITDA",l.ebitda,c.ebitda,!0),f,d("Ammortamenti e svalutazioni",l.ammortamentiSvalutazioni,c.ammortamentiSvalutazioni),d("Gestione straordinaria",l.gestioneStraordinaria,c.gestioneStraordinaria),d("Gestione finanziaria",l.gestioneFinanziaria,c.gestioneFinanziaria),d("TOTALE ALTRE VOCI NON TIPICHE",l.totaleAltreVociNonTipiche,c.totaleAltreVociNonTipiche,!0),d("RISULTATO ANTE IMPOSTE",l.risultatoAnteImposte,c.risultatoAnteImposte,!0),d("Imposte",l.imposte,c.imposte),d("RISULTATO DELL'ESERCIZIO",l.risultatoEsercizio,c.risultatoEsercizio,!0)],g=Yn(p,m),v=Yn(l.ebitda,c.ebitda),w=Yn(l.risultatoEsercizio,c.risultatoEsercizio),y=p/l.totaleRicavi*100;return l.ebitda/l.totaleRicavi*100,l.risultatoEsercizio/l.totaleRicavi*100,x.jsxs("div",{"data-testid":"page-ce-sintetico",children:[x.jsx(Ze,{title:"CE Sintetico",subtitle:`Conto Economico Sintetico - Principali aggregati economici (Progressivo ${a})`}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[x.jsx(_s,{label:"Margine Lordo",value:Qt(y),change:`${g>=0?"+":""}${Qt(g,0)} vs 2024`,changeType:g>=0?"positive":"negative"}),x.jsx(_s,{label:"EBITDA",value:At(l.ebitda),change:`${v>=0?"+":""}${Qt(v,0)} vs 2024`,changeType:v>=0?"positive":"negative"}),x.jsx(_s,{label:"Risultato Esercizio",value:At(l.risultatoEsercizio),change:`${w>=0?"+":""}${Qt(w,0)} vs 2024`,changeType:w>=0?"positive":"negative"})]}),x.jsx(X0,{columns:u,data:h,totalRows:[2,8,10,11,23,29],keyMetricRows:[12,24,30],resultRow:[32]})]})}function g$(){var k,S;const{selectedCompany:e,getCESinteticoMensileData:t}=Nn(),[r,n]=_.useState(null),[i,s]=_.useState("puntuale2025"),[a,o]=_.useState(!1);_.useEffect(()=>{(async()=>{if(!e){n(null);return}o(!0);try{const T=await t(e.id);T&&T.length>0&&T[0].data?n(T[0].data):n(null)}catch(T){console.error("Errore nel caricamento dati CE Sintetico Mensile:",T),n(null)}finally{o(!1)}})()},[e,t]);const l=C=>{s(C)},c=r?r[i]:null;if(!e)return x.jsxs("div",{"data-testid":"page-ce-sintetico-mensile",className:"p-8",children:[x.jsx(Ze,{title:"CE Sintetico Mensile",subtitle:"Conto Economico Sintetico"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center mt-6",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati"})})]});if(a)return x.jsx("div",{className:"p-8 text-center",children:"Caricamento dati..."});if(!r||!c)return x.jsxs("div",{"data-testid":"page-ce-sintetico-mensile",className:"p-8",children:[x.jsx(Ze,{title:"CE Sintetico Mensile",subtitle:"Dati non disponibili"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center mt-6",children:x.jsxs("p",{className:"text-lg text-muted-foreground",children:["Nessun dato disponibile per questa vista (",i,")."]})})]});const{months:u}=c,d=(C,T,P=!1,I=!1)=>{const R=T||[];return R.length===0?{voce:C,values:[],total:"n/a",isPercentage:P,isBold:I}:{voce:C,values:P?R.map(H=>`${H.toFixed(1)}%`):R.map(H=>At(H).replace("","").trim()),total:P?"n/a":At(R[R.length-1]||0).replace("","").trim(),isPercentage:P,isBold:I}},f=c.grossProfit||[],p=c.totaleRicavi||[],m=f.map((C,T)=>{const P=p[T]||0;return P?C/P*100:0}),h=[d("Ricavi caratteristici",c.ricaviCaratteristici),d("Altri ricavi",c.altriRicavi),d("TOTALE RICAVI",c.totaleRicavi,!1,!0),{voce:"",values:[],total:"",isPercentage:!1,isBold:!1},d("Servizi diretti",c.serviziDiretti),d("Consulenze dirette",c.consulenzeDirette),d("Servizi informatici web",c.serviziInformatici),d("Servizi cloud",c.serviziCloud),d("COSTI DIRETTI",c.costiDiretti,!1,!0),d("Beni strumentali",c.beniIndeducibili),d("Spese per manutenzione",c.speseManutenzione||[]),d("Altri servizi e prestazioni",c.altriServizi),d("COSTI INDIRETTI",c.costiIndiretti,!1,!0),d("TOTALE COSTI DIRETTI E INDIRETTI",c.totaleCostiDirettiIndiretti,!1,!0),d("GROSS PROFIT",c.grossProfit,!1,!0),{voce:"",values:[],total:"",isPercentage:!1,isBold:!1},d("Ricavi non tipici",c.ricaviNonTipici),d("Costi commerciali",c.speseCommerciali),d("Personale",c.personale),d("Compensi amministratore",c.compensiAmministratore),d("Rimborsi amministratore",c.rimborsiAmministratore),d("Servizi contabili e paghe",c.serviziAmministrativi||c.serviziContabiliPaghe),d("Consulenze legali",c.consulenzeLegali),d("Consulenze tecniche",c.consulenzeTecniche),d("Altre spese di funzionamento",c.altreSpeseFunzionamento||[]),d("TOTALE STRUTTURA",c.totaleGestioneStruttura||c.totaleStruttura,!1,!0),d("EBITDA",c.ebitda,!1,!0),{voce:"",values:[],total:"",isPercentage:!1,isBold:!1},d("Ammortamenti e svalutazioni",c.totaleAmmortamenti||c.ammortamentiSvalutazioni),d("Gestione straordinaria",c.gestioneStraordinaria),d("Gestione finanziaria",c.gestioneFinanziaria),d("TOTALE ALTRE VOCI NON TIPICHE",c.totaleAltreVociNonTipiche||[],!1,!0),d("RISULTATO ANTE IMPOSTE",c.ebt||c.risultatoAnteImposte,!1,!0),d("Imposte",c.imposteDirette||c.imposte),d("RISULTATO DELL'ESERCIZIO",c.risultatoEsercizio||c.risultato,!1,!0),{voce:"",values:[],total:"",isPercentage:!1,isBold:!1},{voce:"Margine Gross Profit %",values:m.map(C=>C.toFixed(1)+"%"),total:(((k=c.grossProfit)==null?void 0:k[c.grossProfit.length-1])/((S=c.totaleRicavi)==null?void 0:S[c.totaleRicavi.length-1])*100).toFixed(1)+"%",isPercentage:!0,isBold:!0}],g=[2,8,12,13,25,31],v=[14,26,32],w=[34],y={labels:u,datasets:[{label:"Margine Gross Profit %",data:m,borderColor:"#335C96",backgroundColor:"rgba(51, 92, 150, 0.1)",tension:.4}]},b={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!1,ticks:{callback:C=>C+"%"}}}},E=C=>i===C?"bg-primary text-primary-foreground shadow px-4 py-2 text-sm font-medium rounded-md transition-colors":"bg-muted text-muted-foreground hover:bg-muted/80 px-4 py-2 text-sm font-medium rounded-md transition-colors";return x.jsxs("div",{"data-testid":"page-ce-sintetico-mensile",className:"space-y-6",children:[x.jsxs("div",{className:"bg-primary rounded-lg p-6 text-primary-foreground shadow-lg",children:[x.jsx("h1",{className:"text-2xl font-bold mb-2",children:"CE Sintetico Mensile"}),x.jsxs("p",{className:"opacity-90",children:["Conto Economico Sintetico - Analisi mensile ",i.replace("puntuale","Puntuale ")]})]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.jsx("button",{onClick:()=>l("puntuale2025"),className:E("puntuale2025"),children:"Puntuale 2025"}),x.jsx("button",{onClick:()=>l("puntuale2024"),className:E("puntuale2024"),children:"Puntuale 2024"})]}),x.jsx("div",{className:"mb-8",children:x.jsx(cv,{title:`Trend Margine Gross Profit Mensile (${i})`,children:x.jsx(vR,{data:y,options:b})})}),x.jsxs(Rt,{className:"p-6 overflow-x-auto",children:[x.jsxs("h3",{className:"text-lg font-bold mb-5",children:["Riepilogo Mensile Sintetico - ",i]}),x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"w-full border-collapse min-w-max",children:[x.jsx("thead",{children:x.jsxs("tr",{children:[x.jsx("th",{className:"bg-muted px-3 py-3 text-sm font-semibold text-muted-foreground border-b-2 border-border text-left sticky left-0 bg-muted z-20 shadow-[2px_0_4px_rgba(0,0,0,0.05)]",children:"Voce"}),u.map(C=>x.jsx("th",{className:"bg-muted px-3 py-3 text-sm font-semibold text-muted-foreground border-b-2 border-border text-right whitespace-nowrap",children:C},C)),x.jsxs("th",{className:"bg-muted px-3 py-3 text-sm font-semibold text-muted-foreground border-b-2 border-border text-right font-bold",children:[u[u.length-1]," (Finale)"]})]})}),x.jsx("tbody",{children:h.map((C,T)=>{if(C.voce==="")return x.jsx("tr",{children:x.jsx("td",{colSpan:u.length+2,className:"py-1"})},T);const P=g.includes(T),I=v.includes(T),R=w.includes(T),H=R?"bg-yellow-50 dark:bg-yellow-950/20 font-bold":I?"bg-blue-100 dark:bg-blue-900/30 font-bold":P?"bg-blue-50 dark:bg-blue-950/20 font-bold":C.isBold?"font-bold":"hover:bg-muted/50",q=R?"bg-yellow-50 dark:bg-yellow-950/20":I?"bg-blue-100 dark:bg-blue-900/30":P?"bg-blue-50 dark:bg-blue-950/20":"bg-card";return x.jsxs("tr",{className:H,children:[x.jsx("td",{className:`px-3 py-3 text-sm border-b border-border ${C.isBold?"font-semibold":""} sticky left-0 z-20 ${q} shadow-[2px_0_4px_rgba(0,0,0,0.05)]`,children:C.voce}),C.values.map((X,K)=>x.jsx("td",{className:"px-3 py-3 text-sm border-b border-border text-right whitespace-nowrap",children:C.isPercentage?X:` ${X}`},K)),x.jsx("td",{className:`px-3 py-3 text-sm border-b border-border text-right font-bold whitespace-nowrap ${R?"bg-yellow-100 dark:bg-yellow-900/30":I?"bg-blue-150 dark:bg-blue-800/40":P?"bg-blue-100 dark:bg-blue-900/30":"bg-muted/30"}`,children:C.isPercentage?C.total:` ${C.total}`})]},T)})})]})})]})]})}function xR(e){const t=_.useRef({value:e,previous:e});return _.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Nx="Checkbox",[v$,zJ]=ua(Nx),[x$,y$]=v$(Nx),yR=_.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:i,defaultChecked:s,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[f,p]=_.useState(null),m=Je(t,b=>p(b)),h=_.useRef(!1),g=f?u||!!f.closest("form"):!0,[v=!1,w]=fo({prop:i,defaultProp:s,onChange:c}),y=_.useRef(v);return _.useEffect(()=>{const b=f==null?void 0:f.form;if(b){const E=()=>w(y.current);return b.addEventListener("reset",E),()=>b.removeEventListener("reset",E)}},[f,w]),x.jsxs(x$,{scope:r,state:v,disabled:o,children:[x.jsx(Le.button,{type:"button",role:"checkbox","aria-checked":Qs(v)?"mixed":v,"aria-required":a,"data-state":_R(v),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:m,onKeyDown:Re(e.onKeyDown,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:Re(e.onClick,b=>{w(E=>Qs(E)?!0:!E),g&&(h.current=b.isPropagationStopped(),h.current||b.stopPropagation())})}),g&&x.jsx(w$,{control:f,bubbles:!h.current,name:n,value:l,checked:v,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Qs(s)?!1:s})]})});yR.displayName=Nx;var wR="CheckboxIndicator",bR=_.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...i}=e,s=y$(wR,r);return x.jsx(as,{present:n||Qs(s.state)||s.state===!0,children:x.jsx(Le.span,{"data-state":_R(s.state),"data-disabled":s.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});bR.displayName=wR;var w$=e=>{const{control:t,checked:r,bubbles:n=!0,defaultChecked:i,...s}=e,a=_.useRef(null),o=xR(r),l=mC(t);_.useEffect(()=>{const u=a.current,d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==r&&p){const m=new Event("click",{bubbles:n});u.indeterminate=Qs(r),p.call(u,Qs(r)?!1:r),u.dispatchEvent(m)}},[o,r,n]);const c=_.useRef(Qs(r)?!1:r);return x.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??c.current,...s,tabIndex:-1,ref:a,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Qs(e){return e==="indeterminate"}function _R(e){return Qs(e)?"indeterminate":e?"checked":"unchecked"}var SR=yR,b$=bR;const Fx=_.forwardRef(({className:e,...t},r)=>x.jsx(SR,{ref:r,className:_e("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:x.jsx(b$,{className:_e("flex items-center justify-center text-current"),children:x.jsx(Fh,{className:"h-4 w-4"})})}));Fx.displayName=SR.displayName;var Mx="Popover",[ER,jJ]=ua(Mx,[lc]),_d=lc(),[_$,pa]=ER(Mx),TR=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:i,onOpenChange:s,modal:a=!1}=e,o=_d(t),l=_.useRef(null),[c,u]=_.useState(!1),[d=!1,f]=fo({prop:n,defaultProp:i,onChange:s});return x.jsx(J1,{...o,children:x.jsx(_$,{scope:t,contentId:Xs(),triggerRef:l,open:d,onOpenChange:f,onOpenToggle:_.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:c,onCustomAnchorAdd:_.useCallback(()=>u(!0),[]),onCustomAnchorRemove:_.useCallback(()=>u(!1),[]),modal:a,children:r})})};TR.displayName=Mx;var kR="PopoverAnchor",S$=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,i=pa(kR,r),s=_d(r),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=i;return _.useEffect(()=>(a(),()=>o()),[a,o]),x.jsx(N0,{...s,...n,ref:t})});S$.displayName=kR;var CR="PopoverTrigger",AR=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,i=pa(CR,r),s=_d(r),a=Je(t,i.triggerRef),o=x.jsx(Le.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":DR(i.open),...n,ref:a,onClick:Re(e.onClick,i.onOpenToggle)});return i.hasCustomAnchor?o:x.jsx(N0,{asChild:!0,...s,children:o})});AR.displayName=CR;var Lx="PopoverPortal",[E$,T$]=ER(Lx,{forceMount:void 0}),RR=e=>{const{__scopePopover:t,forceMount:r,children:n,container:i}=e,s=pa(Lx,t);return x.jsx(E$,{scope:t,forceMount:r,children:x.jsx(as,{present:r||s.open,children:x.jsx(gd,{asChild:!0,container:i,children:n})})})};RR.displayName=Lx;var Xl="PopoverContent",PR=_.forwardRef((e,t)=>{const r=T$(Xl,e.__scopePopover),{forceMount:n=r.forceMount,...i}=e,s=pa(Xl,e.__scopePopover);return x.jsx(as,{present:n||s.open,children:s.modal?x.jsx(C$,{...i,ref:t}):x.jsx(A$,{...i,ref:t})})});PR.displayName=Xl;var k$=uo("PopoverContent.RemoveScroll"),C$=_.forwardRef((e,t)=>{const r=pa(Xl,e.__scopePopover),n=_.useRef(null),i=Je(t,n),s=_.useRef(!1);return _.useEffect(()=>{const a=n.current;if(a)return sx(a)},[]),x.jsx($0,{as:k$,allowPinchZoom:!0,children:x.jsx(OR,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),s.current||(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Re(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Re(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),A$=_.forwardRef((e,t)=>{const r=pa(Xl,e.__scopePopover),n=_.useRef(!1),i=_.useRef(!1);return x.jsx(OR,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((c=r.triggerRef.current)==null?void 0:c.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),OR=_.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,f=pa(Xl,r),p=_d(r);return rx(),x.jsx(j0,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:s,children:x.jsx(ic,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:x.jsx(Z1,{"data-state":DR(f.open),role:"dialog",id:f.contentId,...p,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),IR="PopoverClose",R$=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,i=pa(IR,r);return x.jsx(Le.button,{type:"button",...n,ref:t,onClick:Re(e.onClick,()=>i.onOpenChange(!1))})});R$.displayName=IR;var P$="PopoverArrow",O$=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,i=_d(r);return x.jsx(ex,{...i,...n,ref:t})});O$.displayName=P$;function DR(e){return e?"open":"closed"}var I$=TR,D$=AR,N$=RR,NR=PR;const F$=I$,M$=D$,FR=_.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},i)=>x.jsx(N$,{children:x.jsx(NR,{ref:i,align:t,sideOffset:r,className:_e("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e),...n})}));FR.displayName=NR.displayName;function c_(e,[t,r]){return Math.min(r,Math.max(t,e))}var L$=_.createContext(void 0);function z$(e){const t=_.useContext(L$);return e||t||"ltr"}var j$=[" ","Enter","ArrowUp","ArrowDown"],B$=[" ","Enter"],Sd="Select",[Z0,ep,U$]=wk(Sd),[fc,BJ]=ua(Sd,[U$,lc]),tp=lc(),[$$,ma]=fc(Sd),[V$,H$]=fc(Sd),MR=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:f,required:p,form:m}=e,h=tp(t),[g,v]=_.useState(null),[w,y]=_.useState(null),[b,E]=_.useState(!1),k=z$(c),[S=!1,C]=fo({prop:n,defaultProp:i,onChange:s}),[T,P]=fo({prop:a,defaultProp:o,onChange:l}),I=_.useRef(null),R=g?m||!!g.closest("form"):!0,[H,q]=_.useState(new Set),X=Array.from(H).map(K=>K.props.value).join(";");return x.jsx(J1,{...h,children:x.jsxs($$,{required:p,scope:t,trigger:g,onTriggerChange:v,valueNode:w,onValueNodeChange:y,valueNodeHasChildren:b,onValueNodeHasChildrenChange:E,contentId:Xs(),value:T,onValueChange:P,open:S,onOpenChange:C,dir:k,triggerPointerDownPosRef:I,disabled:f,children:[x.jsx(Z0.Provider,{scope:t,children:x.jsx(V$,{scope:e.__scopeSelect,onNativeOptionAdd:_.useCallback(K=>{q(Q=>new Set(Q).add(K))},[]),onNativeOptionRemove:_.useCallback(K=>{q(Q=>{const G=new Set(Q);return G.delete(K),G})},[]),children:r})}),R?x.jsxs(oP,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:T,onChange:K=>P(K.target.value),disabled:f,form:m,children:[T===void 0?x.jsx("option",{value:""}):null,Array.from(H)]},X):null]})})};MR.displayName=Sd;var LR="SelectTrigger",zR=_.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...i}=e,s=tp(r),a=ma(LR,r),o=a.disabled||n,l=Je(t,a.onTriggerChange),c=ep(r),u=_.useRef("touch"),[d,f,p]=lP(h=>{const g=c().filter(y=>!y.disabled),v=g.find(y=>y.value===a.value),w=cP(g,h,v);w!==void 0&&a.onValueChange(w.value)}),m=h=>{o||(a.onOpenChange(!0),p()),h&&(a.triggerPointerDownPosRef.current={x:Math.round(h.pageX),y:Math.round(h.pageY)})};return x.jsx(N0,{asChild:!0,...s,children:x.jsx(Le.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":aP(a.value)?"":void 0,...i,ref:l,onClick:Re(i.onClick,h=>{h.currentTarget.focus(),u.current!=="mouse"&&m(h)}),onPointerDown:Re(i.onPointerDown,h=>{u.current=h.pointerType;const g=h.target;g.hasPointerCapture(h.pointerId)&&g.releasePointerCapture(h.pointerId),h.button===0&&h.ctrlKey===!1&&h.pointerType==="mouse"&&(m(h),h.preventDefault())}),onKeyDown:Re(i.onKeyDown,h=>{const g=d.current!=="";!(h.ctrlKey||h.altKey||h.metaKey)&&h.key.length===1&&f(h.key),!(g&&h.key===" ")&&j$.includes(h.key)&&(m(),h.preventDefault())})})})});zR.displayName=LR;var jR="SelectValue",BR=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,children:s,placeholder:a="",...o}=e,l=ma(jR,r),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=Je(t,l.onValueNodeChange);return Sr(()=>{c(u)},[c,u]),x.jsx(Le.span,{...o,ref:d,style:{pointerEvents:"none"},children:aP(l.value)?x.jsx(x.Fragment,{children:a}):s})});BR.displayName=jR;var W$="SelectIcon",UR=_.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...i}=e;return x.jsx(Le.span,{"aria-hidden":!0,...i,ref:t,children:n||""})});UR.displayName=W$;var G$="SelectPortal",$R=e=>x.jsx(gd,{asChild:!0,...e});$R.displayName=G$;var go="SelectContent",VR=_.forwardRef((e,t)=>{const r=ma(go,e.__scopeSelect),[n,i]=_.useState();if(Sr(()=>{i(new DocumentFragment)},[]),!r.open){const s=n;return s?_o.createPortal(x.jsx(HR,{scope:e.__scopeSelect,children:x.jsx(Z0.Slot,{scope:e.__scopeSelect,children:x.jsx("div",{children:e.children})})}),s):null}return x.jsx(WR,{...e,ref:t})});VR.displayName=go;var Vn=10,[HR,ga]=fc(go),K$="SelectContentImpl",q$=uo("SelectContent.RemoveScroll"),WR=_.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:h,avoidCollisions:g,...v}=e,w=ma(go,r),[y,b]=_.useState(null),[E,k]=_.useState(null),S=Je(t,te=>b(te)),[C,T]=_.useState(null),[P,I]=_.useState(null),R=ep(r),[H,q]=_.useState(!1),X=_.useRef(!1);_.useEffect(()=>{if(y)return sx(y)},[y]),rx();const K=_.useCallback(te=>{const[oe,...le]=R().map(F=>F.ref.current),[ne]=le.slice(-1),he=document.activeElement;for(const F of te)if(F===he||(F==null||F.scrollIntoView({block:"nearest"}),F===oe&&E&&(E.scrollTop=0),F===ne&&E&&(E.scrollTop=E.scrollHeight),F==null||F.focus(),document.activeElement!==he))return},[R,E]),Q=_.useCallback(()=>K([C,y]),[K,C,y]);_.useEffect(()=>{H&&Q()},[H,Q]);const{onOpenChange:G,triggerPointerDownPosRef:z}=w;_.useEffect(()=>{if(y){let te={x:0,y:0};const oe=ne=>{var he,F;te={x:Math.abs(Math.round(ne.pageX)-(((he=z.current)==null?void 0:he.x)??0)),y:Math.abs(Math.round(ne.pageY)-(((F=z.current)==null?void 0:F.y)??0))}},le=ne=>{te.x<=10&&te.y<=10?ne.preventDefault():y.contains(ne.target)||G(!1),document.removeEventListener("pointermove",oe),z.current=null};return z.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",le,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",le,{capture:!0})}}},[y,G,z]),_.useEffect(()=>{const te=()=>G(!1);return window.addEventListener("blur",te),window.addEventListener("resize",te),()=>{window.removeEventListener("blur",te),window.removeEventListener("resize",te)}},[G]);const[ie,ae]=lP(te=>{const oe=R().filter(he=>!he.disabled),le=oe.find(he=>he.ref.current===document.activeElement),ne=cP(oe,te,le);ne&&setTimeout(()=>ne.ref.current.focus())}),D=_.useCallback((te,oe,le)=>{const ne=!X.current&&!le;(w.value!==void 0&&w.value===oe||ne)&&(T(te),ne&&(X.current=!0))},[w.value]),V=_.useCallback(()=>y==null?void 0:y.focus(),[y]),B=_.useCallback((te,oe,le)=>{const ne=!X.current&&!le;(w.value!==void 0&&w.value===oe||ne)&&I(te)},[w.value]),U=n==="popper"?bv:GR,Y=U===bv?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:h,avoidCollisions:g}:{};return x.jsx(HR,{scope:r,content:y,viewport:E,onViewportChange:k,itemRefCallback:D,selectedItem:C,onItemLeave:V,itemTextRefCallback:B,focusSelectedItem:Q,selectedItemText:P,position:n,isPositioned:H,searchRef:ie,children:x.jsx($0,{as:q$,allowPinchZoom:!0,children:x.jsx(j0,{asChild:!0,trapped:w.open,onMountAutoFocus:te=>{te.preventDefault()},onUnmountAutoFocus:Re(i,te=>{var oe;(oe=w.trigger)==null||oe.focus({preventScroll:!0}),te.preventDefault()}),children:x.jsx(ic,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:te=>te.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:x.jsx(U,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:te=>te.preventDefault(),...v,...Y,onPlaced:()=>q(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:Re(v.onKeyDown,te=>{const oe=te.ctrlKey||te.altKey||te.metaKey;if(te.key==="Tab"&&te.preventDefault(),!oe&&te.key.length===1&&ae(te.key),["ArrowUp","ArrowDown","Home","End"].includes(te.key)){let ne=R().filter(he=>!he.disabled).map(he=>he.ref.current);if(["ArrowUp","End"].includes(te.key)&&(ne=ne.slice().reverse()),["ArrowUp","ArrowDown"].includes(te.key)){const he=te.target,F=ne.indexOf(he);ne=ne.slice(F+1)}setTimeout(()=>K(ne)),te.preventDefault()}})})})})})})});WR.displayName=K$;var X$="SelectItemAlignedPosition",GR=_.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...i}=e,s=ma(go,r),a=ga(go,r),[o,l]=_.useState(null),[c,u]=_.useState(null),d=Je(t,S=>u(S)),f=ep(r),p=_.useRef(!1),m=_.useRef(!0),{viewport:h,selectedItem:g,selectedItemText:v,focusSelectedItem:w}=a,y=_.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&c&&h&&g&&v){const S=s.trigger.getBoundingClientRect(),C=c.getBoundingClientRect(),T=s.valueNode.getBoundingClientRect(),P=v.getBoundingClientRect();if(s.dir!=="rtl"){const he=P.left-C.left,F=T.left-he,Se=S.left-F,Ee=S.width+Se,Fe=Math.max(Ee,C.width),ke=window.innerWidth-Vn,fe=c_(F,[Vn,Math.max(Vn,ke-Fe)]);o.style.minWidth=Ee+"px",o.style.left=fe+"px"}else{const he=C.right-P.right,F=window.innerWidth-T.right-he,Se=window.innerWidth-S.right-F,Ee=S.width+Se,Fe=Math.max(Ee,C.width),ke=window.innerWidth-Vn,fe=c_(F,[Vn,Math.max(Vn,ke-Fe)]);o.style.minWidth=Ee+"px",o.style.right=fe+"px"}const I=f(),R=window.innerHeight-Vn*2,H=h.scrollHeight,q=window.getComputedStyle(c),X=parseInt(q.borderTopWidth,10),K=parseInt(q.paddingTop,10),Q=parseInt(q.borderBottomWidth,10),G=parseInt(q.paddingBottom,10),z=X+K+H+G+Q,ie=Math.min(g.offsetHeight*5,z),ae=window.getComputedStyle(h),D=parseInt(ae.paddingTop,10),V=parseInt(ae.paddingBottom,10),B=S.top+S.height/2-Vn,U=R-B,Y=g.offsetHeight/2,te=g.offsetTop+Y,oe=X+K+te,le=z-oe;if(oe<=B){const he=I.length>0&&g===I[I.length-1].ref.current;o.style.bottom="0px";const F=c.clientHeight-h.offsetTop-h.offsetHeight,Se=Math.max(U,Y+(he?V:0)+F+Q),Ee=oe+Se;o.style.height=Ee+"px"}else{const he=I.length>0&&g===I[0].ref.current;o.style.top="0px";const Se=Math.max(B,X+h.offsetTop+(he?D:0)+Y)+le;o.style.height=Se+"px",h.scrollTop=oe-B+h.offsetTop}o.style.margin=`${Vn}px 0`,o.style.minHeight=ie+"px",o.style.maxHeight=R+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[f,s.trigger,s.valueNode,o,c,h,g,v,s.dir,n]);Sr(()=>y(),[y]);const[b,E]=_.useState();Sr(()=>{c&&E(window.getComputedStyle(c).zIndex)},[c]);const k=_.useCallback(S=>{S&&m.current===!0&&(y(),w==null||w(),m.current=!1)},[y,w]);return x.jsx(Q$,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:x.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:b},children:x.jsx(Le.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});GR.displayName=X$;var Y$="SelectPopperPosition",bv=_.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:i=Vn,...s}=e,a=tp(r);return x.jsx(Z1,{...a,...s,ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});bv.displayName=Y$;var[Q$,zx]=fc(go,{}),_v="SelectViewport",KR=_.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...i}=e,s=ga(_v,r),a=zx(_v,r),o=Je(t,s.onViewportChange),l=_.useRef(0);return x.jsxs(x.Fragment,{children:[x.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),x.jsx(Z0.Slot,{scope:r,children:x.jsx(Le.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Re(i.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=a;if(f!=null&&f.current&&d){const p=Math.abs(l.current-u.scrollTop);if(p>0){const m=window.innerHeight-Vn*2,h=parseFloat(d.style.minHeight),g=parseFloat(d.style.height),v=Math.max(h,g);if(v<m){const w=v+p,y=Math.min(m,w),b=w-y;d.style.height=y+"px",d.style.bottom==="0px"&&(u.scrollTop=b>0?b:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});KR.displayName=_v;var qR="SelectGroup",[J$,Z$]=fc(qR),eV=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=Xs();return x.jsx(J$,{scope:r,id:i,children:x.jsx(Le.div,{role:"group","aria-labelledby":i,...n,ref:t})})});eV.displayName=qR;var XR="SelectLabel",YR=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=Z$(XR,r);return x.jsx(Le.div,{id:i.id,...n,ref:t})});YR.displayName=XR;var Zh="SelectItem",[tV,QR]=fc(Zh),JR=_.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:i=!1,textValue:s,...a}=e,o=ma(Zh,r),l=ga(Zh,r),c=o.value===n,[u,d]=_.useState(s??""),[f,p]=_.useState(!1),m=Je(t,w=>{var y;return(y=l.itemRefCallback)==null?void 0:y.call(l,w,n,i)}),h=Xs(),g=_.useRef("touch"),v=()=>{i||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return x.jsx(tV,{scope:r,value:n,disabled:i,textId:h,isSelected:c,onItemTextChange:_.useCallback(w=>{d(y=>y||((w==null?void 0:w.textContent)??"").trim())},[]),children:x.jsx(Z0.ItemSlot,{scope:r,value:n,disabled:i,textValue:u,children:x.jsx(Le.div,{role:"option","aria-labelledby":h,"data-highlighted":f?"":void 0,"aria-selected":c&&f,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:m,onFocus:Re(a.onFocus,()=>p(!0)),onBlur:Re(a.onBlur,()=>p(!1)),onClick:Re(a.onClick,()=>{g.current!=="mouse"&&v()}),onPointerUp:Re(a.onPointerUp,()=>{g.current==="mouse"&&v()}),onPointerDown:Re(a.onPointerDown,w=>{g.current=w.pointerType}),onPointerMove:Re(a.onPointerMove,w=>{var y;g.current=w.pointerType,i?(y=l.onItemLeave)==null||y.call(l):g.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Re(a.onPointerLeave,w=>{var y;w.currentTarget===document.activeElement&&((y=l.onItemLeave)==null||y.call(l))}),onKeyDown:Re(a.onKeyDown,w=>{var b;((b=l.searchRef)==null?void 0:b.current)!==""&&w.key===" "||(B$.includes(w.key)&&v(),w.key===" "&&w.preventDefault())})})})})});JR.displayName=Zh;var Hc="SelectItemText",ZR=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,...s}=e,a=ma(Hc,r),o=ga(Hc,r),l=QR(Hc,r),c=H$(Hc,r),[u,d]=_.useState(null),f=Je(t,v=>d(v),l.onItemTextChange,v=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,v,l.value,l.disabled)}),p=u==null?void 0:u.textContent,m=_.useMemo(()=>x.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:h,onNativeOptionRemove:g}=c;return Sr(()=>(h(m),()=>g(m)),[h,g,m]),x.jsxs(x.Fragment,{children:[x.jsx(Le.span,{id:l.textId,...s,ref:f}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?_o.createPortal(s.children,a.valueNode):null]})});ZR.displayName=Hc;var eP="SelectItemIndicator",tP=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return QR(eP,r).isSelected?x.jsx(Le.span,{"aria-hidden":!0,...n,ref:t}):null});tP.displayName=eP;var Sv="SelectScrollUpButton",rP=_.forwardRef((e,t)=>{const r=ga(Sv,e.__scopeSelect),n=zx(Sv,e.__scopeSelect),[i,s]=_.useState(!1),a=Je(t,n.onScrollButtonChange);return Sr(()=>{if(r.viewport&&r.isPositioned){let o=function(){const c=l.scrollTop>0;s(c)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),i?x.jsx(iP,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});rP.displayName=Sv;var Ev="SelectScrollDownButton",nP=_.forwardRef((e,t)=>{const r=ga(Ev,e.__scopeSelect),n=zx(Ev,e.__scopeSelect),[i,s]=_.useState(!1),a=Je(t,n.onScrollButtonChange);return Sr(()=>{if(r.viewport&&r.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),i?x.jsx(iP,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});nP.displayName=Ev;var iP=_.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...i}=e,s=ga("SelectScrollButton",r),a=_.useRef(null),o=ep(r),l=_.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return _.useEffect(()=>()=>l(),[l]),Sr(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),x.jsx(Le.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:Re(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(n,50))}),onPointerMove:Re(i.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),a.current===null&&(a.current=window.setInterval(n,50))}),onPointerLeave:Re(i.onPointerLeave,()=>{l()})})}),rV="SelectSeparator",sP=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return x.jsx(Le.div,{"aria-hidden":!0,...n,ref:t})});sP.displayName=rV;var Tv="SelectArrow",nV=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=tp(r),s=ma(Tv,r),a=ga(Tv,r);return s.open&&a.position==="popper"?x.jsx(ex,{...i,...n,ref:t}):null});nV.displayName=Tv;function aP(e){return e===""||e===void 0}var oP=_.forwardRef((e,t)=>{const{value:r,...n}=e,i=_.useRef(null),s=Je(t,i),a=xR(r);return _.useEffect(()=>{const o=i.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==r&&u){const d=new Event("change",{bubbles:!0});u.call(o,r),o.dispatchEvent(d)}},[a,r]),x.jsx(vd,{asChild:!0,children:x.jsx("select",{...n,ref:s,defaultValue:r})})});oP.displayName="BubbleSelect";function lP(e){const t=cn(e),r=_.useRef(""),n=_.useRef(0),i=_.useCallback(a=>{const o=r.current+a;t(o),function l(c){r.current=c,window.clearTimeout(n.current),c!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=_.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return _.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,s]}function cP(e,t,r){const i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let a=iV(e,Math.max(s,0));i.length===1&&(a=a.filter(c=>c!==r));const l=a.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==r?l:void 0}function iV(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var sV=MR,uP=zR,aV=BR,oV=UR,lV=$R,dP=VR,cV=KR,fP=YR,hP=JR,uV=ZR,dV=tP,pP=rP,mP=nP,gP=sP;const Yu=sV,Qu=aV,Yl=_.forwardRef(({className:e,children:t,...r},n)=>x.jsxs(uP,{ref:n,className:_e("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,x.jsx(oV,{asChild:!0,children:x.jsx(U1,{className:"h-4 w-4 opacity-50"})})]}));Yl.displayName=uP.displayName;const vP=_.forwardRef(({className:e,...t},r)=>x.jsx(pP,{ref:r,className:_e("flex cursor-default items-center justify-center py-1",e),...t,children:x.jsx(lF,{className:"h-4 w-4"})}));vP.displayName=pP.displayName;const xP=_.forwardRef(({className:e,...t},r)=>x.jsx(mP,{ref:r,className:_e("flex cursor-default items-center justify-center py-1",e),...t,children:x.jsx(U1,{className:"h-4 w-4"})}));xP.displayName=mP.displayName;const Ql=_.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>x.jsx(lV,{children:x.jsxs(dP,{ref:i,className:_e("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[x.jsx(vP,{}),x.jsx(cV,{className:_e("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),x.jsx(xP,{})]})}));Ql.displayName=dP.displayName;const fV=_.forwardRef(({className:e,...t},r)=>x.jsx(fP,{ref:r,className:_e("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));fV.displayName=fP.displayName;const kt=_.forwardRef(({className:e,children:t,...r},n)=>x.jsxs(hP,{ref:n,className:_e("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[x.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:x.jsx(dV,{children:x.jsx(Fh,{className:"h-4 w-4"})})}),x.jsx(uV,{children:t})]}));kt.displayName=hP.displayName;const hV=_.forwardRef(({className:e,...t},r)=>x.jsx(gP,{ref:r,className:_e("-mx-1 my-1 h-px bg-muted",e),...t}));hV.displayName=gP.displayName;const u_=[{value:"1",label:"Gennaio"},{value:"2",label:"Febbraio"},{value:"3",label:"Marzo"},{value:"4",label:"Aprile"},{value:"5",label:"Maggio"},{value:"6",label:"Giugno"},{value:"7",label:"Luglio"},{value:"8",label:"Agosto"},{value:"9",label:"Settembre"},{value:"10",label:"Ottobre"},{value:"11",label:"Novembre"},{value:"12",label:"Dicembre"}];function pV(){var C;const{selectedCompany:e,loadFinancialData:t}=Nn(),[r,n]=_.useState([]),[i,s]=_.useState([]),[a,o]=_.useState(!1),[l,c]=_.useState({}),[u,d]=_.useState({}),[f,p]=_.useState("2025"),[m,h]=_.useState("10");_.useEffect(()=>{(async()=>{if(!e){n([]),s([]);return}o(!0);try{const P=await t(e.id,"partitari",parseInt(f),m==="all"?void 0:parseInt(m));if(P&&P.length>0&&P[0].data){const I=P[0].data;s(I.headers||[]),n(I.data||[])}else n([]),s([])}catch(P){console.error("Errore nel caricamento dati partitari:",P),n([]),s([])}finally{o(!1)}})()},[e,t,f,m]);const g=_.useMemo(()=>{const T={};return i.forEach(P=>{T[P]=new Set,r.forEach(I=>{var H;const R=((H=I[P])==null?void 0:H.toString())||"";R&&T[P].add(R)})}),T},[i,r]),v=_.useMemo(()=>r.filter(T=>Object.keys(l).every(P=>{var R;if(!l[P]||l[P].size===0)return!0;const I=((R=T[P])==null?void 0:R.toString())||"";return l[P].has(I)})),[l,r]),w=(T,P)=>{c(I=>{const R={...I};if(!R[T])R[T]=new Set([P]);else{const H=new Set(R[T]);H.has(P)?H.delete(P):H.add(P),R[T]=H}return R})},y=T=>{var H;const P=Array.from(g[T]),I=((H=u[T])==null?void 0:H.toLowerCase())||"",R=I?P.filter(q=>q.toLowerCase().includes(I)):P;c(q=>({...q,[T]:new Set(R)}))},b=T=>{c(P=>{const I={...P};return delete I[T],I})},E=()=>{c({}),d({})},k=Object.values(l).some(T=>T.size>0),S=T=>{var R;const P=Array.from(g[T]),I=((R=u[T])==null?void 0:R.toLowerCase())||"";return I?P.filter(H=>H.toLowerCase().includes(I)):P};return e?x.jsxs("div",{"data-testid":"page-partitari",children:[x.jsx(Ze,{title:"Partitari",subtitle:"Registro completo delle movimentazioni contabili"}),x.jsxs("div",{className:"mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[x.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[x.jsxs(Yu,{value:f,onValueChange:p,children:[x.jsx(Yl,{className:"w-[120px]",children:x.jsx(Qu,{placeholder:"Anno"})}),x.jsxs(Ql,{children:[x.jsx(kt,{value:"2025",children:"2025"}),x.jsx(kt,{value:"2024",children:"2024"}),x.jsx(kt,{value:"2023",children:"2023"})]})]}),x.jsxs(Yu,{value:m,onValueChange:h,children:[x.jsx(Yl,{className:"w-[140px]",children:x.jsx(Qu,{placeholder:"Mese"})}),x.jsxs(Ql,{children:[x.jsx(kt,{value:"all",children:"Tutti i mesi"}),u_.map(T=>x.jsx(kt,{value:T.value,children:T.label},T.value))]})]}),k&&x.jsxs(ir,{variant:"outline",size:"sm",onClick:E,"data-testid":"button-clear-filters",children:[x.jsx(P0,{className:"w-4 h-4 mr-2"}),"Cancella Filtri"]})]}),x.jsxs("div",{className:"text-sm text-muted-foreground",children:[v.length," di ",r.length," righe"]})]}),x.jsx(Rt,{className:"p-0 overflow-hidden",children:a?x.jsxs("div",{className:"p-12 text-center text-muted-foreground",children:[x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),"Caricamento dati in corso..."]}):r.length===0?x.jsxs("div",{className:"p-12 text-center text-muted-foreground",children:["Dati non disponibili per il periodo selezionato (",m==="all"?"Tutto l'anno":(C=u_.find(T=>T.value===m))==null?void 0:C.label," ",f,")"]}):x.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[calc(100vh-300px)] table-scroll-container",children:x.jsxs("table",{className:"w-full border-collapse min-w-max","data-testid":"table-partitari",children:[x.jsx("thead",{className:"sticky top-0 z-20",children:x.jsx("tr",{children:i.map(T=>{const P=l[T],I=P&&P.size>0,R=S(T);return x.jsx("th",{className:"bg-muted px-3 py-3 text-sm font-semibold text-muted-foreground border-b-2 border-border text-left whitespace-nowrap",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{children:T}),x.jsxs(F$,{children:[x.jsx(M$,{asChild:!0,children:x.jsx(ir,{variant:"ghost",size:"sm",className:`h-6 w-6 p-0 ${I?"text-primary":""}`,"data-testid":`filter-button-${T}`,children:x.jsx(U1,{className:"w-4 h-4"})})}),x.jsxs(FR,{className:"w-72 p-0",align:"start",children:[x.jsx("div",{className:"p-3 border-b",children:x.jsx(Ei,{placeholder:"Cerca...",value:u[T]||"",onChange:H=>d(q=>({...q,[T]:H.target.value})),className:"h-8"})}),x.jsxs("div",{className:"p-2 border-b flex gap-2",children:[x.jsx(ir,{variant:"ghost",size:"sm",onClick:()=>y(T),className:"flex-1 h-8",children:"Seleziona Tutto"}),x.jsx(ir,{variant:"ghost",size:"sm",onClick:()=>b(T),className:"flex-1 h-8",children:"Cancella"})]}),x.jsx("div",{className:"max-h-64 overflow-y-auto p-2",children:R.length===0?x.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"Nessun valore trovato"}):R.map(H=>x.jsxs("div",{className:"flex items-center space-x-2 py-1.5 px-2 hover:bg-muted/50 rounded cursor-pointer",onClick:()=>w(T,H),children:[x.jsx(Fx,{checked:(P==null?void 0:P.has(H))||!1,onCheckedChange:()=>w(T,H)}),x.jsx("label",{className:"text-sm flex-1 cursor-pointer",children:H})]},H))})]})]})]})},T)})})}),x.jsx("tbody",{children:v.length===0?x.jsx("tr",{children:x.jsx("td",{colSpan:i.length,className:"px-3 py-8 text-center text-muted-foreground",children:"Nessun risultato trovato con i filtri attuali"})}):v.map((T,P)=>x.jsx("tr",{className:"hover:bg-muted/50","data-testid":`row-${P}`,children:i.map(I=>x.jsx("td",{className:"px-3 py-2 text-sm border-b border-border whitespace-nowrap","data-testid":`cell-${P}-${I}`,children:T[I]||""},I))},P))})]})})})]}):x.jsxs("div",{"data-testid":"page-partitari",children:[x.jsx(Ze,{title:"Partitari",subtitle:"Registro completo delle movimentazioni contabili"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati dei partitari"})})]})}function mV(){const{toast:e}=L1(),[t,r]=_.useState("awentia-bilanci"),[n,i]=_.useState("Awentia Bilanci - Financial Dashboard Application"),[s,a]=_.useState(!1),[o,l]=_.useState(null),{data:c,isLoading:u}=e5({queryKey:["/api/github/user"]}),d=t5({mutationFn:async()=>(await r5("POST","/api/github/create-repo",{name:t,description:n,isPrivate:s})).json(),onSuccess:m=>{l(m),e({title:"Repository creato!",description:`Il repository ${t}  stato creato con successo su GitHub.`}),gk.invalidateQueries({queryKey:["/api/github/repos"]})},onError:m=>{e({title:"Errore",description:m.message||"Impossibile creare il repository",variant:"destructive"})}}),f=m=>{navigator.clipboard.writeText(m),e({title:"Copiato!",description:"Comando copiato negli appunti"})},p=o?["# Inizializza git (se non gi fatto)","git init","","# Aggiungi tutti i file","git add .","","# Crea il primo commit",'git commit -m "Initial commit: Awentia Bilanci Dashboard"',"","# Collega al repository GitHub",`git remote add origin ${o.cloneUrl}`,"","# Pusha il codice","git branch -M main","git push -u origin main"].join(`
`):"";return x.jsxs("div",{"data-testid":"page-github-sync",children:[x.jsx(Ze,{title:"Sincronizza con GitHub",subtitle:"Trasferisci l'applicazione su un repository GitHub"}),x.jsxs("div",{className:"space-y-6",children:[x.jsx(Rt,{className:"p-6",children:x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx(fF,{className:"w-12 h-12 text-primary"}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-lg font-semibold",children:"Account GitHub Connesso"}),u?x.jsx("p",{className:"text-sm text-muted-foreground",children:"Caricamento..."}):c?x.jsxs("p",{className:"text-sm text-muted-foreground",children:["Connesso come ",x.jsxs("span",{className:"font-medium text-foreground",children:["@",c.username]})]}):x.jsx("p",{className:"text-sm text-destructive",children:"Non connesso"})]})]})}),o?x.jsxs(x.Fragment,{children:[x.jsx(Rt,{className:"p-6 bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-900",children:x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx(Kk,{className:"w-6 h-6 text-green-600 dark:text-green-400 mt-0.5"}),x.jsxs("div",{className:"flex-1",children:[x.jsx("h3",{className:"text-lg font-semibold text-green-900 dark:text-green-100",children:"Repository Creato!"}),x.jsx("p",{className:"text-sm text-green-700 dark:text-green-300 mt-1",children:"Il repository  stato creato con successo su GitHub"}),x.jsxs("a",{href:o.repoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline mt-2 inline-block",children:[o.repoUrl," "]})]})]})}),x.jsxs(Rt,{className:"p-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsx("h3",{className:"text-lg font-semibold",children:"Comandi Git"}),x.jsxs(ir,{size:"sm",variant:"outline",onClick:()=>f(p),"data-testid":"button-copy-commands",children:[x.jsx(uF,{className:"w-4 h-4 mr-2"}),"Copia Tutto"]})]}),x.jsx("div",{className:"bg-muted/50 rounded-lg p-4 font-mono text-sm",children:x.jsx("pre",{className:"whitespace-pre-wrap",children:p})}),x.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[x.jsx("h4",{className:"font-semibold text-sm mb-2",children:" Istruzioni:"}),x.jsxs("ol",{className:"text-sm text-muted-foreground space-y-1 list-decimal list-inside",children:[x.jsx("li",{children:"Apri il terminale di Replit (Shell)"}),x.jsx("li",{children:"Copia e incolla i comandi qui sopra"}),x.jsx("li",{children:"Esegui ogni comando in sequenza"}),x.jsx("li",{children:"Il tuo codice sar caricato su GitHub!"})]})]})]}),x.jsx(ir,{variant:"outline",onClick:()=>{l(null),r("awentia-bilanci")},className:"w-full",children:"Crea un Altro Repository"})]}):x.jsxs(Rt,{className:"p-6",children:[x.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Crea Nuovo Repository"}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx(Tn,{htmlFor:"repo-name",children:"Nome Repository"}),x.jsx(Ei,{id:"repo-name",value:t,onChange:m=>r(m.target.value),placeholder:"awentia-bilanci","data-testid":"input-repo-name"})]}),x.jsxs("div",{children:[x.jsx(Tn,{htmlFor:"repo-description",children:"Descrizione"}),x.jsx(Ei,{id:"repo-description",value:n,onChange:m=>i(m.target.value),placeholder:"Descrizione del repository","data-testid":"input-repo-description"})]}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx(Fx,{id:"is-private",checked:s,onCheckedChange:m=>a(m),"data-testid":"checkbox-private"}),x.jsx(Tn,{htmlFor:"is-private",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Repository privato"})]}),x.jsx(ir,{onClick:()=>d.mutate(),disabled:d.isPending||!t,className:"w-full","data-testid":"button-create-repo",children:d.isPending?"Creazione...":"Crea Repository"})]})]})]})]})}function gV(){return x.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:x.jsx(Rt,{className:"w-full max-w-md mx-4",children:x.jsxs(qi,{className:"pt-6",children:[x.jsxs("div",{className:"flex mb-4 gap-2",children:[x.jsx(cF,{className:"h-8 w-8 text-red-500"}),x.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),x.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yP=1252,vV=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Bx=function(e){vV.indexOf(e)!=-1&&(yP=jx[0]=e)};function xV(){Bx(1252)}var Zn=function(e){Bx(e)};function wP(){Zn(1200),xV()}function d_(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function yV(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function bP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Wc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?yV(e.slice(2)):t==254&&r==255?bP(e.slice(2)):t==65279?e.slice(1):e},Cf=function(t){return String.fromCharCode(t)},f_=function(t){return String.fromCharCode(t)},Ss,js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function h_(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=js.charAt(s)+js.charAt(a)+js.charAt(o)+js.charAt(l);return t}function un(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=js.indexOf(e.charAt(c++)),a=js.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=js.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=js.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var $e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),To=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function sa(e){return $e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function p_(e){return $e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qn=function(t){return $e?To(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ko(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ux(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ux(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Es=$e?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:To(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function wV(e){for(var t=[],r=0,n=e.length+250,i=sa(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=sa(65535),n=65530)}return t.push(i.slice(0,r)),Es(t)}var Fr=/\u0000/g,Gc=/[\u0001-\u0006]/g;function yl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ei(e,t){var r=""+e;return r.length>=t?r:bt("0",t-r.length)+r}function $x(e,t){var r=""+e;return r.length>=t?r:bt(" ",t-r.length)+r}function e0(e,t){var r=""+e;return r.length>=t?r:r+bt(" ",t-r.length)}function bV(e,t){var r=""+Math.round(e);return r.length>=t?r:bt("0",t-r.length)+r}function _V(e,t){var r=""+e;return r.length>=t?r:bt("0",t-r.length)+r}var m_=Math.pow(2,32);function Uo(e,t){if(e>m_||e<-m_)return bV(e,t);var r=Math.round(e);return _V(r,t)}function t0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var g_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_m=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SV(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},v_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},EV={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function r0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,d=Math.floor(i);c<t&&(d=Math.floor(i),o=d*a+s,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var f=Math.floor(n*o/u);return[f,n*o-f*u,u]}function $a(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=PV(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var _P=new Date(1899,11,31,0,0,0),TV=_P.getTime(),kV=new Date(1900,2,1,0,0,0);function SP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=kV&&(r+=24*60*60*1e3),(r-(TV+(e.getTimezoneOffset()-_P.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Vx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function CV(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function AV(e){var t=e<0?12:11,r=Vx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function RV(e){var t=Vx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ju(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=AV(e):t===10?r=e.toFixed(10).substr(0,12):r=RV(e),Vx(CV(r.toUpperCase()))}function vo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ju(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dn(14,SP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function PV(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function OV(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return _m[r.m-1][1];case 5:return _m[r.m-1][0];default:return _m[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return g_[r.q][0];default:return g_[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ei(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=ei(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ei(l,c):"";return u}function Bs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var EP=/%/g;function IV(e,t,r){var n=t.replace(EP,""),i=t.length-n.length;return Xi(e,n,r*Math.pow(10,2*i))+bt("%",i)}function DV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Xi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function TP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+TP(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var kP=/# (\?+)( ?)\/( ?)(\d+)/;function NV(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?bt(" ",e[1].length+1+e[4].length):$x(a,e[1].length)+e[2]+"/"+e[3]+ei(o,e[4].length))}function FV(e,t,r){return r+(t===0?"":""+t)+bt(" ",e[1].length+2+e[4].length)}var CP=/^#*0*\.([0#]+)/,AP=/\).*[0#]/,RP=/\(###\) ###\\?-####/;function Pr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function x_(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function y_(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function MV(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function LV(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(AP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vn("n",n,r):"("+vn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return DV(e,t,r);if(t.indexOf("%")!==-1)return IV(e,t,r);if(t.indexOf("E")!==-1)return TP(t,r);if(t.charCodeAt(0)===36)return"$"+vn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Uo(l,t.length);if(t.match(/^[#?]+$/))return i=Uo(r,0),i==="0"&&(i=""),i.length>t.length?i:Pr(t.substr(0,t.length-i.length))+i;if(s=t.match(kP))return NV(s,l,c);if(t.match(/^#+0+$/))return c+Uo(l,t.length-t.indexOf("0"));if(s=t.match(CP))return i=x_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])).replace(/\.(\d*)$/,function(m,h){return"."+h+bt("0",Pr(s[1]).length-h.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+x_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Bs(Uo(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vn(e,t,-r):Bs(""+(Math.floor(r)+MV(r,s[1].length)))+"."+ei(y_(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return vn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=yl(vn(e,t.replace(/[\\-]/g,""),r)),a=0,yl(yl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(RP))return i=vn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=r0(l,Math.pow(10,a)-1,!1),i=""+c,u=Xi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=e0(o[2],a),u.length<s[4].length&&(u=Pr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=r0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?$x(o[1],a)+s[2]+"/"+s[3]+e0(o[2],a):bt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Uo(r,0),t.length<=i.length?i:Pr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,f=t.length-i.length-d;return Pr(t.substr(0,d)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=y_(r,s[1].length),r<0?"-"+vn(e,t,-r):Bs(LV(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?ei(0,3-m.length):"")+m})+"."+ei(a,s[1].length);switch(t){case"###,##0.00":return vn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Bs(Uo(l,0));return p!=="0"?c+p:"";case"###,###.00":return vn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return vn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function zV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Xi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function jV(e,t,r){var n=t.replace(EP,""),i=t.length-n.length;return Xi(e,n,r*Math.pow(10,2*i))+bt("%",i)}function PP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+PP(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(AP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fi("n",n,r):"("+fi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return zV(e,t,r);if(t.indexOf("%")!==-1)return jV(e,t,r);if(t.indexOf("E")!==-1)return PP(t,r);if(t.charCodeAt(0)===36)return"$"+fi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ei(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Pr(t.substr(0,t.length-i.length))+i;if(s=t.match(kP))return FV(s,l,c);if(t.match(/^#+0+$/))return c+ei(l,t.length-t.indexOf("0"));if(s=t.match(CP))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])),i=i.replace(/\.(\d*)$/,function(m,h){return"."+h+bt("0",Pr(s[1]).length-h.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Bs(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fi(e,t,-r):Bs(""+r)+"."+bt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return fi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=yl(fi(e,t.replace(/[\\-]/g,""),r)),a=0,yl(yl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(RP))return i=fi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=r0(l,Math.pow(10,a)-1,!1),i=""+c,u=Xi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=e0(o[2],a),u.length<s[4].length&&(u=Pr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=r0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?$x(o[1],a)+s[2]+"/"+s[3]+e0(o[2],a):bt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Pr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,f=t.length-i.length-d;return Pr(t.substr(0,d)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fi(e,t,-r):Bs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?ei(0,3-m.length):"")+m})+"."+ei(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Bs(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return fi(e,t.slice(0,t.lastIndexOf(".")),r)+Pr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Xi(e,t,r){return(r|0)===r?fi(e,t,r):vn(e,t,r)}function BV(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var OP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function hc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":t0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(OP))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function UV(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,d,f="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!t0(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=e.charAt(++a),m=p==="("||p===")"?p:"t";i[i.length]={t:m,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=$a(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=$a(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var h={t:o,v:o};if(c==null&&(c=$a(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(h.v=c.H>=12?"P":"A"),h.t="T",f="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(h.v=c.H>=12?"PM":"AM"),h.t="T",a+=5,f="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(h.v=c.H>=12?"":""),h.t="T",a+=5,f="h"):(h.t="t",++a),c==null&&h.t==="T")return"";i[i.length]=h,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(OP)){if(c==null&&(c=$a(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",hc(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var g=0,v=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=f,l="h",g<1&&(g=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",b;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=OV(i[a].t.charCodeAt(0),i[a].v,c,v),i[a].t="t";break;case"n":case"?":for(b=a+1;i[b]!=null&&((o=i[b].t)==="?"||o==="D"||(o===" "||o==="t")&&i[b+1]!=null&&(i[b+1].t==="?"||i[b+1].t==="t"&&i[b+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[b].v==="/"||i[b].v===" "&&i[b+1]!=null&&i[b+1].t=="?"));)i[a].v+=i[b].v,i[b]={v:"",t:";"},++b;y+=i[a].v,a=b-1;break;case"G":i[a].t="t",i[a].v=vo(t,r);break}var E="",k,S;if(y.length>0){y.charCodeAt(0)==40?(k=t<0&&y.charCodeAt(0)===45?-t:t,S=Xi("n",y,k)):(k=t<0&&n>1?-t:t,S=Xi("n",y,k),k<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),b=S.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var T=i.length;if(C===i.length&&S.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(b>=i[a].v.length-1?(b-=i[a].v.length,i[a].v=S.substr(b+1,i[a].v.length)):b<0?i[a].v="":(i[a].v=S.substr(0,b+1),b=-1),i[a].t="t",T=a);b>=0&&T<i.length&&(i[T].v=S.substr(0,b+1)+i[T].v)}else if(C!==i.length&&S.indexOf("E")===-1){for(b=S.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,E=i[a].v.substr(u+1);u>=0;--u)b>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(E=S.charAt(b--)+E);i[a].v=E,i[a].t="t",T=a}for(b>=0&&T<i.length&&(i[T].v=S.substr(0,b+1)+i[T].v),b=S.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(u=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,E=i[a].v.substr(0,u);u<i[a].v.length;++u)b<S.length&&(E+=S.charAt(b++));i[a].v=E,i[a].t="t",T=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(k=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Xi(i[a].t,i[a].v,k),i[a].t="t");var P="";for(a=0;a!==i.length;++a)i[a]!=null&&(P+=i[a].v);return P}var w_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function b_(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function $V(e,t){var r=BV(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(w_),o=r[1].match(w_);return b_(t,a)?[n,r[0]]:b_(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Dn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:De)[e],n==null&&(n=r.table&&r.table[v_[e]]||De[v_[e]]),n==null&&(n=EV[e]||"General");break}if(t0(n,0))return vo(t,r);t instanceof Date&&(t=SP(t,r.date1904));var i=$V(n,t);if(t0(i[1]))return vo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return UV(i[1],t,r,i[0])}function to(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(De[r]==null){t<0&&(t=r);continue}if(De[r]==e){t=r;break}}t<0&&(t=391)}return De[t]=e,t}function IP(){De=SV()}var VV={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},DP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function HV(e){var t=typeof e=="number"?De[e]:e;return t=t.replace(DP,"(\\d+)"),new RegExp("^"+t+"$")}function WV(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(DP)||[]).forEach(function(d,f){var p=parseInt(r[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var GV=function(){var e={};e.version="1.2.0";function t(){for(var S=0,C=new Array(256),T=0;T!=256;++T)S=T,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,C[T]=S;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(S){var C=0,T=0,P=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)I[P]=S[P];for(P=0;P!=256;++P)for(T=S[P],C=256+P;C<4096;C+=256)T=I[C]=T>>>8^S[T&255];var R=[];for(P=1;P!=16;++P)R[P-1]=typeof Int32Array<"u"?I.subarray(P*256,P*256+256):I.slice(P*256,P*256+256);return R}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],d=i[6],f=i[7],p=i[8],m=i[9],h=i[10],g=i[11],v=i[12],w=i[13],y=i[14];function b(S,C){for(var T=C^-1,P=0,I=S.length;P<I;)T=T>>>8^r[(T^S.charCodeAt(P++))&255];return~T}function E(S,C){for(var T=C^-1,P=S.length-15,I=0;I<P;)T=y[S[I++]^T&255]^w[S[I++]^T>>8&255]^v[S[I++]^T>>16&255]^g[S[I++]^T>>>24]^h[S[I++]]^m[S[I++]]^p[S[I++]]^f[S[I++]]^d[S[I++]]^u[S[I++]]^c[S[I++]]^l[S[I++]]^o[S[I++]]^a[S[I++]]^s[S[I++]]^r[S[I++]];for(P+=15;I<P;)T=T>>>8^r[(T^S[I++])&255];return~T}function k(S,C){for(var T=C^-1,P=0,I=S.length,R=0,H=0;P<I;)R=S.charCodeAt(P++),R<128?T=T>>>8^r[(T^R)&255]:R<2048?(T=T>>>8^r[(T^(192|R>>6&31))&255],T=T>>>8^r[(T^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,H=S.charCodeAt(P++)&1023,T=T>>>8^r[(T^(240|R>>8&7))&255],T=T>>>8^r[(T^(128|R>>2&63))&255],T=T>>>8^r[(T^(128|H>>6&15|(R&3)<<4))&255],T=T>>>8^r[(T^(128|H&63))&255]):(T=T>>>8^r[(T^(224|R>>12&15))&255],T=T>>>8^r[(T^(128|R>>6&63))&255],T=T>>>8^r[(T^(128|R&63))&255]);return~T}return e.table=r,e.bstr=b,e.buf=E,e.str=k,e}(),Ve=function(){var t={};t.version="1.2.1";function r(A,M){for(var O=A.split("/"),N=M.split("/"),L=0,j=0,Z=Math.min(O.length,N.length);L<Z;++L){if(j=O[L].length-N[L].length)return j;if(O[L]!=N[L])return O[L]<N[L]?-1:1}return O.length-N.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var M=A.lastIndexOf("/");return M===-1?A:A.slice(0,M+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var M=A.lastIndexOf("/");return M===-1?A:A.slice(M+1)}function s(A,M){typeof M=="string"&&(M=new Date(M));var O=M.getHours();O=O<<6|M.getMinutes(),O=O<<5|M.getSeconds()>>>1,A.write_shift(2,O);var N=M.getFullYear()-1980;N=N<<4|M.getMonth()+1,N=N<<5|M.getDate(),A.write_shift(2,N)}function a(A){var M=A.read_shift(2)&65535,O=A.read_shift(2)&65535,N=new Date,L=O&31;O>>>=5;var j=O&15;O>>>=4,N.setMilliseconds(0),N.setFullYear(O+1980),N.setMonth(j-1),N.setDate(L);var Z=M&31;M>>>=5;var se=M&63;return M>>>=6,N.setHours(M),N.setMinutes(se),N.setSeconds(Z<<1),N}function o(A){nr(A,0);for(var M={},O=0;A.l<=A.length-4;){var N=A.read_shift(2),L=A.read_shift(2),j=A.l+L,Z={};switch(N){case 21589:O=A.read_shift(1),O&1&&(Z.mtime=A.read_shift(4)),L>5&&(O&2&&(Z.atime=A.read_shift(4)),O&4&&(Z.ctime=A.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}A.l=j,M[N]=Z}return M}var l;function c(){return l||(l={})}function u(A,M){if(A[0]==80&&A[1]==75)return my(A,M);if((A[0]|32)==109&&(A[1]|32)==105)return pI(A,M);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var O=3,N=512,L=0,j=0,Z=0,se=0,J=0,ee=[],re=A.slice(0,512);nr(re,0);var ce=d(re);switch(O=ce[0],O){case 3:N=512;break;case 4:N=4096;break;case 0:if(ce[1]==0)return my(A,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}N!==512&&(re=A.slice(0,N),nr(re,28));var pe=A.slice(0,N);f(re,O);var xe=re.read_shift(4,"i");if(O===3&&xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xe);re.l+=4,Z=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),se=re.read_shift(4,"i"),L=re.read_shift(4,"i"),J=re.read_shift(4,"i"),j=re.read_shift(4,"i");for(var de=-1,ge=0;ge<109&&(de=re.read_shift(4,"i"),!(de<0));++ge)ee[ge]=de;var Ie=p(A,N);g(J,j,Ie,N,ee);var ft=w(Ie,Z,ee,N);ft[Z].name="!Directory",L>0&&se!==H&&(ft[se].name="!MiniFAT"),ft[ee[0]].name="!FAT",ft.fat_addrs=ee,ft.ssz=N;var ht={},ur=[],gc=[],vc=[];y(Z,ft,Ie,ur,L,ht,gc,se),m(gc,vc,ur),ur.shift();var xc={FileIndex:gc,FullPaths:vc};return M&&M.raw&&(xc.raw={header:pe,sectors:Ie}),xc}function d(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(q,"Header Signature: "),A.l+=16;var M=A.read_shift(2,"u");return[A.read_shift(2,"u"),M]}function f(A,M){var O=9;switch(A.l+=2,O=A.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function p(A,M){for(var O=Math.ceil(A.length/M)-1,N=[],L=1;L<O;++L)N[L-1]=A.slice(L*M,(L+1)*M);return N[O-1]=A.slice(O*M),N}function m(A,M,O){for(var N=0,L=0,j=0,Z=0,se=0,J=O.length,ee=[],re=[];N<J;++N)ee[N]=re[N]=N,M[N]=O[N];for(;se<re.length;++se)N=re[se],L=A[N].L,j=A[N].R,Z=A[N].C,ee[N]===N&&(L!==-1&&ee[L]!==L&&(ee[N]=ee[L]),j!==-1&&ee[j]!==j&&(ee[N]=ee[j])),Z!==-1&&(ee[Z]=N),L!==-1&&N!=ee[N]&&(ee[L]=ee[N],re.lastIndexOf(L)<se&&re.push(L)),j!==-1&&N!=ee[N]&&(ee[j]=ee[N],re.lastIndexOf(j)<se&&re.push(j));for(N=1;N<J;++N)ee[N]===N&&(j!==-1&&ee[j]!==j?ee[N]=ee[j]:L!==-1&&ee[L]!==L&&(ee[N]=ee[L]));for(N=1;N<J;++N)if(A[N].type!==0){if(se=N,se!=ee[se])do se=ee[se],M[N]=M[se]+"/"+M[N];while(se!==0&&ee[se]!==-1&&se!=ee[se]);ee[N]=-1}for(M[0]+="/",N=1;N<J;++N)A[N].type!==2&&(M[N]+="/")}function h(A,M,O){for(var N=A.start,L=A.size,j=[],Z=N;O&&L>0&&Z>=0;)j.push(M.slice(Z*R,Z*R+R)),L-=R,Z=Na(O,Z*4);return j.length===0?Bt(0):Es(j).slice(0,A.size)}function g(A,M,O,N,L){var j=H;if(A===H){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var Z=O[A],se=(N>>>2)-1;if(!Z)return;for(var J=0;J<se&&(j=Na(Z,J*4))!==H;++J)L.push(j);g(Na(Z,N-4),M-1,O,N,L)}}function v(A,M,O,N,L){var j=[],Z=[];L||(L=[]);var se=N-1,J=0,ee=0;for(J=M;J>=0;){L[J]=!0,j[j.length]=J,Z.push(A[J]);var re=O[Math.floor(J*4/N)];if(ee=J*4&se,N<4+ee)throw new Error("FAT boundary crossed: "+J+" 4 "+N);if(!A[re])break;J=Na(A[re],ee)}return{nodes:j,data:O_([Z])}}function w(A,M,O,N){var L=A.length,j=[],Z=[],se=[],J=[],ee=N-1,re=0,ce=0,pe=0,xe=0;for(re=0;re<L;++re)if(se=[],pe=re+M,pe>=L&&(pe-=L),!Z[pe]){J=[];var de=[];for(ce=pe;ce>=0;){de[ce]=!0,Z[ce]=!0,se[se.length]=ce,J.push(A[ce]);var ge=O[Math.floor(ce*4/N)];if(xe=ce*4&ee,N<4+xe)throw new Error("FAT boundary crossed: "+ce+" 4 "+N);if(!A[ge]||(ce=Na(A[ge],xe),de[ce]))break}j[pe]={nodes:se,data:O_([J])}}return j}function y(A,M,O,N,L,j,Z,se){for(var J=0,ee=N.length?2:0,re=M[A].data,ce=0,pe=0,xe;ce<re.length;ce+=128){var de=re.slice(ce,ce+128);nr(de,64),pe=de.read_shift(2),xe=qx(de,0,pe-ee),N.push(xe);var ge={name:xe,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},Ie=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Ie!==0&&(ge.ct=b(de,de.l-8));var ft=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);ft!==0&&(ge.mt=b(de,de.l-8)),ge.start=de.read_shift(4,"i"),ge.size=de.read_shift(4,"i"),ge.size<0&&ge.start<0&&(ge.size=ge.type=0,ge.start=H,ge.name=""),ge.type===5?(J=ge.start,L>0&&J!==H&&(M[J].name="!StreamData")):ge.size>=4096?(ge.storage="fat",M[ge.start]===void 0&&(M[ge.start]=v(O,ge.start,M.fat_addrs,M.ssz)),M[ge.start].name=ge.name,ge.content=M[ge.start].data.slice(0,ge.size)):(ge.storage="minifat",ge.size<0?ge.size=0:J!==H&&ge.start!==H&&M[J]&&(ge.content=h(ge,M[J].data,(M[se]||{}).data))),ge.content&&nr(ge.content,0),j[xe]=ge,Z.push(ge)}}function b(A,M){return new Date((Zr(A,M+4)/1e7*Math.pow(2,32)+Zr(A,M)/1e7-11644473600)*1e3)}function E(A,M){return c(),u(l.readFileSync(A),M)}function k(A,M){var O=M&&M.type;switch(O||$e&&Buffer.isBuffer(A)&&(O="buffer"),O||"base64"){case"file":return E(A,M);case"base64":return u(Qn(un(A)),M);case"binary":return u(Qn(A),M)}return u(A,M)}function S(A,M){var O=M||{},N=O.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=N+"/",A.FileIndex[0]={name:N,type:5}),O.CLSID&&(A.FileIndex[0].clsid=O.CLSID),C(A)}function C(A){var M="Sh33tJ5";if(!Ve.find(A,"/"+M)){var O=Bt(4);O[0]=55,O[1]=O[3]=50,O[2]=54,A.FileIndex.push({name:M,type:2,content:O,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+M),T(A)}}function T(A,M){S(A);for(var O=!1,N=!1,L=A.FullPaths.length-1;L>=0;--L){var j=A.FileIndex[L];switch(j.type){case 0:N?O=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(j.R*j.L*j.C)&&(O=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!M)){var Z=new Date(1987,1,19),se=0,J=Object.create?Object.create(null):{},ee=[];for(L=0;L<A.FullPaths.length;++L)J[A.FullPaths[L]]=!0,A.FileIndex[L].type!==0&&ee.push([A.FullPaths[L],A.FileIndex[L]]);for(L=0;L<ee.length;++L){var re=n(ee[L][0]);N=J[re],N||(ee.push([re,{name:i(re).replace("/",""),type:1,clsid:K,ct:Z,mt:Z,content:null}]),J[re]=!0)}for(ee.sort(function(xe,de){return r(xe[0],de[0])}),A.FullPaths=[],A.FileIndex=[],L=0;L<ee.length;++L)A.FullPaths[L]=ee[L][0],A.FileIndex[L]=ee[L][1];for(L=0;L<ee.length;++L){var ce=A.FileIndex[L],pe=A.FullPaths[L];if(ce.name=i(pe).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||K,L===0)ce.C=ee.length>1?1:-1,ce.size=0,ce.type=5;else if(pe.slice(-1)=="/"){for(se=L+1;se<ee.length&&n(A.FullPaths[se])!=pe;++se);for(ce.C=se>=ee.length?-1:se,se=L+1;se<ee.length&&n(A.FullPaths[se])!=n(pe);++se);ce.R=se>=ee.length?-1:se,ce.type=1}else n(A.FullPaths[L+1]||"")==n(pe)&&(ce.R=L+1),ce.type=2}}}function P(A,M){var O=M||{};if(O.fileType=="mad")return mI(A,O);switch(T(A),O.fileType){case"zip":return lI(A,O)}var N=function(xe){for(var de=0,ge=0,Ie=0;Ie<xe.FileIndex.length;++Ie){var ft=xe.FileIndex[Ie];if(ft.content){var ht=ft.content.length;ht>0&&(ht<4096?de+=ht+63>>6:ge+=ht+511>>9)}}for(var ur=xe.FullPaths.length+3>>2,gc=de+7>>3,vc=de+127>>7,xc=gc+ge+ur+vc,ya=xc+127>>7,op=ya<=109?0:Math.ceil((ya-109)/127);xc+ya+op+127>>7>ya;)op=++ya<=109?0:Math.ceil((ya-109)/127);var Ii=[1,op,ya,vc,ur,ge,de,0];return xe.FileIndex[0].size=de<<6,Ii[7]=(xe.FileIndex[0].start=Ii[0]+Ii[1]+Ii[2]+Ii[3]+Ii[4]+Ii[5])+(Ii[6]+7>>3),Ii}(A),L=Bt(N[7]<<9),j=0,Z=0;{for(j=0;j<8;++j)L.write_shift(1,X[j]);for(j=0;j<8;++j)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),j=0;j<3;++j)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,N[2]),L.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:H),L.write_shift(4,N[3]),L.write_shift(-4,N[1]?N[0]-1:H),L.write_shift(4,N[1]),j=0;j<109;++j)L.write_shift(-4,j<N[2]?N[1]+j:-1)}if(N[1])for(Z=0;Z<N[1];++Z){for(;j<236+Z*127;++j)L.write_shift(-4,j<N[2]?N[1]+j:-1);L.write_shift(-4,Z===N[1]-1?H:Z+1)}var se=function(xe){for(Z+=xe;j<Z-1;++j)L.write_shift(-4,j+1);xe&&(++j,L.write_shift(-4,H))};for(Z=j=0,Z+=N[1];j<Z;++j)L.write_shift(-4,Q.DIFSECT);for(Z+=N[2];j<Z;++j)L.write_shift(-4,Q.FATSECT);se(N[3]),se(N[4]);for(var J=0,ee=0,re=A.FileIndex[0];J<A.FileIndex.length;++J)re=A.FileIndex[J],re.content&&(ee=re.content.length,!(ee<4096)&&(re.start=Z,se(ee+511>>9)));for(se(N[6]+7>>3);L.l&511;)L.write_shift(-4,Q.ENDOFCHAIN);for(Z=j=0,J=0;J<A.FileIndex.length;++J)re=A.FileIndex[J],re.content&&(ee=re.content.length,!(!ee||ee>=4096)&&(re.start=Z,se(ee+63>>6)));for(;L.l&511;)L.write_shift(-4,Q.ENDOFCHAIN);for(j=0;j<N[4]<<2;++j){var ce=A.FullPaths[j];if(!ce||ce.length===0){for(J=0;J<17;++J)L.write_shift(4,0);for(J=0;J<3;++J)L.write_shift(4,-1);for(J=0;J<12;++J)L.write_shift(4,0);continue}re=A.FileIndex[j],j===0&&(re.start=re.size?re.start-1:H);var pe=j===0&&O.root||re.name;if(ee=2*(pe.length+1),L.write_shift(64,pe,"utf16le"),L.write_shift(2,ee),L.write_shift(1,re.type),L.write_shift(1,re.color),L.write_shift(-4,re.L),L.write_shift(-4,re.R),L.write_shift(-4,re.C),re.clsid)L.write_shift(16,re.clsid,"hex");else for(J=0;J<4;++J)L.write_shift(4,0);L.write_shift(4,re.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,re.start),L.write_shift(4,re.size),L.write_shift(4,0)}for(j=1;j<A.FileIndex.length;++j)if(re=A.FileIndex[j],re.size>=4096)if(L.l=re.start+1<<9,$e&&Buffer.isBuffer(re.content))re.content.copy(L,L.l,0,re.size),L.l+=re.size+511&-512;else{for(J=0;J<re.size;++J)L.write_shift(1,re.content[J]);for(;J&511;++J)L.write_shift(1,0)}for(j=1;j<A.FileIndex.length;++j)if(re=A.FileIndex[j],re.size>0&&re.size<4096)if($e&&Buffer.isBuffer(re.content))re.content.copy(L,L.l,0,re.size),L.l+=re.size+63&-64;else{for(J=0;J<re.size;++J)L.write_shift(1,re.content[J]);for(;J&63;++J)L.write_shift(1,0)}if($e)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function I(A,M){var O=A.FullPaths.map(function(J){return J.toUpperCase()}),N=O.map(function(J){var ee=J.split("/");return ee[ee.length-(J.slice(-1)=="/"?2:1)]}),L=!1;M.charCodeAt(0)===47?(L=!0,M=O[0].slice(0,-1)+M):L=M.indexOf("/")!==-1;var j=M.toUpperCase(),Z=L===!0?O.indexOf(j):N.indexOf(j);if(Z!==-1)return A.FileIndex[Z];var se=!j.match(Gc);for(j=j.replace(Fr,""),se&&(j=j.replace(Gc,"!")),Z=0;Z<O.length;++Z)if((se?O[Z].replace(Gc,"!"):O[Z]).replace(Fr,"")==j||(se?N[Z].replace(Gc,"!"):N[Z]).replace(Fr,"")==j)return A.FileIndex[Z];return null}var R=64,H=-2,q="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(A,M,O){c();var N=P(A,O);l.writeFileSync(M,N)}function z(A){for(var M=new Array(A.length),O=0;O<A.length;++O)M[O]=String.fromCharCode(A[O]);return M.join("")}function ie(A,M){var O=P(A,M);switch(M&&M.type||"buffer"){case"file":return c(),l.writeFileSync(M.filename,O),O;case"binary":return typeof O=="string"?O:z(O);case"base64":return h_(typeof O=="string"?O:z(O));case"buffer":if($e)return Buffer.isBuffer(O)?O:To(O);case"array":return typeof O=="string"?Qn(O):O}return O}var ae;function D(A){try{var M=A.InflateRaw,O=new M;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)ae=A;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function V(A,M){if(!ae)return hy(A,M);var O=ae.InflateRaw,N=new O,L=N._processChunk(A.slice(A.l),N._finishFlushFlag);return A.l+=N.bytesRead,L}function B(A){return ae?ae.deflateRawSync(A):me(A)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function oe(A){var M=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(M>>16|M>>8|M)&255}for(var le=typeof Uint8Array<"u",ne=le?new Uint8Array(256):[],he=0;he<256;++he)ne[he]=oe(he);function F(A,M){var O=ne[A&255];return M<=8?O>>>8-M:(O=O<<8|ne[A>>8&255],M<=16?O>>>16-M:(O=O<<8|ne[A>>16&255],O>>>24-M))}function Se(A,M){var O=M&7,N=M>>>3;return(A[N]|(O<=6?0:A[N+1]<<8))>>>O&3}function Ee(A,M){var O=M&7,N=M>>>3;return(A[N]|(O<=5?0:A[N+1]<<8))>>>O&7}function Fe(A,M){var O=M&7,N=M>>>3;return(A[N]|(O<=4?0:A[N+1]<<8))>>>O&15}function ke(A,M){var O=M&7,N=M>>>3;return(A[N]|(O<=3?0:A[N+1]<<8))>>>O&31}function fe(A,M){var O=M&7,N=M>>>3;return(A[N]|(O<=1?0:A[N+1]<<8))>>>O&127}function tt(A,M,O){var N=M&7,L=M>>>3,j=(1<<O)-1,Z=A[L]>>>N;return O<8-N||(Z|=A[L+1]<<8-N,O<16-N)||(Z|=A[L+2]<<16-N,O<24-N)||(Z|=A[L+3]<<24-N),Z&j}function St(A,M,O){var N=M&7,L=M>>>3;return N<=5?A[L]|=(O&7)<<N:(A[L]|=O<<N&255,A[L+1]=(O&7)>>8-N),M+3}function xt(A,M,O){var N=M&7,L=M>>>3;return O=(O&1)<<N,A[L]|=O,M+1}function Mt(A,M,O){var N=M&7,L=M>>>3;return O<<=N,A[L]|=O&255,O>>>=8,A[L+1]=O,M+8}function Xr(A,M,O){var N=M&7,L=M>>>3;return O<<=N,A[L]|=O&255,O>>>=8,A[L+1]=O&255,A[L+2]=O>>>8,M+16}function Lt(A,M){var O=A.length,N=2*O>M?2*O:M+5,L=0;if(O>=M)return A;if($e){var j=p_(N);if(A.copy)A.copy(j);else for(;L<A.length;++L)j[L]=A[L];return j}else if(le){var Z=new Uint8Array(N);if(Z.set)Z.set(A);else for(;L<O;++L)Z[L]=A[L];return Z}return A.length=N,A}function cr(A){for(var M=new Array(A),O=0;O<A;++O)M[O]=0;return M}function hn(A,M,O){var N=1,L=0,j=0,Z=0,se=0,J=A.length,ee=le?new Uint16Array(32):cr(32);for(j=0;j<32;++j)ee[j]=0;for(j=J;j<O;++j)A[j]=0;J=A.length;var re=le?new Uint16Array(J):cr(J);for(j=0;j<J;++j)ee[L=A[j]]++,N<L&&(N=L),re[j]=0;for(ee[0]=0,j=1;j<=N;++j)ee[j+16]=se=se+ee[j-1]<<1;for(j=0;j<J;++j)se=A[j],se!=0&&(re[j]=ee[se+16]++);var ce=0;for(j=0;j<J;++j)if(ce=A[j],ce!=0)for(se=F(re[j],N)>>N-ce,Z=(1<<N+4-ce)-1;Z>=0;--Z)M[se|Z<<ce]=ce&15|j<<4;return N}var kr=le?new Uint16Array(512):cr(512),pn=le?new Uint16Array(32):cr(32);if(!le){for(var Et=0;Et<512;++Et)kr[Et]=0;for(Et=0;Et<32;++Et)pn[Et]=0}(function(){for(var A=[],M=0;M<32;M++)A.push(5);hn(A,pn,32);var O=[];for(M=0;M<=143;M++)O.push(8);for(;M<=255;M++)O.push(9);for(;M<=279;M++)O.push(7);for(;M<=287;M++)O.push(8);hn(O,kr,288)})();var Kt=function(){for(var M=le?new Uint8Array(32768):[],O=0,N=0;O<te.length-1;++O)for(;N<te[O+1];++N)M[N]=O;for(;N<32768;++N)M[N]=29;var L=le?new Uint8Array(259):[];for(O=0,N=0;O<Y.length-1;++O)for(;N<Y[O+1];++N)L[N]=O;function j(se,J){for(var ee=0;ee<se.length;){var re=Math.min(65535,se.length-ee),ce=ee+re==se.length;for(J.write_shift(1,+ce),J.write_shift(2,re),J.write_shift(2,~re&65535);re-- >0;)J[J.l++]=se[ee++]}return J.l}function Z(se,J){for(var ee=0,re=0,ce=le?new Uint16Array(32768):[];re<se.length;){var pe=Math.min(65535,se.length-re);if(pe<10){for(ee=St(J,ee,+(re+pe==se.length)),ee&7&&(ee+=8-(ee&7)),J.l=ee/8|0,J.write_shift(2,pe),J.write_shift(2,~pe&65535);pe-- >0;)J[J.l++]=se[re++];ee=J.l*8;continue}ee=St(J,ee,+(re+pe==se.length)+2);for(var xe=0;pe-- >0;){var de=se[re];xe=(xe<<5^de)&32767;var ge=-1,Ie=0;if((ge=ce[xe])&&(ge|=re&-32768,ge>re&&(ge-=32768),ge<re))for(;se[ge+Ie]==se[re+Ie]&&Ie<250;)++Ie;if(Ie>2){de=L[Ie],de<=22?ee=Mt(J,ee,ne[de+1]>>1)-1:(Mt(J,ee,3),ee+=5,Mt(J,ee,ne[de-23]>>5),ee+=3);var ft=de<8?0:de-4>>2;ft>0&&(Xr(J,ee,Ie-Y[de]),ee+=ft),de=M[re-ge],ee=Mt(J,ee,ne[de]>>3),ee-=3;var ht=de<4?0:de-2>>1;ht>0&&(Xr(J,ee,re-ge-te[de]),ee+=ht);for(var ur=0;ur<Ie;++ur)ce[xe]=re&32767,xe=(xe<<5^se[re])&32767,++re;pe-=Ie-1}else de<=143?de=de+48:ee=xt(J,ee,1),ee=Mt(J,ee,ne[de]),ce[xe]=re&32767,++re}ee=Mt(J,ee,0)-1}return J.l=(ee+7)/8|0,J.l}return function(J,ee){return J.length<8?j(J,ee):Z(J,ee)}}();function me(A){var M=Bt(50+Math.floor(A.length*1.1)),O=Kt(A,M);return M.slice(0,O)}var ct=le?new Uint16Array(32768):cr(32768),qt=le?new Uint16Array(32768):cr(32768),zt=le?new Uint16Array(128):cr(128),xa=1,fy=1;function sI(A,M){var O=ke(A,M)+257;M+=5;var N=ke(A,M)+1;M+=5;var L=Fe(A,M)+4;M+=4;for(var j=0,Z=le?new Uint8Array(19):cr(19),se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=1,ee=le?new Uint8Array(8):cr(8),re=le?new Uint8Array(8):cr(8),ce=Z.length,pe=0;pe<L;++pe)Z[U[pe]]=j=Ee(A,M),J<j&&(J=j),ee[j]++,M+=3;var xe=0;for(ee[0]=0,pe=1;pe<=J;++pe)re[pe]=xe=xe+ee[pe-1]<<1;for(pe=0;pe<ce;++pe)(xe=Z[pe])!=0&&(se[pe]=re[xe]++);var de=0;for(pe=0;pe<ce;++pe)if(de=Z[pe],de!=0){xe=ne[se[pe]]>>8-de;for(var ge=(1<<7-de)-1;ge>=0;--ge)zt[xe|ge<<de]=de&7|pe<<3}var Ie=[];for(J=1;Ie.length<O+N;)switch(xe=zt[fe(A,M)],M+=xe&7,xe>>>=3){case 16:for(j=3+Se(A,M),M+=2,xe=Ie[Ie.length-1];j-- >0;)Ie.push(xe);break;case 17:for(j=3+Ee(A,M),M+=3;j-- >0;)Ie.push(0);break;case 18:for(j=11+fe(A,M),M+=7;j-- >0;)Ie.push(0);break;default:Ie.push(xe),J<xe&&(J=xe);break}var ft=Ie.slice(0,O),ht=Ie.slice(O);for(pe=O;pe<286;++pe)ft[pe]=0;for(pe=N;pe<30;++pe)ht[pe]=0;return xa=hn(ft,ct,286),fy=hn(ht,qt,30),M}function aI(A,M){if(A[0]==3&&!(A[1]&3))return[sa(M),2];for(var O=0,N=0,L=p_(M||1<<18),j=0,Z=L.length>>>0,se=0,J=0;!(N&1);){if(N=Ee(A,O),O+=3,N>>>1)N>>1==1?(se=9,J=5):(O=sI(A,O),se=xa,J=fy);else{O&7&&(O+=8-(O&7));var ee=A[O>>>3]|A[(O>>>3)+1]<<8;if(O+=32,ee>0)for(!M&&Z<j+ee&&(L=Lt(L,j+ee),Z=L.length);ee-- >0;)L[j++]=A[O>>>3],O+=8;continue}for(;;){!M&&Z<j+32767&&(L=Lt(L,j+32767),Z=L.length);var re=tt(A,O,se),ce=N>>>1==1?kr[re]:ct[re];if(O+=ce&15,ce>>>=4,!(ce>>>8&255))L[j++]=ce;else{if(ce==256)break;ce-=257;var pe=ce<8?0:ce-4>>2;pe>5&&(pe=0);var xe=j+Y[ce];pe>0&&(xe+=tt(A,O,pe),O+=pe),re=tt(A,O,J),ce=N>>>1==1?pn[re]:qt[re],O+=ce&15,ce>>>=4;var de=ce<4?0:ce-2>>1,ge=te[ce];for(de>0&&(ge+=tt(A,O,de),O+=de),!M&&Z<xe&&(L=Lt(L,xe+100),Z=L.length);j<xe;)L[j]=L[j-ge],++j}}}return M?[L,O+7>>>3]:[L.slice(0,j),O+7>>>3]}function hy(A,M){var O=A.slice(A.l||0),N=aI(O,M);return A.l+=N[1],N[0]}function py(A,M){if(A)typeof console<"u"&&console.error(M);else throw new Error(M)}function my(A,M){var O=A;nr(O,0);var N=[],L=[],j={FileIndex:N,FullPaths:L};S(j,{root:M.root});for(var Z=O.length-4;(O[Z]!=80||O[Z+1]!=75||O[Z+2]!=5||O[Z+3]!=6)&&Z>=0;)--Z;O.l=Z+4,O.l+=4;var se=O.read_shift(2);O.l+=6;var J=O.read_shift(4);for(O.l=J,Z=0;Z<se;++Z){O.l+=20;var ee=O.read_shift(4),re=O.read_shift(4),ce=O.read_shift(2),pe=O.read_shift(2),xe=O.read_shift(2);O.l+=8;var de=O.read_shift(4),ge=o(O.slice(O.l+ce,O.l+ce+pe));O.l+=ce+pe+xe;var Ie=O.l;O.l=de+4,oI(O,ee,re,j,ge),O.l=Ie}return j}function oI(A,M,O,N,L){A.l+=2;var j=A.read_shift(2),Z=A.read_shift(2),se=a(A);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var J=A.read_shift(4),ee=A.read_shift(4),re=A.read_shift(4),ce=A.read_shift(2),pe=A.read_shift(2),xe="",de=0;de<ce;++de)xe+=String.fromCharCode(A[A.l++]);if(pe){var ge=o(A.slice(A.l,A.l+pe));(ge[21589]||{}).mt&&(se=ge[21589].mt),((L||{})[21589]||{}).mt&&(se=L[21589].mt)}A.l+=pe;var Ie=A.slice(A.l,A.l+ee);switch(Z){case 8:Ie=V(A,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var ft=!1;j&8&&(J=A.read_shift(4),J==134695760&&(J=A.read_shift(4),ft=!0),ee=A.read_shift(4),re=A.read_shift(4)),ee!=M&&py(ft,"Bad compressed size: "+M+" != "+ee),re!=O&&py(ft,"Bad uncompressed size: "+O+" != "+re),ap(N,xe,Ie,{unsafe:!0,mt:se})}function lI(A,M){var O=M||{},N=[],L=[],j=Bt(1),Z=O.compression?8:0,se=0,J=0,ee=0,re=0,ce=0,pe=A.FullPaths[0],xe=pe,de=A.FileIndex[0],ge=[],Ie=0;for(J=1;J<A.FullPaths.length;++J)if(xe=A.FullPaths[J].slice(pe.length),de=A.FileIndex[J],!(!de.size||!de.content||xe=="Sh33tJ5")){var ft=re,ht=Bt(xe.length);for(ee=0;ee<xe.length;++ee)ht.write_shift(1,xe.charCodeAt(ee)&127);ht=ht.slice(0,ht.l),ge[ce]=GV.buf(de.content,0);var ur=de.content;Z==8&&(ur=B(ur)),j=Bt(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,se),j.write_shift(2,Z),de.mt?s(j,de.mt):j.write_shift(4,0),j.write_shift(-4,ge[ce]),j.write_shift(4,ur.length),j.write_shift(4,de.content.length),j.write_shift(2,ht.length),j.write_shift(2,0),re+=j.length,N.push(j),re+=ht.length,N.push(ht),re+=ur.length,N.push(ur),j=Bt(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,se),j.write_shift(2,Z),j.write_shift(4,0),j.write_shift(-4,ge[ce]),j.write_shift(4,ur.length),j.write_shift(4,de.content.length),j.write_shift(2,ht.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,ft),Ie+=j.l,L.push(j),Ie+=ht.length,L.push(ht),++ce}return j=Bt(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,ce),j.write_shift(2,ce),j.write_shift(4,Ie),j.write_shift(4,re),j.write_shift(2,0),Es([Es(N),Es(L),j])}var Pd={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function cI(A,M){if(A.ctype)return A.ctype;var O=A.name||"",N=O.match(/\.([^\.]+)$/);return N&&Pd[N[1]]||M&&(N=(O=M).match(/[\.\\]([^\.\\])+$/),N&&Pd[N[1]])?Pd[N[1]]:"application/octet-stream"}function uI(A){for(var M=h_(A),O=[],N=0;N<M.length;N+=76)O.push(M.slice(N,N+76));return O.join(`\r
`)+`\r
`}function dI(A){var M=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var re=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],N=M.split(`\r
`),L=0;L<N.length;++L){var j=N[L];if(j.length==0){O.push("");continue}for(var Z=0;Z<j.length;){var se=76,J=j.slice(Z,Z+se);J.charAt(se-1)=="="?se--:J.charAt(se-2)=="="?se-=2:J.charAt(se-3)=="="&&(se-=3),J=j.slice(Z,Z+se),Z+=se,Z<j.length&&(J+="="),O.push(J)}}return O.join(`\r
`)}function fI(A){for(var M=[],O=0;O<A.length;++O){for(var N=A[O];O<=A.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+A[++O];M.push(N)}for(var L=0;L<M.length;++L)M[L]=M[L].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return Qn(M.join(`\r
`))}function hI(A,M,O){for(var N="",L="",j="",Z,se=0;se<10;++se){var J=M[se];if(!J||J.match(/^\s*$/))break;var ee=J.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":N=ee[2].trim();break;case"content-type":j=ee[2].trim();break;case"content-transfer-encoding":L=ee[2].trim();break}}switch(++se,L.toLowerCase()){case"base64":Z=Qn(un(M.slice(se).join("")));break;case"quoted-printable":Z=fI(M.slice(se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var re=ap(A,N.slice(O.length),Z,{unsafe:!0});j&&(re.ctype=j)}function pI(A,M){if(z(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=M&&M.root||"",N=($e&&Buffer.isBuffer(A)?A.toString("binary"):z(A)).split(`\r
`),L=0,j="";for(L=0;L<N.length;++L)if(j=N[L],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),O||(O=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),j.slice(0,O.length)!=O););var Z=(N[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var se="--"+(Z[1]||""),J=[],ee=[],re={FileIndex:J,FullPaths:ee};S(re);var ce,pe=0;for(L=0;L<N.length;++L){var xe=N[L];xe!==se&&xe!==se+"--"||(pe++&&hI(re,N.slice(ce,L),O),ce=L)}return re}function mI(A,M){var O=M||{},N=O.boundary||"SheetJS";N="------="+N;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],j=A.FullPaths[0],Z=j,se=A.FileIndex[0],J=1;J<A.FullPaths.length;++J)if(Z=A.FullPaths[J].slice(j.length),se=A.FileIndex[J],!(!se.size||!se.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var ee=se.content,re=$e&&Buffer.isBuffer(ee)?ee.toString("binary"):z(ee),ce=0,pe=Math.min(1024,re.length),xe=0,de=0;de<=pe;++de)(xe=re.charCodeAt(de))>=32&&xe<128&&++ce;var ge=ce>=pe*4/5;L.push(N),L.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+Z),L.push("Content-Transfer-Encoding: "+(ge?"quoted-printable":"base64")),L.push("Content-Type: "+cI(se,Z)),L.push(""),L.push(ge?dI(re):uI(re))}return L.push(N+`--\r
`),L.join(`\r
`)}function gI(A){var M={};return S(M,A),M}function ap(A,M,O,N){var L=N&&N.unsafe;L||S(A);var j=!L&&Ve.find(A,M);if(!j){var Z=A.FullPaths[0];M.slice(0,Z.length)==Z?Z=M:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+M).replace("//","/")),j={name:i(M),type:2},A.FileIndex.push(j),A.FullPaths.push(Z),L||Ve.utils.cfb_gc(A)}return j.content=O,j.size=O?O.length:0,N&&(N.CLSID&&(j.clsid=N.CLSID),N.mt&&(j.mt=N.mt),N.ct&&(j.ct=N.ct)),j}function vI(A,M){S(A);var O=Ve.find(A,M);if(O){for(var N=0;N<A.FileIndex.length;++N)if(A.FileIndex[N]==O)return A.FileIndex.splice(N,1),A.FullPaths.splice(N,1),!0}return!1}function xI(A,M,O){S(A);var N=Ve.find(A,M);if(N){for(var L=0;L<A.FileIndex.length;++L)if(A.FileIndex[L]==N)return A.FileIndex[L].name=i(O),A.FullPaths[L]=O,!0}return!1}function yI(A){T(A,!0)}return t.find=I,t.read=k,t.parse=u,t.write=ie,t.writeFile=G,t.utils={cfb_new:gI,cfb_add:ap,cfb_del:vI,cfb_mov:xI,cfb_gc:yI,ReadShift:du,CheckField:tO,prep_blob:nr,bconcat:Es,use_zlib:D,_deflateRaw:me,_inflateRaw:hy,consts:Q},t}();function KV(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ai(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Hx(e){for(var t=[],r=Ai(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var n0=new Date(1899,11,30,0,0,0);function Mr(e,t){var r=e.getTime(),n=n0.getTime()+(e.getTimezoneOffset()-n0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var NP=new Date,qV=n0.getTime()+(NP.getTimezoneOffset()-n0.getTimezoneOffset())*6e4,__=NP.getTimezoneOffset();function rp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+qV),t.getTimezoneOffset()!==__&&t.setTime(t.getTime()+(t.getTimezoneOffset()-__)*6e4),t}function XV(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var S_=new Date("2017-02-19T19:06:09.000Z"),FP=isNaN(S_.getFullYear())?new Date("2/19/17"):S_,YV=FP.getFullYear()==2017;function er(e,t){var r=new Date(e);if(YV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(FP.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xo(e,t){if($e&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return qc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return qc(bP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return qc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return qc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ar(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ar(e[r]));return t}function bt(e,t){for(var r="";r.length<t;)r+=e;return r}function ni(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var QV=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&QV.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var JV=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function MP(e){return e?e.content&&e.type?xo(e.content,!0):e.data?Wc(e.data):e.asNodeBuffer&&$e?Wc(e.asNodeBuffer().toString("binary")):e.asBinary?Wc(e.asBinary()):e._data&&e._data.getContent?Wc(xo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function LP(e){if(!e)return null;if(e.data)return d_(e.data);if(e.asNodeBuffer&&$e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?d_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ZV(e){return e&&e.name.slice(-4)===".bin"?LP(e):MP(e)}function xn(e,t){for(var r=e.FullPaths||Ai(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Wx(e,t){var r=xn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function It(e,t,r){if(!r)return ZV(Wx(e,t));if(!t)return null;try{return It(e,t)}catch{return null}}function rn(e,t,r){if(!r)return MP(Wx(e,t));if(!t)return null;try{return rn(e,t)}catch{return null}}function eH(e,t,r){return LP(Wx(e,t))}function E_(e){for(var t=e.FullPaths||Ai(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function tH(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return $e?n=To(r):n=wV(r),Ve.utils.cfb_add(e,t,n)}Ve.utils.cfb_add(e,t,r)}else e.file(t,r)}function zP(e,t){switch(t.type){case"base64":return Ve.read(e,{type:"base64"});case"binary":return Ve.read(e,{type:"binary"});case"buffer":case"array":return Ve.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Kc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var jP=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rH=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,T_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nH=/<[^>]*>/g,Tr=jP.match(T_)?T_:nH,iH=/<\w*:/,sH=/<(\/?)\w+:/;function Ae(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(rH),o=0,l="",c=0,u="",d="",f=1;if(a)for(c=0;c!=a.length;++c){for(d=a[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(u=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(f=(i=d.charCodeAt(s+1))==34||i==39?1:0,l=d.slice(s+1+f,d.length-f),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Pi(e){return e.replace(sH,"<$1")}var BP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},aH=Hx(BP),Ge=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,l){return BP[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),oH=/[&<>'"]/g,lH=/[\u0000-\u001f]/g;function Gx(e){var t=e+"";return t.replace(oH,function(r){return aH[r]}).replace(/\n/g,"<br/>").replace(lH,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var k_=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function ut(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sm(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function C_(e){var t=sa(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function A_(e){return To(e,"binary").toString("utf8")}var Af="foo bar baz",it=$e&&(A_(Af)==Sm(Af)&&A_||C_(Af)==Sm(Af)&&C_)||Sm,qc=$e?function(e){return To(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Zu=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),UP=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),cH=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),uH=/<\/?(?:vt:)?variant>/g,dH=/<(?:vt:)([^>]*)>([\s\S]*)</;function R_(e,t){var r=Ae(e),n=e.match(cH(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(uH,"").match(dH);a&&i.push({v:it(a[2]),t:a[1]})}),i}var fH=/(^\s|\s$|\n)/;function hH(e){return Ai(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function pH(e,t,r){return"<"+e+(r!=null?hH(r):"")+(t!=null?(t.match(fH)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Kx(e){if($e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return it(ko(Ux(e)));throw new Error("Bad input format: expected Buffer or string")}var ed=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,mH={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gH=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function vH(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function xH(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var P_=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},O_=$e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:To(t)})):P_(e)}:P_,I_=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Gi(e,i)));return n.join("").replace(Fr,"")},qx=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Fr,""):I_(e,t,r)}:I_,D_=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},$P=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):D_(e,t,r)}:D_,N_=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Wo(e,i)));return n.join("")},Ed=$e?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):N_(t,r,n)}:N_,VP=function(e,t){var r=Zr(e,t);return r>0?Ed(e,t+4,t+4+r-1):""},HP=VP,WP=function(e,t){var r=Zr(e,t);return r>0?Ed(e,t+4,t+4+r-1):""},GP=WP,KP=function(e,t){var r=2*Zr(e,t);return r>0?Ed(e,t+4,t+4+r-1):""},qP=KP,XP=function(t,r){var n=Zr(t,r);return n>0?qx(t,r+4,r+4+n):""},YP=XP,QP=function(e,t){var r=Zr(e,t);return r>0?Ed(e,t+4,t+4+r):""},JP=QP,ZP=function(e,t){return vH(e,t)},i0=ZP,eO=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};$e&&(HP=function(t,r){if(!Buffer.isBuffer(t))return VP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},GP=function(t,r){if(!Buffer.isBuffer(t))return WP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},qP=function(t,r){if(!Buffer.isBuffer(t))return KP(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},YP=function(t,r){if(!Buffer.isBuffer(t))return XP(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},JP=function(t,r){if(!Buffer.isBuffer(t))return QP(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},i0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):ZP(t,r)},eO=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wo=function(e,t){return e[t]},Gi=function(e,t){return e[t+1]*256+e[t]},yH=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Na=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},wH=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function du(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,$e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Gi(this,c)),c+=2;e*=2;break;case"utf8":r=Ed(this,this.l,this.l+e);break;case"utf16le":e*=2,r=qx(this,this.l,this.l+e);break;case"wstr":return du.call(this,e,"dbcs");case"lpstr-ansi":r=HP(this,this.l),e=4+Zr(this,this.l);break;case"lpstr-cp":r=GP(this,this.l),e=4+Zr(this,this.l);break;case"lpwstr":r=qP(this,this.l),e=4+2*Zr(this,this.l);break;case"lpp4":e=4+Zr(this,this.l),r=YP(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zr(this,this.l),r=JP(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Wo(this,this.l+e++))!==0;)s.push(Cf(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=Gi(this,this.l+e))!==0;)s.push(Cf(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Wo(this,c),this.l=c+1,o=du.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Cf(Gi(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Wo(this,c),this.l=c+1,o=du.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Cf(Wo(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Wo(this,this.l),this.l++,n;case 2:return n=(t==="i"?yH:Gi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Na:wH)(this,this.l),this.l+=4,n):(i=Zr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=i0(this,this.l):i=i0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=$P(this,this.l,e);break}}return this.l+=e,r}var bH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},_H=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},SH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function EH(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)SH(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,bH(this,t,this.l);break;case 8:if(n=8,r==="f"){xH(this,t,this.l);break}case 16:break;case-4:n=4,_H(this,t,this.l);break}return this.l+=n,this}function tO(e,t){var r=$P(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function nr(e,t){e.l=t,e.read_shift=du,e.chk=tO,e.write_shift=EH}function Er(e,t){e.l+=t}function Bt(e){var t=sa(e);return nr(t,0),t}function os(e,t,r){if(e){var n,i,s;nr(e,e.l||0);for(var a=e.length,o=0,l=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=u0[o]||u0[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function kv(){var e=[],t=$e?256:2048,r=function(c){var u=Bt(c);return nr(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),Es(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function fu(e,t,r){var n=ar(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function F_(e,t,r){var n=ar(e);return n.s=fu(n.s,t.s,r),n.e=fu(n.e,t.s,r),n}function hu(e,t){if(e.cRel&&e.c<0)for(e=ar(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ar(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Oe(e);return!e.cRel&&e.cRel!=null&&(r=CH(r)),!e.rRel&&e.rRel!=null&&(r=TH(r)),r}function Em(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wt(e.s.c)+":"+(e.e.cRel?"":"$")+Wt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+or(e.s.r)+":"+(e.e.rRel?"":"$")+or(e.e.r):hu(e.s,t.biff)+":"+hu(e.e,t.biff)}function Xx(e){return parseInt(kH(e),10)-1}function or(e){return""+(e+1)}function TH(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function kH(e){return e.replace(/\$(\d+)$/,"$1")}function Yx(e){for(var t=AH(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function CH(e){return e.replace(/^([A-Z])/,"$$$1")}function AH(e){return e.replace(/^\$([A-Z])/,"$1")}function RH(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Oe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function pc(e){var t=e.indexOf(":");return t==-1?{s:Dr(e),e:Dr(e)}:{s:Dr(e.slice(0,t)),e:Dr(e.slice(t+1))}}function He(e,t){return typeof t>"u"||typeof t=="number"?He(e.s,e.e):(typeof e!="string"&&(e=Oe(e)),typeof t!="string"&&(t=Oe(t)),e==t?e:e+":"+t)}function _t(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function M_(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dn(e.z,r?Mr(t):t)}catch{}try{return e.w=Dn((e.XF||{}).numFmtId||(r?14:0),r?Mr(t):t)}catch{return""+t}}function is(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ro[e.v]||e.v:t==null?M_(e,e.v):M_(e,t))}function va(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function rO(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=_t(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[d].length;++f)if(!(typeof t[d][f]>"u")){var p={v:t[d][f]},m=a+d,h=o+f;if(c.s.r>m&&(c.s.r=m),c.s.c>h&&(c.s.c=h),c.e.r<m&&(c.e.r=m),c.e.c<h&&(c.e.c=h),t[d][f]&&typeof t[d][f]=="object"&&!Array.isArray(t[d][f])&&!(t[d][f]instanceof Date))p=t[d][f];else if(Array.isArray(p.v)&&(p.f=t[d][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||De[14],n.cellDates?(p.t="d",p.w=Dn(p.z,Mr(p.v))):(p.t="n",p.v=Mr(p.v),p.w=Dn(p.z,p.v))):p.t="s";if(i)s[m]||(s[m]=[]),s[m][h]&&s[m][h].z&&(p.z=s[m][h].z),s[m][h]=p;else{var g=Oe({c:h,r:m});s[g]&&s[g].z&&(p.z=s[g].z),s[g]=p}}}return c.s.c<1e7&&(s["!ref"]=He(c)),s}function mc(e,t){return rO(null,e,t)}function PH(e){return e.read_shift(4,"i")}function br(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function OH(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Qx(e,t){var r=e.l,n=e.read_shift(1),i=br(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(OH(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var IH=Qx;function Fn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Co(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var DH=br;function Jx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var NH=br,Cv=Jx;function Zx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?i0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Na(t,0)>>2;return r?i/100:i}function nO(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ao=nO;function xr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function FH(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=ro[i];c&&(t.rgb=rd(c));break;case 2:t.rgb=rd([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function MH(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function iO(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function LH(e){return iO(e,1)}function zH(e){return iO(e,2)}var ey=2,$r=3,Rf=11,L_=12,s0=19,Pf=64,jH=65,BH=71,UH=4108,$H=4126,Xt=80,sO=81,VH=[Xt,sO],HH={1:{n:"CodePage",t:ey},2:{n:"Category",t:Xt},3:{n:"PresentationFormat",t:Xt},4:{n:"ByteCount",t:$r},5:{n:"LineCount",t:$r},6:{n:"ParagraphCount",t:$r},7:{n:"SlideCount",t:$r},8:{n:"NoteCount",t:$r},9:{n:"HiddenCount",t:$r},10:{n:"MultimediaClipCount",t:$r},11:{n:"ScaleCrop",t:Rf},12:{n:"HeadingPairs",t:UH},13:{n:"TitlesOfParts",t:$H},14:{n:"Manager",t:Xt},15:{n:"Company",t:Xt},16:{n:"LinksUpToDate",t:Rf},17:{n:"CharacterCount",t:$r},19:{n:"SharedDoc",t:Rf},22:{n:"HyperlinksChanged",t:Rf},23:{n:"AppVersion",t:$r,p:"version"},24:{n:"DigSig",t:jH},26:{n:"ContentType",t:Xt},27:{n:"ContentStatus",t:Xt},28:{n:"Language",t:Xt},29:{n:"Version",t:Xt},255:{},2147483648:{n:"Locale",t:s0},2147483651:{n:"Behavior",t:s0},1919054434:{}},WH={1:{n:"CodePage",t:ey},2:{n:"Title",t:Xt},3:{n:"Subject",t:Xt},4:{n:"Author",t:Xt},5:{n:"Keywords",t:Xt},6:{n:"Comments",t:Xt},7:{n:"Template",t:Xt},8:{n:"LastAuthor",t:Xt},9:{n:"RevNumber",t:Xt},10:{n:"EditTime",t:Pf},11:{n:"LastPrinted",t:Pf},12:{n:"CreatedDate",t:Pf},13:{n:"ModifiedDate",t:Pf},14:{n:"PageCount",t:$r},15:{n:"WordCount",t:$r},16:{n:"CharCount",t:$r},17:{n:"Thumbnail",t:BH},18:{n:"Application",t:Xt},19:{n:"DocSecurity",t:$r},255:{},2147483648:{n:"Locale",t:s0},2147483651:{n:"Behavior",t:s0},1919054434:{}},z_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},GH=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function KH(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var qH=KH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ro=ar(qH),Ro={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},aO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},j_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function XH(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function YH(e){var t=XH();if(!e||!e.match)return t;var r={};if((e.match(Tr)||[]).forEach(function(n){var i=Ae(n);switch(i[0].replace(iH,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[j_[i.ContentType]]!==void 0&&t[j_[i.ContentType]].push(i.PartName);break}}),t.xmlns!==mH.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var il={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Av(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function pu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Tr)||[]).forEach(function(i){var s=Ae(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Kc(s.Target,t);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var QH="application/vnd.oasis.opendocument.spreadsheet";function JH(e,t){for(var r=Kx(e),n,i;n=ed.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ae(n[0],!1),i.path=="/"&&i.type!==QH)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var mu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ZH=function(){for(var e=new Array(mu.length),t=0;t<mu.length;++t){var r=mu[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function oO(e){var t={};e=it(e);for(var r=0;r<mu.length;++r){var n=mu[r],i=e.match(ZH[r]);i!=null&&i.length>0&&(t[n[1]]=Ge(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=er(t[n[1]]))}return t}var eW=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function lO(e,t,r,n){var i=[];if(typeof e=="string")i=R_(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var a=typeof t=="string"?R_(t,n).map(function(u){return u.v}):t,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function tW(e,t,r){var n={};return t||(t={}),e=it(e),eW.forEach(function(i){var s=(e.match(Zu(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Ge(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&lO(n.HeadingPairs,n.TitlesOfParts,t,r),t}var rW=/<[^>]+>[^<]*/g;function nW(e,t){var r={},n="",i=e.match(rW);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Ae(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ge(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ge(u);break;case"bool":r[n]=ut(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=er(u);break;case"cy":case"error":r[n]=Ge(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}var iW={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tm;function sW(e,t,r){Tm||(Tm=Hx(iW)),t=Tm[t]||t,e[t]=r}function ty(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function cO(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function uO(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function dO(e,t,r){return t===31?uO(e):cO(e,t,r)}function Rv(e,t,r){return dO(e,t,r===!1?0:4)}function aW(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return dO(e,t,0)}function oW(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Fr,""),e.l-i&2&&(e.l+=2)}return r}function lW(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Fr,"");return r}function cW(e){var t=e.l,r=a0(e,sO);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=a0(e,$r);return[r,n]}function uW(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(cW(e));return r}function B_(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),a=e.read_shift(4);n[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(Fr,"").replace(Gc,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function fO(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function dW(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function a0(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==L_&&n!==t&&VH.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===L_?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return cO(e,n,4).replace(Fr,"");case 31:return uO(e);case 64:return ty(e);case 65:return fO(e);case 71:return dW(e);case 80:return Rv(e,n,!s.raw).replace(Fr,"");case 81:return aW(e,n).replace(Fr,"");case 4108:return uW(e);case 4126:case 4127:return n==4127?oW(e):lW(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function U_(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var u=e.read_shift(4),d=e.read_shift(4);s[a]=[u,d+r]}s.sort(function(w,y){return w[1]-y[1]});var f={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var p=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],p=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],p=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(p=!1,e.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var m=t[s[a][0]];if(f[m.n]=a0(e,m.t,{raw:!0}),m.p==="version"&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(f[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zn(o=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(s[a][0]===1){if(o=f.CodePage=a0(e,ey),Zn(o),l!==-1){var h=e.l;e.l=s[l][1],c=B_(e,o),e.l=h}}else if(s[a][0]===0){if(o===0){l=a,e.l=s[a+1][1];continue}c=B_(e,o)}else{var g=c[s[a][0]],v;switch(e[e.l]){case 65:e.l+=4,v=fO(e);break;case 30:e.l+=4,v=Rv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Rv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Tt(e,4);break;case 64:e.l+=4,v=er(ty(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=v}}return e.l=r+n,f}function $_(e,t,r){var n=e.content;if(!n)return{};nr(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Ve.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var d=U_(n,t),f={SystemIdentifier:c};for(var p in d)f[p]=d[p];if(f.FMTID=s,i===1)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=U_(n,null)}catch{}for(p in m)f[p]=m[p];return f.FMTID=[s,a],f}function fs(e,t){return e.read_shift(t),null}function fW(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Tt(e,t){return e.read_shift(t)===1}function Dt(e){return e.read_shift(2,"u")}function hO(e,t){return fW(e,t,Dt)}function hW(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Td(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function pW(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*a),n&&(e.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function yo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function kd(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):yo(e,n,r)}function Po(e,t,r){if(r.biff>5)return kd(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mW(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function gW(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Fr,"");return n&&(e.l+=24),i}function vW(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(Fr,"");return r+a}function xW(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return gW(e);case"0303000000000000c000000000000046":return vW(e);default:throw new Error("Unsupported Moniker "+r)}}function Of(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Fr,""):"";return r}function yW(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,a,o,l,c="",u,d;i&16&&(s=Of(e,r-e.l)),i&128&&(a=Of(e,r-e.l)),(i&257)===257&&(o=Of(e,r-e.l)),(i&257)===1&&(l=xW(e,r-e.l)),i&8&&(c=Of(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(d=ty(e)),e.l=r;var f=a||o||l||"";f&&c&&(f+="#"+c),f||(f="#"+c),i&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var p={Target:f};return u&&(p.guid=u),d&&(p.time=d),s&&(p.Tooltip=s),p}function pO(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function mO(e,t){var r=pO(e);return r[3]=0,r}function Oi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function wW(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function bW(e,t,r){return t===0?"":Po(e,t,r)}function _W(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function gO(e){var t=e.read_shift(2),r=Zx(e);return[t,r]}function SW(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Td(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function np(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function vO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var EW=vO;function xO(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function TW(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function kW(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function hr(e){e.l+=2,e.l+=e.read_shift(2)}var CW={0:hr,4:hr,5:hr,6:hr,7:kW,8:hr,9:hr,10:hr,11:hr,12:hr,13:TW,14:hr,15:hr,16:hr,17:hr,18:hr,19:hr,20:hr,21:xO};function AW(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(CW[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function If(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function RW(e,t){return t===0||e.read_shift(2),1200}function PW(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Po(e,0,r);return e.read_shift(t+n-e.l),i}function OW(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function IW(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Td(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function DW(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<r;++a)s.push(pW(e));return s.Count=n,s.Unique=i,s}function NW(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function FW(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function MW(e){var t=wW(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function LW(e){return e.read_shift(2),e.read_shift(4)}function V_(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function zW(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function jW(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function BW(){}function UW(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Td(e,0,r),n}function $W(e){var t=Oi(e);return t.isst=e.read_shift(4),t}function VW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Oi(e);r.biff==2&&e.l++;var s=kd(e,n-e.l,r);return i.val=s,i}function HW(e,t,r){var n=e.read_shift(2),i=Po(e,0,r);return[n,i]}var WW=Po;function H_(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function GW(e){var t=e.read_shift(2),r=e.read_shift(2),n=gO(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function KW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(gO(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function qW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function XW(e,t,r,n){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=GH[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function YW(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=XW(e,t,n.fStyle,r),n}function QW(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function W_(e,t,r){var n=Oi(e);(r.biff==2||t==9)&&++e.l;var i=hW(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function JW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Oi(e),i=xr(e);return n.val=i,n}var G_=bW;function ZW(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=yo(e,s),o=[];n>e.l;)o.push(kd(e));return[s,i,a,o]}function K_(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=SW(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var eG=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function q_(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=yo(e,a,r);i&32&&(c=eG[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var d=n==e.l||o===0||!(u>0)?[]:FX(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function yO(e,t,r){if(r.biff<8)return tG(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(_W(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function tG(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Td(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function rG(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=yo(e,n,r),a=yo(e,i,r);return[s,a]}function nG(e,t,r){var n=vO(e);e.l++;var i=e.read_shift(1);return t-=8,[MX(e,t,r),i,n]}function X_(e,t,r){var n=EW(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,DX(e,t,r)]}function iG(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function sG(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=Po(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,a,s]}}function aG(e,t,r){return sG(e,t,r)}function oG(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(np(e));return r}function lG(e,t,r){if(r&&r.biff<8)return uG(e,t,r);var n=xO(e),i=AW(e,t-22,n[1]);return{cmo:n,ft:i}}var cG={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function uG(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((cG[n]||Er)(e,t,r)),{cmo:[i,n,s],ft:a}}function dG(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=mW(e,6,r);var o=e.read_shift(2);e.read_shift(2),Dt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=yo(e,e.lens[c+1]-e.lens[c]-1);if(i+=d,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function fG(e,t){var r=np(e);e.l+=16;var n=yW(e,t-24);return[r,n]}function hG(e,t){e.read_shift(2);var r=np(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Fr,""),[r,n]}function pG(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=z_[r]||r,r=e.read_shift(2),t[1]=z_[r]||r,t}function mG(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(mO(e));return r}function gG(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(mO(e));return r}function vG(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function wO(e,t,r){if(!r.cellStyles)return Er(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function xG(e,t){var r={};return t<32||(e.l+=16,r.header=xr(e),r.footer=xr(e),e.l+=2),r}function yG(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var wG=Oi,bG=hO,_G=kd;function SG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function EG(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Oi(e);++e.l;var i=Po(e,t-7,r);return n.t="str",n.val=i,n}function TG(e){var t=Oi(e);++e.l;var r=xr(e);return t.t="n",t.val=r,t}function kG(e){var t=Oi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function CG(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function AG(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function RG(e,t,r){var n=e.l+t,i=Oi(e),s=e.read_shift(2),a=yo(e,s,r);return e.l=n,i.t="str",i.val=a,i}var PG=[2,3,48,49,131,139,140,245],Y_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Hx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=sa(1);switch(l.type){case"base64":u=Qn(un(o));break;case"binary":u=Qn(o);break;case"buffer":case"array":u=o;break}nr(u,0);var d=u.read_shift(1),f=!!(d&136),p=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var h=0,g=521;d==2&&(h=u.read_shift(2)),u.l+=3,d!=2&&(h=u.read_shift(4)),h>1048576&&(h=1e6),d!=2&&(g=u.read_shift(2));var v=u.read_shift(2),w=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var y=[],b={},E=Math.min(u.length,d==2?521:g-10-(p?264:0)),k=m?32:11;u.l<E&&u[u.l]!=13;)switch(b={},b.name=Ss.utils.decode(w,u.slice(u.l,u.l+k)).replace(/[\u0000\r\n].*$/g,""),u.l+=k,b.type=String.fromCharCode(u.read_shift(1)),d!=2&&!m&&(b.offset=u.read_shift(4)),b.len=u.read_shift(1),d==2&&(b.offset=u.read_shift(2)),b.dec=u.read_shift(1),b.name.length&&y.push(b),d!=2&&(u.l+=m?13:14),b.type){case"B":(!p||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var S=0,C=0;for(c[0]=[],C=0;C!=y.length;++C)c[0][C]=y[C].name;for(;h-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++S]=[],C=0,C=0;C!=y.length;++C){var T=u.slice(u.l,u.l+y[C].len);u.l+=y[C].len,nr(T,0);var P=Ss.utils.decode(w,T);switch(y[C].type){case"C":P.trim().length&&(c[S][C]=P.replace(/\s+$/,""));break;case"D":P.length===8?c[S][C]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):c[S][C]=P;break;case"F":c[S][C]=parseFloat(P.trim());break;case"+":case"I":c[S][C]=m?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":c[S][C]=!0;break;case"N":case"F":c[S][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[S][C]="##MEMO##"+(m?parseInt(P.trim(),10):T.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(c[S][C]=+P||0);break;case"@":c[S][C]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[S][C]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[S][C]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][C]=-T.read_shift(-8,"f");break;case"B":if(p&&y[C].len==8){c[S][C]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[C].len;break;case"0":if(y[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[C].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=mc(r(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function i(o,l){try{return va(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Zn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=kv(),d=Mv(o,{header:1,raw:!0,cellDates:!0}),f=d[0],p=d.slice(1),m=o["!cols"]||[],h=0,g=0,v=0,w=1;for(h=0;h<f.length;++h){if(((m[h]||{}).DBF||{}).name){f[h]=m[h].DBF.name,++v;continue}if(f[h]!=null){if(++v,typeof f[h]=="number"&&(f[h]=f[h].toString(10)),typeof f[h]!="string")throw new Error("DBF Invalid column name "+f[h]+" |"+typeof f[h]+"|");if(f.indexOf(f[h])!==h){for(g=0;g<1024;++g)if(f.indexOf(f[h]+"_"+g)==-1){f[h]+="_"+g;break}}}}var y=_t(o["!ref"]),b=[],E=[],k=[];for(h=0;h<=y.e.c-y.s.c;++h){var S="",C="",T=0,P=[];for(g=0;g<p.length;++g)p[g][h]!=null&&P.push(p[g][h]);if(P.length==0||f[h]==null){b[h]="?";continue}for(g=0;g<P.length;++g){switch(typeof P[g]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=P[g]instanceof Date?"D":"C";break;default:C="C"}T=Math.max(T,String(P[g]).length),S=S&&S!=C?"C":C}T>250&&(T=250),C=((m[h]||{}).DBF||{}).type,C=="C"&&m[h].DBF.len>T&&(T=m[h].DBF.len),S=="B"&&C=="N"&&(S="N",k[h]=m[h].DBF.dec,T=m[h].DBF.len),E[h]=S=="C"||C=="N"?T:s[S]||0,w+=E[h],b[h]=S}var I=u.next(32);for(I.write_shift(4,318902576),I.write_shift(4,p.length),I.write_shift(2,296+32*v),I.write_shift(2,w),h=0;h<4;++h)I.write_shift(4,0);for(I.write_shift(4,0|(+t[yP]||3)<<8),h=0,g=0;h<f.length;++h)if(f[h]!=null){var R=u.next(32),H=(f[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,H,"sbcs"),R.write_shift(1,b[h]=="?"?"C":b[h],"sbcs"),R.write_shift(4,g),R.write_shift(1,E[h]||s[b[h]]||0),R.write_shift(1,k[h]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),g+=E[h]||s[b[h]]||0}var q=u.next(264);for(q.write_shift(4,13),h=0;h<65;++h)q.write_shift(4,0);for(h=0;h<p.length;++h){var X=u.next(w);for(X.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(b[g]){case"L":X.write_shift(1,p[h][g]==null?63:p[h][g]?84:70);break;case"B":X.write_shift(8,p[h][g]||0,"f");break;case"N":var K="0";for(typeof p[h][g]=="number"&&(K=p[h][g].toFixed(k[g]||0)),v=0;v<E[g]-K.length;++v)X.write_shift(1,32);X.write_shift(1,K,"sbcs");break;case"D":p[h][g]?(X.write_shift(4,("0000"+p[h][g].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(p[h][g].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+p[h][g].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(p[h][g]!=null?p[h][g]:"").slice(0,E[g]);for(X.write_shift(1,Q,"sbcs"),v=0;v<E[g]-Q.length;++v)X.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),OG=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ai(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,p){var m=e[p];return typeof m=="number"?f_(m):m},n=function(f,p,m){var h=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return h==59?f:f_(h)};e["|"]=254;function i(f,p){switch(p.type){case"base64":return s(un(f),p);case"binary":return s(f,p);case"buffer":return s($e&&Buffer.isBuffer(f)?f.toString("binary"):ko(f),p);case"array":return s(xo(f),p)}throw new Error("Unrecognized type "+p.type)}function s(f,p){var m=f.split(/[\n\r]+/),h=-1,g=-1,v=0,w=0,y=[],b=[],E=null,k={},S=[],C=[],T=[],P=0,I;for(+p.codepage>=0&&Zn(+p.codepage);v!==m.length;++v){P=0;var R=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),H=R.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),q=H[0],X;if(R.length>0)switch(q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&b.push(R.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,Q=!1,G=!1,z=!1,ie=-1,ae=-1;for(w=1;w<H.length;++w)switch(H[w].charAt(0)){case"A":break;case"X":g=parseInt(H[w].slice(1))-1,Q=!0;break;case"Y":for(h=parseInt(H[w].slice(1))-1,Q||(g=0),I=y.length;I<=h;++I)y[I]=[];break;case"K":X=H[w].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(ni(X))?isNaN(Jl(X).getDate())||(X=er(X)):(X=ni(X),E!==null&&hc(E)&&(X=rp(X))),K=!0;break;case"E":z=!0;var D=wl(H[w].slice(1),{r:h,c:g});y[h][g]=[y[h][g],D];break;case"S":G=!0,y[h][g]=[y[h][g],"S5S"];break;case"G":break;case"R":ie=parseInt(H[w].slice(1))-1;break;case"C":ae=parseInt(H[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}if(K&&(y[h][g]&&y[h][g].length==2?y[h][g][0]=X:y[h][g]=X,E=null),G){if(z)throw new Error("SYLK shared formula cannot have own formula");var V=ie>-1&&y[ie][ae];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");y[h][g][1]=PO(V[1],{r:h-ie,c:g-ae})}break;case"F":var B=0;for(w=1;w<H.length;++w)switch(H[w].charAt(0)){case"X":g=parseInt(H[w].slice(1))-1,++B;break;case"Y":for(h=parseInt(H[w].slice(1))-1,I=y.length;I<=h;++I)y[I]=[];break;case"M":P=parseInt(H[w].slice(1))/20;break;case"F":break;case"G":break;case"P":E=b[parseInt(H[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=H[w].slice(1).split(" "),I=parseInt(T[0],10);I<=parseInt(T[1],10);++I)P=parseInt(T[2],10),C[I-1]=P===0?{hidden:!0}:{wch:P},Zl(C[I-1]);break;case"C":g=parseInt(H[w].slice(1))-1,C[g]||(C[g]={});break;case"R":h=parseInt(H[w].slice(1))-1,S[h]||(S[h]={}),P>0?(S[h].hpt=P,S[h].hpx=nd(P)):P===0&&(S[h].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}B<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}}return S.length>0&&(k["!rows"]=S),C.length>0&&(k["!cols"]=C),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,k]}function a(f,p){var m=i(f,p),h=m[0],g=m[1],v=mc(h,p);return Ai(g).forEach(function(w){v[w]=g[w]}),v}function o(f,p){return va(a(f,p),p)}function l(f,p,m,h){var g="C;Y"+(m+1)+";X"+(h+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+vq(f.f,{r:m,c:h}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(f,p){p.forEach(function(m,h){var g="F;W"+(h+1)+" "+(h+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=l0(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=c0(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,p){p.forEach(function(m,h){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*CO(m.hpx)+";"),g.length>2&&f.push(g+"R"+(h+1))})}function d(f,p){var m=["ID;PWXL;N;E"],h=[],g=_t(f["!ref"]),v,w=Array.isArray(f),y=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),f["!cols"]&&c(m,f["!cols"]),f["!rows"]&&u(m,f["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var E=g.s.c;E<=g.e.c;++E){var k=Oe({r:b,c:E});v=w?(f[b]||[])[E]:f[k],!(!v||v.v==null&&(!v.f||v.F))&&h.push(l(v,f,b,E))}return m.join(y)+y+h.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),IG=function(){function e(s,a){switch(a.type){case"base64":return t(un(s),a);case"binary":return t(s,a);case"buffer":return t($e&&Buffer.isBuffer(s)?s.toString("binary"):ko(s),a);case"array":return t(xo(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var f=o[u].trim().split(","),p=f[0],m=f[1];++u;for(var h=o[u]||"";(h.match(/["]/g)||[]).length&1&&u<o.length-1;)h+=`
`+o[++u];switch(h=h.trim(),+p){case-1:if(h==="BOT"){d[++l]=[],c=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?d[l][c]=!0:h==="FALSE"?d[l][c]=!1:isNaN(ni(m))?isNaN(Jl(m).getDate())?d[l][c]=m:d[l][c]=er(m):d[l][c]=ni(m),++c;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),d[l][c++]=h!==""?h:null;break}if(h==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(s,a){return mc(e(s,a),a)}function n(s,a){return va(r(s,a),a)}var i=function(){var s=function(l,c,u,d,f){l.push(c),l.push(u+","+d),l.push('"'+f.replace(/"/g,'""')+'"')},a=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=_t(l["!ref"]),d,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var h=Oe({r:p,c:m});if(d=f?(l[p]||[])[m]:l[h],!d){a(c,1,0,"");continue}switch(d.t){case"n":var g=d.w;!g&&d.v!=null&&(g=d.v),g==null?d.f&&!d.F?a(c,1,0,"="+d.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Dn(d.z||De[14],Mr(er(d.v)))),a(c,0,d.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var v=`\r
`,w=c.join(v);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),DG=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,f){for(var p=d.split(`
`),m=-1,h=-1,g=0,v=[];g!==p.length;++g){var w=p[g].trim().split(":");if(w[0]==="cell"){var y=Dr(w[1]);if(v.length<=y.r)for(m=v.length;m<=y.r;++m)v[m]||(v[m]=[]);switch(m=y.r,h=y.c,w[2]){case"t":v[m][h]=e(w[3]);break;case"v":v[m][h]=+w[3];break;case"vtf":var b=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[m][h]=!!+w[4];break;default:v[m][h]=+w[4];break}w[2]=="vtf"&&(v[m][h]=[v[m][h],b])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function n(d,f){return mc(r(d,f),f)}function i(d,f){return va(n(d,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var f=[],p=[],m,h="",g=pc(d["!ref"]),v=Array.isArray(d),w=g.s.r;w<=g.e.r;++w)for(var y=g.s.c;y<=g.e.c;++y)if(h=Oe({r:w,c:y}),m=v?(d[w]||[])[y]:d[h],!(!m||m.v==null||m.t==="z")){switch(p=["cell",h,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var b=Mr(er(m.v));p[2]="vtc",p[3]="nd",p[4]=""+b,p[5]=m.w||Dn(m.z||De[14],b);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(d){return[s,a,o,a,c(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),td=function(){function e(u,d,f,p,m){m.raw?d[f][p]=u:u===""||(u==="TRUE"?d[f][p]=!0:u==="FALSE"?d[f][p]=!1:isNaN(ni(u))?isNaN(Jl(u).getDate())?d[f][p]=u:d[f][p]=er(u):d[f][p]=ni(u))}function t(u,d){var f=d||{},p=[];if(!u||u.length===0)return p;for(var m=u.split(/[\r\n]/),h=m.length-1;h>=0&&m[h].length===0;)--h;for(var g=10,v=0,w=0;w<=h;++w)v=m[w].indexOf(" "),v==-1?v=m[w].length:v++,g=Math.max(g,v);for(w=0;w<=h;++w){p[w]=[];var y=0;for(e(m[w].slice(0,g).trim(),p,w,y,f),y=1;y<=(m[w].length-g)/10+1;++y)e(m[w].slice(g+(y-1)*10,g+y*10).trim(),p,w,y,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var d={},f=!1,p=0,m=0;p<u.length;++p)(m=u.charCodeAt(p))==34?f=!f:!f&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p]);if(!m.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p])}return m.sort(function(h,g){return h[0]-g[0]||n[h[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(u,d){var f=d||{},p="",m=f.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):f&&f.FS?p=f.FS:p=i(u.slice(0,1024));var g=0,v=0,w=0,y=0,b=0,E=p.charCodeAt(0),k=!1,S=0,C=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=f.dateNF!=null?HV(f.dateNF):null;function P(){var I=u.slice(y,b),R={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)R.t="z";else if(f.raw)R.t="s",R.v=I;else if(I.trim().length===0)R.t="s",R.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(R.t="s",R.v=I.slice(2,-1).replace(/""/g,'"')):yq(I)?(R.t="n",R.f=I.slice(1)):(R.t="s",R.v=I);else if(I=="TRUE")R.t="b",R.v=!0;else if(I=="FALSE")R.t="b",R.v=!1;else if(!isNaN(w=ni(I)))R.t="n",f.cellText!==!1&&(R.w=I),R.v=w;else if(!isNaN(Jl(I).getDate())||T&&I.match(T)){R.z=f.dateNF||De[14];var H=0;T&&I.match(T)&&(I=WV(I,f.dateNF,I.match(T)||[]),H=1),f.cellDates?(R.t="d",R.v=er(I,H)):(R.t="n",R.v=Mr(er(I,H))),f.cellText!==!1&&(R.w=Dn(R.z,R.v instanceof Date?Mr(R.v):R.v)),f.cellNF||delete R.z}else R.t="s",R.v=I;if(R.t=="z"||(f.dense?(m[g]||(m[g]=[]),m[g][v]=R):m[Oe({c:v,r:g})]=R),y=b+1,C=u.charCodeAt(y),h.e.c<v&&(h.e.c=v),h.e.r<g&&(h.e.r=g),S==E)++v;else if(v=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;b<u.length;++b)switch(S=u.charCodeAt(b)){case 34:C===34&&(k=!k);break;case E:case 10:case 13:if(!k&&P())break e;break}return b-y>0&&P(),m["!ref"]=He(h),m}function a(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):mc(t(u,d),d)}function o(u,d){var f="",p=d.type=="string"?[0,0,0,0]:cy(u,d);switch(d.type){case"base64":f=un(u);break;case"binary":f=u;break;case"buffer":d.codepage==65001?f=u.toString("utf8"):d.codepage&&typeof Ss<"u"?f=Ss.utils.decode(d.codepage,u):f=$e&&Buffer.isBuffer(u)?u.toString("binary"):ko(u);break;case"array":f=xo(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=it(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=it(f):d.type=="binary"&&typeof Ss<"u"&&d.codepage&&(f=Ss.utils.decode(d.codepage,Ss.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?DG.to_sheet(d.type=="string"?f:it(f),d):a(f,d)}function l(u,d){return va(o(u,d),d)}function c(u){for(var d=[],f=_t(u["!ref"]),p,m=Array.isArray(u),h=f.s.r;h<=f.e.r;++h){for(var g=[],v=f.s.c;v<=f.e.c;++v){var w=Oe({r:h,c:v});if(p=m?(u[h]||[])[v]:u[w],!p||p.v==null){g.push("          ");continue}for(var y=(p.w||(is(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(v===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function NG(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=OG.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return td.to_workbook(e,t)}}var gu=function(){function e(D,V,B){if(D){nr(D,D.l||0);for(var U=B.Enum||ie;D.l<D.length;){var Y=D.read_shift(2),te=U[Y]||U[65535],oe=D.read_shift(2),le=D.l+oe,ne=te.f&&te.f(D,oe,B);if(D.l=le,V(ne,te,Y))return}}}function t(D,V){switch(V.type){case"base64":return r(Qn(un(D)),V);case"binary":return r(Qn(D),V);case"buffer":case"array":return r(D,V)}throw"Unsupported type "+V.type}function r(D,V){if(!D)return D;var B=V||{},U=B.dense?[]:{},Y="Sheet1",te="",oe=0,le={},ne=[],he=[],F={s:{r:0,c:0},e:{r:0,c:0}},Se=B.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)B.Enum=ie,e(D,function(fe,tt,St){switch(St){case 0:B.vers=fe,fe>=4096&&(B.qpro=!0);break;case 6:F=fe;break;case 204:fe&&(te=fe);break;case 222:te=fe;break;case 15:case 51:B.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:St==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=B.dateNF||De[14],B.cellDates&&(fe[1].t="d",fe[1].v=rp(fe[1].v))),B.qpro&&fe[3]>oe&&(U["!ref"]=He(F),le[Y]=U,ne.push(Y),U=B.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},oe=fe[3],Y=te||"Sheet"+(oe+1),te="");var xt=B.dense?(U[fe[0].r]||[])[fe[0].c]:U[Oe(fe[0])];if(xt){xt.t=fe[1].t,xt.v=fe[1].v,fe[1].z!=null&&(xt.z=fe[1].z),fe[1].f!=null&&(xt.f=fe[1].f);break}B.dense?(U[fe[0].r]||(U[fe[0].r]=[]),U[fe[0].r][fe[0].c]=fe[1]):U[Oe(fe[0])]=fe[1];break}},B);else if(D[2]==26||D[2]==14)B.Enum=ae,D[2]==14&&(B.qpro=!0,D.l=0),e(D,function(fe,tt,St){switch(St){case 204:Y=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>oe&&(U["!ref"]=He(F),le[Y]=U,ne.push(Y),U=B.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},oe=fe[3],Y="Sheet"+(oe+1)),Se>0&&fe[0].r>=Se)break;B.dense?(U[fe[0].r]||(U[fe[0].r]=[]),U[fe[0].r][fe[0].c]=fe[1]):U[Oe(fe[0])]=fe[1],F.e.c<fe[0].c&&(F.e.c=fe[0].c),F.e.r<fe[0].r&&(F.e.r=fe[0].r);break;case 27:fe[14e3]&&(he[fe[14e3][0]]=fe[14e3][1]);break;case 1537:he[fe[0]]=fe[1],fe[0]==oe&&(Y=fe[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(U["!ref"]=He(F),le[te||Y]=U,ne.push(te||Y),!he.length)return{SheetNames:ne,Sheets:le};for(var Ee={},Fe=[],ke=0;ke<he.length;++ke)le[ne[ke]]?(Fe.push(he[ke]||ne[ke]),Ee[he[ke]]=le[he[ke]]||le[ne[ke]]):(Fe.push(he[ke]),Ee[he[ke]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:Ee}}function n(D,V){var B=V||{};if(+B.codepage>=0&&Zn(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var U=kv(),Y=_t(D["!ref"]),te=Array.isArray(D),oe=[];Bn(U,0,s(1030)),Bn(U,6,l(Y));for(var le=Math.min(Y.e.r,8191),ne=Y.s.r;ne<=le;++ne)for(var he=or(ne),F=Y.s.c;F<=Y.e.c;++F){ne===Y.s.r&&(oe[F]=Wt(F));var Se=oe[F]+he,Ee=te?(D[ne]||[])[F]:D[Se];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?Bn(U,13,p(ne,F,Ee.v)):Bn(U,14,h(ne,F,Ee.v));else{var Fe=is(Ee);Bn(U,15,d(ne,F,Fe.slice(0,239)))}}return Bn(U,1),U.end()}function i(D,V){var B=V||{};if(+B.codepage>=0&&Zn(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var U=kv();Bn(U,0,a(D));for(var Y=0,te=0;Y<D.SheetNames.length;++Y)(D.Sheets[D.SheetNames[Y]]||{})["!ref"]&&Bn(U,27,z(D.SheetNames[Y],te++));var oe=0;for(Y=0;Y<D.SheetNames.length;++Y){var le=D.Sheets[D.SheetNames[Y]];if(!(!le||!le["!ref"])){for(var ne=_t(le["!ref"]),he=Array.isArray(le),F=[],Se=Math.min(ne.e.r,8191),Ee=ne.s.r;Ee<=Se;++Ee)for(var Fe=or(Ee),ke=ne.s.c;ke<=ne.e.c;++ke){Ee===ne.s.r&&(F[ke]=Wt(ke));var fe=F[ke]+Fe,tt=he?(le[Ee]||[])[ke]:le[fe];if(!(!tt||tt.t=="z"))if(tt.t=="n")Bn(U,23,P(Ee,ke,oe,tt.v));else{var St=is(tt);Bn(U,22,S(Ee,ke,oe,St.slice(0,239)))}}++oe}}return Bn(U,1),U.end()}function s(D){var V=Bt(2);return V.write_shift(2,D),V}function a(D){var V=Bt(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var B=0,U=0,Y=0,te=0;te<D.SheetNames.length;++te){var oe=D.SheetNames[te],le=D.Sheets[oe];if(!(!le||!le["!ref"])){++Y;var ne=pc(le["!ref"]);B<ne.e.r&&(B=ne.e.r),U<ne.e.c&&(U=ne.e.c)}}return B>8191&&(B=8191),V.write_shift(2,B),V.write_shift(1,Y),V.write_shift(1,U),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(D,V,B){var U={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&B.qpro?(U.s.c=D.read_shift(1),D.l++,U.s.r=D.read_shift(2),U.e.c=D.read_shift(1),D.l++,U.e.r=D.read_shift(2),U):(U.s.c=D.read_shift(2),U.s.r=D.read_shift(2),V==12&&B.qpro&&(D.l+=2),U.e.c=D.read_shift(2),U.e.r=D.read_shift(2),V==12&&B.qpro&&(D.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(D){var V=Bt(8);return V.write_shift(2,D.s.c),V.write_shift(2,D.s.r),V.write_shift(2,D.e.c),V.write_shift(2,D.e.r),V}function c(D,V,B){var U=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(U[0].c=D.read_shift(1),U[3]=D.read_shift(1),U[0].r=D.read_shift(2),D.l+=2):(U[2]=D.read_shift(1),U[0].c=D.read_shift(2),U[0].r=D.read_shift(2)),U}function u(D,V,B){var U=D.l+V,Y=c(D,V,B);if(Y[1].t="s",B.vers==20768){D.l++;var te=D.read_shift(1);return Y[1].v=D.read_shift(te,"utf8"),Y}return B.qpro&&D.l++,Y[1].v=D.read_shift(U-D.l,"cstr"),Y}function d(D,V,B){var U=Bt(7+B.length);U.write_shift(1,255),U.write_shift(2,V),U.write_shift(2,D),U.write_shift(1,39);for(var Y=0;Y<U.length;++Y){var te=B.charCodeAt(Y);U.write_shift(1,te>=128?95:te)}return U.write_shift(1,0),U}function f(D,V,B){var U=c(D,V,B);return U[1].v=D.read_shift(2,"i"),U}function p(D,V,B){var U=Bt(7);return U.write_shift(1,255),U.write_shift(2,V),U.write_shift(2,D),U.write_shift(2,B,"i"),U}function m(D,V,B){var U=c(D,V,B);return U[1].v=D.read_shift(8,"f"),U}function h(D,V,B){var U=Bt(13);return U.write_shift(1,255),U.write_shift(2,V),U.write_shift(2,D),U.write_shift(8,B,"f"),U}function g(D,V,B){var U=D.l+V,Y=c(D,V,B);if(Y[1].v=D.read_shift(8,"f"),B.qpro)D.l=U;else{var te=D.read_shift(2);b(D.slice(D.l,D.l+te),Y),D.l+=te}return Y}function v(D,V,B){var U=V&32768;return V&=-32769,V=(U?D:0)+(V>=8192?V-16384:V),(U?"":"$")+(B?Wt(V):or(V))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(D,V){nr(D,0);for(var B=[],U=0,Y="",te="",oe="",le="";D.l<D.length;){var ne=D[D.l++];switch(ne){case 0:B.push(D.read_shift(8,"f"));break;case 1:te=v(V[0].c,D.read_shift(2),!0),Y=v(V[0].r,D.read_shift(2),!1),B.push(te+Y);break;case 2:{var he=v(V[0].c,D.read_shift(2),!0),F=v(V[0].r,D.read_shift(2),!1);te=v(V[0].c,D.read_shift(2),!0),Y=v(V[0].r,D.read_shift(2),!1),B.push(he+F+":"+te+Y)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(D.read_shift(2));break;case 6:{for(var Se="";ne=D[D.l++];)Se+=String.fromCharCode(ne);B.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:le=B.pop(),oe=B.pop(),B.push(["AND","OR"][ne-20]+"("+oe+","+le+")");break;default:if(ne<32&&y[ne])le=B.pop(),oe=B.pop(),B.push(oe+y[ne]+le);else if(w[ne]){if(U=w[ne][1],U==69&&(U=D[D.l++]),U>B.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+B.join("|")+"|");return}var Ee=B.slice(-U);B.length-=U,B.push(w[ne][0]+"("+Ee.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}B.length==1?V[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function E(D){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=D.read_shift(2),V[3]=D[D.l++],V[0].c=D[D.l++],V}function k(D,V){var B=E(D);return B[1].t="s",B[1].v=D.read_shift(V-4,"cstr"),B}function S(D,V,B,U){var Y=Bt(6+U.length);Y.write_shift(2,D),Y.write_shift(1,B),Y.write_shift(1,V),Y.write_shift(1,39);for(var te=0;te<U.length;++te){var oe=U.charCodeAt(te);Y.write_shift(1,oe>=128?95:oe)}return Y.write_shift(1,0),Y}function C(D,V){var B=E(D);B[1].v=D.read_shift(2);var U=B[1].v>>1;if(B[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return B[1].v=U,B}function T(D,V){var B=E(D),U=D.read_shift(4),Y=D.read_shift(4),te=D.read_shift(2);if(te==65535)return U===0&&Y===3221225472?(B[1].t="e",B[1].v=15):U===0&&Y===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var oe=te&32768;return te=(te&32767)-16446,B[1].v=(1-oe*2)*(Y*Math.pow(2,te+32)+U*Math.pow(2,te)),B}function P(D,V,B,U){var Y=Bt(14);if(Y.write_shift(2,D),Y.write_shift(1,B),Y.write_shift(1,V),U==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var te=0,oe=0,le=0,ne=0;return U<0&&(te=1,U=-U),oe=Math.log2(U)|0,U/=Math.pow(2,oe-31),ne=U>>>0,ne&2147483648||(U/=2,++oe,ne=U>>>0),U-=ne,ne|=2147483648,ne>>>=0,U*=Math.pow(2,32),le=U>>>0,Y.write_shift(4,le),Y.write_shift(4,ne),oe+=16383+(te?32768:0),Y.write_shift(2,oe),Y}function I(D,V){var B=T(D);return D.l+=V-14,B}function R(D,V){var B=E(D),U=D.read_shift(4);return B[1].v=U>>6,B}function H(D,V){var B=E(D),U=D.read_shift(8,"f");return B[1].v=U,B}function q(D,V){var B=H(D);return D.l+=V-10,B}function X(D,V){return D[D.l+V-1]==0?D.read_shift(V,"cstr"):""}function K(D,V){var B=D[D.l++];B>V-1&&(B=V-1);for(var U="";U.length<B;)U+=String.fromCharCode(D[D.l++]);return U}function Q(D,V,B){if(!(!B.qpro||V<21)){var U=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var Y=D.read_shift(V-21,"cstr");return[U,Y]}}function G(D,V){for(var B={},U=D.l+V;D.l<U;){var Y=D.read_shift(2);if(Y==14e3){for(B[Y]=[0,""],B[Y][0]=D.read_shift(2);D[D.l];)B[Y][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return B}function z(D,V){var B=Bt(5+D.length);B.write_shift(2,14e3),B.write_shift(2,V);for(var U=0;U<D.length;++U){var Y=D.charCodeAt(U);B[B.l++]=Y>127?95:Y}return B[B.l++]=0,B}var ie={0:{n:"BOF",f:Dt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},ae={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function FG(e){var t={},r=e.match(Tr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ae(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=jx[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var MG=function(){var e=Zu("t"),t=Zu("rPr");function r(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:Ge(a[1])},l=s.match(t);return l&&(o.s=FG(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),LG=function(){var t=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),zG=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,jG=/<(?:\w+:)?r>/,BG=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ry(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ge(it(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=it(e),r&&(n.h=Gx(n.t))):e.match(jG)&&(n.r=it(e),n.t=Ge(it((e.replace(BG,"").match(zG)||[]).join("").replace(Tr,""))),r&&(n.h=LG(MG(n.r)))),n):{t:""}}var UG=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$G=/<(?:\w+:)?(?:si|sstItem)>/g,VG=/<\/(?:\w+:)?(?:si|sstItem)>/;function HG(e,t){var r=[],n="";if(!e)return r;var i=e.match(UG);if(i){n=i[2].replace($G,"").split(VG);for(var s=0;s!=n.length;++s){var a=ry(n[s].trim(),t);a!=null&&(r[r.length]=a)}i=Ae(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function WG(e){return[e.read_shift(4),e.read_shift(4)]}function GG(e,t){var r=[],n=!1;return os(e,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function bO(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Yi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function KG(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Yi(e,4),t.U=Yi(e,4),t.W=Yi(e,4),t}function qG(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function XG(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(qG(e));return t}function YG(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function QG(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Yi(e,4),t.U=Yi(e,4),t.W=Yi(e,4),t}function JG(e){var t=QG(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function _O(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function SO(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function ZG(e){var t=Yi(e);switch(t.Minor){case 2:return[t.Minor,eK(e)];case 3:return[t.Minor,tK()];case 4:return[t.Minor,rK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function eK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=_O(e,r),i=SO(e,e.length-e.l);return{t:"Std",h:n,v:i}}function tK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function rK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Tr,function(s){var a=Ae(s);switch(Pi(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function nK(e,t){var r={},n=r.EncryptionVersionInfo=Yi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=_O(e,i),t-=i,r.EncryptionVerifier=SO(e,t),r}function iK(e){var t={},r=t.EncryptionVersionInfo=Yi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function sK(e){var t=0,r,n=bO(e),i=n.length+1,s,a,o,l,c;for(r=sa(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var EO=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=t[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],d=0;d!=7;++d)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=bO(a),l=s(o),c=o.length,u=sa(16),d=0;d!=16;++d)u[d]=0;var f,p,m;for((c&1)===1&&(f=l>>8,u[c]=i(e[0],f),--c,f=l&255,p=o[o.length-1],u[c]=i(p,f));c>0;)--c,f=l>>8,u[c]=i(o[c],f),--c,f=l&255,u[c]=i(o[c],f);for(c=15,m=15-o.length;m>0;)f=l>>8,u[c]=i(e[m],f),--c,--m,f=l&255,u[c]=i(o[c],f),--c,--m;return u}}(),aK=function(e,t,r,n,i){i||(i=t),n||(n=EO(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},oK=function(e){var t=0,r=EO(e);return function(n){var i=aK("",n,t,r);return t=i[1],i[0]}};function lK(e,t,r,n){var i={key:Dt(e),verificationBytes:Dt(e)};return r.password&&(i.verifier=sK(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=oK(r.password)),i}function cK(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=iK(e):n.Data=nK(e,t),n}function uK(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?cK(e,t-2,n):lK(e,r.biff>=8?t:t-2,r,n),n}var dK=function(){function e(i,s){switch(s.type){case"base64":return t(un(i),s);case"binary":return t(i,s);case"buffer":return t($e&&Buffer.isBuffer(i)?i.toString("binary"):ko(i),s);case"array":return t(xo(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var f=/\\\w+\b/g,p=0,m,h=-1;m=f.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(p,f.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++h,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[d][h]=v:o[Oe({r:d,c:h})]=v}break}p=f.lastIndex}h>c.e.c&&(c.e.c=h)}),o["!ref"]=He(c),o}function r(i,s){return va(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=_t(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var d=Oe({r:c,c:u});o=l?(i[c]||[])[u]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(is(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function fK(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function rd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function hK(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),a=i-s;if(a===0)return[0,0,t];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,l,c/2]}function pK(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function o0(e,t){if(t===0)return e;var r=hK(fK(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),rd(pK(r))}var TO=6,mK=15,gK=1,Ir=TO;function l0(e){return Math.floor((e+Math.round(128/Ir)/256)*Ir)}function c0(e){return Math.floor((e-5)/Ir*100+.5)/100}function Pv(e){return Math.round((e*Ir+5)/Ir*256)/256}function km(e){return Pv(c0(l0(e)))}function ny(e){var t=Math.abs(e-km(e)),r=Ir;if(t>.005)for(Ir=gK;Ir<mK;++Ir)Math.abs(e-km(e))<=t&&(t=Math.abs(e-km(e)),r=Ir);Ir=r}function Zl(e){e.width?(e.wpx=l0(e.width),e.wch=c0(e.wpx),e.MDW=Ir):e.wpx?(e.wch=c0(e.wpx),e.width=Pv(e.wch),e.MDW=Ir):typeof e.wch=="number"&&(e.width=Pv(e.wch),e.wpx=l0(e.width),e.MDW=Ir),e.customWidth&&delete e.customWidth}var vK=96,kO=vK;function CO(e){return e*96/kO}function nd(e){return e*kO/96}var xK={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yK(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Tr)||[]).forEach(function(a){var o=Ae(a);switch(Pi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=ut(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=ut(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function wK(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Tr)||[]).forEach(function(a){var o=Ae(a);switch(Pi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function bK(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Tr)||[]).forEach(function(a){var o=Ae(a);switch(Pi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=it(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?ut(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?ut(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?ut(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?ut(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?ut(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?ut(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?ut(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=jx[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=ut(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=ro[i.color.index];i.color.index==81&&(l=ro[1]),l||(l=ro[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=o0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function _K(e,t,r){t.NumberFmt=[];for(var n=Ai(De),i=0;i<n.length;++i)t.NumberFmt[n[i]]=De[n[i]];var s=e[0].match(Tr);if(s)for(i=0;i<s.length;++i){var a=Ae(s[i]);switch(Pi(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ge(it(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}to(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Df=["numFmtId","fillId","fontId","borderId","xfId"],Nf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function SK(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Tr)||[]).forEach(function(s){var a=Ae(s),o=0;switch(Pi(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Df.length;++o)n[Df[o]]&&(n[Df[o]]=parseInt(n[Df[o]],10));for(o=0;o<Nf.length;++o)n[Nf[o]]&&(n[Nf[o]]=ut(n[Nf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=ut(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var EK=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&_K(d,u,c),(d=o.match(i))&&bK(d,u,l,c),(d=o.match(n))&&wK(d,u,l,c),(d=o.match(s))&&yK(d,u,l,c),(d=o.match(r))&&SK(d,u,c),u}}();function TK(e,t){var r=e.read_shift(2),n=br(e);return[r,n]}function kK(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=MH(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=FH(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=br(e),n}var CK=Er;function AK(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var RK=Er;function PK(e,t,r){var n={};n.NumberFmt=[];for(var i in De)n.NumberFmt[i]=De[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return os(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],to(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=o0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var OK=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function IK(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Tr)||[]).forEach(function(i){var s=Ae(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[OK.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function DK(){}function NK(){}var FK=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MK=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,LK=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function zK(e,t,r){t.themeElements={};var n;[["clrScheme",FK,IK],["fontScheme",MK,DK],["fmtScheme",LK,NK]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var jK=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function AO(e,t){(!e||e.length===0)&&(e=BK());var r,n={};if(!(r=e.match(jK)))throw new Error("themeElements not found in theme");return zK(r[0],n,t),n.raw=e,n}function BK(e,t){var r=[jP];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function UK(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var a;try{a=zP(s,{type:"array"})}catch{return}var o=rn(a,"theme/theme/theme1.xml",!0);if(o)return AO(o,r)}}function $K(e){return e.read_shift(4)}function VK(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=HK(e,4);break;case 2:t.xclrValue=pO(e);break;case 3:t.xclrValue=$K(e);break;case 4:e.l+=4;break}return e.l+=8,t}function HK(e,t){return Er(e,t)}function WK(e,t){return Er(e,t)}function GK(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=VK(e);break;case 6:n[1]=WK(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function KK(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(GK(e,r-e.l));return{ixfe:n,ext:s}}function qK(e,t){t.forEach(function(r){switch(r[0]){}})}function XK(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:br(e)}}function YK(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function QK(e){return e.l+=4,e.read_shift(4)!=0}function JK(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return os(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function ZK(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,a;return e.replace(Tr,function(o){var l=Ae(o);switch(Pi(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function eq(e){var t=[];if(!e)return t;var r=1;return(e.match(Tr)||[]).forEach(function(n){var i=Ae(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function tq(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Oe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function rq(e,t,r){var n=[];return os(e,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function nq(e,t,r,n){if(!e)return e;var i=n||{},s=!1;os(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function iq(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Q_(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(a){var o=Dr(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var l=_t(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=He(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}s.c.push(u)})}function sq(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ae(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Dr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var d=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&ry(d[1])||{r:"",t:"",h:""};c.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),c.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=f.h),n.push(c)}}}}),n}function aq(e,t){var r=[],n=!1,i={},s=0;return e.replace(Tr,function(o,l){var c=Ae(o);switch(Pi(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function oq(e,t){var r=[],n=!1;return e.replace(Tr,function(s){var a=Ae(s);switch(Pi(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function lq(e){var t={};t.iauthor=e.read_shift(4);var r=Ao(e);return t.rfx=r.s,t.ref=Oe(r.s),e.l+=16,t}var cq=br;function uq(e,t){var r=[],n=[],i={},s=!1;return os(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var dq="application/vnd.ms-office.vbaProject";function fq(e){var t=Ve.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ve.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Ve.write(t)}function hq(){return{"!type":"dialog"}}function pq(){return{"!type":"dialog"}}function mq(){return{"!type":"macro"}}function gq(){return{"!type":"macro"}}var wl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+Wt(u)+(l?"":"$")+or(c)}return function(i,s){return t=s,i.replace(e,r)}}(),RO=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vq=function(){return function(t,r){return t.replace(RO,function(n,i,s,a,o,l){var c=Yx(a)-(s?0:r.c),u=Xx(l)-(o?0:r.r),d=u==0?"":o?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+d+"C"+f})}}();function PO(e,t){return e.replace(RO,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Wt(Yx(s)+t.c))+(a=="$"?a+o:or(Xx(o)+t.r))})}function xq(e,t,r){var n=pc(t),i=n.s,s=Dr(r),a={r:s.r-i.r,c:s.c-i.c};return PO(e,a)}function yq(e){return e.length!=1}function J_(e){return e.replace(/_xlfn\./g,"")}function Ot(e){e.l+=1}function aa(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function OO(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return IO(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=aa(e),o=aa(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function IO(e){var t=aa(e),r=aa(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function wq(e,t,r){if(r.biff<8)return IO(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=aa(e),a=aa(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function DO(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return bq(e);var n=e.read_shift(r&&r.biff==12?4:2),i=aa(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function bq(e){var t=aa(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function _q(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Sq(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Eq(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function Eq(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function Tq(e,t,r){var n=(e[e.l++]&96)>>5,i=OO(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function kq(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=OO(e,s,r);return[n,i,a]}function Cq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Aq(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function Rq(e,t,r){var n=(e[e.l++]&96)>>5,i=wq(e,t-1,r);return[n,i]}function Pq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Z_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Oq(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Iq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Dq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Nq(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Fq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function NO(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Mq(e){return e.read_shift(2),NO(e)}function Lq(e){return e.read_shift(2),NO(e)}function zq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=DO(e,0,r);return[n,i]}function jq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Sq(e,0,r);return[n,i]}function Bq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=DO(e,0,r);return[n,i,s]}function Uq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[$X[i],LO[i],n]}function $q(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Vq(e);return[i,(s[0]===0?LO:UX)[s[1]]]}function Vq(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hq(e,t,r){e.l+=r&&r.biff==2?3:4}function Wq(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Gq(e){return e.l++,Ro[e.read_shift(1)]}function Kq(e){return e.l++,e.read_shift(2)}function qq(e){return e.l++,e.read_shift(1)!==0}function Xq(e){return e.l++,xr(e)}function Yq(e,t,r){return e.l++,Td(e,t-1,r)}function Qq(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Tt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ro[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=xr(e);break;case 2:r[1]=Po(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Jq(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Ao:np)(e));return i}function Zq(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Qq(e,r.biff);return a}function eX(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function tX(e,t,r){if(r.biff==5)return rX(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function rX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function nX(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function iX(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function sX(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function aX(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var oX=Er,lX=Er,cX=Er;function Cd(e,t,r){return e.l+=2,[_q(e)]}function iy(e){return e.l+=6,[]}var uX=Cd,dX=iy,fX=iy,hX=Cd;function FO(e){return e.l+=2,[Dt(e),e.read_shift(2)&1]}var pX=Cd,mX=FO,gX=iy,vX=Cd,xX=Cd,yX=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=yX[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function bX(e){return e.l+=2,[e.read_shift(4)]}function _X(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function SX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function EX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function kX(e){return e.l+=4,[0,0]}var eS={1:{n:"PtgExp",f:Wq},2:{n:"PtgTbl",f:cX},3:{n:"PtgAdd",f:Ot},4:{n:"PtgSub",f:Ot},5:{n:"PtgMul",f:Ot},6:{n:"PtgDiv",f:Ot},7:{n:"PtgPower",f:Ot},8:{n:"PtgConcat",f:Ot},9:{n:"PtgLt",f:Ot},10:{n:"PtgLe",f:Ot},11:{n:"PtgEq",f:Ot},12:{n:"PtgGe",f:Ot},13:{n:"PtgGt",f:Ot},14:{n:"PtgNe",f:Ot},15:{n:"PtgIsect",f:Ot},16:{n:"PtgUnion",f:Ot},17:{n:"PtgRange",f:Ot},18:{n:"PtgUplus",f:Ot},19:{n:"PtgUminus",f:Ot},20:{n:"PtgPercent",f:Ot},21:{n:"PtgParen",f:Ot},22:{n:"PtgMissArg",f:Ot},23:{n:"PtgStr",f:Yq},26:{n:"PtgSheet",f:_X},27:{n:"PtgEndSheet",f:SX},28:{n:"PtgErr",f:Gq},29:{n:"PtgBool",f:qq},30:{n:"PtgInt",f:Kq},31:{n:"PtgNum",f:Xq},32:{n:"PtgArray",f:Pq},33:{n:"PtgFunc",f:Uq},34:{n:"PtgFuncVar",f:$q},35:{n:"PtgName",f:eX},36:{n:"PtgRef",f:zq},37:{n:"PtgArea",f:Tq},38:{n:"PtgMemArea",f:nX},39:{n:"PtgMemErr",f:oX},40:{n:"PtgMemNoMem",f:lX},41:{n:"PtgMemFunc",f:iX},42:{n:"PtgRefErr",f:sX},43:{n:"PtgAreaErr",f:Cq},44:{n:"PtgRefN",f:jq},45:{n:"PtgAreaN",f:Rq},46:{n:"PtgMemAreaN",f:EX},47:{n:"PtgMemNoMemN",f:TX},57:{n:"PtgNameX",f:tX},58:{n:"PtgRef3d",f:Bq},59:{n:"PtgArea3d",f:kq},60:{n:"PtgRefErr3d",f:aX},61:{n:"PtgAreaErr3d",f:Aq},255:{}},CX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},AX={1:{n:"PtgElfLel",f:FO},2:{n:"PtgElfRw",f:vX},3:{n:"PtgElfCol",f:uX},6:{n:"PtgElfRwV",f:xX},7:{n:"PtgElfColV",f:hX},10:{n:"PtgElfRadical",f:pX},11:{n:"PtgElfRadicalS",f:gX},13:{n:"PtgElfColS",f:dX},15:{n:"PtgElfColSV",f:fX},16:{n:"PtgElfRadicalLel",f:mX},25:{n:"PtgList",f:wX},29:{n:"PtgSxName",f:bX},255:{}},RX={0:{n:"PtgAttrNoop",f:kX},1:{n:"PtgAttrSemi",f:Fq},2:{n:"PtgAttrIf",f:Dq},4:{n:"PtgAttrChoose",f:Oq},8:{n:"PtgAttrGoto",f:Iq},16:{n:"PtgAttrSum",f:Hq},32:{n:"PtgAttrBaxcel",f:Z_},33:{n:"PtgAttrBaxcel",f:Z_},64:{n:"PtgAttrSpace",f:Mq},65:{n:"PtgAttrSpaceSemi",f:Lq},128:{n:"PtgAttrIfError",f:Nq},255:{}};function Ad(e,t,r,n){if(n.biff<8)return Er(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=Zq(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Jq(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Er(e,t)),s}function Rd(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=eS[s]||eS[CX[s]],(s===24||s===25)&&(i=(s===24?AX:RX)[e[e.l+1]]),!i||!i.f?Er(e,t):a.push([i.n,i.f(e,t,r)]);return a}function PX(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var OX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function IX(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function MO(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function tS(e,t,r){var n=MO(e,t,r);return n=="#REF"?n:IX(n,r)}function gr(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,d=0,f=0,p,m="";if(!e[0]||!e[0][0])return"";for(var h=-1,g="",v=0,w=e[0].length;v<w;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),h>=0){switch(e[0][h][1][0]){case 0:g=bt(" ",e[0][h][1][1]);break;case 1:g=bt("\r",e[0][h][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}c=c+g,h=-1}o.push(c+OX[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=fu(y[1][1],a,i),o.push(hu(u,s));break;case"PtgRefN":u=r?fu(y[1][1],r,i):y[1][1],o.push(hu(u,s));break;case"PtgRef3d":d=y[1][1],u=fu(y[1][2],a,i),m=tS(n,d,i),o.push(m+"!"+hu(u,s));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],E=y[1][1];b||(b=0),b&=127;var k=b==0?[]:o.slice(-b);o.length-=b,E==="User"&&(E=k.shift()),o.push(E+"("+k.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=F_(y[1][1],r?{s:r}:a,i),o.push(Em(p,i));break;case"PtgArea":p=F_(y[1][1],a,i),o.push(Em(p,i));break;case"PtgArea3d":d=y[1][1],p=y[1][2],m=tS(n,d,i),o.push(m+"!"+Em(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var S=(n.names||[])[f-1]||(n[0]||[])[f],C=S?S.Name:"SH33TJSNAME"+String(f);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var T=y[1][1];f=y[1][2];var P;if(i.biff<=5)T<0&&(T=-T),n[T]&&(P=n[T][f]);else{var I="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][f]&&n[T][f].itab>0&&(I=n.SheetNames[n[T][f].itab-1]+"!"):I=n.SheetNames[f-1]+"!"),n[T]&&n[T][f])I+=n[T][f].Name;else if(n[0]&&n[0][f])I+=n[0][f].Name;else{var R=(MO(n,T,i)||"").split(";;");R[f-1]?I=R[f-1]:I+="SH33TJSERRX"}o.push(I);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var H="(",q=")";if(h>=0){switch(g="",e[0][h][1][0]){case 2:H=bt(" ",e[0][h][1][1])+H;break;case 3:H=bt("\r",e[0][h][1][1])+H;break;case 4:q=bt(" ",e[0][h][1][1])+q;break;case 5:q=bt("\r",e[0][h][1][1])+q;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}h=-1}o.push(H+o.pop()+q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[Oe(u)]){var K=n.sharedf[Oe(u)];o.push(gr(K,a,X,n,i))}else{var Q=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(gr(c[1],a,X,n,i)),Q=!0;break}Q||o.push(y[1])}break;case"PtgArray":o.push("{"+PX(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&h>=0&&G.indexOf(e[0][v][0])==-1){y=e[0][h];var z=!0;switch(y[1][0]){case 4:z=!1;case 0:g=bt(" ",y[1][1]);break;case 5:z=!1;case 1:g=bt("\r",y[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((z?g:"")+o.pop()+(z?"":g)),h=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function DX(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Er(e,t-2)];var o=Rd(e,a,r);return t!==a+i&&(s=Ad(e,t-a-i,o,r)),e.l=n,[o,s]}function NX(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Er(e,t-2)];var o=Rd(e,a,r);return t!==a+i&&(s=Ad(e,t-a-i,o,r)),e.l=n,[o,s]}function FX(e,t,r,n){var i=e.l+t,s=Rd(e,n,r),a;return i!==e.l&&(a=Ad(e,i-e.l,s,r)),[s,a]}function MX(e,t,r){var n=e.l+t,i,s=e.read_shift(2),a=Rd(e,s,r);return s==65535?[[],Er(e,t-2)]:(t!==s+2&&(i=Ad(e,n-s-2,a,r)),[a,i])}function LX(e){var t;if(Gi(e,e.l+6)!==65535)return[xr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Cm(e,t,r){var n=e.l+t,i=Oi(e);r.biff==2&&++e.l;var s=LX(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=NX(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function ip(e,t,r){var n=e.read_shift(4),i=Rd(e,n,r),s=e.read_shift(4),a=s>0?Ad(e,s,i,r):null;return[i,a]}var zX=ip,sp=ip,jX=ip,BX=ip,UX={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},LO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$X={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function rS(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Am(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var vu={},bl={};function xu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function zO(e,t,r,n,i,s){try{n.cellNF&&(e.z=De[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=er(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(De[t]==null&&to(VV[t]||"General",t),e.t==="e")e.w=e.w||Ro[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ju(e.v);else if(e.t==="d"){var a=Mr(e.v);(a|0)===a?e.w=a.toString(10):e.w=Ju(a)}else{if(e.v===void 0)return"";e.w=vo(e.v,bl)}else e.t==="d"?e.w=Dn(t,Mr(e.v),bl):e.w=Dn(t,e.v,bl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=o0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=o0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function VX(e,t){var r=_t(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=He(r))}var HX=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,WX=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,GX=/<(?:\w:)?hyperlink [^>]*>/mg,KX=/"(\w*:\w*)"/,qX=/<(?:\w:)?col\b[^>]*[\/]?>/g,XX=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,YX=/<(?:\w:)?pageMargins[^>]*\/>/g,jO=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,QX=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,JX=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ZX(e,t,r,n,i,s,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(WX);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var f=c.match(jO);f?sy(f[0],o,i,r):(f=c.match(QX))&&eY(f[0],f[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=c.slice(p,p+50).match(KX);m&&VX(o,m[1])}var h=c.match(JX);h&&h[1]&&aY(h[1],i);var g=[];if(t.cellStyles){var v=c.match(qX);v&&nY(g,v)}d&&oY(d[1],o,t,l,s,a);var w=u.match(XX);w&&(o["!autofilter"]=iY(w[0]));var y=[],b=u.match(HX);if(b)for(p=0;p!=b.length;++p)y[p]=_t(b[p].slice(b[p].indexOf('"')+1));var E=u.match(GX);E&&tY(o,E,n);var k=u.match(YX);if(k&&(o["!margins"]=rY(Ae(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=He(l)),t.sheetRows>0&&o["!ref"]){var S=_t(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=He(S))}return g.length>0&&(o["!cols"]=g),y.length>0&&(o["!merges"]=y),o}function sy(e,t,r,n){var i=Ae(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ge(it(i.codeName)))}function eY(e,t,r,n,i){sy(e.slice(0,e.indexOf(">")),r,n,i)}function tY(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Ae(it(t[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ge(s.location))):(s.Target="#"+Ge(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=_t(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Oe({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function rY(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function nY(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Ae(t[n],!0);i.hidden&&(i.hidden=ut(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ny(i.width)),Zl(i);s<=a;)e[s++]=ar(i)}}function iY(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var sY=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function aY(e,t){t.Views||(t.Views=[{}]),(e.match(sY)||[]).forEach(function(r,n){var i=Ae(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),ut(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var oY=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Zu("v"),a=Zu("f");return function(l,c,u,d,f,p){for(var m=0,h="",g=[],v=[],w=0,y=0,b=0,E="",k,S,C=0,T=0,P,I,R=0,H=0,q=Array.isArray(p.CellXf),X,K=[],Q=[],G=Array.isArray(c),z=[],ie={},ae=!1,D=!!u.sheetStubs,V=l.split(t),B=0,U=V.length;B!=U;++B){h=V[B].trim();var Y=h.length;if(Y!==0){var te=0;e:for(m=0;m<Y;++m)switch(h[m]){case">":if(h[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(S=Ae(h.slice(te,m),!0),C=S.r!=null?parseInt(S.r,10):C+1,T=-1,u.sheetRows&&u.sheetRows<C)continue;ie={},ae=!1,S.ht&&(ae=!0,ie.hpt=parseFloat(S.ht),ie.hpx=nd(ie.hpt)),S.hidden=="1"&&(ae=!0,ie.hidden=!0),S.outlineLevel!=null&&(ae=!0,ie.level=+S.outlineLevel),ae&&(z[C-1]=ie)}break;case"<":te=m;break}if(te>=m)break;if(S=Ae(h.slice(te,m),!0),C=S.r!=null?parseInt(S.r,10):C+1,T=-1,!(u.sheetRows&&u.sheetRows<C)){d.s.r>C-1&&(d.s.r=C-1),d.e.r<C-1&&(d.e.r=C-1),u&&u.cellStyles&&(ie={},ae=!1,S.ht&&(ae=!0,ie.hpt=parseFloat(S.ht),ie.hpx=nd(ie.hpt)),S.hidden=="1"&&(ae=!0,ie.hidden=!0),S.outlineLevel!=null&&(ae=!0,ie.level=+S.outlineLevel),ae&&(z[C-1]=ie)),g=h.slice(m).split(e);for(var oe=0;oe!=g.length&&g[oe].trim().charAt(0)=="<";++oe);for(g=g.slice(oe),m=0;m!=g.length;++m)if(h=g[m].trim(),h.length!==0){if(v=h.match(r),w=m,y=0,b=0,h="<c "+(h.slice(0,1)=="<"?">":"")+h,v!=null&&v.length===2){for(w=0,E=v[1],y=0;y!=E.length&&!((b=E.charCodeAt(y)-64)<1||b>26);++y)w=26*w+b;--w,T=w}else++T;for(y=0;y!=h.length&&h.charCodeAt(y)!==62;++y);if(++y,S=Ae(h.slice(0,y),!0),S.r||(S.r=Oe({r:C-1,c:T})),E=h.slice(y),k={t:""},(v=E.match(s))!=null&&v[1]!==""&&(k.v=Ge(v[1])),u.cellFormula){if((v=E.match(a))!=null&&v[1]!==""){if(k.f=Ge(it(v[1])).replace(/\r\n/g,`
`),u.xlfn||(k.f=J_(k.f)),v[0].indexOf('t="array"')>-1)k.F=(E.match(i)||[])[1],k.F.indexOf(":")>-1&&K.push([_t(k.F),k.F]);else if(v[0].indexOf('t="shared"')>-1){I=Ae(v[0]);var le=Ge(it(v[1]));u.xlfn||(le=J_(le)),Q[parseInt(I.si,10)]=[I,le,S.r]}}else(v=E.match(/<f[^>]*\/>/))&&(I=Ae(v[0]),Q[I.si]&&(k.f=xq(Q[I.si][1],Q[I.si][2],S.r)));var ne=Dr(S.r);for(y=0;y<K.length;++y)ne.r>=K[y][0].s.r&&ne.r<=K[y][0].e.r&&ne.c>=K[y][0].s.c&&ne.c<=K[y][0].e.c&&(k.F=K[y][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(D)k.t="z";else continue;else k.t=S.t||"n";switch(d.s.c>T&&(d.s.c=T),d.e.c<T&&(d.e.c=T),k.t){case"n":if(k.v==""||k.v==null){if(!D)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!D)continue;k.t="z"}else P=vu[parseInt(k.v,10)],k.v=P.t,k.r=P.r,u.cellHTML&&(k.h=P.h);break;case"str":k.t="s",k.v=k.v!=null?it(k.v):"",u.cellHTML&&(k.h=Gx(k.v));break;case"inlineStr":v=E.match(n),k.t="s",v!=null&&(P=ry(v[1]))?(k.v=P.t,u.cellHTML&&(k.h=P.h)):k.v="";break;case"b":k.v=ut(k.v);break;case"d":u.cellDates?k.v=er(k.v,1):(k.v=Mr(er(k.v,1)),k.t="n");break;case"e":(!u||u.cellText!==!1)&&(k.w=k.v),k.v=aO[k.v];break}if(R=H=0,X=null,q&&S.s!==void 0&&(X=p.CellXf[S.s],X!=null&&(X.numFmtId!=null&&(R=X.numFmtId),u.cellStyles&&X.fillId!=null&&(H=X.fillId))),zO(k,R,H,u,f,p),u.cellDates&&q&&k.t=="n"&&hc(De[R])&&(k.t="d",k.v=rp(k.v)),S.cm&&u.xlmeta){var he=(u.xlmeta.Cell||[])[+S.cm-1];he&&he.type=="XLDAPR"&&(k.D=!0)}if(G){var F=Dr(S.r);c[F.r]||(c[F.r]=[]),c[F.r][F.c]=k}else c[S.r]=k}}}}z.length>0&&(c["!rows"]=z)}}();function lY(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var cY=Ao;function uY(){}function dY(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=DH(e),r}function fY(e){var t=Fn(e);return[t]}function hY(e){var t=Co(e);return[t]}function pY(e){var t=Fn(e),r=e.read_shift(1);return[t,r,"b"]}function mY(e){var t=Co(e),r=e.read_shift(1);return[t,r,"b"]}function gY(e){var t=Fn(e),r=e.read_shift(1);return[t,r,"e"]}function vY(e){var t=Co(e),r=e.read_shift(1);return[t,r,"e"]}function xY(e){var t=Fn(e),r=e.read_shift(4);return[t,r,"s"]}function yY(e){var t=Co(e),r=e.read_shift(4);return[t,r,"s"]}function wY(e){var t=Fn(e),r=xr(e);return[t,r,"n"]}function BO(e){var t=Co(e),r=xr(e);return[t,r,"n"]}function bY(e){var t=Fn(e),r=Zx(e);return[t,r,"n"]}function _Y(e){var t=Co(e),r=Zx(e);return[t,r,"n"]}function SY(e){var t=Fn(e),r=Qx(e);return[t,r,"is"]}function EY(e){var t=Fn(e),r=br(e);return[t,r,"str"]}function TY(e){var t=Co(e),r=br(e);return[t,r,"str"]}function kY(e,t,r){var n=e.l+t,i=Fn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=sp(e,n-e.l,r);a[3]=gr(o,null,i,r.supbooks,r)}else e.l=n;return a}function CY(e,t,r){var n=e.l+t,i=Fn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=sp(e,n-e.l,r);a[3]=gr(o,null,i,r.supbooks,r)}else e.l=n;return a}function AY(e,t,r){var n=e.l+t,i=Fn(e);i.r=r["!row"];var s=xr(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=sp(e,n-e.l,r);a[3]=gr(o,null,i,r.supbooks,r)}else e.l=n;return a}function RY(e,t,r){var n=e.l+t,i=Fn(e);i.r=r["!row"];var s=br(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=sp(e,n-e.l,r);a[3]=gr(o,null,i,r.supbooks,r)}else e.l=n;return a}var PY=Ao;function OY(e,t){var r=e.l+t,n=Ao(e),i=Jx(e),s=br(e),a=br(e),o=br(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function IY(){}function DY(e,t,r){var n=e.l+t,i=nO(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=zX(e,n-e.l,r);a[1]=o}else e.l=n;return a}function NY(e,t,r){var n=e.l+t,i=Ao(e),s=[i];if(r.cellFormula){var a=BX(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}var FY=["left","right","top","bottom","header","footer"];function MY(e){var t={};return FY.forEach(function(r){t[r]=xr(e)}),t}function LY(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function zY(){}function jY(){}function BY(e,t,r,n,i,s,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,f=!1,p,m,h,g,v,w,y,b,E,k=[];o.biff=12,o["!row"]=0;var S=0,C=!1,T=[],P={},I=o.supbooks||i.supbooks||[[]];if(I.sharedf=P,I.arrayf=T,I.SheetNames=i.SheetNames||i.Sheets.map(function(G){return G.name}),!o.supbooks&&(o.supbooks=I,i.Names))for(var R=0;R<i.Names.length;++R)I[0][R+1]=i.Names[R];var H=[],q=[],X=!1;u0[16]={n:"BrtShortReal",f:BO};var K;if(os(e,function(z,ie,ae){if(!f)switch(ae){case 148:c=z;break;case 0:p=z,o.sheetRows&&o.sheetRows<=p.r&&(f=!0),b=or(g=p.r),o["!row"]=p.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=nd(z.hpt)),q[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:z[2]},z[2]){case"n":m.v=z[1];break;case"s":y=vu[z[1]],m.v=y.t,m.r=y.r;break;case"b":m.v=!!z[1];break;case"e":m.v=z[1],o.cellText!==!1&&(m.w=Ro[m.v]);break;case"str":m.t="s",m.v=z[1];break;case"is":m.t="s",m.v=z[1].t;break}if((h=a.CellXf[z[0].iStyleRef])&&zO(m,h.numFmtId,null,o,s,a),v=z[0].c==-1?v+1:z[0].c,o.dense?(l[g]||(l[g]=[]),l[g][v]=m):l[Wt(v)+b]=m,o.cellFormula){for(C=!1,S=0;S<T.length;++S){var D=T[S];p.r>=D[0].s.r&&p.r<=D[0].e.r&&v>=D[0].s.c&&v<=D[0].e.c&&(m.F=He(D[0]),C=!0)}!C&&z.length>3&&(m.f=z[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),o.cellDates&&h&&m.t=="n"&&hc(De[h.numFmtId])){var V=$a(m.v);V&&(m.t="d",m.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}K&&(K.type=="XLDAPR"&&(m.D=!0),K=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;m={t:"z",v:void 0},v=z[0].c==-1?v+1:z[0].c,o.dense?(l[g]||(l[g]=[]),l[g][v]=m):l[Wt(v)+b]=m,u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),K&&(K.type=="XLDAPR"&&(m.D=!0),K=void 0);break;case 176:k.push(z);break;case 49:K=((o.xlmeta||{}).Cell||[])[z-1];break;case 494:var B=n["!id"][z.relId];for(B?(z.Target=B.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=B):z.relId==""&&(z.Target="#"+z.loc),g=z.rfx.s.r;g<=z.rfx.e.r;++g)for(v=z.rfx.s.c;v<=z.rfx.e.c;++v)o.dense?(l[g]||(l[g]=[]),l[g][v]||(l[g][v]={t:"z",v:void 0}),l[g][v].l=z):(w=Oe({c:v,r:g}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=z);break;case 426:if(!o.cellFormula)break;T.push(z),E=o.dense?l[g][v]:l[Wt(v)+b],E.f=gr(z[1],u,{r:p.r,c:v},I,o),E.F=He(z[0]);break;case 427:if(!o.cellFormula)break;P[Oe(z[0].s)]=z[1],E=o.dense?l[g][v]:l[Wt(v)+b],E.f=gr(z[1],u,{r:p.r,c:v},I,o);break;case 60:if(!o.cellStyles)break;for(;z.e>=z.s;)H[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},X||(X=!0,ny(z.w/256)),Zl(H[z.e+1]);break;case 161:l["!autofilter"]={ref:He(z)};break;case 476:l["!margins"]=z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),z.name&&(i.Sheets[r].CodeName=z.name),(z.above||z.left)&&(l["!outline"]={above:z.above,left:z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ie.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ae.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=He(c||u)),o.sheetRows&&l["!ref"]){var Q=_t(l["!ref"]);o.sheetRows<=+Q.e.r&&(Q.e.r=o.sheetRows-1,Q.e.r>u.e.r&&(Q.e.r=u.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>u.e.c&&(Q.e.c=u.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=He(Q))}return k.length>0&&(l["!merges"]=k),H.length>0&&(l["!cols"]=H),q.length>0&&(l["!rows"]=q),l}function UY(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var i=Ge((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function $Y(e,t,r,n,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=UY(d);u.s.r=u.s.c=0,u.e.c=o,c=Wt(o),f[0].forEach(function(p,m){a[c+or(m)]={t:"n",v:p,z:f[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=He(u)),a}function VY(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(jO);return o&&sy(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function HY(e,t){e.l+=10;var r=br(e);return{name:r}}function WY(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return os(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var UO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],GY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],KY=[],qY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function nS(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ut(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function iS(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ut(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function $O(e){iS(e.WBProps,UO),iS(e.CalcPr,qY),nS(e.WBView,GY),nS(e.Sheets,KY),bl.date1904=ut(e.WBProps.date1904)}var XY="][*?/\\".split("");function YY(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return XY.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var QY=/<\w+:workbook/;function JY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(e.replace(Tr,function(l,c){var u=Ae(l);switch(Pi(u[0])){case"<?xml":break;case"<workbook":l.match(QY)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":UO.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=ut(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=it(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ge(it(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=it(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),ut(u.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Ge(it(e.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),gH.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $O(r),r}function ZY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Cv(e),r.name=br(e),r}function eQ(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?br(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function tQ(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function rQ(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=NH(e),a=jX(e,0,r),o=Jx(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function nQ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],u0[16]={n:"BrtFRTArchID$",f:tQ},os(e,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=gr(l.Ptg,null,null,a,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),$O(r),r.Names=s,r.supbooks=a,r}function iQ(e,t,r){return t.slice(-4)===".bin"?nQ(e,r):JY(e,r)}function sQ(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?BY(e,n,r,i,s,a,o):ZX(e,n,r,i,s,a,o)}function aQ(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?WY(e,n,r,i,s):VY(e,n,r,i,s)}function oQ(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?mq():gq()}function lQ(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?hq():pq()}function cQ(e,t,r,n){return t.slice(-4)===".bin"?PK(e,r,n):EK(e,r,n)}function uQ(e,t,r){return AO(e,r)}function dQ(e,t,r){return t.slice(-4)===".bin"?GG(e,r):HG(e,r)}function fQ(e,t,r){return t.slice(-4)===".bin"?uq(e,r):sq(e,r)}function hQ(e,t,r){return t.slice(-4)===".bin"?rq(e):eq(e)}function pQ(e,t,r,n){return r.slice(-4)===".bin"?nq(e,t,r,n):void 0}function mQ(e,t,r){return t.slice(-4)===".bin"?JK(e,t,r):ZK(e,t,r)}var VO=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,HO=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(VO),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(HO),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function gQ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(VO),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(HO),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var yu;function vQ(e,t){var r=yu[e]||Ge(e);return r==="General"?vo(t):Dn(r,t)}function xQ(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ut(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=er(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ge(t)]=i}function yQ(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ro[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ju(e.v):e.w=vo(e.v):e.w=vQ(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=yu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&hc(n)){var i=$a(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function wQ(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=xK[n.Pattern]||n.Pattern)}e[t.ID]=t}function bQ(e,t,r,n,i,s,a,o,l,c){var u="General",d=n.StyleID,f={};c=c||{};var p=[],m=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&a&&(d=a.StyleID);s[d]!==void 0&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&p.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ut(e);break;case"String":n.t="s",n.r=k_(Ge(e)),n.v=e.indexOf("<")>-1?Ge(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(er(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ge(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=aO[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=k_(t||e));break}if(yQ(n,u,c),c.cellFormula!==!1)if(n.Formula){var h=Ge(n.Formula);h.charCodeAt(0)==61&&(h=h.slice(1)),n.f=wl(h,i),delete n.Formula,n.ArrayRange=="RC"?n.F=wl("RC:RC",i):n.ArrayRange&&(n.F=wl(n.ArrayRange,i),l.push([_t(n.F),n.F]))}else for(m=0;m<l.length;++m)i.r>=l[m][0].s.r&&i.r<=l[m][0].e.r&&i.c>=l[m][0].s.c&&i.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(p.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function _Q(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rm(e,t){var r=t||{};IP();var n=Wc(Kx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=it(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=ar(r);return a.type="string",td.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){i.indexOf("<"+tt)>=0&&(s=!0)}),s)return OQ(n,r);yu={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},d=[],f=r.dense?[]:{},p="",m={},h={},g=jn('<Data ss:Type="String">'),v=0,w=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},k={},S="",C=0,T=[],P={},I={},R=0,H=[],q=[],X={},K=[],Q,G=!1,z=[],ie=[],ae={},D=0,V=0,B={Sheets:[],WBProps:{date1904:!1}},U={};ed.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";o=ed.exec(n);)switch(o[3]=(Y=o[3]).toLowerCase()){case"data":if(Y=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?bQ(n.slice(v,o.index),S,g,l[l.length-1][0]=="comment"?X:m,{c:w,r:y},E,K[w],h,z,r):(S="",g=jn(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(q.length>0&&(m.c=q),(!r.sheetRows||r.sheetRows>y)&&m.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][w]=m):f[Wt(w)+or(y)]=m),m.HRef&&(m.l={Target:Ge(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(D=w+(parseInt(m.MergeAcross,10)|0),V=y+(parseInt(m.MergeDown,10)|0),T.push({s:{c:w,r:y},e:{c:D,r:V}})),!r.sheetStubs)m.MergeAcross?w=D+1:++w;else if(m.MergeAcross||m.MergeDown){for(var te=w;te<=D;++te)for(var oe=y;oe<=V;++oe)(te>w||oe>y)&&(r.dense?(f[oe]||(f[oe]=[]),f[oe][te]={t:"z"}):f[Wt(te)+or(oe)]={t:"z"});w=D+1}else++w;else m=gQ(o[0]),m.Index&&(w=+m.Index-1),w<b.s.c&&(b.s.c=w),w>b.e.c&&(b.e.c=w),o[0].slice(-2)==="/>"&&++w,q=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),o[0].slice(-2)==="/>"&&(h=jn(o[0]),h.Index&&(y=+h.Index-1)),w=0,++y):(h=jn(o[0]),h.Index&&(y=+h.Index-1),ae={},(h.AutoFitHeight=="0"||h.Height)&&(ae.hpx=parseInt(h.Height,10),ae.hpt=CO(ae.hpx),ie[y]=ae),h.Hidden=="1"&&(ae.hidden=!0,ie[y]=ae));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(f["!ref"]=He(b),r.sheetRows&&r.sheetRows<=b.e.r&&(f["!fullref"]=f["!ref"],b.e.r=r.sheetRows-1,f["!ref"]=He(b))),T.length&&(f["!merges"]=T),K.length>0&&(f["!cols"]=K),ie.length>0&&(f["!rows"]=ie),u[p]=f}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,l.push([o[3],!1]),c=jn(o[0]),p=Ge(c.Name),f=r.dense?[]:{},T=[],z=[],ie=[],U={name:p,Hidden:0},B.Sheets.push(U);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),K=[],G=!1}break;case"style":o[1]==="/"?wQ(E,k,r):k=jn(o[0]);break;case"numberformat":k.nf=Ge(jn(o[0]).Format||"General"),yu[k.nf]&&(k.nf=yu[k.nf]);for(var le=0;le!=392&&De[le]!=k.nf;++le);if(le==392){for(le=57;le!=392;++le)if(De[le]==null){to(k.nf,le);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Q=jn(o[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!G&&Q.wpx>10){G=!0,Ir=TO;for(var ne=0;ne<K.length;++ne)K[ne]&&Zl(K[ne])}G&&Zl(Q),K[Q.Index-1||K.length]=Q;for(var he=0;he<+Q.Span;++he)K[K.length]=ar(Q);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var F=Ae(o[0]),Se={Name:F.Name,Ref:wl(F.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Se.Sheet=B.Sheets.length-1),B.Names.push(Se);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=jn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?sW(P,Y,n.slice(R,o.index)):R=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));_Q(X),q.push(X)}else l.push([o[3],!1]),c=jn(o[0]),X={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ee=jn(o[0]);f["!autofilter"]={ref:wl(Ee.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return uS(n,r);var Fe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(R,o.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else R=o.index+o[0].length;break;case"header":f["!margins"]||xu(f["!margins"]={},"xlml"),isNaN(+Ae(o[0]).Margin)||(f["!margins"].header=+Ae(o[0]).Margin);break;case"footer":f["!margins"]||xu(f["!margins"]={},"xlml"),isNaN(+Ae(o[0]).Margin)||(f["!margins"].footer=+Ae(o[0]).Margin);break;case"pagemargins":var ke=Ae(o[0]);f["!margins"]||xu(f["!margins"]={},"xlml"),isNaN(+ke.Top)||(f["!margins"].top=+ke.Top),isNaN(+ke.Left)||(f["!margins"].left=+ke.Left),isNaN(+ke.Right)||(f["!margins"].right=+ke.Right),isNaN(+ke.Bottom)||(f["!margins"].bottom=+ke.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?xQ(I,Y,H,n.slice(R,o.index)):(H=o,R=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var fe={};return!r.bookSheets&&!r.bookProps&&(fe.Sheets=u),fe.SheetNames=d,fe.Workbook=B,fe.SSF=ar(De),fe.Props=P,fe.Custprops=I,fe}function Ov(e,t){switch(ly(t=t||{}),t.type||"base64"){case"base64":return Rm(un(e),t);case"binary":case"buffer":case"file":return Rm(e,t);case"array":return Rm(ko(e),t)}}function SQ(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=LH(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=zH(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var EQ=[60,1084,2066,2165,2175];function TQ(e,t,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Gi(r,r.l),c=Iv[l],u=0;c!=null&&EQ.indexOf(l)>-1;)s=Gi(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,c=Iv[l=Gi(r,r.l)];var d=Es(a);nr(d,0);var f=0;d.lens=[];for(var p=0;p<a.length;++p)d.lens.push(f),f+=a[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,i)}function ui(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=De[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ro[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ju(e.v):e.w=vo(e.v):e.w=Dn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&hc(De[n]||String(n))){var i=$a(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Ff(e,t,r){return{v:e,ixfe:t,t:r}}function kQ(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},a={},o=null,l=[],c="",u={},d,f="",p,m,h,g,v={},w=[],y,b,E=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},T=function(me){return me<8?ro[me]:me<64&&k[me-8]||ro[me]},P=function(me,ct,qt){var zt=ct.XF.data;if(!(!zt||!zt.patternType||!qt||!qt.cellStyles)){ct.s={},ct.s.patternType=zt.patternType;var xa;(xa=rd(T(zt.icvFore)))&&(ct.s.fgColor={rgb:xa}),(xa=rd(T(zt.icvBack)))&&(ct.s.bgColor={rgb:xa})}},I=function(me,ct,qt){if(!(ae>1)&&!(qt.sheetRows&&me.r>=qt.sheetRows)){if(qt.cellStyles&&ct.XF&&ct.XF.data&&P(me,ct,qt),delete ct.ixfe,delete ct.XF,d=me,f=Oe(me),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),me.r<a.s.r&&(a.s.r=me.r),me.c<a.s.c&&(a.s.c=me.c),me.r+1>a.e.r&&(a.e.r=me.r+1),me.c+1>a.e.c&&(a.e.c=me.c+1),qt.cellFormula&&ct.f){for(var zt=0;zt<w.length;++zt)if(!(w[zt][0].s.c>me.c||w[zt][0].s.r>me.r)&&!(w[zt][0].e.c<me.c||w[zt][0].e.r<me.r)){ct.F=He(w[zt][0]),(w[zt][0].s.c!=me.c||w[zt][0].s.r!=me.r)&&delete ct.f,ct.f&&(ct.f=""+gr(w[zt][1],a,me,z,R));break}}qt.dense?(i[me.r]||(i[me.r]=[]),i[me.r][me.c]=ct):i[f]=ct}},R={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(R.password=t.password);var H,q=[],X=[],K=[],Q=[],G=!1,z=[];z.SheetNames=R.snames,z.sharedf=R.sharedf,z.arrayf=R.arrayf,z.names=[],z.XTI=[];var ie=0,ae=0,D=0,V=[],B=[],U;R.codepage=1200,Zn(1200);for(var Y=!1;e.l<e.length-1;){var te=e.l,oe=e.read_shift(2);if(oe===0&&ie===10)break;var le=e.l===e.length?0:e.read_shift(2),ne=Iv[oe];if(ne&&ne.f){if(t.bookSheets&&ie===133&&oe!==133)break;if(ie=oe,ne.r===2||ne.r==12){var he=e.read_shift(2);if(le-=2,!R.enc&&he!==oe&&((he&255)<<8|he>>8)!==oe)throw new Error("rt mismatch: "+he+"!="+oe);ne.r==12&&(e.l+=10,le-=10)}var F={};if(oe===10?F=ne.f(e,le,R):F=TQ(oe,ne,e,le,R),ae==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(oe){case 34:r.opts.Date1904=S.WBProps.date1904=F;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(e.l=0),R.enc=F,!t.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=F;break;case 66:var Se=Number(F);switch(Se){case 21010:Se=1200;break;case 32768:Se=1e4;break;case 32769:Se=1252;break}Zn(R.codepage=Se),Y=!0;break;case 317:R.rrtabid=F;break;case 25:R.winlocked=F;break;case 439:r.opts.RefreshAll=F;break;case 12:r.opts.CalcCount=F;break;case 16:r.opts.CalcDelta=F;break;case 17:r.opts.CalcIter=F;break;case 13:r.opts.CalcMode=F;break;case 14:r.opts.CalcPrecision=F;break;case 95:r.opts.CalcSaveRecalc=F;break;case 15:R.CalcRefMode=F;break;case 2211:r.opts.FullCalc=F;break;case 129:F.fDialog&&(i["!type"]="dialog"),F.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),F.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:E.push(F);break;case 430:z.push([F]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(F);break;case 24:case 536:U={Name:F.Name,Ref:gr(F.rgce,a,null,z,R)},F.itab>0&&(U.Sheet=F.itab-1),z.names.push(U),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(B[F.itab-1]={ref:He(F.rgce[0][0][1][2])});break;case 22:R.ExternCount=F;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(F),z.XTI=z.XTI.concat(F);break;case 2196:if(R.biff<8)break;U!=null&&(U.Comment=F[1]);break;case 18:i["!protect"]=F;break;case 19:F!==0&&R.WTF&&console.error("Password verifier: "+F);break;case 133:s[F.pos]=F,R.snames.push(F.name);break;case 10:{if(--ae)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=He(a),t.sheetRows&&t.sheetRows<=a.e.r){var Ee=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=He(a),a.e.r=Ee}a.e.r++,a.e.c++}q.length>0&&(i["!merges"]=q),X.length>0&&(i["!objects"]=X),K.length>0&&(i["!cols"]=K),Q.length>0&&(i["!rows"]=Q),S.Sheets.push(C)}c===""?u=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[oe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),R.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(R.biff=5,Y=!0,Zn(R.codepage=28591)),R.biff==8&&F.BIFFVer==0&&F.dt==16&&(R.biff=2),ae++)break;if(i=t.dense?[]:{},R.biff<8&&!Y&&(Y=!0,Zn(R.codepage=t.codepage||1252)),R.biff<5||F.BIFFVer==0&&F.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Fe={pos:e.l-le,name:c};s[Fe.pos]=Fe,R.snames.push(c)}else c=(s[te]||{name:""}).name;F.dt==32&&(i["!type"]="chart"),F.dt==64&&(i["!type"]="macro"),q=[],X=[],R.arrayf=w=[],K=[],Q=[],G=!1,C={Hidden:(s[te]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[F.r]||[])[F.c]:i[Oe({c:F.c,r:F.r})])&&++F.c,y={ixfe:F.ixfe,XF:E[F.ixfe]||{},v:F.val,t:"n"},D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:F.c,r:F.r},y,t);break;case 5:case 517:y={ixfe:F.ixfe,XF:E[F.ixfe],v:F.val,t:F.t},D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:F.c,r:F.r},y,t);break;case 638:y={ixfe:F.ixfe,XF:E[F.ixfe],v:F.rknum,t:"n"},D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:F.c,r:F.r},y,t);break;case 189:for(var ke=F.c;ke<=F.C;++ke){var fe=F.rkrec[ke-F.c][0];y={ixfe:fe,XF:E[fe],v:F.rkrec[ke-F.c][1],t:"n"},D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:ke,r:F.r},y,t)}break;case 6:case 518:case 1030:{if(F.val=="String"){o=F;break}if(y=Ff(F.val,F.cell.ixfe,F.tt),y.XF=E[y.ixfe],t.cellFormula){var tt=F.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var St=tt[0][0][1][0],xt=tt[0][0][1][1],Mt=Oe({r:St,c:xt});v[Mt]?y.f=""+gr(F.formula,a,F.cell,z,R):y.F=((t.dense?(i[St]||[])[xt]:i[Mt])||{}).F}else y.f=""+gr(F.formula,a,F.cell,z,R)}D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I(F.cell,y,t),o=F}break;case 7:case 519:if(o)o.val=F,y=Ff(F,o.cell.ixfe,"s"),y.XF=E[y.ixfe],t.cellFormula&&(y.f=""+gr(o.formula,a,o.cell,z,R)),D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(F);var Xr=Oe(F[0].s);if(p=t.dense?(i[F[0].s.r]||[])[F[0].s.c]:i[Xr],t.cellFormula&&p){if(!o||!Xr||!p)break;p.f=""+gr(F[1],a,F[0],z,R),p.F=He(F[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;v[Oe(o.cell)]=F[0],p=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Oe(o.cell)],(p||{}).f=""+gr(F[0],a,d,z,R)}}break;case 253:y=Ff(l[F.isst].t,F.ixfe,"s"),l[F.isst].h&&(y.h=l[F.isst].h),y.XF=E[y.ixfe],D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:F.c,r:F.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:F.ixfe,XF:E[F.ixfe],t:"z"},D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:F.c,r:F.r},y,t));break;case 190:if(t.sheetStubs)for(var Lt=F.c;Lt<=F.C;++Lt){var cr=F.ixfe[Lt-F.c];y={ixfe:cr,XF:E[cr],t:"z"},D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:Lt,r:F.r},y,t)}break;case 214:case 516:case 4:y=Ff(F.val,F.ixfe,"s"),y.XF=E[y.ixfe],D>0&&(y.z=V[y.ixfe>>8&63]),ui(y,t,r.opts.Date1904),I({c:F.c,r:F.r},y,t);break;case 0:case 512:ae===1&&(a=F);break;case 252:l=F;break;case 1054:if(R.biff==4){V[D++]=F[1];for(var hn=0;hn<D+163&&De[hn]!=F[1];++hn);hn>=163&&to(F[1],D+163)}else to(F[1],F[0]);break;case 30:{V[D++]=F;for(var kr=0;kr<D+163&&De[kr]!=F;++kr);kr>=163&&to(F,D+163)}break;case 229:q=q.concat(F);break;case 93:X[F.cmo[0]]=R.lastobj=F;break;case 438:R.lastobj.TxO=F;break;case 127:R.lastobj.ImData=F;break;case 440:for(g=F[0].s.r;g<=F[0].e.r;++g)for(h=F[0].s.c;h<=F[0].e.c;++h)p=t.dense?(i[g]||[])[h]:i[Oe({c:h,r:g})],p&&(p.l=F[1]);break;case 2048:for(g=F[0].s.r;g<=F[0].e.r;++g)for(h=F[0].s.c;h<=F[0].e.c;++h)p=t.dense?(i[g]||[])[h]:i[Oe({c:h,r:g})],p&&p.l&&(p.l.Tooltip=F[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;p=t.dense?(i[F[0].r]||[])[F[0].c]:i[Oe(F[0])];var pn=X[F[2]];p||(t.dense?(i[F[0].r]||(i[F[0].r]=[]),p=i[F[0].r][F[0].c]={t:"z"}):p=i[Oe(F[0])]={t:"z"},a.e.r=Math.max(a.e.r,F[0].r),a.s.r=Math.min(a.s.r,F[0].r),a.e.c=Math.max(a.e.c,F[0].c),a.s.c=Math.min(a.s.c,F[0].c)),p.c||(p.c=[]),m={a:F[1],t:pn.TxO.t},p.c.push(m)}break;case 2173:qK(E[F.ixfe],F.ext);break;case 125:{if(!R.cellStyles)break;for(;F.e>=F.s;)K[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},G||(G=!0,ny(F.w/256)),Zl(K[F.e+1])}break;case 520:{var Et={};F.level!=null&&(Q[F.r]=Et,Et.level=F.level),F.hidden&&(Q[F.r]=Et,Et.hidden=!0),F.hpt&&(Q[F.r]=Et,Et.hpt=F.hpt,Et.hpx=nd(F.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||xu(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[oe]]=F;break;case 161:i["!margins"]||xu(i["!margins"]={}),i["!margins"].header=F.header,i["!margins"].footer=F.footer;break;case 574:F.RTL&&(S.Views[0].RTL=!0);break;case 146:k=F;break;case 2198:H=F;break;case 140:b=F;break;case 442:c?C.CodeName=F||C.name:S.WBProps.CodeName=F||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+oe.toString(16)),e.l+=le}return r.SheetNames=Ai(s).sort(function(Kt,me){return Number(Kt)-Number(me)}).map(function(Kt){return s[Kt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&B.forEach(function(Kt,me){r.Sheets[r.SheetNames[me]]["!autofilter"]=Kt}),r.Strings=l,r.SSF=ar(De),R.enc&&(r.Encryption=R.enc),H&&(r.Themes=H),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),z.names.length>0&&(S.Names=z.names),r.Workbook=S,r}var sS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function CQ(e,t,r){var n=Ve.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=$_(n,HH,sS.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Ve.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=$_(a,WH,sS.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(lO(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function WO(e,t){t||(t={}),ly(t),wP(),t.codepage&&Bx(t.codepage);var r,n;if(e.FullPaths){if(Ve.find(e,"/encryption"))throw new Error("File is password-protected");r=Ve.find(e,"!CompObj"),n=Ve.find(e,"/Workbook")||Ve.find(e,"/Book")}else{switch(t.type){case"base64":e=Qn(un(e));break;case"binary":e=Qn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}nr(e,0),n={content:e}}var i,s;if(r&&SQ(r),t.bookProps&&!t.bookSheets)i={};else{var a=$e?"buffer":"array";if(n&&n.content)i=kQ(n.content,t);else if((s=Ve.find(e,"PerfectOffice_MAIN"))&&s.content)i=gu.to_workbook(s.content,(t.type=a,t));else if((s=Ve.find(e,"NativeContent_MAIN"))&&s.content)i=gu.to_workbook(s.content,(t.type=a,t));else throw(s=Ve.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ve.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=fq(e))}var o={};return e.FullPaths&&CQ(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var u0={0:{f:lY},1:{f:fY},2:{f:bY},3:{f:gY},4:{f:pY},5:{f:wY},6:{f:EY},7:{f:xY},8:{f:RY},9:{f:AY},10:{f:kY},11:{f:CY},12:{f:hY},13:{f:_Y},14:{f:vY},15:{f:mY},16:{f:BO},17:{f:TY},18:{f:yY},19:{f:Qx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:rQ},40:{},42:{},43:{f:kK},44:{f:TK},45:{f:CK},46:{f:RK},47:{f:AK},48:{},49:{f:PH},50:{},51:{f:YK},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:wO},62:{f:SY},63:{f:tq},64:{f:zY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Er,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:LY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dY},148:{f:cY,p:16},151:{f:IY},152:{},153:{f:eQ},154:{},155:{},156:{f:ZY},157:{},158:{},159:{T:1,f:WG},160:{T:-1},161:{T:1,f:Ao},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:PY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:XK},336:{T:-1},337:{f:QK,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:yO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DY},427:{f:NY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:MY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uY},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:OY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cq},633:{T:1},634:{T:-1},635:{T:1,f:lq},636:{T:-1},637:{f:IH},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:HY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Iv={6:{f:Cm},10:{f:fs},12:{f:Dt},13:{f:Dt},14:{f:Tt},15:{f:Tt},16:{f:xr},17:{f:Tt},18:{f:Tt},19:{f:Dt},20:{f:G_},21:{f:G_},23:{f:yO},24:{f:q_},25:{f:Tt},26:{},27:{},28:{f:aG},29:{},34:{f:Tt},35:{f:K_},38:{f:xr},39:{f:xr},40:{f:xr},41:{f:xr},42:{f:Tt},43:{f:Tt},47:{f:uK},49:{f:UW},51:{f:Dt},60:{},61:{f:zW},64:{f:Tt},65:{f:BW},66:{f:Dt},77:{},80:{},81:{},82:{},85:{f:Dt},89:{},90:{},91:{},92:{f:PW},93:{f:lG},94:{},95:{f:Tt},96:{},97:{},99:{f:Tt},125:{f:wO},128:{f:QW},129:{f:OW},130:{f:Dt},131:{f:Tt},132:{f:Tt},133:{f:IW},134:{},140:{f:pG},141:{f:Dt},144:{},146:{f:gG},151:{},152:{},153:{},154:{},155:{},156:{f:Dt},157:{},158:{},160:{f:bG},161:{f:xG},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KW},190:{f:qW},193:{f:fs},197:{},198:{},199:{},200:{},201:{},202:{f:Tt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Dt},220:{},221:{f:Tt},222:{},224:{f:YW},225:{f:RW},226:{f:fs},227:{},229:{f:oG},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:DW},253:{f:$W},255:{f:NW},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:hO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tt},353:{f:fs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:ZW},431:{f:Tt},432:{},433:{},434:{},437:{},438:{f:dG},439:{f:Tt},440:{f:fG},441:{},442:{f:kd},443:{},444:{f:Dt},445:{},446:{},448:{f:fs},449:{f:LW,r:2},450:{f:fs},512:{f:H_},513:{f:wG},515:{f:JW},516:{f:VW},517:{f:W_},519:{f:_G},520:{f:FW},523:{},545:{f:X_},549:{f:V_},566:{},574:{f:jW},638:{f:GW},659:{},1048:{},1054:{f:HW},1084:{},1212:{f:nG},2048:{f:hG},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:If},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:fs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vG,r:12},2173:{f:KK,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:rG,r:12},2197:{},2198:{f:UK,r:12},2199:{},2200:{},2201:{},2202:{f:iG,r:12},2203:{f:fs},2204:{},2205:{},2206:{},2207:{},2211:{f:MW},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Dt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:yG},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mG},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:H_},1:{},2:{f:kG},3:{f:TG},4:{f:EG},5:{f:W_},7:{f:CG},8:{},9:{f:If},11:{},22:{f:Dt},30:{f:WW},31:{},32:{},33:{f:X_},36:{},37:{f:V_},50:{f:AG},62:{},52:{},67:{},68:{f:Dt},69:{},86:{},126:{},127:{f:SG},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RG},223:{},234:{},354:{},421:{},518:{f:Cm},521:{f:If},536:{f:q_},547:{f:K_},561:{},579:{},1030:{f:Cm},1033:{f:If},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Bn(e,t,r,n){var i=t;if(!isNaN(i)){var s=(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&eO(r)&&e.push(r)}}function aS(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,l=JV(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,f=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(a=0;a<l.length;++a){var h=l[a].trim(),g=h.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var v=h.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var w=v[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var E=0;E<m.length;++E){var k=m[E];k.s.c==u&&k.s.r<c&&c<=k.e.r&&(u=k.e.c+1,E=-1)}var S=Ae(w.slice(0,w.indexOf(">")));f=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||f>1)&&m.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+f-1}});var C=S.t||S["data-t"]||"";if(!y.length){u+=f;continue}if(y=UP(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!y.length){u+=f;continue}var T={t:"s",v:y};r.raw||!y.trim().length||C=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(ni(y))?isNaN(Jl(y).getDate())||(T={t:"d",v:er(y)},r.cellDates||(T={t:"n",v:Mr(T.v)}),T.z=r.dateNF||De[14]):T={t:"n",v:ni(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=T):n[Oe({r:c,c:u})]=T,u+=f}}}}return n["!ref"]=He(p),m.length&&(n["!merges"]=m),n}function AQ(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Oe({r,c:a}),d=n.dense?(e[r]||[])[a]:e[u],f=d&&d.v!=null&&(d.h||Gx(d.w||(is(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(pH("td",f,p))}}var m="<tr>";return m+s.join("")+"</tr>"}var RQ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PQ="</body></html>";function OQ(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return va(aS(r[0],t),t);var n=uy();return r.forEach(function(i,s){dy(n,aS(i,t),"Sheet"+(s+1))}),n}function IQ(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function DQ(e,t){var r=t||{},n=r.header!=null?r.header:RQ,i=r.footer!=null?r.footer:PQ,s=[n],a=pc(e["!ref"]);r.dense=Array.isArray(e),s.push(IQ(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(AQ(e,a,o,r));return s.push("</table>"+i),s.join("")}function GO(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Dr(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=pc(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var d=[],f=0,p=e["!rows"]||(e["!rows"]=[]),m=0,h=0,g=0,v=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&h<l;++m){var b=o[m];if(oS(b)){if(n.display)continue;p[h]={hidden:!0}}var E=b.children;for(g=v=0;g<E.length;++g){var k=E[g];if(!(n.display&&oS(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):UP(k.innerHTML),C=k.getAttribute("data-z")||k.getAttribute("z");for(f=0;f<d.length;++f){var T=d[f];T.s.c==v+s&&T.s.r<h+i&&h+i<=T.e.r&&(v=T.e.c+1-s,f=-1)}y=+k.getAttribute("colspan")||1,((w=+k.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:h+i,c:v+s},e:{r:h+i+(w||1)-1,c:v+s+(y||1)-1}});var P={t:"s",v:S},I=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?P.t=I||"z":n.raw||S.trim().length==0||I=="s"||(S==="TRUE"?P={t:"b",v:!0}:S==="FALSE"?P={t:"b",v:!1}:isNaN(ni(S))?isNaN(Jl(S).getDate())||(P={t:"d",v:er(S)},n.cellDates||(P={t:"n",v:Mr(P.v)}),P.z=n.dateNF||De[14]):P={t:"n",v:ni(S)})),P.z===void 0&&C!=null&&(P.z=C);var R="",H=k.getElementsByTagName("A");if(H&&H.length)for(var q=0;q<H.length&&!(H[q].hasAttribute("href")&&(R=H[q].getAttribute("href"),R.charAt(0)!="#"));++q);R&&R.charAt(0)!="#"&&(P.l={Target:R}),n.dense?(e[h+i]||(e[h+i]=[]),e[h+i][v+s]=P):e[Oe({c:v+s,r:h+i})]=P,c.e.c<v+s&&(c.e.c=v+s),v+=y}}++h}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,h-1+i),e["!ref"]=He(c),h>=l&&(e["!fullref"]=He((c.e.r=o.length-m+h-1+i,c))),e}function KO(e,t){var r=t||{},n=r.dense?[]:{};return GO(n,e,t)}function NQ(e,t){return va(KO(e,t),t)}function oS(e){var t="",r=FQ(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function FQ(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function MQ(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ge(t.replace(/<[^>]*>/g,""));return[r]}var lS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qO(e,t){var r=t||{},n=Kx(e),i=[],s,a,o={name:""},l="",c=0,u,d,f={},p=[],m=r.dense?[]:{},h,g,v={value:""},w="",y=0,b=[],E=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,T={},P=[],I={},R=0,H=0,q=[],X=1,K=1,Q=[],G={Names:[]},z={},ie=["",""],ae=[],D={},V="",B=0,U=!1,Y=!1,te=0;for(ed.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");h=ed.exec(n);)switch(h[3]=h[3].replace(/_.*$/,"")){case"table":case"":h[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?m["!ref"]=He(S):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=r.sheetRows-1,m["!ref"]=He(S)),P.length&&(m["!merges"]=P),q.length&&(m["!rows"]=q),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),f[u.name]=m,Y=!1):h[0].charAt(h[0].length-2)!=="/"&&(u=Ae(h[0],!1),E=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,m=r.dense?[]:{},P=[],q=[],Y=!0);break;case"table-row-group":h[1]==="/"?--C:++C;break;case"table-row":case"":if(h[1]==="/"){E+=X,X=1;break}if(d=Ae(h[0],!1),d.?E=d.-1:E==-1&&(E=0),X=+d["number-rows-repeated"]||1,X<10)for(te=0;te<X;++te)C>0&&(q[E+te]={level:C});k=-1;break;case"covered-table-cell":h[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(m[E]||(m[E]=[]),m[E][k]={t:"z"}):m[Oe({r:E,c:k})]={t:"z"}),w="",b=[];break;case"table-cell":case"":if(h[0].charAt(h[0].length-2)==="/")++k,v=Ae(h[0],!1),K=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=rS(Ge(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=Ge(v["string-value"]||""),r.dense?(m[E]||(m[E]=[]),m[E][k]=g):m[Oe({r:E,c:k})]=g),k+=K-1;else if(h[1]!=="/"){++k,w="",y=0,b=[],K=1;var oe=X?E+X-1:E;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),E<S.s.r&&(S.s.r=E),oe>S.e.r&&(S.e.r=oe),v=Ae(h[0],!1),ae=[],D={},g={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ge(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(R=parseInt(v["number-matrix-rows-spanned"],10)||0,H=parseInt(v["number-matrix-columns-spanned"],10)||0,I={s:{r:E,c:k},e:{r:E+R-1,c:k+H-1}},g.F=He(I),Q.push([I,g.F])),v.formula)g.f=rS(v.formula);else for(te=0;te<Q.length;++te)E>=Q[te][0].s.r&&E<=Q[te][0].e.r&&k>=Q[te][0].s.c&&k<=Q[te][0].e.c&&(g.F=Q[te][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(R=parseInt(v["number-rows-spanned"],10)||0,H=parseInt(v["number-columns-spanned"],10)||0,I={s:{r:E,c:k},e:{r:E+R-1,c:k+H-1}},P.push(I)),v["number-columns-repeated"]&&(K=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=ut(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=er(v["date-value"]),r.cellDates||(g.t="n",g.v=Mr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=XV(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=rp(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(w=Ge(v["string-value"]),b=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(U=!1,g.t==="s"&&(g.v=w||"",b.length&&(g.R=b),U=y==0),z.Target&&(g.l=z),ae.length>0&&(g.c=ae,ae=[]),w&&r.cellText!==!1&&(g.w=w),U&&(g.t="z",delete g.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var le=0;le<X;++le){if(K=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[E+le]||(m[E+le]=[]),m[E+le][k]=le==0?g:ar(g);--K>0;)m[E+le][k+K]=ar(g);else for(m[Oe({r:E+le,c:k})]=g;--K>0;)m[Oe({r:E+le,c:k+K})]=ar(g);S.e.c<=k&&(S.e.c=k)}K=parseInt(v["number-columns-repeated"]||"1",10),k+=K-1,K=0,g={},w="",b=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(h[1]==="/"){if((s=i.pop())[0]!==h[3])throw"Bad state: "+s}else h[0].charAt(h[0].length-2)!=="/"&&i.push([h[3],!0]);break;case"annotation":if(h[1]==="/"){if((s=i.pop())[0]!==h[3])throw"Bad state: "+s;D.t=w,b.length&&(D.R=b),D.a=V,ae.push(D)}else h[0].charAt(h[0].length-2)!=="/"&&i.push([h[3],!1]);V="",B=0,w="",y=0,b=[];break;case"creator":h[1]==="/"?V=n.slice(B,h.index):B=h.index+h[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(h[1]==="/"){if((s=i.pop())[0]!==h[3])throw"Bad state: "+s}else h[0].charAt(h[0].length-2)!=="/"&&i.push([h[3],!1]);w="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(h[1]==="/"){if(T[o.name]=l,(s=i.pop())[0]!==h[3])throw"Bad state: "+s}else h[0].charAt(h[0].length-2)!=="/"&&(l="",o=Ae(h[0],!1),i.push([h[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ae(h[0],!1),l+=lS[h[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ae(h[0],!1),l+=lS[h[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(h[0].slice(-2)==="/>")break;if(h[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,h.index);break}else c=h.index+h[0].length;break;case"named-range":a=Ae(h[0],!1),ie=Am(a["cell-range-address"]);var ne={Name:a.name,Ref:ie[0]+"!"+ie[1]};Y&&(ne.Sheet=p.length),G.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(h[1]==="/"&&(!v||!v["string-value"])){var he=MQ(n.slice(y,h.index));w=(w.length>0?w+`
`:"")+he[0]}else Ae(h[0],!1),y=h.index+h[0].length;break;case"s":break;case"database-range":if(h[1]==="/")break;try{ie=Am(Ae(h[0])["target-range-address"]),f[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(h[1]!=="/"){if(z=Ae(h[0],!1),!z.href)break;z.Target=Ge(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(ie=Am(z.Target.slice(1)),z.Target="#"+ie[0]+"!"+ie[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(h[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(h)}}var F={Sheets:f,SheetNames:p,Workbook:G};return r.bookSheets&&delete F.Sheets,F}function cS(e,t){t=t||{},xn(e,"META-INF/manifest.xml")&&JH(It(e,"META-INF/manifest.xml"),t);var r=rn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=qO(it(r),t);return xn(e,"meta.xml")&&(n.Props=oO(It(e,"meta.xml"))),n}function uS(e,t){return qO(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ay(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Dv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):it(ko(e))}function Nv(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function dS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function LQ(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function id(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Gt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function wr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=id(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=id(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function oy(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function zQ(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=id(e,n),s=wr(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Gt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=wr(o.data),c=Gt(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=Gt(s[3][0].data)>>>0>0),r.push(a)}return r}function jQ(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=id(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Nv(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Nv(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function BQ(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jQ(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Nv(t)}function UQ(e,t,r,n){var i=ay(e),s=i.getUint32(4,!0),a=(n>1?12:8)+dS(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=dS(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function $Q(e,t,r){var n=ay(e),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=LQ(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return d}function VQ(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return UQ(e,t,r,e[0]);case 5:return $Q(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Js(e){var t=wr(e);return id(t[1][0].data)}function fS(e,t){var r=wr(t.data),n=Gt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=wr(a.data),l=Gt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Dv(o[3][0].data);break;case 8:{var c=e[Js(o[9][0].data)][0],u=wr(c.data),d=e[Js(u[1][0].data)][0],f=Gt(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var p=wr(d.data);s[l]=p[3].map(function(m){return Dv(m.data)}).join("")}break}}),s}function HQ(e,t){var r,n,i,s,a,o,l,c,u,d,f,p,m,h,g=wr(e),v=Gt(g[1][0].data)>>>0,w=Gt(g[2][0].data)>>>0,y=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Gt(g[8][0].data)>0||!1,b,E;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)b=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,E=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=g[4])==null?void 0:u[0])!=null&&d.data&&t!=1)b=(p=(f=g[4])==null?void 0:f[0])==null?void 0:p.data,E=(h=(m=g[3])==null?void 0:m[0])==null?void 0:h.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=y?4:1,S=ay(b),C=[],T=0;T<b.length/2;++T){var P=S.getUint16(T*2,!0);P<65535&&C.push([T,P])}if(C.length!=w)throw"Expected ".concat(w," cells, found ").concat(C.length);var I=[];for(T=0;T<C.length-1;++T)I[C[T][0]]=E.subarray(C[T][1]*k,C[T+1][1]*k);return C.length>=1&&(I[C[C.length-1][0]]=E.subarray(C[C.length-1][1]*k)),{R:v,cells:I}}function WQ(e,t){var r,n=wr(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Gt(n[7][0].data)>>>0>0?1:0:-1,s=oy(n[5],function(a){return HQ(a,i)});return{nrows:Gt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function GQ(e,t,r){var n,i=wr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Gt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Gt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=He(s);var a=wr(i[4][0].data),o=fS(e,e[Js(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?fS(e,e[Js(a[17][0].data)][0]):[],c=wr(a[3][0].data),u=0;c[1].forEach(function(d){var f=wr(d.data),p=e[Js(f[2][0].data)][0],m=Gt(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var h=WQ(e,p);h.data.forEach(function(g,v){g.forEach(function(w,y){var b=Oe({r:u+v,c:y}),E=VQ(w,o,l);E&&(r[b]=E)})}),u+=h.nrows})}function KQ(e,t){var r=wr(t.data),n={"!ref":"A1"},i=e[Js(r[2][0].data)],s=Gt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return GQ(e,i[0],n),n}function qQ(e,t){var r,n=wr(t.data),i={name:(r=n[1])!=null&&r[0]?Dv(n[1][0].data):"",sheets:[]},s=oy(n[2],Js);return s.forEach(function(a){e[a].forEach(function(o){var l=Gt(o.meta[1][0].data);l==6e3&&i.sheets.push(KQ(e,o))})}),i}function XQ(e,t){var r=uy(),n=wr(t.data),i=oy(n[1],Js);if(i.forEach(function(s){e[s].forEach(function(a){var o=Gt(a.meta[1][0].data);if(o==2){var l=qQ(e,a);l.sheets.forEach(function(c,u){dy(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Pm(e){var t,r,n,i,s={},a=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=BQ(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=zQ(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){s[d.id]=d.messages,a.push(d.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Gt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var u=Gt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return XQ(s,o)}function YQ(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function ly(e){YQ([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function QQ(e){return il.WS.indexOf(e)>-1?"sheet":e==il.CS?"chart":e==il.DS?"dialog":e==il.MS?"macro":e&&e.length?e:"sheet"}function JQ(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,QQ(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function ZQ(e,t,r,n,i,s,a,o,l,c,u,d){try{s[n]=pu(rn(e,r,!0),t);var f=It(e,t),p;switch(o){case"sheet":p=sQ(f,t,i,l,s[n],c,u,d);break;case"chart":if(p=aQ(f,t,i,l,s[n],c,u,d),!p||!p["!drawel"])break;var m=Kc(p["!drawel"].Target,t),h=Av(m),g=iq(rn(e,m,!0),pu(rn(e,h,!0),m)),v=Kc(g,m),w=Av(v);p=$Y(rn(e,v,!0),v,l,pu(rn(e,w,!0),v),c,p);break;case"macro":p=oQ(f,t,i,l,s[n],c,u,d);break;case"dialog":p=lQ(f,t,i,l,s[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var y=[];s&&s[n]&&Ai(s[n]).forEach(function(b){var E="";if(s[n][b].Type==il.CMNT){E=Kc(s[n][b].Target,t);var k=fQ(It(e,E,!0),E,l);if(!k||!k.length)return;Q_(p,k,!1)}s[n][b].Type==il.TCMNT&&(E=Kc(s[n][b].Target,t),y=y.concat(aq(It(e,E,!0),l)))}),y&&y.length&&Q_(p,y,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function gn(e){return e.charAt(0)=="/"?e.slice(1):e}function eJ(e,t){if(IP(),t=t||{},ly(t),xn(e,"META-INF/manifest.xml")||xn(e,"objectdata.xml"))return cS(e,t);if(xn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Pm<"u"){if(e.FileIndex)return Pm(e);var r=Ve.utils.cfb_new();return E_(e).forEach(function(q){tH(r,q,eH(e,q))}),Pm(r)}throw new Error("Unsupported NUMBERS file")}if(!xn(e,"[Content_Types].xml"))throw xn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=E_(e),i=YH(rn(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",It(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!It(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(vu=[],i.sst)try{vu=dQ(It(e,gn(i.sst)),i.sst,t)}catch(q){if(t.WTF)throw q}t.cellStyles&&i.themes.length&&(l=uQ(rn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=cQ(It(e,gn(i.style)),i.style,l,t))}i.links.map(function(q){try{var X=pu(rn(e,Av(gn(q))),q);return pQ(It(e,gn(q)),X,q,t)}catch{}});var u=iQ(It(e,gn(i.workbooks[0])),i.workbooks[0],t),d={},f="";i.coreprops.length&&(f=It(e,gn(i.coreprops[0]),!0),f&&(d=oO(f)),i.extprops.length!==0&&(f=It(e,gn(i.extprops[0]),!0),f&&tW(f,d,t)));var p={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(f=rn(e,gn(i.custprops[0]),!0),f&&(p=nW(f,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(X){return X.name}):d.Worksheets&&d.SheetNames.length>0&&(a=d.SheetNames),t.bookProps&&(m.Props=d,m.Custprops=p),t.bookSheets&&typeof a<"u"&&(m.SheetNames=a),t.bookSheets?m.SheetNames:t.bookProps))return m;a={};var h={};t.bookDeps&&i.calcchain&&(h=hQ(It(e,gn(i.calcchain)),i.calcchain));var g=0,v={},w,y;{var b=u.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var E=0;E!=b.length;++E)d.SheetNames[E]=b[E].name}var k=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),C=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");xn(e,C)||(C="xl/_rels/workbook."+k+".rels");var T=pu(rn(e,C,!0),C.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=mQ(It(e,gn(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=oq(It(e,gn(i.people[0])),t)),T&&(T=JQ(T,u.Sheets));var P=It(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var I="sheet";if(T&&T[g]?(w="xl/"+T[g][1].replace(/[\/]?xl\//,""),xn(e,w)||(w=T[g][1]),xn(e,w)||(w=C.replace(/_rels\/.*$/,"")+T[g][1]),I=T[g][2]):(w="xl/worksheets/sheet"+(g+1-P)+"."+k,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var R=!1,H=0;H!=t.sheets.length;++H)typeof t.sheets[H]=="number"&&t.sheets[H]==g&&(R=1),typeof t.sheets[H]=="string"&&t.sheets[H].toLowerCase()==d.SheetNames[g].toLowerCase()&&(R=1);if(!R)continue e}}ZQ(e,w,y,d.SheetNames[g],g,v,a,I,t,u,l,c)}return m={Directory:i,Workbook:u,Props:d,Custprops:p,Deps:h,Sheets:a,SheetNames:d.SheetNames,Strings:vu,Styles:c,Themes:l,SSF:ar(De)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(q,X){q=q.replace(/^Root Entry[\/]/,""),m.keys.push(q),m.files[q]=e.FileIndex[X]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=It(e,gn(i.vba[0]),!0):i.defaults&&i.defaults.bin===dq&&(m.vbaraw=It(e,"xl/vbaProject.bin",!0))),m}function tJ(e,t){var r=t||{},n="Workbook",i=Ve.find(e,n);try{if(n="/!DataSpaces/Version",i=Ve.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(KG(i.content),n="/!DataSpaces/DataSpaceMap",i=Ve.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=XG(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ve.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=YG(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ve.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);JG(i.content)}catch{}if(n="/EncryptionInfo",i=Ve.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ZG(i.content);if(n="/EncryptedPackage",i=Ve.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function cy(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=un(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function rJ(e,t){return Ve.find(e,"EncryptedPackage")?tJ(e,t):WO(e,t)}function nJ(e,t){var r,n=e,i=t||{};return i.type||(i.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r=zP(n,i),eJ(r,i)}function XO(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ov(e.slice(r),t);default:break e}return td.to_workbook(e,t)}function iJ(e,t){var r="",n=cy(e,t);switch(t.type){case"base64":r=un(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=xo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=it(r)),t.type="binary",XO(r,t)}function sJ(e,t){var r=e;return t.type=="base64"&&(r=un(r)),r=Ss.utils.decode(1200,r.slice(2),"str"),t.type="binary",XO(r,t)}function aJ(e){return e.match(/[^\x00-\x7F]/)?qc(e):e}function Om(e,t,r,n){return n?(r.type="string",td.to_workbook(e,r)):td.to_workbook(t,r)}function Fv(e,t){wP();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fv(new Uint8Array(e),(r=ar(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),bl={},r.dateNF&&(bl.dateNF=r.dateNF),r.type||(r.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=$e?"buffer":"binary",n=KV(e),typeof Uint8Array<"u"&&!$e&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=aJ(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=ar(r),r.type="array",Fv(Ux(n),r)}switch((i=cy(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return rJ(Ve.read(n,r),r);break;case 9:if(i[1]<=8)return WO(n,r);break;case 60:return Ov(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return NG(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return IG.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?nJ(n,r):Om(e,n,r,s);case 239:return i[3]===60?Ov(n,r):Om(e,n,r,s);case 255:if(i[1]===254)return sJ(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return gu.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return gu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Y_.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return dK.to_workbook(n,r);break;case 10:case 13:case 32:return iJ(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return PG.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Y_.to_workbook(n,r):Om(e,n,r,s)}function oJ(e,t,r,n,i,s,a,o){var l=or(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!a||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=a?e[r][p]:e[n[p]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[p]!=null&&(f[s[p]]=c);continue}var h=m.v;switch(m.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[p]!=null){if(h==null)if(m.t=="e"&&h===null)f[s[p]]=null;else if(c!==void 0)f[s[p]]=c;else if(u&&h===null)f[s[p]]=null;else continue;else f[s[p]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?h:is(m,h,o);h!=null&&(d=!1)}}return{row:f,isempty:d}}function Mv(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=_t(u);break;case"number":l=_t(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var d=or(l.s.r),f=[],p=[],m=0,h=0,g=Array.isArray(e),v=l.s.r,w=0,y={};g&&!e[v]&&(e[v]=[]);var b=c.skipHidden&&e["!cols"]||[],E=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(b[w]||{}).hidden)switch(f[w]=Wt(w),r=g?e[v][w]:e[f[w]+d],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=f[w];break;case 3:s[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=is(r,null,c),h=y[a]||0,!h)y[a]=1;else{do o=a+"_"+h++;while(y[o]);y[a]=h,y[o]=1}s[w]=o}for(v=l.s.r+i;v<=l.e.r;++v)if(!(E[v]||{}).hidden){var k=oJ(e,l,v,f,n,s,g,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[m++]=k.row)}return p.length=m,p}var hS=/"/g;function lJ(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",d=or(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var p=o.dense?(e[r]||[])[f]:e[n[f]+d];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:is(p,null,o));for(var m=0,h=0;m!==u.length;++m)if((h=u.charCodeAt(m))===i||h===s||h===34||o.forceQuotes){u='"'+u.replace(hS,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(hS,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function YO(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=_t(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(f[m]||{}).hidden||(d[m]=Wt(m));for(var h=0,g=i.s.r;g<=i.e.r;++g)(p[g]||{}).hidden||(u=lJ(e,i,g,d,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((h++?o:"")+u)));return delete n.dense,r.join("")}function cJ(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=YO(e,t);return r}function uJ(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=_t(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Wt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=or(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function QO(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var d=_t(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(a=d.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var f=n.header||[],p=0;t.forEach(function(h,g){Ai(h).forEach(function(v){(p=f.indexOf(v))==-1&&(f[p=f.length]=v);var w=h[v],y="z",b="",E=Oe({c:o+p,r:a+g+i});c=sd(s,E),w&&typeof w=="object"&&!(w instanceof Date)?s[E]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=Mr(w)),b=n.dateNF||De[14]):w===null&&n.nullError&&(y="e",w=0),c?(c.t=y,c.v=w,delete c.w,delete c.R,b&&(c.z=b)):s[E]=c={t:y,v:w},b&&(c.z=b))})}),u.e.c=Math.max(u.e.c,o+f.length-1);var m=or(a);if(i)for(p=0;p<f.length;++p)s[Wt(p+o)+m]={t:"s",v:f[p]};return s["!ref"]=He(u),s}function dJ(e,t){return QO(null,e,t)}function sd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Dr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?sd(e,Oe(t)):sd(e,Oe({r:t,c:r||0}))}function fJ(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function uy(){return{SheetNames:[],Sheets:{}}}function dy(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(YY(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function hJ(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=fJ(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function pJ(e,t){return e.z=t,e}function JO(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mJ(e,t,r){return JO(e,"#"+t,r)}function gJ(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vJ(e,t,r,n){for(var i=typeof t!="string"?t:_t(t),s=typeof t=="string"?t:He(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=sd(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Fi={encode_col:Wt,encode_row:or,encode_cell:Oe,encode_range:He,decode_col:Yx,decode_row:Xx,split_cell:RH,decode_cell:Dr,decode_range:pc,format_cell:is,sheet_add_aoa:rO,sheet_add_json:QO,sheet_add_dom:GO,aoa_to_sheet:mc,json_to_sheet:dJ,table_to_sheet:KO,table_to_book:NQ,sheet_to_csv:YO,sheet_to_txt:cJ,sheet_to_json:Mv,sheet_to_html:DQ,sheet_to_formulae:uJ,sheet_to_row_object_array:Mv,sheet_get_cell:sd,book_new:uy,book_append_sheet:dy,book_set_sheet_visibility:hJ,cell_set_number_format:pJ,cell_set_hyperlink:JO,cell_set_internal_link:mJ,cell_add_comment:gJ,sheet_set_array_formula:vJ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Mf={"Ricavi caratteristici":"ricaviCaratteristici","Altri ricavi":"altriRicavi","TOTALE RICAVI":"totaleRicavi","Servizi diretti":"serviziDiretti","Cosulenze dirette":"consulenzeDirette","Consulenze dirette":"consulenzeDirette","Servizi informatici web":"serviziInformatici","Servizi cloud":"serviziCloud","COSTI DIRETTI":"costiDiretti","Altri servizi e prestazioni":"altriServizi","COSTI INDIRETTI":"costiIndiretti","TOTALE COSTI DIRETTI E INDIRETTI":"totaleCostiDirettiIndiretti","GROSS PROFIT":"grossProfit",Autofatture:"autofatture","Rimborsi spese":"rimborsiSpese","Altri proventi":"altriProventi","ALTRI RICAVI NON TIPICI":"ricaviNonTipici","Spese viaggio":"speseViaggio","Pedaggi autostradali":"pedaggi",Pubblicit:"pubblicita","Materiale pubblicitario":"materialePubblicitario",Omaggi:"omaggi","Spese di rappresentanza":"speseRappresentanza","Mostre e fiere":"mostreFiere","Servizi commerciali":"serviziCommerciali",Carburante:"carburante","SPESE COMMERCIALI":"speseCommerciali","Beni indeducibili":"beniIndeducibili","Spese generali":"speseGenerali","Materiale vario e di consumo":"materialeConsumo","Spese di pulizia":"spesePulizia",Utenze:"utenze",Assicurazioni:"assicurazioni",Rimanenze:"rimanenze","Tasse e valori bollati":"tasseValori","Sanzioni e multe":"sanzioniMulte","Compensi amministratore":"compensiAmministratore","Rimborsi amministratore":"rimborsiAmministratore",Personale:"personale","Servizi amministrativi contabilit":"serviziAmministrativi","Servizi amministrativi paghe":"serviziAmministrativiPaghe","Consulenze tecniche":"consulenzeTecniche","Consulenze legali":"consulenzeLegali","Locazioni e noleggi":"locazioniNoleggi","Servizi indeducibili":"serviziIndeducibili","Utili e perdite su cambi":"utiliPerditeCambi","Perdite su crediti":"perditeSuCrediti","Licenze d'uso":"licenzeUso","Utenze telefoniche e cellulari":"utenzeTelefoniche","Altri oneri":"altriOneri","Abbuoni e arrotondamenti":"abbuoniArrotondamenti","SPESE DI STRUTTURA":"speseStruttura","TOTALE GESTIONE STRUTTURA E NON TIPICA":"totaleGestioneStruttura","TOTALE GESTIONE STRUTTURA":"totaleGestioneStruttura",EBITDA:"ebitda","Ammortamenti immateriali":"ammortamentiImmateriali","Ammortamenti materiali":"ammortamentiMateriali","Svalutazioni e accantonamenti":"svalutazioni","AMMORTAMENTI, ACCANT. SVALUTAZIONI":"totaleAmmortamenti","ammortamenti e svalutazioni":"totaleAmmortamenti","Gestione straordinaria":"gestioneStraordinaria",EBIT:"ebit","Spese e commissioni bancarie":"speseCommissioniBancarie","Interessi passivi su mutui":"interessiPassiviMutui","Altri interessi":"altriInteressi","GESTIONE FINANZIARIA":"gestioneFinanziaria",EBT:"ebt","RISULTATO ANTE IMPOSTE":"ebt","Imposte dirette":"imposteDirette",Imposte:"imposteDirette","RISULTATO DELL'ESERCIZIO":"risultatoEsercizio","RISULTATO DI ESERCIZIO (UTILE / PERDITA)":"risultatoEsercizio","UTILE (PERDITA) DELL'ESERCIZIO":"risultatoEsercizio","Risultato d'esercizio":"risultatoEsercizio","Risultato netto":"risultatoEsercizio",Merci:"merci","Ricavi da attivit di consulenza":"ricaviCaratteristici","Ricavi da attivit legate ad outcome/success fee":"ricaviCaratteristici",'Ricavi da fee "Sherpa as a Service"':"ricaviCaratteristici","Ricavi da Provvigioni":"ricaviCaratteristici","Ricavi da Contributi/Bandi":"ricaviCaratteristici","Ricavi da Capitalizzazioni":"ricaviCaratteristici","Ricavi non caratteristici":"altriRicavi","Totale ricavi complessivi":"totaleRicavi","Costi collaboratori a partita iva":"costiServizi","Costi per fee di segnalazione":"costiServizi","Costi connessi alla delivery corsi/eventi":"costiServizi","Consulenze e servizi esterni":"costiServizi","Costi per Bandi":"costiServizi","Costi per Formazione e TeamBuilding":"costiServizi","Costi per Sherpa Platform(R&D)":"costiServizi","Costi Board":"compensiAmministratore","Costo IT/Tool e Software":"serviziInformatici","Spese Commerciali e Marketing":"speseCommerciali","Spese di Struttura":"speseStruttura","Spese per benefit":"personale","Totale costi fissi gestione caratteristica":"totaleGestioneStruttura","Primo Margine":"grossProfit","Costi del Personale per delivery":"personale","Costi del Personale per sviluppo business":"personale","Costi del Personale per sviluppo ip":"personale"},$o=e=>{if(e==null)return 0;if(typeof e=="number")return e;if(typeof e=="string"){const t=e.replace(/\./g,"").replace(",",".").trim(),r=parseFloat(t);return isNaN(r)?0:r}return 0},Im=e=>{if(!e)return null;const t=String(e).trim();if(Mf[t])return Mf[t];const r=t.toUpperCase().replace(/\s+/g," ");if(Mf[r])return Mf[r];const n=t.toLowerCase().replace(/\s+/g,"");return n.includes("costiboard")?"compensiAmministratore":n.includes("costoit")||n.includes("tool")?"serviziInformatici":n.includes("spesecommercialie")||n.includes("spesecommerciali")?"speseCommerciali":n.includes("spesedistruttura")?"speseStruttura":n.includes("speseperbenefit")?"personale":n.includes("ricavidaconsulenza")||n.includes("ricavicaratteristici")||n.includes("1-totalericavi")?"ricaviCaratteristici":r.includes("TOTALE RICAVI")?"totaleRicavi":r.includes("RISULTATO")&&r.includes("ESERCIZIO")||r.includes("UTILE")&&r.includes("PERDITA")?"risultatoEsercizio":r==="AMMORTAMENTI"?"ammortamenti":r.includes("EBITDA")||r.includes("MARGINEMOL")?"ebitda":r.includes("EBIT")&&!r.includes("EBITDA")?"ebit":n.includes("ricavidaconsulenza")||n.includes("ricavidaattivitdiconsulenza")||n.includes("ricavilegateadobiettivi")||n.includes("obiettivivariabiali")?"ricaviCaratteristici":n.includes("ammortamentiimmateriali")||n.includes("ammortamentimateriali")?"ammortamenti":n.includes("svalutazionieaccantonamenti")?"svalutazioni":r.includes("TOTALE COSTI FISSI")||r.includes("TOTALECOSTIFISSI")?"totaleGestioneStruttura":r.includes("GESTIONE FINANZIARIA")?"gestioneFinanziaria":r.includes("EBIT")&&!r.includes("EBITDA")?"ebit":r.includes("RISULTATO")||r.includes("UTILE")||r.includes("EBT")?"risultatoEsercizio":null};class pS{constructor(t){this.workbook=Fv(t,{type:"binary"})}detectCompanyName(){const t="1_CE dettaglio";if(!this.workbook.SheetNames.includes(t))return null;const r=this.workbook.Sheets[t],n=Fi.sheet_to_json(r,{header:1});for(let i=0;i<Math.min(n.length,5);i++){const s=n[i];if(s)for(let a=0;a<Math.min(s.length,3);a++){const o=String(s[a]).trim();if(o&&o.length>3&&!o.toLowerCase().includes("pagina")&&!o.toLowerCase().includes("data")&&!o.toLowerCase().includes("bilancio")){if(o.toLowerCase().startsWith("azienda:")||o.toLowerCase().startsWith("societ:"))return o.substring(8).trim();if(!o.match(/^\d+$/)&&!o.match(/^[0-9\/]+$/))return o}}}return null}parseCEDettaglio(){console.log("[ExcelParser] Existing sheets:",this.workbook.SheetNames);let t=this.workbook.SheetNames.find(l=>{const c=l.toLowerCase();return c.includes("1_ce dettaglio")||c.includes("dettaglio")&&c.includes("ce")||c==="ce dettaglio"||c==="economico dettaglio"});if(!t)return console.warn("[ExcelParser] Could not find 'CE Dettaglio' sheet. Available:",this.workbook.SheetNames),null;console.log(`[ExcelParser] Parsing detail sheet: ${t}`);const r=this.workbook.Sheets[t],n=Fi.sheet_to_json(r,{header:1});let i=-1,s=-1;console.log(`[ExcelParser] Scanning ${t} for headers...`);for(let l=0;l<Math.min(n.length,40);l++){const c=n[l];c&&c.forEach((u,d)=>{const f=String(u).toUpperCase();f.includes("2025")&&(i===-1&&(i=d),(f.includes("CONSUNTIVO")||f.includes("PROGRESSIVO")||f.includes("ACTUAL"))&&(i=d),f.includes("BUDGET")&&i===d&&(i=-1)),(f.includes("CONSUNTIVO")||f.includes("ACTUAL")||f.includes("12"))&&i===-1&&(i=d),f.includes("2024")&&s===-1&&(s=d),(f.includes("BUDGET")||f.includes("PRECEDENTE"))&&s===-1&&(s=d)})}i===-1&&(console.warn("[ExcelParser] Columns for 2025 not found explicitly. Using default index 2 (C)."),i=2),s===-1&&(console.warn("[ExcelParser] Columns for 2024 not found explicitly. Using default index 5 (F)."),s=5),console.log(`[ExcelParser] Columns Identified -> 2025: ${i}, 2024: ${s}`);const a={},o={};return n.forEach(l=>{if(!l||l.length===0)return;const c=l[0],u=Im(c);c&&typeof c=="string"&&c.length>5&&console.log(`[ExcelParser Debug] Label: "${c.substring(0,30)}..." -> Key: ${u}`),u&&(a[u]=(a[u]||0)+$o(l[i]),o[u]=(o[u]||0)+$o(l[s]))}),!a.totaleRicavi&&a.ricaviCaratteristici&&(a.totaleRicavi=a.ricaviCaratteristici+(a.altriRicavi||0),o.totaleRicavi=o.ricaviCaratteristici+(o.altriRicavi||0)),!a.totaleCostiDirettiIndiretti&&a.totaleRicavi&&a.ebitda!==void 0&&(a.totaleCostiDirettiIndiretti=a.totaleRicavi-a.ebitda,o.totaleCostiDirettiIndiretti=o.totaleRicavi-o.ebitda),{progressivo2025:a,progressivo2024:o}}parseCEDettaglioMensile(){let t=this.workbook.SheetNames.find(r=>{const n=r.toLowerCase();return n==="ce dettaglio mensile"||n==="eco_dettaglio_mensile"||n.includes("dettaglio")&&n.includes("mensile")});return t?this.parseMonthlyBlocks(t):null}parseCESintetico(){const t=this.workbook.SheetNames.find(r=>{const n=r.toLowerCase();return(n.includes("sintetico")||n.includes("sintentico"))&&!n.includes("mensile")});return t?this.parseSummaryLikeSheet(t):null}parseCESinteticoMensile(){const t=this.workbook.SheetNames.find(i=>{const s=i.toLowerCase().replace(/[_\.]/g," ");return s.includes("sintetico")&&s.includes("mensile")}),r=this.workbook.SheetNames.find(i=>{const s=i.toLowerCase().replace(/[_\.]/g," ");return s.includes("dettaglio")&&s.includes("mensile")})||"CE dettaglio mensile";let n=t?this.parseMonthlyBlocks(t):null;if((!n||!n.progressivo2024||!n.puntuale2024)&&(console.log(`[ExcelParser] Primary parse of '${t}' incomplete or missing. Checking '${r}'...`),this.workbook.SheetNames.includes(r))){const i=this.parseMonthlyBlocks(r);i&&(n||(n={}),!n.progressivo2025&&i.progressivo2025&&(n.progressivo2025=i.progressivo2025),!n.puntuale2025&&i.puntuale2025&&(n.puntuale2025=i.puntuale2025),!n.progressivo2024&&i.progressivo2024&&(n.progressivo2024=i.progressivo2024),!n.puntuale2024&&i.puntuale2024&&(n.puntuale2024=i.puntuale2024))}return n}parseSummaryLikeSheet(t){const r=this.workbook.Sheets[t],n=Fi.sheet_to_json(r,{header:1});let i=-1,s=-1;for(let l=0;l<Math.min(n.length,20);l++){const c=n[l];c&&c.forEach((u,d)=>{const f=String(u);f.includes("2025")&&i===-1&&(i=d),f.includes("2024")&&s===-1&&(s=d)})}i===-1&&(i=2),s===-1&&(s=5);const a={},o={};return n.forEach(l=>{if(!l||l.length===0)return;const c=l[0],u=Im(c);u&&(a[u]=(a[u]||0)+$o(l[i]),o[u]=(o[u]||0)+$o(l[s]))}),{progressivo2025:a,progressivo2024:o}}parseMonthlyBlocks(t){const r=this.workbook.Sheets[t];if(!r)return null;const n=Fi.sheet_to_json(r,{header:1});console.log(`[ExcelParser] Parsing monthly blocks for sheet: ${t}`);const i=[];for(let u=0;u<Math.min(n.length,1e3);u++){const d=n[u];if(d)for(let f=0;f<d.length;f++){const p=String(d[f]).trim(),m=p.toUpperCase();if(m==="GENNAIO"||m==="GEN"||m.startsWith("GEN")&&(m.length<=4||m.includes("20"))){console.log(`[ExcelParser] Found potential block start at Row ${u}, Col ${f}: ${p}`);const g=[];let v=f,w=0;for(;v<d.length&&w<50;){d[v];const y=String(d[v]||"").trim();if(y.toUpperCase().match(/^(TOTALE|%|TRASCODIFICA|RIF)/)||!y&&g.length>0&&!String(d[v+1]||"").trim())break;y&&g.push(y.substring(0,3)),v++,w++}if(g.length>=1){let y=0,b="";for(let S=1;S<=20&&!(u-S<0);S++){const C=n[u-S];if(!C)continue;const T=C.join(" ").toUpperCase();if(T.trim().length>0&&console.log(`[ExcelParser] Scanning Header Row -${S}: "${T}"`),T.includes("2025")||T.includes(" 25 ")?y=2025:T.includes("2024")||T.includes(" 24 ")?y=2024:T.includes("2023")&&(y=2023),T.includes("PROGRESSIVO")||T.includes("CUMULATO")||T.includes("CONSUNTIVO")?b="progressivo":(T.includes("PUNTUALE")||T.includes("MENSILE")||T.includes("MESE"))&&(b="puntuale"),y&&b)break}const E=d.join(" ").toUpperCase();y||(E.includes("2025")||E.includes(" 25 ")?y=2025:(E.includes("2024")||E.includes(" 24 "))&&(y=2024)),console.log(`[ExcelParser] Block Metadata -> Year: ${y}, Type: ${b}, Months: ${g.length}`),i.find(S=>S.startRow===u&&S.startCol===f)||i.push({startCol:f,startRow:u,months:g,year:y,type:b}),f=v-1}}}}if(console.log(`[ExcelParser] Total Blocks Found: ${i.length}`),i.length===0)return null;const s=u=>{if(!u)return null;const d={months:u.months};for(let f=u.startRow+1;f<n.length;f++){const p=n[f];if(!p)continue;const m=i.find(v=>v.startRow>u.startRow&&Math.abs(v.startCol-u.startCol)<5);if(m&&f>=m.startRow)break;const h=p[0],g=Im(h);if(g){const v=[];for(let w=0;w<u.months.length;w++)v.push($o(p[u.startCol+w]));d[g]=v}}return d};i.sort((u,d)=>Math.abs(u.startRow-d.startRow)>5?u.startRow-d.startRow:u.startCol-d.startCol),console.log("[ExcelParser] Sorted Blocks for Mapping:",i.map(u=>`(R${u.startRow},C${u.startCol}) Y:${u.year} T:${u.type}`));let a=i.find(u=>u.year===2025&&(u.type==="progressivo"||!u.type));i.length>=1&&(!i[0].year||i[0].year===2025)&&(a||(a=i[0]));let o=i.find(u=>u.year===2025&&u.type==="puntuale");!o&&i.length>=2&&i[1]!==a&&(o=i[1]);let l=i.find(u=>u.year===2024&&(u.type==="progressivo"||!u.type));!l&&i.length>=3&&i[2]!==a&&i[2]!==o&&(l=i[2]);let c=i.find(u=>u.year===2024&&u.type==="puntuale");return!c&&i.length>=4&&i[3]!==a&&i[3]!==o&&i[3]!==l&&(c=i[3]),console.log("[ExcelParser] Final Mapping Result:",{p25:a?`Found (R${a.startRow})`:"Missing",m25:o?`Found (R${o.startRow})`:"Missing",p24:l?`Found (R${l.startRow})`:"Missing",m24:c?`Found (R${c.startRow})`:"Missing"}),{progressivo2025:s(a),puntuale2025:s(o),progressivo2024:s(l),puntuale2024:s(c)}}detectReferenceMonth(){const t="1_CE dettaglio";if(this.workbook.SheetNames.includes(t)){const n=this.workbook.Sheets[t],i=Fi.sheet_to_json(n,{header:1});for(let s=0;s<Math.min(i.length,15);s++){const a=i[s];if(a)for(const o of a){const l=String(o).toLowerCase(),c={gennaio:1,febbraio:2,marzo:3,aprile:4,maggio:5,giugno:6,luglio:7,agosto:8,settembre:9,ottobre:10,novembre:11,dicembre:12};for(const[u,d]of Object.entries(c))if(l.includes(` ${u}`)||l.startsWith(u))return d}}}const r="CE dettaglio mensile";if(this.workbook.SheetNames.includes(r)){const n=this.workbook.Sheets[r],i=Fi.sheet_to_json(n,{header:1});for(let s=0;s<Math.min(i.length,30);s++){const a=i[s];if(a&&String(a[0]).toUpperCase().includes("RICAVI"))break}}return null}detectPartitari(){const t=this.workbook.SheetNames[0],r=this.workbook.Sheets[t],n=Fi.sheet_to_json(r,{header:1});if(n.length<1)return!1;const i=n[0].map(o=>String(o).trim()),s=["CodiceConto","Descr_conto","Data_registraz"];return s.filter(o=>i.includes(o)).length===s.length}parsePartitari(){const t=this.workbook.SheetNames[0],r=this.workbook.Sheets[t],n=Fi.sheet_to_json(r,{header:1});if(!n||n.length===0)return null;const i=n[0].map(o=>String(o).trim()),a=n.slice(1).map(o=>{const l={};return i.forEach((c,u)=>{let d=o[u];(c.includes("Importo")||c.includes("Saldo")||c.includes("Progr"))&&(d=$o(d)),l[c]=d}),l});return{headers:i,data:a}}parseSource(){const t=this.workbook.SheetNames.find(i=>i.trim().toLowerCase()==="source");if(!t)return null;const r=this.workbook.Sheets[t],n=Fi.sheet_to_json(r,{header:1,defval:""});return console.log(`[ExcelParser] Parsed Source sheet: ${n.length} rows found.`),n}parseSourceSummary(t){if(!t||t.length<5)return null;let r=-1;for(let l=0;l<Math.min(t.length,30);l++){const c=t[l];if(c){for(let u=0;u<c.length;u++){const d=String(c[u]).toLowerCase().trim();if(d.includes("year to date")||d==="ytd"){r=u,console.log(`[ExcelParser] Found 'Year to Date' column at index ${u}`);break}}if(r!==-1)break}}let n=0,i=0,s=0,a=!1;const o=l=>{if(typeof l=="number")return l;if(!l)return 0;const c=String(l).replace(/\./g,"").replace(",",".").trim(),u=parseFloat(c);return isNaN(u)?0:u};for(let l=t.length-1;l>=0;l--){const c=t[l];if(!c)continue;const u=c.slice(0,6).map(p=>String(p).toLowerCase().trim()).join(" ");let d=r;if(d===-1){for(let p=c.length-1;p>=0;p--)if(c[p]!==""&&c[p]!==null&&c[p]!==void 0&&!isNaN(o(c[p]))&&o(c[p])!==0){d=p;break}}if(d===-1)continue;const f=o(c[d]);if(u.includes("differenza")){console.log(`[ExcelParser] Found Anchor 'DIFFERENZA' at row ${l} with val ${f}`),s===0&&(s=-f);const p=g=>{if(g<0)return 0;const v=t[g];return!v||v.length<=d?0:o(v[d])};t[l-1]&&(n===0&&(n=Math.abs(p(l-1))),console.log(`[ExcelParser] Anchor deduced Ricavi at row ${l-1}: ${n}`)),t[l-2]&&(i===0&&(i=p(l-2)),console.log(`[ExcelParser] Anchor deduced Costi at row ${l-2}: ${i}`)),a=!0}else n===0&&(u.includes("totale ricavi")||String(c[0]||"").toLowerCase()==="ricavi"||String(c[3]||"").toLowerCase()==="ricavi")?n=Math.abs(f):i===0&&(u.includes("totale costi")||String(c[0]||"").toLowerCase()==="costi"||String(c[3]||"").toLowerCase()==="costi")&&(i=f);if(n!==0&&i!==0&&s!==0)break}return a?(console.log(`[ExcelParser] Source Summary Extracted -> Ricavi: ${n}, Costi: ${i}, Risultato: ${s}`),{ricavi:n,costi:i,risultato:s}):null}}const xJ=OA,yJ=IA,ZO=_.forwardRef(({className:e,...t},r)=>x.jsx(V0,{ref:r,className:_e("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));ZO.displayName=V0.displayName;const eI=_.forwardRef(({className:e,children:t,...r},n)=>x.jsxs(yJ,{children:[x.jsx(ZO,{}),x.jsxs(H0,{ref:n,className:_e("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,x.jsxs(DA,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[x.jsx(P0,{className:"h-4 w-4"}),x.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));eI.displayName=H0.displayName;const tI=({className:e,...t})=>x.jsx("div",{className:_e("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});tI.displayName="DialogHeader";const rI=({className:e,...t})=>x.jsx("div",{className:_e("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});rI.displayName="DialogFooter";const nI=_.forwardRef(({className:e,...t},r)=>x.jsx(W0,{ref:r,className:_e("text-lg font-semibold leading-none tracking-tight",e),...t}));nI.displayName=W0.displayName;const iI=_.forwardRef(({className:e,...t},r)=>x.jsx(G0,{ref:r,className:_e("text-sm text-muted-foreground",e),...t}));iI.displayName=G0.displayName;function wJ(){const{companies:e,selectedCompany:t,setSelectedCompany:r,createCompany:n,saveFinancialData:i,deleteFinancialData:s}=Nn(),{toast:a}=L1(),[o,l]=_.useState(!1),[c,u]=_.useState("upload"),[d,f]=_.useState("2025"),[p,m]=_.useState("10"),[h,g]=_.useState(null),[v,w]=_.useState(null),[y,b]=_.useState(null),[E,k]=_.useState(!1),[S,C]=_.useState(""),[T,P]=_.useState(""),[I,R]=_.useState(null),[H,q]=_.useState({ricavi:"",costi:"",ebitda:"",risultato:""}),X=()=>{u("upload"),g(null),w(null),b(null),q({ricavi:"",costi:"",ebitda:"",risultato:""}),R(null)},K=async(V,B)=>{l(!0),u("upload"),r(e.find(Y=>Y.id===B)||null),R(null);const U=new FileReader;U.onload=async Y=>{var oe,le,ne,he,F;const te=(oe=Y.target)==null?void 0:oe.result;if(!te){l(!1);return}try{const Se=new pS(te);if(Se.detectPartitari()){console.log("File detected as Partitari CSV");const me=Se.parsePartitari();b(me),w({yearly:null,monthly:null,sintetico:null,sinteticoMensile:null,partitari:{headers:me.headers.length,data:me.data.length}}),g({kpis:{ricavi:0,costi:0,ebitda:0,risultato:0},sanityCheck:{isBalanced:!0,warnings:[]},commentary:"Importazione Partitari Rilevata. I dati verranno salvati direttamente.",costLabel:"Partitari",costDescription:"Movimenti contabili",rawData:{ceDettaglio:null,ceDettaglioMensile:null,ceSintetico:null,ceSinteticoMensile:null}}),u("preview"),l(!1);return}const Ee=Se.parseCEDettaglio(),Fe=Se.parseCEDettaglioMensile(),ke=Se.parseCESintetico(),fe=Se.parseCESinteticoMensile(),tt=Se.parseSource(),St=Se.detectReferenceMonth();St&&(m(St.toString()),a({title:"Periodo Rilevato",description:`Impostato automaticamente al mese: ${new Date(0,St-1).toLocaleString("it-IT",{month:"long"})}`,className:"bg-blue-50 border-blue-200"}));let xt=0,Mt=0,Xr=0,Lt=0,cr=0,hn=0,kr="Costi",pn="Costi operativi";if(Ee&&Ee.progressivo2025){const me=Ee.progressivo2025;xt=me.totaleRicavi||me.ricaviCaratteristici||0,Mt=me.ebitda||0,Xr=me.risultato||me.risultatoEsercizio||0,me.totaleCostiDirettiIndiretti&&me.totaleCostiDirettiIndiretti!==0?(Lt=me.totaleCostiDirettiIndiretti,kr="Costi Diretti e Indiretti",pn="Costi diretti e indiretti"):(me.totaleGestioneStruttura||0)+(me.costiServizi||0)>0?(Lt=(me.costiMateriePrime||0)+(me.costiServizi||0)+(me.serviziDiretti||0)+(me.consulenzeDirette||0)+(me.serviziInformatici||0)+(me.serviziCloud||0)+(me.altriServizi||0)+(me.godimentoBeniTerzi||0)+(me.personale||0)+(me.compensiAmministratore||0)+(me.speseCommerciali||0)+(me.speseGenerali||0)+(me.speseStruttura||0)+(me.totaleGestioneStruttura||0),Math.abs(Lt-(xt-Mt))>100&&(Lt=xt-Mt),kr="Costi Totali Operativi",pn="Costi variabili e costi fissi"):(Lt=xt-Mt,kr="Costi Operativi",pn="Costi operativi"),cr=me.grossProfit||0,hn=me.totaleGestioneStruttura||0}else if(ke&&ke.progressivo2025){const me=ke.progressivo2025;xt=me.totaleRicavi||0,Mt=me.ebitda||0,Xr=me.risultatoEsercizio||0,Lt=xt-Mt,kr="Costi Operativi",pn="Costi operativi"}const Et=Se.parseSourceSummary(tt||[]);Et&&(console.log("[Import] Overriding KPIs with Source Summary values:",Et),xt=Et.ricavi,Lt=Et.costi,Xr=Et.risultato,kr="Costi Totali (Source)",pn="Da Source: 'Costi'");let Kt={isBalanced:!0,warnings:[],commentary:"Analisi AI non disponibile (Offline)"};if(!Se.detectPartitari()){xt===0&&Kt.warnings.push(" Ricavi pari a zero."),Xr===0&&Kt.warnings.push(" Risultato nullo.");try{const me=((le=e.find(qt=>qt.id===B))==null?void 0:le.name)||T||"Unknown",ct=await fetch("/api/analyze-financials",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyName:me,year:parseInt(d),kpis:{ricavi:xt,costi:Lt,ebitda:Mt,risultato:Xr},details:{grossProfit:cr,costiStruttura:hn}})});if(ct.ok){const qt=await ct.json();Kt={isBalanced:qt.isBalanced,warnings:[...Kt.warnings,...qt.warnings],commentary:qt.commentary}}}catch(me){console.error("AI Error:",me)}}g({kpis:{ricavi:xt,costi:Lt,ebitda:Mt,risultato:Xr},sanityCheck:{isBalanced:Kt.warnings.length===0,warnings:Kt.warnings},commentary:Kt.commentary,costLabel:kr,costDescription:pn,rawData:{ceDettaglio:Ee,ceDettaglioMensile:Fe,ceSintetico:ke,ceSinteticoMensile:fe}}),w({yearly:Ee?{rows:Object.keys(Ee.progressivo2025).length,has2024:!1}:null,monthly:Fe?{rows:((he=(ne=Fe.progressivo2025)==null?void 0:ne.months)==null?void 0:he.length)||0,months:((F=Fe.progressivo2025)==null?void 0:F.months)||[]}:null,sintetico:null,sinteticoMensile:null,partitari:null,sourceData:tt}),q({ricavi:xt.toString(),costi:Lt.toString(),ebitda:Mt.toString(),risultato:Xr.toString()}),u("preview")}catch(Se){console.error("Errore parsing:",Se),a({title:"Errore Lettura File",description:"Impossibile leggere il file.",variant:"destructive"})}finally{l(!1)}},U.readAsBinaryString(V)},Q=async V=>{const B=new FileReader;B.onload=async U=>{var le;const Y=(le=U.target)==null?void 0:le.result;if(!Y)return;const te=new pS(Y);if(te.detectPartitari()){a({title:"File Partitari Rilevato",description:"Seleziona un'azienda per importare i partitari."});return}const oe=te.detectCompanyName();if(oe){const ne=e.find(he=>he.name.toLowerCase().includes(oe.toLowerCase())||oe.toLowerCase().includes(he.name.toLowerCase()));ne?(a({title:"Azienda Riconosciuta",description:`File associato a: ${ne.name}`}),r(ne),K(V,ne.id)):(C(oe),P(oe),R(V),k(!0))}else a({title:"Attenzione",description:"Nome azienda non rilevato.",variant:"destructive"})},B.readAsBinaryString(V)},G=async()=>{if(!T.trim())return;l(!0);const V=await n(T);V?(r(V),k(!1),a({title:"Azienda Creata",description:`Benvenuto in ${V.name}`}),I&&K(I,V.id)):a({title:"Errore",description:"Impossibile creare l'azienda.",variant:"destructive"}),l(!1)},z=async V=>{var U;const B=(U=V.target.files)==null?void 0:U[0];B&&(V.target.value="",t?K(B,t.id):await Q(B))},ie=V=>V&&V.puntuale2025?{labels:V.puntuale2025.months||[],ricavi:V.puntuale2025.totaleRicavi||[],ebitda:V.puntuale2025.ebitda||[]}:{labels:[],ricavi:[],ebitda:[]},ae=(V,B,U)=>{const Y=(le,ne,he)=>({voce:le,value2025:ne,percentage:V.ricavi2025?ne/V.ricavi2025*100:0,value2024:he}),te=B.totaleRicavi||B.ricaviCaratteristici||V.ricavi2025,oe=U.totaleRicavi||U.ricaviCaratteristici||V.ricavi2024;return[Y("Ricavi",te,oe),Y("Costi Operativi",B.totaleCostiDirettiIndiretti||V.costi2025,U.totaleCostiDirettiIndiretti||V.costi2024),Y("EBITDA",B.ebitda||V.ebitda2025,U.ebitda||V.ebitda2024),Y("Ammortamenti",B.ammortamenti||B.totaleAmmortamenti||0,U.ammortamenti||U.totaleAmmortamenti||0),Y("EBIT",B.ebit||V.ebitda2025-(B.ammortamenti||0),U.ebit||V.ebitda2024-(U.ammortamenti||0)),Y("Gestione Finanziaria",B.gestioneFinanziaria||0,U.gestioneFinanziaria||0),Y("Risultato Esercizio",B.risultato||B.risultatoEsercizio||V.risultato2025,U.risultato||U.risultatoEsercizio||V.risultato2024)]},D=async()=>{var V,B;if(!(!t||!h))try{if(l(!0),y&&(await i(t.id,"partitari",y,parseInt(d),parseInt(p)),a({title:"Partitari Importati",description:`Salvate ${y.data.length} righe.`})),v!=null&&v.sourceData&&v.sourceData.length>0){console.log(`[Import] Saving Source data: ${v.sourceData.length} rows...`);try{await i(t.id,"source",v.sourceData,parseInt(d),parseInt(p)),console.log("[Import] Source data saved successfully.")}catch(U){console.error("[Import] Error saving Source data:",U)}}else console.warn("[Import] No Source data to save or empty array.");if(h.rawData&&(h.rawData.ceDettaglio||h.rawData.ceSintetico)){const U=[],Y=parseInt(d),te=parseInt(p),{rawData:oe}=h;oe.ceDettaglio&&U.push(i(t.id,"ce-dettaglio",oe.ceDettaglio,Y,te)),oe.ceDettaglioMensile&&U.push(i(t.id,"ce-dettaglio-mensile",oe.ceDettaglioMensile,Y,te)),oe.ceSintetico&&U.push(i(t.id,"ce-sintetico",oe.ceSintetico,Y,te)),oe.ceSinteticoMensile&&U.push(i(t.id,"ce-sintetico-mensile",oe.ceSinteticoMensile,Y,te));const le=((V=oe.ceDettaglio)==null?void 0:V.progressivo2024)||{},ne=h.kpis,he=parseFloat(H.ricavi)||ne.ricavi,F=le.totaleRicavi||0,Se=parseFloat(H.ebitda)||ne.ebitda,Ee=le.ebitda||0,Fe={kpis:{ricavi2025:he,ricavi2024:F,costi2025:parseFloat(H.costi)||ne.costi,costi2024:le.totaleCostiDirettiIndiretti||0,ebitda2025:Se,ebitda2024:Ee,risultato2025:parseFloat(H.risultato)||ne.risultato,risultato2024:le.risultatoEsercizio||le.risultato||0,margineEbitda2025:he?Se/he*100:0,margineEbitda2024:F?Ee/F*100:0,costLabel:h.costLabel||"Costi"},summary:ae({...h.kpis,ricavi2025:he,ricavi2024:F},((B=oe.ceDettaglio)==null?void 0:B.progressivo2025)||{},le),comparison:{},monthlyTrend:ie(oe.ceDettaglioMensile)};U.push(i(t.id,"dashboard",Fe,Y,te)),await Promise.all(U)}a({title:"Importazione Completata",description:"Dati salvati con successo.",className:"bg-green-50 border-green-200"}),X()}catch(U){console.error(U),a({title:"Errore Salvataggio",variant:"destructive"})}finally{l(!1)}};return x.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[x.jsx(Ze,{title:"Importa Dati",subtitle:"Carica i bilanci e lascia che l'AI li analizzi per te"}),!t&&x.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[x.jsx(qw,{className:"h-5 w-5 text-blue-600 mt-0.5"}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-blue-800",children:"Nuova Funzionalit: Rilevamento Automatico"}),x.jsx("p",{className:"text-sm text-blue-600",children:"Puoi caricare un file senza selezionare un'azienda. Il sistema prover a riconoscere il nome e ti proporr di creare una nuova azienda se necessario."})]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[x.jsxs(Rt,{className:"md:col-span-1 shadow-lg border-t-4 border-t-primary",children:[x.jsxs(Ja,{children:[x.jsx(Za,{children:"1. Carica File"}),x.jsx(Wh,{children:"Seleziona azienda e periodo"})]}),x.jsxs(qi,{className:"space-y-6",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx(Tn,{children:"Azienda"}),x.jsxs(Yu,{value:(t==null?void 0:t.id)||"",onValueChange:V=>{const B=e.find(U=>U.id===V);B&&r(B)},children:[x.jsx(Yl,{children:x.jsx(Qu,{placeholder:"Seleziona o Rileva Autom."})}),x.jsx(Ql,{children:e.map(V=>x.jsx(kt,{value:V.id,children:V.name},V.id))})]})]}),x.jsx(LC,{}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx(Tn,{children:"Anno"}),x.jsx(Ei,{type:"number",value:d,onChange:V=>f(V.target.value)})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(Tn,{children:"Mese Riferimento"}),x.jsxs(Yu,{value:p,onValueChange:m,children:[x.jsx(Yl,{children:x.jsx(Qu,{})}),x.jsxs(Ql,{children:[x.jsx(kt,{value:"1",children:"Gennaio"}),x.jsx(kt,{value:"2",children:"Febbraio"}),x.jsx(kt,{value:"3",children:"Marzo"}),x.jsx(kt,{value:"4",children:"Aprile"}),x.jsx(kt,{value:"5",children:"Maggio"}),x.jsx(kt,{value:"6",children:"Giugno"}),x.jsx(kt,{value:"7",children:"Luglio"}),x.jsx(kt,{value:"8",children:"Agosto"}),x.jsx(kt,{value:"9",children:"Settembre"}),x.jsx(kt,{value:"10",children:"Ottobre"}),x.jsx(kt,{value:"11",children:"Novembre"}),x.jsx(kt,{value:"12",children:"Dicembre"})]})]})]})]}),x.jsxs("div",{className:"pt-4",children:[x.jsx(Tn,{className:"block mb-2",children:"File Excel (Bilancio) o CSV (Partitari)"}),(v==null?void 0:v.partitari)&&x.jsxs("div",{className:"md:col-span-2 border rounded-lg p-4 bg-muted/20",children:[x.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[x.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-md",children:x.jsx(gF,{className:"w-5 h-5 text-purple-600 dark:text-purple-300"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium",children:"Partitari"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Movimenti contabili"})]})]}),x.jsx("div",{className:"pl-[52px]",children:x.jsxs("div",{className:"flex gap-4 text-sm",children:[x.jsxs("div",{children:[x.jsx("span",{className:"text-muted-foreground",children:"Righe:"})," ",x.jsx("span",{className:"font-medium",children:v.partitari.data})]}),x.jsxs("div",{children:[x.jsx("span",{className:"text-muted-foreground",children:"Colonne:"})," ",x.jsx("span",{className:"font-medium",children:v.partitari.headers})]})]})})]}),(v==null?void 0:v.yearly)&&x.jsx("div",{className:"border rounded-lg p-4 bg-muted/20",children:x.jsxs("div",{className:"flex flex-col gap-1",children:[x.jsx("span",{className:"text-sm font-medium",children:"Bilancio Annuale"}),x.jsxs("span",{className:"text-xs text-muted-foreground",children:[v.yearly.rows," righe estratte"]})]})}),x.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center hover:bg-muted/50 transition-colors cursor-pointer relative mt-2",children:[x.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",onChange:z,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:o}),x.jsxs("div",{className:"flex flex-col items-center gap-2",children:[x.jsx(dF,{className:"h-10 w-10 text-muted-foreground"}),x.jsx("p",{className:"text-sm font-medium",children:"Trascina o clicca per caricare"}),x.jsx("p",{className:"text-xs text-muted-foreground",children:"Supporta .xlsx, .csv"})]})]})]}),x.jsx("div",{className:"flex justify-end pt-4 border-t",children:x.jsxs(ir,{variant:"destructive",size:"sm",onClick:async()=>{if(!t){a({title:"Errore",description:"Seleziona un'azienda per eliminare i dati.",variant:"destructive"});return}if(confirm(`Sei sicuro di voler eliminare TUTTI i dati del ${d} per ${t.name}? Questa azione  irreversibile.`))try{l(!0),await s(t.id,parseInt(d)),a({title:"Dati eliminati",description:`I dati del ${d} sono stati rimossi con successo.`})}catch{a({title:"Errore",description:"Impossibile eliminare i dati.",variant:"destructive"})}finally{l(!1)}},children:["Elimina Dati ",d," (Reset)"]})})]})]}),c==="preview"&&h&&x.jsxs(Rt,{className:"md:col-span-2 shadow-lg",children:[x.jsxs(Ja,{children:[x.jsx(Za,{children:"2. Anteprima e Validazione"}),x.jsx(Wh,{children:"Verifica i dati estratti dall'intelligenza artificiale"})]}),x.jsx(qi,{children:x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:`p-4 rounded-lg flex items-start gap-3 ${h.sanityCheck.isBalanced?"bg-green-50 text-green-900 border border-green-200":"bg-amber-50 text-amber-900 border border-amber-200"}`,children:[h.sanityCheck.isBalanced?x.jsx(Kk,{className:"w-5 h-5 mt-0.5 text-green-600"}):x.jsx(xF,{className:"w-5 h-5 mt-0.5 text-amber-600"}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold",children:h.sanityCheck.isBalanced?"Analisi Preliminare: OK":"Analisi Preliminare: Attenzione"}),x.jsx("p",{className:"text-sm opacity-90 mt-1",children:h.sanityCheck.isBalanced?"I dati principali sembrano coerenti. Verifica comunque i valori qui sotto prima di confermare.":"Sono state rilevate potenziali anomalie. Controlla i messaggi di avviso."}),h.sanityCheck.warnings.length>0&&x.jsx("ul",{className:"list-disc list-inside text-sm mt-2 ml-1 space-y-1",children:h.sanityCheck.warnings.map((V,B)=>x.jsx("li",{children:V},B))})]})]}),x.jsxs("div",{className:"bg-violet-50 border border-violet-100 p-4 rounded-lg",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2 text-violet-800 font-semibold",children:[x.jsx(qw,{className:"w-5 h-5"}),x.jsx("span",{children:"Parere dell'AI CFO"})]}),x.jsxs("p",{className:"text-sm text-violet-900 italic",children:['"',h.commentary||"Nessun commento disponibile.",'"']})]}),x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:["Ricavi","Costi","EBITDA","Risultato"].map(V=>{const B=V.toLowerCase();return x.jsxs(Rt,{children:[x.jsx(Ja,{className:"pb-2",children:x.jsx(Za,{className:"text-sm font-medium text-muted-foreground",children:V})}),x.jsxs(qi,{children:[x.jsx(Ei,{value:H[B],onChange:U=>q(Y=>({...Y,[B]:U.target.value})),className:"font-bold text-lg"}),x.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Rilevato: ",At(h.kpis[B])]})]})]},B)})})]})}),x.jsxs(b4,{className:"flex justify-between border-t pt-6",children:[x.jsx(ir,{variant:"outline",onClick:X,children:"Annulla e Ricarica"}),x.jsxs(ir,{size:"lg",onClick:D,disabled:o,className:"gap-2",children:[o?"Salvataggio...":"Conferma e Importa Dati"," ",x.jsx(rF,{className:"w-4 h-4"})]})]})]})]}),x.jsx(xJ,{open:E,onOpenChange:k,children:x.jsxs(eI,{children:[x.jsxs(tI,{children:[x.jsx(nI,{children:"Nuova Azienda Rilevata"}),x.jsxs(iI,{children:["Sembra che tu stia importando un file per ",x.jsxs("strong",{children:['"',S,'"']}),". Questa azienda non esiste ancora nel sistema. Vuoi crearla?"]})]}),x.jsxs("div",{className:"py-4",children:[x.jsx(Tn,{children:"Nome Azienda"}),x.jsx(Ei,{value:T,onChange:V=>P(V.target.value),className:"mt-2"})]}),x.jsxs(rI,{children:[x.jsx(ir,{variant:"outline",onClick:()=>k(!1),children:"Annulla"}),x.jsx(ir,{onClick:G,disabled:o,children:o?"Creazione...":x.jsxs(x.Fragment,{children:[x.jsx(sF,{className:"mr-2 h-4 w-4"}),"Crea e Continua"]})})]})]})})]})}const bJ=()=>{const{selectedCompany:e,getSourceData:t}=Nn(),[r,n]=_.useState([]),[i,s]=_.useState(!1),[a,o]=_.useState("current"),[l,c]=_.useState([]),[u,d]=_.useState([]),[f,p]=_.useState([]),[m,h]=_.useState([]),[g,v]=_.useState(!1),[w,y]=_.useState({});_.useEffect(()=>{e&&b()},[e]);const b=async()=>{if(e){s(!0);try{const K=await t(e.id);if(K&&K.length>0){const G=K[0].data;Array.isArray(G)&&G.length>0?(n(G),E(G)):(n([]),v(!1))}else n([]),v(!1)}catch(K){console.error("Error loading source data:",K)}finally{s(!1)}}},E=K=>{if(!K||K.length<1)return;let Q=0,G=K[0];for(let ae=0;ae<Math.min(K.length,20);ae++){const D=K[ae].join(" ").toLowerCase();if(D.includes("descrizione")&&(D.includes("conto")||D.includes("famiglia"))){Q=ae,G=K[ae];break}}let z=-1;for(let ae=0;ae<Q+5;ae++){const D=K[ae];if(D){for(let V=0;V<D.length;V++)if(String(D[V]).toUpperCase().trim().includes("ANNO PRECEDENTE")){z=V;break}if(z!==-1)break}}let ie=0;for(let ae=0;ae<G.length;ae++){const D=String(G[ae]).toLowerCase();if(D==="1"||D.includes("gen")){ie=ae;break}}if(p(G),h(K.slice(Q+1)),z!==-1&&ie>0){const ae=G.slice(0,ie),D=G.slice(ie,z),V=[...ae,...D],B=G.slice(z),U=[...ae,...B],Y=K.slice(Q+1).filter(le=>{const he=le.slice(0,ie).some(Se=>Se!==null&&Se!==""),F=le.join(" ").toUpperCase();return F.includes("ANNO PRECEDENTE")||F.includes("ANNO CORRENTE")?!1:he}),te=Y.map(le=>{const ne=le.slice(0,ie),he=le.slice(ie,z);return[...ne,...he]}),oe=Y.map(le=>{const ne=le.slice(0,ie),he=le.slice(z);return[...ne,...he]});c({headers:V,rows:te}),d({headers:U,rows:oe}),v(!0),o("current")}else v(!1),o("all")},k=K=>{if(K==null||K==="")return"";const Q=Number(K);return!isNaN(Q)&&typeof K!="string"&&(Math.abs(Q)>1e3||!Number.isInteger(Q))?Q.toLocaleString("it-IT",{minimumFractionDigits:0,maximumFractionDigits:2}):K},S=K=>a===K?"bg-primary text-primary-foreground shadow px-4 py-2 text-sm font-medium rounded-md transition-colors":"bg-muted text-muted-foreground hover:bg-muted/80 px-4 py-2 text-sm font-medium rounded-md transition-colors",T=a==="current"&&g?l:a==="previous"&&g?u:{headers:f,rows:m},P=(T==null?void 0:T.headers)||[],I=(T==null?void 0:T.rows)||[],R=_.useMemo(()=>P?P.map((K,Q)=>{const G=String(K||"").trim(),z=G.toUpperCase();return z.includes("CONTO")||z.includes("DESCRIZIONE")||z.includes("FAMIGLIA")||z.includes("ANALITICA")?{name:G,index:Q}:null}).filter(Boolean):[],[P]),H=_.useMemo(()=>{const K={};return R.forEach(Q=>{const G=new Set;I.forEach(z=>{const ie=String(z[Q.index]||"").trim();ie&&G.add(ie)}),K[Q.name]=Array.from(G).sort()}),K},[I,R]),q=_.useMemo(()=>I.filter(K=>R.every(Q=>{const G=w[Q.name];return!G||G==="all"?!0:String(K[Q.index]||"").trim()===G})),[I,w,R]),X=(K,Q)=>{y(G=>({...G,[K]:Q}))};return e?i?x.jsx("div",{className:"p-8 text-center",children:"Caricamento dati..."}):!r||r.length===0?x.jsxs("div",{"data-testid":"page-source",className:"p-8",children:[x.jsx(Ze,{title:"Source Data",subtitle:"Dati non disponibili"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center mt-6",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Nessun dato Source presente."})})]}):x.jsxs("div",{"data-testid":"page-source",className:"h-[calc(100vh-4rem)] flex flex-col p-6 animate-in fade-in duration-500 box-border",children:[x.jsxs("div",{className:"flex-none mb-4 space-y-4",children:[x.jsx("div",{className:"flex justify-between items-start",children:x.jsxs("div",{className:"bg-primary rounded-lg p-6 text-primary-foreground shadow-lg flex-1 mr-4",children:[x.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Source Data"}),x.jsxs("p",{className:"opacity-90",children:["Dati originali importati - ",e.name]})]})}),x.jsxs("div",{className:"flex flex-col gap-4",children:[g&&x.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.jsx("button",{onClick:()=>o("current"),className:S("current"),children:"Anno Corrente"}),x.jsx("button",{onClick:()=>o("previous"),className:S("previous"),children:"Anno Precedente"}),x.jsx("button",{onClick:()=>o("all"),className:S("all"),children:"Vista Completa (Raw)"})]}),R.length>0&&x.jsxs(Rt,{className:"p-4 flex flex-wrap gap-4 items-center bg-card border shadow-sm",children:[x.jsx("span",{className:"text-sm font-semibold text-muted-foreground mr-2",children:"Filtra per:"}),R.map(K=>{var Q;return x.jsxs("div",{className:"flex flex-col gap-1 min-w-[200px]",children:[x.jsx("label",{className:"text-xs font-medium text-muted-foreground ml-1",children:K.name}),x.jsxs(Yu,{value:w[K.name]||"all",onValueChange:G=>X(K.name,G),children:[x.jsx(Yl,{className:"h-9 w-full",children:x.jsx(Qu,{placeholder:"Tutti"})}),x.jsxs(Ql,{children:[x.jsx(kt,{value:"all",children:"Tutti"}),(Q=H[K.name])==null?void 0:Q.map((G,z)=>x.jsx(kt,{value:G,children:G},z))]})]})]},K.index)}),Object.keys(w).some(K=>w[K]&&w[K]!=="all")&&x.jsx("button",{onClick:()=>y({}),className:"h-9 px-4 py-2 mt-auto text-sm font-medium text-destructive hover:bg-destructive/10 rounded-md transition-colors",children:"Reset Filtri"})]})]})]}),x.jsxs(Rt,{className:"flex-1 min-h-0 flex flex-col overflow-hidden shadow-sm border bg-card",children:[x.jsxs("div",{className:"flex-none p-4 border-b bg-muted/20 flex items-center justify-between",children:[x.jsx("h3",{className:"text-lg font-bold",children:a==="current"?"Dati Esercizio Corrente":a==="previous"?"Dati Esercizio Precedente":"Foglio Completo"}),x.jsxs("div",{className:"flex items-center gap-2",children:[I.length!==q.length&&x.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["Filtrati: ",q.length," su ",I.length]}),x.jsxs("span",{className:"text-sm font-medium text-muted-foreground bg-background px-2 py-1 rounded border shadow-sm",children:[q.length," righe"]})]})]}),x.jsx("div",{className:"flex-1 overflow-auto relative w-full",children:x.jsxs("table",{className:"w-full border-collapse min-w-max",children:[x.jsx("thead",{className:"sticky top-0 z-30",children:x.jsx("tr",{children:P.map((K,Q)=>{const G=String(K||"").toUpperCase(),z=G.includes("CONTO")||G.includes("DESCRIZIONE")||G.includes("FAMIGLIA")||G.includes("ANALITICA")||G.includes("NOTE"),ie=Q===0,ae=ie||z?"text-left":"text-right",D=ie?"sticky left-0 z-40 shadow-[2px_0_4px_rgba(0,0,0,0.05)]":"";return x.jsx("th",{className:`bg-muted px-3 py-3 text-sm font-semibold text-muted-foreground border-b-2 border-border whitespace-nowrap ${ae} ${D}`,children:String(K||"")},Q)})})}),x.jsx("tbody",{children:q.map((K,Q)=>{const G=K.join(" ").toUpperCase(),z=G.includes("TOTALE")||G.includes("RISULTATO")||G.includes("EBITDA")||G.includes("COSTI DIRETTI"),ie=G.includes("RISULTATO"),ae=ie?"bg-yellow-50":z?"bg-blue-50":"hover:bg-muted/50",D=z||ie?"font-bold":"";return x.jsx("tr",{className:`${ae} transition-colors border-b border-border last:border-0`,children:K.map((V,B)=>{const U=B===0,Y=String(P[B]||"").toUpperCase(),te=Y.includes("CONTO")||Y.includes("DESCRIZIONE")||Y.includes("FAMIGLIA")||Y.includes("ANALITICA")||Y.includes("NOTE"),oe=U||te?"text-left":"text-right",ne=U?`sticky left-0 z-20 shadow-[2px_0_4px_rgba(0,0,0,0.05)] ${ae==="hover:bg-muted/50"?"bg-card":ae}`:"";return x.jsx("td",{className:`px-3 py-3 text-sm whitespace-nowrap text-muted-foreground/90 ${oe} ${D} ${ne}`,children:k(V)},B)})},Q)})})]})})]})]}):x.jsxs("div",{"data-testid":"page-source",className:"p-8",children:[x.jsx(Ze,{title:"Source Data",subtitle:"Dati grezzi importati"}),x.jsx("div",{className:"p-8 bg-muted rounded-lg text-center mt-6",children:x.jsx("p",{className:"text-lg text-muted-foreground",children:"Seleziona un'azienda per visualizzare i dati"})})]})};function _J(){const{user:e,loading:t,isAdmin:r}=q0(),{selectedCompany:n}=Nn();if(t)return x.jsx("div",{className:"min-h-screen flex items-center justify-center",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const i=!0;if(!e&&i)return x.jsx(Tj,{});const s=r||!i;return x.jsxs("div",{className:"flex-1 w-full overflow-auto",children:[x.jsxs("div",{className:"sticky top-0 z-50 bg-background border-b px-4 py-3 md:px-6 md:py-4 flex items-center gap-3 md:hidden",children:[x.jsx(BA,{"data-testid":"button-sidebar-toggle",className:"min-h-[44px] min-w-[44px]"}),x.jsx("h1",{className:"text-lg font-semibold",children:"Awentia Bilanci"})]}),x.jsxs("div",{className:"p-4 md:p-8",children:[s&&x.jsx(Vj,{}),!s&&n&&x.jsx("div",{className:"mb-6 p-4 bg-muted rounded-lg",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium",children:"Azienda:"}),x.jsx("span",{className:"text-sm",children:n.name})]})}),!i,x.jsxs(_N,{children:[x.jsx(Ln,{path:"/",component:c$}),x.jsx(Ln,{path:"/ce-dettaglio",component:u$}),x.jsx(Ln,{path:"/ce-dettaglio-mensile",component:d$}),x.jsx(Ln,{path:"/ce-dettaglio-mensile/:mese",component:p$}),x.jsx(Ln,{path:"/ce-sintetico",component:m$}),x.jsx(Ln,{path:"/ce-sintetico-mensile",component:g$}),x.jsx(Ln,{path:"/partitari",component:pV}),x.jsx(Ln,{path:"/source",component:bJ}),x.jsx(Ln,{path:"/github",component:mV}),x.jsx(Ln,{path:"/import",component:wJ}),x.jsx(Ln,{component:gV})]})]})]})}function SJ(){const e={"--sidebar-width":"20rem","--sidebar-width-icon":"4rem"};return x.jsx($N,{client:gk,children:x.jsxs(DC,{children:[x.jsx(wj,{children:x.jsx(ZT,{base:"/bilanci_dashboard/",children:x.jsx(XM,{style:e,children:x.jsxs("div",{className:"flex min-h-screen w-full bg-background",children:[x.jsx(yj,{}),x.jsx("main",{className:"flex-1 w-full overflow-auto",children:x.jsx(_J,{})})]})})})}),x.jsx(t8,{})]})})}BT(document.getElementById("root")).render(x.jsx(SJ,{}));
